import{j as e,c as gt,r as Q,g as ye,W as ee,T as Ft,R as qt,S as re,E as ne,a as xe,b as ke,n as ut,C as Ce,M as se,d as Mt,e as Se,F as $t,D as Gt,s as je,p as Zt,v as Ee,f as Lt,h as ie,i as At,k as ae,u as Kt,t as Te,l as Tt,m as Yt,o as Ae,q as ze,w as Rt,U as Ne,x as Ie,P as oe,y as Oe,z as Re,A as le,B as Be,G as Pe,H as Fe,I as Le,J as xt,K as ce,L as zt,N as Nt,O as De,Q as Bt,V as Ue,X as We,Y as Dt,Z as Ut,_ as Me,$ as Ge,a0 as Ze,a1 as He,a2 as Ve,a3 as qe}from"./assets/index-DbSbL4sG.js";const $e=I=>e.jsxs("svg",{...I,viewBox:"0 0 134 131",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M120.619 0.704712H13.8714C6.502 0.704712 0.527954 6.64798 0.527954 13.9794V117.225C0.527954 124.557 6.502 130.5 13.8714 130.5H120.619C127.988 130.5 133.962 124.557 133.962 117.225V13.9794C133.962 6.64798 127.988 0.704712 120.619 0.704712Z",fill:"url(#wptb_logo_paint0_linear_7_1042)"}),e.jsx("path",{d:"M106.489 28.0007H28.0248C26.8471 28.0007 25.8923 28.9506 25.8923 30.1223V44.4636C25.8923 45.6354 26.8471 46.5852 28.0248 46.5852H106.489C107.667 46.5852 108.621 45.6354 108.621 44.4636V30.1223C108.621 28.9506 107.667 28.0007 106.489 28.0007Z",fill:"white"}),e.jsx("path",{d:"M59.7869 56.3042H28.0249C26.8471 56.3042 25.8923 57.254 25.8923 58.4257V72.7671C25.8923 73.9388 26.8471 74.8887 28.0249 74.8887H59.7869C60.9647 74.8887 61.9195 73.9388 61.9195 72.7671V58.4257C61.9195 57.254 60.9647 56.3042 59.7869 56.3042Z",fill:"white"}),e.jsx("path",{d:"M106.489 56.3042H74.7267C73.549 56.3042 72.5942 57.254 72.5942 58.4257V72.7671C72.5942 73.9388 73.549 74.8887 74.7267 74.8887H106.489C107.667 74.8887 108.621 73.9388 108.621 72.7671V58.4257C108.621 57.254 107.667 56.3042 106.489 56.3042Z",fill:"white"}),e.jsx("path",{d:"M59.7631 84.6194H28.001C26.8233 84.6194 25.8685 85.5693 25.8685 86.741V101.082C25.8685 102.254 26.8233 103.204 28.001 103.204H59.7631C60.9409 103.204 61.8957 102.254 61.8957 101.082V86.741C61.8957 85.5693 60.9409 84.6194 59.7631 84.6194Z",fill:"white"}),e.jsx("path",{d:"M106.465 84.6194H74.7029C73.5251 84.6194 72.5703 85.5693 72.5703 86.741V101.082C72.5703 102.254 73.5251 103.204 74.7029 103.204H106.465C107.643 103.204 108.598 102.254 108.598 101.082V86.741C108.598 85.5693 107.643 84.6194 106.465 84.6194Z",fill:"white"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"wptb_logo_paint0_linear_7_1042",x1:"124.538",y1:"-5.75483",x2:"45.6569",y2:"93.515",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#29ABE2"}),e.jsx("stop",{offset:"1",stopColor:"#0071BC"})]})})]}),Ke=wp.i18n,St=I=>Ke.__(I,"wp-table-builder"),It=({setPage:I,page:U})=>e.jsxs("div",{className:"wptb-v2-nav",children:[e.jsx("div",{className:"wptb-v2-logo",children:e.jsx($e,{})}),e.jsxs("div",{children:[e.jsxs("button",{className:gt("wptb-v2-link-btn",{"wptb-active-nav":U==="tables"}),onClick:()=>I("tables"),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M20 4H4a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1M4 2a3 3 0 0 0-3 3v14a3 3 0 0 0 3 3h16a3 3 0 0 0 3-3V5a3 3 0 0 0-3-3zm2 5h2v2H6zm5 0a1 1 0 1 0 0 2h6a1 1 0 1 0 0-2zm-3 4H6v2h2zm2 1a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2h-6a1 1 0 0 1-1-1m-2 3H6v2h2zm2 1a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2h-6a1 1 0 0 1-1-1",clipRule:"evenodd"})}),e.jsx("span",{children:St("Table List")})]}),e.jsxs("button",{className:gt("wptb-v2-link-btn",{"wptb-active-nav":U==="create"}),onClick:()=>I("create"),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M18 14h2v3h3v2h-3v3h-2v-3h-3v-2h3zM4 3h14a2 2 0 0 1 2 2v7.08a6 6 0 0 0-4.32.92H12v4h1.08c-.11.68-.11 1.35 0 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2m0 4v4h6V7zm8 0v4h6V7zm-8 6v4h6v-4z"})}),e.jsx("span",{children:St("Add New")})]}),e.jsxs("button",{className:gt("wptb-v2-link-btn",{"wptb-active-nav":U==="import"}),onClick:()=>I("import"),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M4 3h14a2 2 0 0 1 2 2v7.08a6 6 0 0 0-4.32.92H12v4h1.08c-.11.68-.11 1.35 0 2H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2m0 4v4h6V7zm8 0v4h6V7zm-8 6v4h6v-4zm14.44 2v2h4v2h-4v2l-3-3z"})}),e.jsx("span",{children:St("Import")})]}),e.jsxs("button",{className:gt("wptb-v2-link-btn",{"wptb-active-nav":U==="export"}),onClick:()=>I("export"),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M4 3h14a2 2 0 0 1 2 2v7.08a6 6 0 0 0-4.32.92H12v4h1.08c-.11.68-.11 1.35 0 2H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2m0 4v4h6V7zm8 0v4h6V7zm-8 6v4h6v-4zm15.44 8v-2h-4v-2h4v-2l3 3z"})}),e.jsx("span",{children:St("Export")})]}),WPTB_CFG.SETTINGS.is_authorized&&e.jsxs("button",{className:gt("wptb-v2-link-btn",{"wptb-active-nav":U==="settings"}),onClick:()=>I("settings"),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5a3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97s-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1s.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64z"})}),e.jsx("span",{children:St("Settings")})]})]})]}),Ye=({apiData:I,setPage:U})=>{const l=k=>{!I||k<1||k>I.total_pages||k===I.current_page||U(k)};return e.jsx("div",{className:"wptb-v2-pagination",children:e.jsxs("div",{className:"wptb-v2-pagination-group",children:[e.jsx("button",{type:"button",className:gt({"wptb-v2-pagination-disabled":I.current_page===1}),onClick:()=>l(I.current_page-1),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeWidth:"2",d:"m15 6l-6 6l6 6"})})}),I.pages.map(k=>k!==0?e.jsx("button",{type:"button",className:gt({"wptb-v2-pagination-active":k===I.current_page}),onClick:()=>l(k),children:k},k):e.jsx("p",{className:"wptb-page-divider",children:"..."})),e.jsx("button",{type:"button",className:gt({"wptb-v2-pagination-disabled":I.current_page===I.total_pages}),onClick:()=>l(I.current_page+1),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeWidth:"2",d:"m9 6l6 6l-6 6"})})})]})})},he=(I,U="asc")=>{const[l,k]=Q.useState({by:I,order:U});return Q.useMemo(()=>[l,h=>{let c="asc";l.by===h&&(c=l.order==="asc"?"desc":"asc"),k({by:h,order:c})}],[l])},Xe={loading:!0,posts:[],current_page:1,page_start:"...",page_end:"...",total_count:"...",pages:[],total_pages:1},de=({page:I,search:U,status:l,skipTables:k,sort:h,abortCtrl:c,refetchOnSkipChange:n})=>{const[s,a]=Q.useState(Xe),[m,_]=Q.useState(!1),f=(o,b)=>{if(b){let i;["id","title","date","modified"].includes(h.by||"id")?i=h.by:i="id",i!=="id"?h.order==="asc"?o.sort((p,d)=>p[i].localeCompare(d[i])):o.sort((p,d)=>d[i].localeCompare(p[i])):h.order==="asc"?o.sort((p,d)=>p[i]-d[i]):o.sort((p,d)=>d[i]-p[i])}a({...s,posts:o})},y=n?k:"";return Q.useEffect(()=>{const o=new URLSearchParams({page:I.toString(),search:U||"",status:l||"",except:k||"",...h?{sort_by:h.by,sort_order:h.order}:{}}),b=`${WPTB_CFG.API_BASE}/v1/tables?${o.toString()}`;a(i=>({...i,current_page:I,loading:!0})),fetch(b,{signal:c==null?void 0:c.signal,headers:{"X-WP-Nonce":WPTB_CFG.NONCE.wp_rest}}).then(i=>i.json()).then(i=>{const{posts:p,current_page:d,total_pages:C,total_count:S}=i,z=(d-1)*i.per_page+1,A=z+p.length-1;a({loading:!1,posts:p,current_page:d,page_start:z,page_end:A,pages:ye(C,2),total_pages:C,total_count:S})}).catch(()=>{a({...s,loading:!1}),WPTB.utils.notify("Something went wrong! Please reload the page!","error",0)})},[I,U,l,h.by,h.order,y,m]),[s,f,()=>_(!m)]},ue={duplicate:{icon:ee,title:"Sure to duplicate?",text:I=>`Table: <b>${I.targetTitle}</b> is set to be duplicated.<br/> Are you sure?`,className:"wptb-modal-warning",url:"duplicate"},trash:{icon:Ft,title:"Sure to trash?",text:I=>`Table: <b>${I.targetTitle}</b> is set to be trashed. <br />Are you sure?`,className:"wptb-modal-danger",url:"trash"},restore:{icon:qt,title:"Sure to restore?",text:I=>`Table: <b>${I.targetTitle}</b> is set to be trashed. <br />Are you sure?`,className:"wptb-modal-warning",url:"restore"},delete:{icon:Ft,title:"Sure to delete?",text:I=>`Table: <b>${I.targetTitle}</b> is set to be deleted. Are you sure?<br/> It will be deleted permanently.`,className:"wptb-modal-danger",url:"delete"},trash_bulk:{icon:Ft,title:"Sure to trash?",text:(I,U)=>`<b>${U}</b> table(s) are set to be trashed. <br />Are you sure?`,className:"wptb-modal-danger",url:"trash_bulk"},restore_bulk:{icon:qt,title:"Sure to restore?",text:(I,U)=>`<b>${U}</b> table(s) are set to be restored. <br />Are you sure?`,className:"wptb-modal-warning",url:"restore_bulk"}},Je=async({action:I,id:U,ids:l})=>{const k=ue[I].url;if(!k)return{action:I,id:U,ids:l,res:{}};try{const h=await fetch(WPTB_CFG.API_BASE+"/v1/"+k,{method:"POST",headers:{"Content-type":"application/json","X-WP-Nonce":WPTB_CFG.NONCE.wp_rest},body:JSON.stringify({id:U,ids:l,security_code:WPTB_CFG.SECURITY_CODE})}),c=await h.json();if(!h.ok)throw new Error(c.message||`HTTP error! Status: ${h.status}`);return{action:I,id:U,ids:l,res:c}}catch(h){return{action:I,id:U,ids:l,res:{error:h.message}}}},Qe=({apiData:I,setPage:U,isTrash:l,setTables:k,sortBy:h,sortOrder:c,setSort:n,search:s,setSearch:a})=>{const m=Q.useRef({}),_=Q.useRef({}),[f,y]=Q.useState(""),[o,b]=Q.useState(0),[i,p]=Q.useState(null);Q.useEffect(()=>{m.current={},b(0)},[I]);const d=N=>{U("builder",{table:N})},C=()=>{o<I.posts.length?(I.posts.forEach(N=>{m.current[N.id]=!0}),b(I.posts.length)):(m.current={},b(0))},S=N=>{m.current[N]?(delete m.current[N],b(o-1)):(m.current[N]=!0,b(o+1))},z=async()=>{var v;if(!i)return;if(i.targetId){if(_.current[i.targetId])return;_.current[i.targetId]=!0}else for(const O in m.current){if(_.current[O])return;_.current[O]=m.current[O]}const N=Object.keys(m.current).map(Number);m.current={},b(0),p(null);const{action:x,id:u,ids:E,res:G}=await Je({action:i.action,id:i.targetId,ids:N});if(E!=null&&E.length?E.forEach(O=>{delete _.current[O]}):delete _.current[u],G.error){ut(G.error,"error",0),k([...I.posts]);return}if(G.message&&ut(G.message,"success"),x==="trash"||x==="restore"||x==="delete")k([...I.posts.filter(O=>O.id!==u)]);else if(x==="trash_bulk"||x==="restore_bulk")k([...I.posts.filter(O=>!(E!=null&&E.includes(O.id)))]);else{const O=[...I.posts];(v=G.posts)==null||v.forEach(r=>{O.push(r)}),k(O,!0)}},A=i&&ue[i.action];h=h||"id";const W=N=>{window.open(`${WPTB_CFG.HOME_URL}/?post_type=wptb-tables&p=${N}&_wpnonce=${WPTB_CFG.NONCE.table}`,"_blank")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"wptb-v2-table-upper-group",children:[e.jsxs("div",{className:"wptb-v2-bulk-actions",children:[e.jsxs("select",{value:f,onChange:N=>y(N.target.value),children:[e.jsx("option",{value:"",children:"Bulk Actions"}),l?e.jsx("option",{value:"restore_bulk",children:"Restore"}):e.jsx("option",{value:"trash_bulk",children:"Delete"})]}),e.jsx("button",{type:"button",onClick:()=>o>0&&p({action:f}),children:"Apply"}),e.jsxs("p",{children:[e.jsx("b",{children:o})," items selected"]})]}),e.jsx(re,{placeholder:"Search table...",onChange:a,value:s})]}),e.jsx("div",{className:"wptb-v2-table-list-wrapper",children:e.jsxs("table",{className:gt({"wptb-v2-table-list":!I.loading,"wptb-v2-table-loading":I.loading}),children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"30px"}}),e.jsx("col",{}),e.jsx("col",{}),e.jsx("col",{}),e.jsx("col",{})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:o===I.posts.length,onChange:C})}),e.jsxs("th",{children:["Title",e.jsx("button",{type:"button",onClick:()=>n("title"),className:gt("wptb-v2-table-sort-btn",{"wptb-sort-btn-asc":h==="title"&&c==="asc","wptb-sort-btn-desc":h==="title"&&c!=="asc"})})]}),e.jsxs("th",{children:["Shortcode",e.jsx("button",{type:"button",onClick:()=>n("id"),className:gt("wptb-v2-table-sort-btn",{"wptb-sort-btn-asc":h==="id"&&c==="asc","wptb-sort-btn-desc":h==="id"&&c!=="asc"})})]}),e.jsxs("th",{children:["Created",e.jsx("button",{type:"button",onClick:()=>n("date"),className:gt("wptb-v2-table-sort-btn",{"wptb-sort-btn-asc":h==="date"&&c==="asc","wptb-sort-btn-desc":h==="date"&&c!=="asc"})})]}),e.jsxs("th",{children:["Last Modified",e.jsx("button",{type:"button",onClick:()=>n("modified"),className:gt("wptb-v2-table-sort-btn",{"wptb-sort-btn-asc":h==="modified"&&c==="asc","wptb-sort-btn-desc":h==="modified"&&c!=="asc"})})]})]})}),e.jsx("tbody",{children:I.loading?Array(10).fill(0).map((N,x)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{})}),e.jsx("td",{children:e.jsx("div",{})}),e.jsx("td",{children:e.jsx("div",{})}),e.jsx("td",{children:e.jsx("div",{})}),e.jsx("td",{children:e.jsx("div",{})})]},x)):I.posts.length?I.posts.map(N=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("input",{type:"checkbox",checked:m.current[N.id],onChange:()=>S(N.id)}),_.current[N.id]&&e.jsx("div",{className:"wptb-v2-table-pending",children:ne})]}),e.jsxs("td",{children:[e.jsxs("p",{children:[N.is_template?e.jsx(xe,{}):"",N.title||"[Untitled]"]}),l?e.jsxs("div",{className:"wptb-v2-table-actions",children:[e.jsx("button",{className:"wptb-table-action-restore",type:"button",onClick:()=>p({action:"restore",targetId:N.id,targetTitle:N.title}),children:"Restore"}),e.jsx("button",{className:"wptb-table-action-trash",type:"button",onClick:()=>p({action:"delete",targetId:N.id,targetTitle:N.title}),children:"Delete"})]}):e.jsxs("div",{className:"wptb-v2-table-actions",children:[e.jsx("button",{className:"wptb-table-action-edit",type:"button",onClick:()=>d(N.id),children:"Edit"}),e.jsx("button",{className:"wptb-table-action-duplicate",type:"button",onClick:()=>p({action:"duplicate",targetId:N.id,targetTitle:N.title}),children:"Duplicate"}),e.jsx("button",{type:"button",className:"wptb-table-action-preview",onClick:()=>W(N.id),children:"Preview"}),e.jsx("button",{className:"wptb-table-action-trash",type:"button",onClick:()=>p({action:"trash",targetId:N.id,targetTitle:N.title}),children:"Trash"})]})]}),e.jsx("td",{children:e.jsxs("div",{className:"wptb-v2-shortcode-col",children:["[wptb id=",N.id,"]",e.jsx("button",{type:"button",className:"wptb-v2-copy-btn",onClick:()=>{ke(`[wptb id=${N.id}]`),ut("Copied to clipboard!","success")},children:Ce})]})}),e.jsx("td",{children:N.date}),e.jsx("td",{children:N.modified})]},N.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,children:e.jsx("p",{children:"No results found"})})})})]})}),A&&e.jsxs(se,{onClose:()=>p(null),title:A.title,icon:A.icon,className:A.className,children:[e.jsx("p",{dangerouslySetInnerHTML:{__html:A.text(i,o)}}),e.jsxs("div",{className:"wptb-v2-modal-actions",children:[e.jsx("button",{type:"button",onClick:z,children:"Yes"}),e.jsx("button",{type:"button",onClick:()=>p(null),children:"No"})]})]})]})},tr=({setPage:I,page_num:U,search:l,status:k,sort_by:h,sort_order:c})=>{const n=Q.useRef(),s=Q.useRef(),[a,m]=Q.useState(l),[_,f]=de({page:U?parseInt(U):1,search:l,status:k,sort:{by:h||"id",order:c||"desc"},abortCtrl:n.current});Q.useEffect(()=>{const b=a==null?void 0:a.trim();if(l){if(b&&b.length>0&&b.length<2)return}else if(!b||b.length<2)return;s.current&&clearTimeout(s.current),n.current&&n.current.abort(),n.current=new AbortController,s.current=setTimeout(()=>{I("tables",{search:a,status:k}),n.current=void 0,s.current=void 0},500)},[a]);const y=b=>{I("tables",{page_num:1,search:l,status:k,sort_by:b,sort_order:b===(h||"id")&&c==="asc"?"desc":"asc"})},o=k==="trash";return e.jsxs("div",{className:"wptb-v2-page",children:[e.jsx(It,{setPage:I,page:"tables"}),e.jsxs("div",{className:"wptb-v2-page-content",children:[e.jsxs("div",{className:"wptb-v2-page-content-top",children:[e.jsx("h2",{children:"Table List"}),e.jsxs("div",{className:"wptb-v2-table-status-btns",children:[e.jsx("button",{type:"button",className:gt({"wptb-v2-active-section":!o}),onClick:()=>{I("tables",{})},children:"ALL"}),e.jsx("button",{type:"button",className:gt({"wptb-v2-active-section":o}),onClick:()=>{I("tables",{status:"trash"})},children:"TRASH"})]})]}),e.jsxs("div",{className:"wptb-v2-table-list-area",children:[e.jsxs("p",{className:"wptb-v2-pagination-info",children:["Showing ",e.jsx("b",{children:_.page_start})," to ",e.jsx("b",{children:_.page_end})," of"," ",e.jsx("b",{children:_.total_count})," entries"]}),e.jsx(Qe,{apiData:_,setPage:I,isTrash:o,setTables:f,setSort:y,sortBy:h,sortOrder:c,search:a,setSearch:m}),e.jsx(Ye,{apiData:_,setPage:b=>I("tables",{page_num:b,search:l,sort_by:h,sort_order:c})})]})]})]})},er=({setPage:I})=>{const[U,l]=Q.useState(4),[k,h]=Q.useState(4),c=()=>{const n=Se(U,k);I("builder",{table:n})};return e.jsxs("div",{className:"wptb-v2-create-table",children:[e.jsx("table",{children:e.jsx("tbody",{children:U<50&&k<50?Array(U).fill(0).map((n,s)=>e.jsx("tr",{children:Array(k).fill(0).map((a,m)=>e.jsx("td",{},m))},s)):e.jsx("tr",{children:e.jsx("td",{})})})}),e.jsxs("div",{className:"wptb-v2-create-table-form",children:[e.jsx("div",{className:"wptb-v2-create-table-form-input",children:e.jsx(Mt,{label:"Number of rows",min:2,max:20,value:U,onChange:l,allowOutOfRange:!0})}),e.jsx("div",{className:"wptb-v2-create-table-form-input",children:e.jsx(Mt,{label:"Number of columns",min:2,max:20,value:k,onChange:h,allowOutOfRange:!0})}),e.jsx("button",{type:"button",className:"wptb-v2-create-btn",onClick:c,children:"Create New"})]})]})},rr=({content:I})=>{const U=Q.useRef(null);return Q.useLayoutEffect(()=>{if(!U.current)return;const l=U.current,k=l.querySelector("table"),{width:h,height:c}=l.getBoundingClientRect(),n=k.dataset.wptbTableContainerMaxWidth;k.style.width="auto",k.style.minWidth=n?`${n}px`:"700px",k.style.transform="";const s=20,{width:a,height:m}=k.getBoundingClientRect(),_=h/(a+s),f=c/(m+s);k.style.transform=`scale(${Math.min(_,f)})`},[]),e.jsx("div",{ref:U,className:"wptb-v2-table-template-html",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:I}})})},Ct=[],nr=({setPage:I,search:U})=>{const[l,k]=Q.useState(Ct),[h,c]=Q.useState(!0),[n,s]=Q.useState(),a=Q.useRef(null);Q.useEffect(()=>{if(Ct.length){c(!1),k(Ct),a.current=new $t(Ct,{includeScore:!0,threshold:.3,keys:["title"]});return}let f=new AbortController;const y=`${WPTB_CFG.API_BASE}/v1/patterns`;return fetch(y,{signal:f.signal,headers:{"X-WP-Nonce":WPTB_CFG.NONCE.wp_rest}}).then(o=>o.json()).then(o=>{if(c(!1),!Ct.length){if(o.error)throw new Error(o.error);k(o.patterns),Ct.push(...o.patterns),a.current=new $t(Ct,{includeScore:!0,threshold:.3,keys:["title"]})}}).catch(()=>{}).finally(()=>{f=void 0}),()=>f==null?void 0:f.abort()},[]);const m=Q.useCallback(f=>{var y;if(f==="")k(Ct);else{const o=(y=a.current)==null?void 0:y.search(f),b=o==null?void 0:o.map(i=>i.item);k(b||[])}},[]);Q.useEffect(()=>{const f=U==null?void 0:U.trim();if(!f||f.length<2){k(Ct);return}m(f)},[U,m]);const _=async f=>{if(f.is_upsell){je("patterns");return}if(n){ut("A request is already in progress","error");return}s(f.name);const y=(d,C)=>{const S=Zt(d);S.title="Clone of: "+C;const z=Ee();S.id=void 0,S.tags=[],Lt.dispatch(ie({id:z,table:S})),I("builder",{table:z})};if(f.content){y(f.content,f.title);return}const o=`${WPTB_CFG.API_BASE}/v1/patterns?nonce=${WPTB_CFG.SECURITY_CODE}&name=${f.name}`,b=await fetch(o,{headers:{"Content-Type":"application/json"}});if(!b.ok){ut("Something went wrong","error"),s(void 0);return}const i=await b.json();if(i.error){ut(i.error,"error"),s(void 0);return}const p=i.pattern;y(p.content,p.title)};return e.jsx("div",{className:"wptb-v2-table-templates",children:h?Array.from({length:9},(f,y)=>e.jsxs("div",{className:"wptb-v2-table-template",children:[e.jsx("div",{className:"wptb-v2-table-template-preview",children:e.jsx("div",{className:"wptb-v2-table-template-preview-loading"})}),e.jsx("div",{className:"wptb-v2-table-template-title",children:e.jsx("div",{className:"wptb-v2-table-template-title-loading"})})]},y)):l.map(f=>e.jsxs("button",{className:gt("wptb-v2-table-template",{"wptb-v2-table-template-upsell":f.is_upsell}),onClick:()=>_(f),children:[f.content?e.jsx(rr,{content:f.content}):e.jsxs("div",{className:"wptb-v2-table-template-preview",children:[e.jsx("img",{src:WPTB_CFG.PLUGIN_URL+"/v2/assets/patterns/images/"+f.name+".png",alt:f.name}),n===f.name&&e.jsx("div",{className:"wptb-v2-table-template-preview-creating",children:e.jsx(Gt,{})})]}),e.jsx("div",{className:"wptb-v2-table-template-title",children:f.title})]},f.name))})},sr=({setPage:I,search:U})=>{const[l,k]=Q.useState(U||""),h=Q.useRef();return Q.useEffect(()=>{const c=l==null?void 0:l.trim();if(U){if(c&&c.length>0&&c.length<2)return}else if(!c||c.length<2)return;h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{I("create",{search:l}),h.current=void 0},500)},[l]),e.jsxs("div",{className:"wptb-v2-page wptb-v2-create-page",children:[e.jsx(It,{setPage:I,page:"create"}),e.jsxs("div",{className:"wptb-v2-page-content",children:[e.jsxs("div",{className:"wptb-v2-page-content-top",children:[e.jsx("h2",{children:St("New Table")}),e.jsx(re,{value:l,onChange:k,placeholder:"Search templates..."})]}),e.jsxs("div",{className:"wptb-v2-page-content-main",children:[e.jsx(er,{setPage:I}),e.jsx("div",{className:"wptb-v2-divider",children:"or"}),e.jsx("h2",{children:"Choose from templates"}),e.jsx(nr,{setPage:I,search:U})]})]})]})};function Pt(I){throw new Error('Could not dynamically require "'+I+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fe={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(I,U){(function(l){I.exports=l()})(function(){return function l(k,h,c){function n(m,_){if(!h[m]){if(!k[m]){var f=typeof Pt=="function"&&Pt;if(!_&&f)return f(m,!0);if(s)return s(m,!0);var y=new Error("Cannot find module '"+m+"'");throw y.code="MODULE_NOT_FOUND",y}var o=h[m]={exports:{}};k[m][0].call(o.exports,function(b){var i=k[m][1][b];return n(i||b)},o,o.exports,l,k,h,c)}return h[m].exports}for(var s=typeof Pt=="function"&&Pt,a=0;a<c.length;a++)n(c[a]);return n}({1:[function(l,k,h){var c=l("./utils"),n=l("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";h.encode=function(a){for(var m,_,f,y,o,b,i,p=[],d=0,C=a.length,S=C,z=c.getTypeOf(a)!=="string";d<a.length;)S=C-d,f=z?(m=a[d++],_=d<C?a[d++]:0,d<C?a[d++]:0):(m=a.charCodeAt(d++),_=d<C?a.charCodeAt(d++):0,d<C?a.charCodeAt(d++):0),y=m>>2,o=(3&m)<<4|_>>4,b=1<S?(15&_)<<2|f>>6:64,i=2<S?63&f:64,p.push(s.charAt(y)+s.charAt(o)+s.charAt(b)+s.charAt(i));return p.join("")},h.decode=function(a){var m,_,f,y,o,b,i=0,p=0,d="data:";if(a.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var C,S=3*(a=a.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(a.charAt(a.length-1)===s.charAt(64)&&S--,a.charAt(a.length-2)===s.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(C=n.uint8array?new Uint8Array(0|S):new Array(0|S);i<a.length;)m=s.indexOf(a.charAt(i++))<<2|(y=s.indexOf(a.charAt(i++)))>>4,_=(15&y)<<4|(o=s.indexOf(a.charAt(i++)))>>2,f=(3&o)<<6|(b=s.indexOf(a.charAt(i++))),C[p++]=m,o!==64&&(C[p++]=_),b!==64&&(C[p++]=f);return C}},{"./support":30,"./utils":32}],2:[function(l,k,h){var c=l("./external"),n=l("./stream/DataWorker"),s=l("./stream/Crc32Probe"),a=l("./stream/DataLengthProbe");function m(_,f,y,o,b){this.compressedSize=_,this.uncompressedSize=f,this.crc32=y,this.compression=o,this.compressedContent=b}m.prototype={getContentWorker:function(){var _=new n(c.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),f=this;return _.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),_},getCompressedWorker:function(){return new n(c.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},m.createWorkerFrom=function(_,f,y){return _.pipe(new s).pipe(new a("uncompressedSize")).pipe(f.compressWorker(y)).pipe(new a("compressedSize")).withStreamInfo("compression",f)},k.exports=m},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(l,k,h){var c=l("./stream/GenericWorker");h.STORE={magic:"\0\0",compressWorker:function(){return new c("STORE compression")},uncompressWorker:function(){return new c("STORE decompression")}},h.DEFLATE=l("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(l,k,h){var c=l("./utils"),n=function(){for(var s,a=[],m=0;m<256;m++){s=m;for(var _=0;_<8;_++)s=1&s?3988292384^s>>>1:s>>>1;a[m]=s}return a}();k.exports=function(s,a){return s!==void 0&&s.length?c.getTypeOf(s)!=="string"?function(m,_,f,y){var o=n,b=y+f;m^=-1;for(var i=y;i<b;i++)m=m>>>8^o[255&(m^_[i])];return-1^m}(0|a,s,s.length,0):function(m,_,f,y){var o=n,b=y+f;m^=-1;for(var i=y;i<b;i++)m=m>>>8^o[255&(m^_.charCodeAt(i))];return-1^m}(0|a,s,s.length,0):0}},{"./utils":32}],5:[function(l,k,h){h.base64=!1,h.binary=!1,h.dir=!1,h.createFolders=!0,h.date=null,h.compression=null,h.compressionOptions=null,h.comment=null,h.unixPermissions=null,h.dosPermissions=null},{}],6:[function(l,k,h){var c=null;c=typeof Promise<"u"?Promise:l("lie"),k.exports={Promise:c}},{lie:37}],7:[function(l,k,h){var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",n=l("pako"),s=l("./utils"),a=l("./stream/GenericWorker"),m=c?"uint8array":"array";function _(f,y){a.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=y,this.meta={}}h.magic="\b\0",s.inherits(_,a),_.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(m,f.data),!1)},_.prototype.flush=function(){a.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},_.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},_.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(y){f.push({data:y,meta:f.meta})}},h.compressWorker=function(f){return new _("Deflate",f)},h.uncompressWorker=function(){return new _("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(l,k,h){function c(o,b){var i,p="";for(i=0;i<b;i++)p+=String.fromCharCode(255&o),o>>>=8;return p}function n(o,b,i,p,d,C){var S,z,A=o.file,W=o.compression,N=C!==m.utf8encode,x=s.transformTo("string",C(A.name)),u=s.transformTo("string",m.utf8encode(A.name)),E=A.comment,G=s.transformTo("string",C(E)),v=s.transformTo("string",m.utf8encode(E)),O=u.length!==A.name.length,r=v.length!==E.length,M="",tt="",F="",et=A.dir,L=A.date,nt={crc32:0,compressedSize:0,uncompressedSize:0};b&&!i||(nt.crc32=o.crc32,nt.compressedSize=o.compressedSize,nt.uncompressedSize=o.uncompressedSize);var P=0;b&&(P|=8),N||!O&&!r||(P|=2048);var j=0,X=0;et&&(j|=16),d==="UNIX"?(X=798,j|=function($,lt){var dt=$;return $||(dt=lt?16893:33204),(65535&dt)<<16}(A.unixPermissions,et)):(X=20,j|=function($){return 63&($||0)}(A.dosPermissions)),S=L.getUTCHours(),S<<=6,S|=L.getUTCMinutes(),S<<=5,S|=L.getUTCSeconds()/2,z=L.getUTCFullYear()-1980,z<<=4,z|=L.getUTCMonth()+1,z<<=5,z|=L.getUTCDate(),O&&(tt=c(1,1)+c(_(x),4)+u,M+="up"+c(tt.length,2)+tt),r&&(F=c(1,1)+c(_(G),4)+v,M+="uc"+c(F.length,2)+F);var K="";return K+=`
\0`,K+=c(P,2),K+=W.magic,K+=c(S,2),K+=c(z,2),K+=c(nt.crc32,4),K+=c(nt.compressedSize,4),K+=c(nt.uncompressedSize,4),K+=c(x.length,2),K+=c(M.length,2),{fileRecord:f.LOCAL_FILE_HEADER+K+x+M,dirRecord:f.CENTRAL_FILE_HEADER+c(X,2)+K+c(G.length,2)+"\0\0\0\0"+c(j,4)+c(p,4)+x+M+G}}var s=l("../utils"),a=l("../stream/GenericWorker"),m=l("../utf8"),_=l("../crc32"),f=l("../signature");function y(o,b,i,p){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=i,this.encodeFileName=p,this.streamFiles=o,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(y,a),y.prototype.push=function(o){var b=o.meta.percent||0,i=this.entriesCount,p=this._sources.length;this.accumulate?this.contentBuffer.push(o):(this.bytesWritten+=o.data.length,a.prototype.push.call(this,{data:o.data,meta:{currentFile:this.currentFile,percent:i?(b+100*(i-p-1))/i:100}}))},y.prototype.openedSource=function(o){this.currentSourceOffset=this.bytesWritten,this.currentFile=o.file.name;var b=this.streamFiles&&!o.file.dir;if(b){var i=n(o,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(o){this.accumulate=!1;var b=this.streamFiles&&!o.file.dir,i=n(o,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(i.dirRecord),b)this.push({data:function(p){return f.DATA_DESCRIPTOR+c(p.crc32,4)+c(p.compressedSize,4)+c(p.uncompressedSize,4)}(o),meta:{percent:100}});else for(this.push({data:i.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var o=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var i=this.bytesWritten-o,p=function(d,C,S,z,A){var W=s.transformTo("string",A(z));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(d,2)+c(d,2)+c(C,4)+c(S,4)+c(W.length,2)+W}(this.dirRecords.length,i,o,this.zipComment,this.encodeFileName);this.push({data:p,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(o){this._sources.push(o);var b=this;return o.on("data",function(i){b.processChunk(i)}),o.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),o.on("error",function(i){b.error(i)}),this},y.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(o){var b=this._sources;if(!a.prototype.error.call(this,o))return!1;for(var i=0;i<b.length;i++)try{b[i].error(o)}catch{}return!0},y.prototype.lock=function(){a.prototype.lock.call(this);for(var o=this._sources,b=0;b<o.length;b++)o[b].lock()},k.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(l,k,h){var c=l("../compressions"),n=l("./ZipFileWorker");h.generateWorker=function(s,a,m){var _=new n(a.streamFiles,m,a.platform,a.encodeFileName),f=0;try{s.forEach(function(y,o){f++;var b=function(C,S){var z=C||S,A=c[z];if(!A)throw new Error(z+" is not a valid compression method !");return A}(o.options.compression,a.compression),i=o.options.compressionOptions||a.compressionOptions||{},p=o.dir,d=o.date;o._compressWorker(b,i).withStreamInfo("file",{name:y,dir:p,date:d,comment:o.comment||"",unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions}).pipe(_)}),_.entriesCount=f}catch(y){_.error(y)}return _}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(l,k,h){function c(){if(!(this instanceof c))return new c;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var n=new c;for(var s in this)typeof this[s]!="function"&&(n[s]=this[s]);return n}}(c.prototype=l("./object")).loadAsync=l("./load"),c.support=l("./support"),c.defaults=l("./defaults"),c.version="3.10.1",c.loadAsync=function(n,s){return new c().loadAsync(n,s)},c.external=l("./external"),k.exports=c},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(l,k,h){var c=l("./utils"),n=l("./external"),s=l("./utf8"),a=l("./zipEntries"),m=l("./stream/Crc32Probe"),_=l("./nodejsUtils");function f(y){return new n.Promise(function(o,b){var i=y.decompressed.getContentWorker().pipe(new m);i.on("error",function(p){b(p)}).on("end",function(){i.streamInfo.crc32!==y.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):o()}).resume()})}k.exports=function(y,o){var b=this;return o=c.extend(o||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),_.isNode&&_.isStream(y)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):c.prepareContent("the loaded zip file",y,!0,o.optimizedBinaryString,o.base64).then(function(i){var p=new a(o);return p.load(i),p}).then(function(i){var p=[n.Promise.resolve(i)],d=i.files;if(o.checkCRC32)for(var C=0;C<d.length;C++)p.push(f(d[C]));return n.Promise.all(p)}).then(function(i){for(var p=i.shift(),d=p.files,C=0;C<d.length;C++){var S=d[C],z=S.fileNameStr,A=c.resolve(S.fileNameStr);b.file(A,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:o.createFolders}),S.dir||(b.file(A).unsafeOriginalName=z)}return p.zipComment.length&&(b.comment=p.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(l,k,h){var c=l("../utils"),n=l("../stream/GenericWorker");function s(a,m){n.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(m)}c.inherits(s,n),s.prototype._bindStream=function(a){var m=this;(this._stream=a).pause(),a.on("data",function(_){m.push({data:_,meta:{percent:0}})}).on("error",function(_){m.isPaused?this.generatedError=_:m.error(_)}).on("end",function(){m.isPaused?m._upstreamEnded=!0:m.end()})},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},k.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(l,k,h){var c=l("readable-stream").Readable;function n(s,a,m){c.call(this,a),this._helper=s;var _=this;s.on("data",function(f,y){_.push(f)||_._helper.pause(),m&&m(y)}).on("error",function(f){_.emit("error",f)}).on("end",function(){_.push(null)})}l("../utils").inherits(n,c),n.prototype._read=function(){this._helper.resume()},k.exports=n},{"../utils":32,"readable-stream":16}],14:[function(l,k,h){k.exports={isNode:typeof Buffer<"u",newBufferFrom:function(c,n){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(c,n);if(typeof c=="number")throw new Error('The "data" argument must not be a number');return new Buffer(c,n)},allocBuffer:function(c){if(Buffer.alloc)return Buffer.alloc(c);var n=new Buffer(c);return n.fill(0),n},isBuffer:function(c){return Buffer.isBuffer(c)},isStream:function(c){return c&&typeof c.on=="function"&&typeof c.pause=="function"&&typeof c.resume=="function"}}},{}],15:[function(l,k,h){function c(A,W,N){var x,u=s.getTypeOf(W),E=s.extend(N||{},_);E.date=E.date||new Date,E.compression!==null&&(E.compression=E.compression.toUpperCase()),typeof E.unixPermissions=="string"&&(E.unixPermissions=parseInt(E.unixPermissions,8)),E.unixPermissions&&16384&E.unixPermissions&&(E.dir=!0),E.dosPermissions&&16&E.dosPermissions&&(E.dir=!0),E.dir&&(A=d(A)),E.createFolders&&(x=p(A))&&C.call(this,x,!0);var G=u==="string"&&E.binary===!1&&E.base64===!1;N&&N.binary!==void 0||(E.binary=!G),(W instanceof f&&W.uncompressedSize===0||E.dir||!W||W.length===0)&&(E.base64=!1,E.binary=!0,W="",E.compression="STORE",u="string");var v=null;v=W instanceof f||W instanceof a?W:b.isNode&&b.isStream(W)?new i(A,W):s.prepareContent(A,W,E.binary,E.optimizedBinaryString,E.base64);var O=new y(A,v,E);this.files[A]=O}var n=l("./utf8"),s=l("./utils"),a=l("./stream/GenericWorker"),m=l("./stream/StreamHelper"),_=l("./defaults"),f=l("./compressedObject"),y=l("./zipObject"),o=l("./generate"),b=l("./nodejsUtils"),i=l("./nodejs/NodejsStreamInputAdapter"),p=function(A){A.slice(-1)==="/"&&(A=A.substring(0,A.length-1));var W=A.lastIndexOf("/");return 0<W?A.substring(0,W):""},d=function(A){return A.slice(-1)!=="/"&&(A+="/"),A},C=function(A,W){return W=W!==void 0?W:_.createFolders,A=d(A),this.files[A]||c.call(this,A,null,{dir:!0,createFolders:W}),this.files[A]};function S(A){return Object.prototype.toString.call(A)==="[object RegExp]"}var z={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var W,N,x;for(W in this.files)x=this.files[W],(N=W.slice(this.root.length,W.length))&&W.slice(0,this.root.length)===this.root&&A(N,x)},filter:function(A){var W=[];return this.forEach(function(N,x){A(N,x)&&W.push(x)}),W},file:function(A,W,N){if(arguments.length!==1)return A=this.root+A,c.call(this,A,W,N),this;if(S(A)){var x=A;return this.filter(function(E,G){return!G.dir&&x.test(E)})}var u=this.files[this.root+A];return u&&!u.dir?u:null},folder:function(A){if(!A)return this;if(S(A))return this.filter(function(u,E){return E.dir&&A.test(u)});var W=this.root+A,N=C.call(this,W),x=this.clone();return x.root=N.name,x},remove:function(A){A=this.root+A;var W=this.files[A];if(W||(A.slice(-1)!=="/"&&(A+="/"),W=this.files[A]),W&&!W.dir)delete this.files[A];else for(var N=this.filter(function(u,E){return E.name.slice(0,A.length)===A}),x=0;x<N.length;x++)delete this.files[N[x].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var W,N={};try{if((N=s.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");s.checkSupport(N.type),N.platform!=="darwin"&&N.platform!=="freebsd"&&N.platform!=="linux"&&N.platform!=="sunos"||(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var x=N.comment||this.comment||"";W=o.generateWorker(this,N,x)}catch(u){(W=new a("error")).error(u)}return new m(W,N.type||"string",N.mimeType)},generateAsync:function(A,W){return this.generateInternalStream(A).accumulate(W)},generateNodeStream:function(A,W){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(W)}};k.exports=z},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(l,k,h){k.exports=l("stream")},{stream:void 0}],17:[function(l,k,h){var c=l("./DataReader");function n(s){c.call(this,s);for(var a=0;a<this.data.length;a++)s[a]=255&s[a]}l("../utils").inherits(n,c),n.prototype.byteAt=function(s){return this.data[this.zero+s]},n.prototype.lastIndexOfSignature=function(s){for(var a=s.charCodeAt(0),m=s.charCodeAt(1),_=s.charCodeAt(2),f=s.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===a&&this.data[y+1]===m&&this.data[y+2]===_&&this.data[y+3]===f)return y-this.zero;return-1},n.prototype.readAndCheckSignature=function(s){var a=s.charCodeAt(0),m=s.charCodeAt(1),_=s.charCodeAt(2),f=s.charCodeAt(3),y=this.readData(4);return a===y[0]&&m===y[1]&&_===y[2]&&f===y[3]},n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var a=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,a},k.exports=n},{"../utils":32,"./DataReader":18}],18:[function(l,k,h){var c=l("../utils");function n(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var a,m=0;for(this.checkOffset(s),a=this.index+s-1;a>=this.index;a--)m=(m<<8)+this.byteAt(a);return this.index+=s,m},readString:function(s){return c.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},k.exports=n},{"../utils":32}],19:[function(l,k,h){var c=l("./Uint8ArrayReader");function n(s){c.call(this,s)}l("../utils").inherits(n,c),n.prototype.readData=function(s){this.checkOffset(s);var a=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,a},k.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(l,k,h){var c=l("./DataReader");function n(s){c.call(this,s)}l("../utils").inherits(n,c),n.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},n.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},n.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},n.prototype.readData=function(s){this.checkOffset(s);var a=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,a},k.exports=n},{"../utils":32,"./DataReader":18}],21:[function(l,k,h){var c=l("./ArrayReader");function n(s){c.call(this,s)}l("../utils").inherits(n,c),n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var a=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,a},k.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(l,k,h){var c=l("../utils"),n=l("../support"),s=l("./ArrayReader"),a=l("./StringReader"),m=l("./NodeBufferReader"),_=l("./Uint8ArrayReader");k.exports=function(f){var y=c.getTypeOf(f);return c.checkSupport(y),y!=="string"||n.uint8array?y==="nodebuffer"?new m(f):n.uint8array?new _(c.transformTo("uint8array",f)):new s(c.transformTo("array",f)):new a(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(l,k,h){h.LOCAL_FILE_HEADER="PK",h.CENTRAL_FILE_HEADER="PK",h.CENTRAL_DIRECTORY_END="PK",h.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",h.ZIP64_CENTRAL_DIRECTORY_END="PK",h.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(l,k,h){var c=l("./GenericWorker"),n=l("../utils");function s(a){c.call(this,"ConvertWorker to "+a),this.destType=a}n.inherits(s,c),s.prototype.processChunk=function(a){this.push({data:n.transformTo(this.destType,a.data),meta:a.meta})},k.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(l,k,h){var c=l("./GenericWorker"),n=l("../crc32");function s(){c.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}l("../utils").inherits(s,c),s.prototype.processChunk=function(a){this.streamInfo.crc32=n(a.data,this.streamInfo.crc32||0),this.push(a)},k.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(l,k,h){var c=l("../utils"),n=l("./GenericWorker");function s(a){n.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}c.inherits(s,n),s.prototype.processChunk=function(a){if(a){var m=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=m+a.data.length}n.prototype.processChunk.call(this,a)},k.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(l,k,h){var c=l("../utils"),n=l("./GenericWorker");function s(a){n.call(this,"DataWorker");var m=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,a.then(function(_){m.dataIsReady=!0,m.data=_,m.max=_&&_.length||0,m.type=c.getTypeOf(_),m.isPaused||m._tickAndRepeat()},function(_){m.error(_)})}c.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,c.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(c.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var a=null,m=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":a=this.data.substring(this.index,m);break;case"uint8array":a=this.data.subarray(this.index,m);break;case"array":case"nodebuffer":a=this.data.slice(this.index,m)}return this.index=m,this.push({data:a,meta:{percent:this.max?this.index/this.max*100:0}})},k.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(l,k,h){function c(n){this.name=n||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}c.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",n)}return!0},error:function(n){return!this.isFinished&&(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,s){return this._listeners[n].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(n,s){if(this._listeners[n])for(var a=0;a<this._listeners[n].length;a++)this._listeners[n][a].call(this,s)},pipe:function(n){return n.registerPrevious(this)},registerPrevious:function(n){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo,this.mergeStreamInfo(),this.previous=n;var s=this;return n.on("data",function(a){s.processChunk(a)}),n.on("end",function(){s.end()}),n.on("error",function(a){s.error(a)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var n=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,s){return this.extraStreamInfo[n]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}},k.exports=c},{}],29:[function(l,k,h){var c=l("../utils"),n=l("./ConvertWorker"),s=l("./GenericWorker"),a=l("../base64"),m=l("../support"),_=l("../external"),f=null;if(m.nodestream)try{f=l("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(b,i){return new _.Promise(function(p,d){var C=[],S=b._internalType,z=b._outputType,A=b._mimeType;b.on("data",function(W,N){C.push(W),i&&i(N)}).on("error",function(W){C=[],d(W)}).on("end",function(){try{var W=function(N,x,u){switch(N){case"blob":return c.newBlob(c.transformTo("arraybuffer",x),u);case"base64":return a.encode(x);default:return c.transformTo(N,x)}}(z,function(N,x){var u,E=0,G=null,v=0;for(u=0;u<x.length;u++)v+=x[u].length;switch(N){case"string":return x.join("");case"array":return Array.prototype.concat.apply([],x);case"uint8array":for(G=new Uint8Array(v),u=0;u<x.length;u++)G.set(x[u],E),E+=x[u].length;return G;case"nodebuffer":return Buffer.concat(x);default:throw new Error("concat : unsupported type '"+N+"'")}}(S,C),A);p(W)}catch(N){d(N)}C=[]}).resume()})}function o(b,i,p){var d=i;switch(i){case"blob":case"arraybuffer":d="uint8array";break;case"base64":d="string"}try{this._internalType=d,this._outputType=i,this._mimeType=p,c.checkSupport(d),this._worker=b.pipe(new n(d)),b.lock()}catch(C){this._worker=new s("error"),this._worker.error(C)}}o.prototype={accumulate:function(b){return y(this,b)},on:function(b,i){var p=this;return b==="data"?this._worker.on(b,function(d){i.call(p,d.data,d.meta)}):this._worker.on(b,function(){c.delay(i,arguments,p)}),this},resume:function(){return c.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(c.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},b)}},k.exports=o},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(l,k,h){if(h.base64=!0,h.array=!0,h.string=!0,h.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",h.nodebuffer=typeof Buffer<"u",h.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")h.blob=!1;else{var c=new ArrayBuffer(0);try{h.blob=new Blob([c],{type:"application/zip"}).size===0}catch{try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(c),h.blob=n.getBlob("application/zip").size===0}catch{h.blob=!1}}}try{h.nodestream=!!l("readable-stream").Readable}catch{h.nodestream=!1}},{"readable-stream":16}],31:[function(l,k,h){for(var c=l("./utils"),n=l("./support"),s=l("./nodejsUtils"),a=l("./stream/GenericWorker"),m=new Array(256),_=0;_<256;_++)m[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;m[254]=m[254]=1;function f(){a.call(this,"utf-8 decode"),this.leftOver=null}function y(){a.call(this,"utf-8 encode")}h.utf8encode=function(o){return n.nodebuffer?s.newBufferFrom(o,"utf-8"):function(b){var i,p,d,C,S,z=b.length,A=0;for(C=0;C<z;C++)(64512&(p=b.charCodeAt(C)))==55296&&C+1<z&&(64512&(d=b.charCodeAt(C+1)))==56320&&(p=65536+(p-55296<<10)+(d-56320),C++),A+=p<128?1:p<2048?2:p<65536?3:4;for(i=n.uint8array?new Uint8Array(A):new Array(A),C=S=0;S<A;C++)(64512&(p=b.charCodeAt(C)))==55296&&C+1<z&&(64512&(d=b.charCodeAt(C+1)))==56320&&(p=65536+(p-55296<<10)+(d-56320),C++),p<128?i[S++]=p:(p<2048?i[S++]=192|p>>>6:(p<65536?i[S++]=224|p>>>12:(i[S++]=240|p>>>18,i[S++]=128|p>>>12&63),i[S++]=128|p>>>6&63),i[S++]=128|63&p);return i}(o)},h.utf8decode=function(o){return n.nodebuffer?c.transformTo("nodebuffer",o).toString("utf-8"):function(b){var i,p,d,C,S=b.length,z=new Array(2*S);for(i=p=0;i<S;)if((d=b[i++])<128)z[p++]=d;else if(4<(C=m[d]))z[p++]=65533,i+=C-1;else{for(d&=C===2?31:C===3?15:7;1<C&&i<S;)d=d<<6|63&b[i++],C--;1<C?z[p++]=65533:d<65536?z[p++]=d:(d-=65536,z[p++]=55296|d>>10&1023,z[p++]=56320|1023&d)}return z.length!==p&&(z.subarray?z=z.subarray(0,p):z.length=p),c.applyFromCharCode(z)}(o=c.transformTo(n.uint8array?"uint8array":"array",o))},c.inherits(f,a),f.prototype.processChunk=function(o){var b=c.transformTo(n.uint8array?"uint8array":"array",o.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var i=b;(b=new Uint8Array(i.length+this.leftOver.length)).set(this.leftOver,0),b.set(i,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var p=function(C,S){var z;for((S=S||C.length)>C.length&&(S=C.length),z=S-1;0<=z&&(192&C[z])==128;)z--;return z<0||z===0?S:z+m[C[z]]>S?z:S}(b),d=b;p!==b.length&&(n.uint8array?(d=b.subarray(0,p),this.leftOver=b.subarray(p,b.length)):(d=b.slice(0,p),this.leftOver=b.slice(p,b.length))),this.push({data:h.utf8decode(d),meta:o.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:h.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},h.Utf8DecodeWorker=f,c.inherits(y,a),y.prototype.processChunk=function(o){this.push({data:h.utf8encode(o.data),meta:o.meta})},h.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(l,k,h){var c=l("./support"),n=l("./base64"),s=l("./nodejsUtils"),a=l("./external");function m(i){return i}function _(i,p){for(var d=0;d<i.length;++d)p[d]=255&i.charCodeAt(d);return p}l("setimmediate"),h.newBlob=function(i,p){h.checkSupport("blob");try{return new Blob([i],{type:p})}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return d.append(i),d.getBlob(p)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(i,p,d){var C=[],S=0,z=i.length;if(z<=d)return String.fromCharCode.apply(null,i);for(;S<z;)p==="array"||p==="nodebuffer"?C.push(String.fromCharCode.apply(null,i.slice(S,Math.min(S+d,z)))):C.push(String.fromCharCode.apply(null,i.subarray(S,Math.min(S+d,z)))),S+=d;return C.join("")},stringifyByChar:function(i){for(var p="",d=0;d<i.length;d++)p+=String.fromCharCode(i[d]);return p},applyCanBeUsed:{uint8array:function(){try{return c.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return c.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function y(i){var p=65536,d=h.getTypeOf(i),C=!0;if(d==="uint8array"?C=f.applyCanBeUsed.uint8array:d==="nodebuffer"&&(C=f.applyCanBeUsed.nodebuffer),C)for(;1<p;)try{return f.stringifyByChunk(i,d,p)}catch{p=Math.floor(p/2)}return f.stringifyByChar(i)}function o(i,p){for(var d=0;d<i.length;d++)p[d]=i[d];return p}h.applyFromCharCode=y;var b={};b.string={string:m,array:function(i){return _(i,new Array(i.length))},arraybuffer:function(i){return b.string.uint8array(i).buffer},uint8array:function(i){return _(i,new Uint8Array(i.length))},nodebuffer:function(i){return _(i,s.allocBuffer(i.length))}},b.array={string:y,array:m,arraybuffer:function(i){return new Uint8Array(i).buffer},uint8array:function(i){return new Uint8Array(i)},nodebuffer:function(i){return s.newBufferFrom(i)}},b.arraybuffer={string:function(i){return y(new Uint8Array(i))},array:function(i){return o(new Uint8Array(i),new Array(i.byteLength))},arraybuffer:m,uint8array:function(i){return new Uint8Array(i)},nodebuffer:function(i){return s.newBufferFrom(new Uint8Array(i))}},b.uint8array={string:y,array:function(i){return o(i,new Array(i.length))},arraybuffer:function(i){return i.buffer},uint8array:m,nodebuffer:function(i){return s.newBufferFrom(i)}},b.nodebuffer={string:y,array:function(i){return o(i,new Array(i.length))},arraybuffer:function(i){return b.nodebuffer.uint8array(i).buffer},uint8array:function(i){return o(i,new Uint8Array(i.length))},nodebuffer:m},h.transformTo=function(i,p){if(p=p||"",!i)return p;h.checkSupport(i);var d=h.getTypeOf(p);return b[d][i](p)},h.resolve=function(i){for(var p=i.split("/"),d=[],C=0;C<p.length;C++){var S=p[C];S==="."||S===""&&C!==0&&C!==p.length-1||(S===".."?d.pop():d.push(S))}return d.join("/")},h.getTypeOf=function(i){return typeof i=="string"?"string":Object.prototype.toString.call(i)==="[object Array]"?"array":c.nodebuffer&&s.isBuffer(i)?"nodebuffer":c.uint8array&&i instanceof Uint8Array?"uint8array":c.arraybuffer&&i instanceof ArrayBuffer?"arraybuffer":void 0},h.checkSupport=function(i){if(!c[i.toLowerCase()])throw new Error(i+" is not supported by this platform")},h.MAX_VALUE_16BITS=65535,h.MAX_VALUE_32BITS=-1,h.pretty=function(i){var p,d,C="";for(d=0;d<(i||"").length;d++)C+="\\x"+((p=i.charCodeAt(d))<16?"0":"")+p.toString(16).toUpperCase();return C},h.delay=function(i,p,d){setImmediate(function(){i.apply(d||null,p||[])})},h.inherits=function(i,p){function d(){}d.prototype=p.prototype,i.prototype=new d},h.extend=function(){var i,p,d={};for(i=0;i<arguments.length;i++)for(p in arguments[i])Object.prototype.hasOwnProperty.call(arguments[i],p)&&d[p]===void 0&&(d[p]=arguments[i][p]);return d},h.prepareContent=function(i,p,d,C,S){return a.Promise.resolve(p).then(function(z){return c.blob&&(z instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(z))!==-1)&&typeof FileReader<"u"?new a.Promise(function(A,W){var N=new FileReader;N.onload=function(x){A(x.target.result)},N.onerror=function(x){W(x.target.error)},N.readAsArrayBuffer(z)}):z}).then(function(z){var A=h.getTypeOf(z);return A?(A==="arraybuffer"?z=h.transformTo("uint8array",z):A==="string"&&(S?z=n.decode(z):d&&C!==!0&&(z=function(W){return _(W,c.uint8array?new Uint8Array(W.length):new Array(W.length))}(z))),z):a.Promise.reject(new Error("Can't read the data of '"+i+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(l,k,h){var c=l("./reader/readerFor"),n=l("./utils"),s=l("./signature"),a=l("./zipEntry"),m=l("./support");function _(f){this.files=[],this.loadOptions=f}_.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(y)+", expected "+n.pretty(f)+")")}},isSignature:function(f,y){var o=this.reader.index;this.reader.setIndex(f);var b=this.reader.readString(4)===y;return this.reader.setIndex(o),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),y=m.uint8array?"uint8array":"array",o=n.transformTo(y,f);this.zipComment=this.loadOptions.decodeFileName(o)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,y,o,b=this.zip64EndOfCentralSize-44;0<b;)f=this.reader.readInt(2),y=this.reader.readInt(4),o=this.reader.readData(y),this.zip64ExtensibleData[f]={id:f,length:y,value:o}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,y;for(f=0;f<this.files.length;f++)y=this.files[f],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(f=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var y=f;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var o=this.centralDirOffset+this.centralDirSize;this.zip64&&(o+=20,o+=12+this.zip64EndOfCentralSize);var b=y-o;if(0<b)this.isSignature(y,s.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(f){this.reader=c(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},k.exports=_},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(l,k,h){var c=l("./reader/readerFor"),n=l("./utils"),s=l("./compressedObject"),a=l("./crc32"),m=l("./utf8"),_=l("./compressions"),f=l("./support");function y(o,b){this.options=o,this.loadOptions=b}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(o){var b,i;if(o.skip(22),this.fileNameLength=o.readInt(2),i=o.readInt(2),this.fileName=o.readData(this.fileNameLength),o.skip(i),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=function(p){for(var d in _)if(Object.prototype.hasOwnProperty.call(_,d)&&_[d].magic===p)return _[d];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,b,o.readData(this.compressedSize))},readCentralPart:function(o){this.versionMadeBy=o.readInt(2),o.skip(2),this.bitFlag=o.readInt(2),this.compressionMethod=o.readString(2),this.date=o.readDate(),this.crc32=o.readInt(4),this.compressedSize=o.readInt(4),this.uncompressedSize=o.readInt(4);var b=o.readInt(2);if(this.extraFieldsLength=o.readInt(2),this.fileCommentLength=o.readInt(2),this.diskNumberStart=o.readInt(2),this.internalFileAttributes=o.readInt(2),this.externalFileAttributes=o.readInt(4),this.localHeaderOffset=o.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");o.skip(b),this.readExtraFields(o),this.parseZIP64ExtraField(o),this.fileComment=o.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var o=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),o==0&&(this.dosPermissions=63&this.externalFileAttributes),o==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var o=c(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=o.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=o.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=o.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=o.readInt(4))}},readExtraFields:function(o){var b,i,p,d=o.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});o.index+4<d;)b=o.readInt(2),i=o.readInt(2),p=o.readData(i),this.extraFields[b]={id:b,length:i,value:p};o.setIndex(d)},handleUTF8:function(){var o=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=m.utf8decode(this.fileName),this.fileCommentStr=m.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var i=n.transformTo(o,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var p=this.findExtraFieldUnicodeComment();if(p!==null)this.fileCommentStr=p;else{var d=n.transformTo(o,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(d)}}},findExtraFieldUnicodePath:function(){var o=this.extraFields[28789];if(o){var b=c(o.value);return b.readInt(1)!==1||a(this.fileName)!==b.readInt(4)?null:m.utf8decode(b.readData(o.length-5))}return null},findExtraFieldUnicodeComment:function(){var o=this.extraFields[25461];if(o){var b=c(o.value);return b.readInt(1)!==1||a(this.fileComment)!==b.readInt(4)?null:m.utf8decode(b.readData(o.length-5))}return null}},k.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(l,k,h){function c(b,i,p){this.name=b,this.dir=p.dir,this.date=p.date,this.comment=p.comment,this.unixPermissions=p.unixPermissions,this.dosPermissions=p.dosPermissions,this._data=i,this._dataBinary=p.binary,this.options={compression:p.compression,compressionOptions:p.compressionOptions}}var n=l("./stream/StreamHelper"),s=l("./stream/DataWorker"),a=l("./utf8"),m=l("./compressedObject"),_=l("./stream/GenericWorker");c.prototype={internalStream:function(b){var i=null,p="string";try{if(!b)throw new Error("No output type specified.");var d=(p=b.toLowerCase())==="string"||p==="text";p!=="binarystring"&&p!=="text"||(p="string"),i=this._decompressWorker();var C=!this._dataBinary;C&&!d&&(i=i.pipe(new a.Utf8EncodeWorker)),!C&&d&&(i=i.pipe(new a.Utf8DecodeWorker))}catch(S){(i=new _("error")).error(S)}return new n(i,p,"")},async:function(b,i){return this.internalStream(b).accumulate(i)},nodeStream:function(b,i){return this.internalStream(b||"nodebuffer").toNodejsStream(i)},_compressWorker:function(b,i){if(this._data instanceof m&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var p=this._decompressWorker();return this._dataBinary||(p=p.pipe(new a.Utf8EncodeWorker)),m.createWorkerFrom(p,b,i)},_decompressWorker:function(){return this._data instanceof m?this._data.getContentWorker():this._data instanceof _?this._data:new s(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},o=0;o<f.length;o++)c.prototype[f[o]]=y;k.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(l,k,h){(function(c){var n,s,a=c.MutationObserver||c.WebKitMutationObserver;if(a){var m=0,_=new a(b),f=c.document.createTextNode("");_.observe(f,{characterData:!0}),n=function(){f.data=m=++m%2}}else if(c.setImmediate||c.MessageChannel===void 0)n="document"in c&&"onreadystatechange"in c.document.createElement("script")?function(){var i=c.document.createElement("script");i.onreadystatechange=function(){b(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},c.document.documentElement.appendChild(i)}:function(){setTimeout(b,0)};else{var y=new c.MessageChannel;y.port1.onmessage=b,n=function(){y.port2.postMessage(0)}}var o=[];function b(){var i,p;s=!0;for(var d=o.length;d;){for(p=o,o=[],i=-1;++i<d;)p[i]();d=o.length}s=!1}k.exports=function(i){o.push(i)!==1||s||n()}}).call(this,typeof At<"u"?At:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(l,k,h){var c=l("immediate");function n(){}var s={},a=["REJECTED"],m=["FULFILLED"],_=["PENDING"];function f(d){if(typeof d!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,d!==n&&i(this,d)}function y(d,C,S){this.promise=d,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function o(d,C,S){c(function(){var z;try{z=C(S)}catch(A){return s.reject(d,A)}z===d?s.reject(d,new TypeError("Cannot resolve promise with itself")):s.resolve(d,z)})}function b(d){var C=d&&d.then;if(d&&(typeof d=="object"||typeof d=="function")&&typeof C=="function")return function(){C.apply(d,arguments)}}function i(d,C){var S=!1;function z(N){S||(S=!0,s.reject(d,N))}function A(N){S||(S=!0,s.resolve(d,N))}var W=p(function(){C(A,z)});W.status==="error"&&z(W.value)}function p(d,C){var S={};try{S.value=d(C),S.status="success"}catch(z){S.status="error",S.value=z}return S}(k.exports=f).prototype.finally=function(d){if(typeof d!="function")return this;var C=this.constructor;return this.then(function(S){return C.resolve(d()).then(function(){return S})},function(S){return C.resolve(d()).then(function(){throw S})})},f.prototype.catch=function(d){return this.then(null,d)},f.prototype.then=function(d,C){if(typeof d!="function"&&this.state===m||typeof C!="function"&&this.state===a)return this;var S=new this.constructor(n);return this.state!==_?o(S,this.state===m?d:C,this.outcome):this.queue.push(new y(S,d,C)),S},y.prototype.callFulfilled=function(d){s.resolve(this.promise,d)},y.prototype.otherCallFulfilled=function(d){o(this.promise,this.onFulfilled,d)},y.prototype.callRejected=function(d){s.reject(this.promise,d)},y.prototype.otherCallRejected=function(d){o(this.promise,this.onRejected,d)},s.resolve=function(d,C){var S=p(b,C);if(S.status==="error")return s.reject(d,S.value);var z=S.value;if(z)i(d,z);else{d.state=m,d.outcome=C;for(var A=-1,W=d.queue.length;++A<W;)d.queue[A].callFulfilled(C)}return d},s.reject=function(d,C){d.state=a,d.outcome=C;for(var S=-1,z=d.queue.length;++S<z;)d.queue[S].callRejected(C);return d},f.resolve=function(d){return d instanceof this?d:s.resolve(new this(n),d)},f.reject=function(d){var C=new this(n);return s.reject(C,d)},f.all=function(d){var C=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=d.length,z=!1;if(!S)return this.resolve([]);for(var A=new Array(S),W=0,N=-1,x=new this(n);++N<S;)u(d[N],N);return x;function u(E,G){C.resolve(E).then(function(v){A[G]=v,++W!==S||z||(z=!0,s.resolve(x,A))},function(v){z||(z=!0,s.reject(x,v))})}},f.race=function(d){var C=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=d.length,z=!1;if(!S)return this.resolve([]);for(var A=-1,W=new this(n);++A<S;)N=d[A],C.resolve(N).then(function(x){z||(z=!0,s.resolve(W,x))},function(x){z||(z=!0,s.reject(W,x))});var N;return W}},{immediate:36}],38:[function(l,k,h){var c={};(0,l("./lib/utils/common").assign)(c,l("./lib/deflate"),l("./lib/inflate"),l("./lib/zlib/constants")),k.exports=c},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(l,k,h){var c=l("./zlib/deflate"),n=l("./utils/common"),s=l("./utils/strings"),a=l("./zlib/messages"),m=l("./zlib/zstream"),_=Object.prototype.toString,f=0,y=-1,o=0,b=8;function i(d){if(!(this instanceof i))return new i(d);this.options=n.assign({level:y,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:o,to:""},d||{});var C=this.options;C.raw&&0<C.windowBits?C.windowBits=-C.windowBits:C.gzip&&0<C.windowBits&&C.windowBits<16&&(C.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var S=c.deflateInit2(this.strm,C.level,C.method,C.windowBits,C.memLevel,C.strategy);if(S!==f)throw new Error(a[S]);if(C.header&&c.deflateSetHeader(this.strm,C.header),C.dictionary){var z;if(z=typeof C.dictionary=="string"?s.string2buf(C.dictionary):_.call(C.dictionary)==="[object ArrayBuffer]"?new Uint8Array(C.dictionary):C.dictionary,(S=c.deflateSetDictionary(this.strm,z))!==f)throw new Error(a[S]);this._dict_set=!0}}function p(d,C){var S=new i(C);if(S.push(d,!0),S.err)throw S.msg||a[S.err];return S.result}i.prototype.push=function(d,C){var S,z,A=this.strm,W=this.options.chunkSize;if(this.ended)return!1;z=C===~~C?C:C===!0?4:0,typeof d=="string"?A.input=s.string2buf(d):_.call(d)==="[object ArrayBuffer]"?A.input=new Uint8Array(d):A.input=d,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new n.Buf8(W),A.next_out=0,A.avail_out=W),(S=c.deflate(A,z))!==1&&S!==f)return this.onEnd(S),!(this.ended=!0);A.avail_out!==0&&(A.avail_in!==0||z!==4&&z!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(n.shrinkBuf(A.output,A.next_out))):this.onData(n.shrinkBuf(A.output,A.next_out)))}while((0<A.avail_in||A.avail_out===0)&&S!==1);return z===4?(S=c.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===f):z!==2||(this.onEnd(f),!(A.avail_out=0))},i.prototype.onData=function(d){this.chunks.push(d)},i.prototype.onEnd=function(d){d===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},h.Deflate=i,h.deflate=p,h.deflateRaw=function(d,C){return(C=C||{}).raw=!0,p(d,C)},h.gzip=function(d,C){return(C=C||{}).gzip=!0,p(d,C)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(l,k,h){var c=l("./zlib/inflate"),n=l("./utils/common"),s=l("./utils/strings"),a=l("./zlib/constants"),m=l("./zlib/messages"),_=l("./zlib/zstream"),f=l("./zlib/gzheader"),y=Object.prototype.toString;function o(i){if(!(this instanceof o))return new o(i);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},i||{});var p=this.options;p.raw&&0<=p.windowBits&&p.windowBits<16&&(p.windowBits=-p.windowBits,p.windowBits===0&&(p.windowBits=-15)),!(0<=p.windowBits&&p.windowBits<16)||i&&i.windowBits||(p.windowBits+=32),15<p.windowBits&&p.windowBits<48&&!(15&p.windowBits)&&(p.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var d=c.inflateInit2(this.strm,p.windowBits);if(d!==a.Z_OK)throw new Error(m[d]);this.header=new f,c.inflateGetHeader(this.strm,this.header)}function b(i,p){var d=new o(p);if(d.push(i,!0),d.err)throw d.msg||m[d.err];return d.result}o.prototype.push=function(i,p){var d,C,S,z,A,W,N=this.strm,x=this.options.chunkSize,u=this.options.dictionary,E=!1;if(this.ended)return!1;C=p===~~p?p:p===!0?a.Z_FINISH:a.Z_NO_FLUSH,typeof i=="string"?N.input=s.binstring2buf(i):y.call(i)==="[object ArrayBuffer]"?N.input=new Uint8Array(i):N.input=i,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new n.Buf8(x),N.next_out=0,N.avail_out=x),(d=c.inflate(N,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&u&&(W=typeof u=="string"?s.string2buf(u):y.call(u)==="[object ArrayBuffer]"?new Uint8Array(u):u,d=c.inflateSetDictionary(this.strm,W)),d===a.Z_BUF_ERROR&&E===!0&&(d=a.Z_OK,E=!1),d!==a.Z_STREAM_END&&d!==a.Z_OK)return this.onEnd(d),!(this.ended=!0);N.next_out&&(N.avail_out!==0&&d!==a.Z_STREAM_END&&(N.avail_in!==0||C!==a.Z_FINISH&&C!==a.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=s.utf8border(N.output,N.next_out),z=N.next_out-S,A=s.buf2string(N.output,S),N.next_out=z,N.avail_out=x-z,z&&n.arraySet(N.output,N.output,S,z,0),this.onData(A)):this.onData(n.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(E=!0)}while((0<N.avail_in||N.avail_out===0)&&d!==a.Z_STREAM_END);return d===a.Z_STREAM_END&&(C=a.Z_FINISH),C===a.Z_FINISH?(d=c.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===a.Z_OK):C!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(N.avail_out=0))},o.prototype.onData=function(i){this.chunks.push(i)},o.prototype.onEnd=function(i){i===a.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg},h.Inflate=o,h.inflate=b,h.inflateRaw=function(i,p){return(p=p||{}).raw=!0,b(i,p)},h.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(l,k,h){var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";h.assign=function(a){for(var m=Array.prototype.slice.call(arguments,1);m.length;){var _=m.shift();if(_){if(typeof _!="object")throw new TypeError(_+"must be non-object");for(var f in _)_.hasOwnProperty(f)&&(a[f]=_[f])}}return a},h.shrinkBuf=function(a,m){return a.length===m?a:a.subarray?a.subarray(0,m):(a.length=m,a)};var n={arraySet:function(a,m,_,f,y){if(m.subarray&&a.subarray)a.set(m.subarray(_,_+f),y);else for(var o=0;o<f;o++)a[y+o]=m[_+o]},flattenChunks:function(a){var m,_,f,y,o,b;for(m=f=0,_=a.length;m<_;m++)f+=a[m].length;for(b=new Uint8Array(f),m=y=0,_=a.length;m<_;m++)o=a[m],b.set(o,y),y+=o.length;return b}},s={arraySet:function(a,m,_,f,y){for(var o=0;o<f;o++)a[y+o]=m[_+o]},flattenChunks:function(a){return[].concat.apply([],a)}};h.setTyped=function(a){a?(h.Buf8=Uint8Array,h.Buf16=Uint16Array,h.Buf32=Int32Array,h.assign(h,n)):(h.Buf8=Array,h.Buf16=Array,h.Buf32=Array,h.assign(h,s))},h.setTyped(c)},{}],42:[function(l,k,h){var c=l("./common"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var a=new c.Buf8(256),m=0;m<256;m++)a[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;function _(f,y){if(y<65537&&(f.subarray&&s||!f.subarray&&n))return String.fromCharCode.apply(null,c.shrinkBuf(f,y));for(var o="",b=0;b<y;b++)o+=String.fromCharCode(f[b]);return o}a[254]=a[254]=1,h.string2buf=function(f){var y,o,b,i,p,d=f.length,C=0;for(i=0;i<d;i++)(64512&(o=f.charCodeAt(i)))==55296&&i+1<d&&(64512&(b=f.charCodeAt(i+1)))==56320&&(o=65536+(o-55296<<10)+(b-56320),i++),C+=o<128?1:o<2048?2:o<65536?3:4;for(y=new c.Buf8(C),i=p=0;p<C;i++)(64512&(o=f.charCodeAt(i)))==55296&&i+1<d&&(64512&(b=f.charCodeAt(i+1)))==56320&&(o=65536+(o-55296<<10)+(b-56320),i++),o<128?y[p++]=o:(o<2048?y[p++]=192|o>>>6:(o<65536?y[p++]=224|o>>>12:(y[p++]=240|o>>>18,y[p++]=128|o>>>12&63),y[p++]=128|o>>>6&63),y[p++]=128|63&o);return y},h.buf2binstring=function(f){return _(f,f.length)},h.binstring2buf=function(f){for(var y=new c.Buf8(f.length),o=0,b=y.length;o<b;o++)y[o]=f.charCodeAt(o);return y},h.buf2string=function(f,y){var o,b,i,p,d=y||f.length,C=new Array(2*d);for(o=b=0;o<d;)if((i=f[o++])<128)C[b++]=i;else if(4<(p=a[i]))C[b++]=65533,o+=p-1;else{for(i&=p===2?31:p===3?15:7;1<p&&o<d;)i=i<<6|63&f[o++],p--;1<p?C[b++]=65533:i<65536?C[b++]=i:(i-=65536,C[b++]=55296|i>>10&1023,C[b++]=56320|1023&i)}return _(C,b)},h.utf8border=function(f,y){var o;for((y=y||f.length)>f.length&&(y=f.length),o=y-1;0<=o&&(192&f[o])==128;)o--;return o<0||o===0?y:o+a[f[o]]>y?o:y}},{"./common":41}],43:[function(l,k,h){k.exports=function(c,n,s,a){for(var m=65535&c|0,_=c>>>16&65535|0,f=0;s!==0;){for(s-=f=2e3<s?2e3:s;_=_+(m=m+n[a++]|0)|0,--f;);m%=65521,_%=65521}return m|_<<16|0}},{}],44:[function(l,k,h){k.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(l,k,h){var c=function(){for(var n,s=[],a=0;a<256;a++){n=a;for(var m=0;m<8;m++)n=1&n?3988292384^n>>>1:n>>>1;s[a]=n}return s}();k.exports=function(n,s,a,m){var _=c,f=m+a;n^=-1;for(var y=m;y<f;y++)n=n>>>8^_[255&(n^s[y])];return-1^n}},{}],46:[function(l,k,h){var c,n=l("../utils/common"),s=l("./trees"),a=l("./adler32"),m=l("./crc32"),_=l("./messages"),f=0,y=4,o=0,b=-2,i=-1,p=4,d=2,C=8,S=9,z=286,A=30,W=19,N=2*z+1,x=15,u=3,E=258,G=E+u+1,v=42,O=113,r=1,M=2,tt=3,F=4;function et(t,D){return t.msg=_[D],D}function L(t){return(t<<1)-(4<t?9:0)}function nt(t){for(var D=t.length;0<=--D;)t[D]=0}function P(t){var D=t.state,B=D.pending;B>t.avail_out&&(B=t.avail_out),B!==0&&(n.arraySet(t.output,D.pending_buf,D.pending_out,B,t.next_out),t.next_out+=B,D.pending_out+=B,t.total_out+=B,t.avail_out-=B,D.pending-=B,D.pending===0&&(D.pending_out=0))}function j(t,D){s._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,D),t.block_start=t.strstart,P(t.strm)}function X(t,D){t.pending_buf[t.pending++]=D}function K(t,D){t.pending_buf[t.pending++]=D>>>8&255,t.pending_buf[t.pending++]=255&D}function $(t,D){var B,w,g=t.max_chain_length,T=t.strstart,Z=t.prev_length,H=t.nice_match,R=t.strstart>t.w_size-G?t.strstart-(t.w_size-G):0,q=t.window,J=t.w_mask,V=t.prev,rt=t.strstart+E,ht=q[T+Z-1],ot=q[T+Z];t.prev_length>=t.good_match&&(g>>=2),H>t.lookahead&&(H=t.lookahead);do if(q[(B=D)+Z]===ot&&q[B+Z-1]===ht&&q[B]===q[T]&&q[++B]===q[T+1]){T+=2,B++;do;while(q[++T]===q[++B]&&q[++T]===q[++B]&&q[++T]===q[++B]&&q[++T]===q[++B]&&q[++T]===q[++B]&&q[++T]===q[++B]&&q[++T]===q[++B]&&q[++T]===q[++B]&&T<rt);if(w=E-(rt-T),T=rt-E,Z<w){if(t.match_start=D,H<=(Z=w))break;ht=q[T+Z-1],ot=q[T+Z]}}while((D=V[D&J])>R&&--g!=0);return Z<=t.lookahead?Z:t.lookahead}function lt(t){var D,B,w,g,T,Z,H,R,q,J,V=t.w_size;do{if(g=t.window_size-t.lookahead-t.strstart,t.strstart>=V+(V-G)){for(n.arraySet(t.window,t.window,V,V,0),t.match_start-=V,t.strstart-=V,t.block_start-=V,D=B=t.hash_size;w=t.head[--D],t.head[D]=V<=w?w-V:0,--B;);for(D=B=V;w=t.prev[--D],t.prev[D]=V<=w?w-V:0,--B;);g+=V}if(t.strm.avail_in===0)break;if(Z=t.strm,H=t.window,R=t.strstart+t.lookahead,q=g,J=void 0,J=Z.avail_in,q<J&&(J=q),B=J===0?0:(Z.avail_in-=J,n.arraySet(H,Z.input,Z.next_in,J,R),Z.state.wrap===1?Z.adler=a(Z.adler,H,J,R):Z.state.wrap===2&&(Z.adler=m(Z.adler,H,J,R)),Z.next_in+=J,Z.total_in+=J,J),t.lookahead+=B,t.lookahead+t.insert>=u)for(T=t.strstart-t.insert,t.ins_h=t.window[T],t.ins_h=(t.ins_h<<t.hash_shift^t.window[T+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[T+u-1])&t.hash_mask,t.prev[T&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=T,T++,t.insert--,!(t.lookahead+t.insert<u)););}while(t.lookahead<G&&t.strm.avail_in!==0)}function dt(t,D){for(var B,w;;){if(t.lookahead<G){if(lt(t),t.lookahead<G&&D===f)return r;if(t.lookahead===0)break}if(B=0,t.lookahead>=u&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+u-1])&t.hash_mask,B=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),B!==0&&t.strstart-B<=t.w_size-G&&(t.match_length=$(t,B)),t.match_length>=u)if(w=s._tr_tally(t,t.strstart-t.match_start,t.match_length-u),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=u){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+u-1])&t.hash_mask,B=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,--t.match_length!=0;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else w=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(w&&(j(t,!1),t.strm.avail_out===0))return r}return t.insert=t.strstart<u-1?t.strstart:u-1,D===y?(j(t,!0),t.strm.avail_out===0?tt:F):t.last_lit&&(j(t,!1),t.strm.avail_out===0)?r:M}function st(t,D){for(var B,w,g;;){if(t.lookahead<G){if(lt(t),t.lookahead<G&&D===f)return r;if(t.lookahead===0)break}if(B=0,t.lookahead>=u&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+u-1])&t.hash_mask,B=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=u-1,B!==0&&t.prev_length<t.max_lazy_match&&t.strstart-B<=t.w_size-G&&(t.match_length=$(t,B),t.match_length<=5&&(t.strategy===1||t.match_length===u&&4096<t.strstart-t.match_start)&&(t.match_length=u-1)),t.prev_length>=u&&t.match_length<=t.prev_length){for(g=t.strstart+t.lookahead-u,w=s._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-u),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=g&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+u-1])&t.hash_mask,B=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),--t.prev_length!=0;);if(t.match_available=0,t.match_length=u-1,t.strstart++,w&&(j(t,!1),t.strm.avail_out===0))return r}else if(t.match_available){if((w=s._tr_tally(t,0,t.window[t.strstart-1]))&&j(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return r}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(w=s._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<u-1?t.strstart:u-1,D===y?(j(t,!0),t.strm.avail_out===0?tt:F):t.last_lit&&(j(t,!1),t.strm.avail_out===0)?r:M}function Y(t,D,B,w,g){this.good_length=t,this.max_lazy=D,this.nice_length=B,this.max_chain=w,this.func=g}function it(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*N),this.dyn_dtree=new n.Buf16(2*(2*A+1)),this.bl_tree=new n.Buf16(2*(2*W+1)),nt(this.dyn_ltree),nt(this.dyn_dtree),nt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(x+1),this.heap=new n.Buf16(2*z+1),nt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*z+1),nt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function at(t){var D;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=d,(D=t.state).pending=0,D.pending_out=0,D.wrap<0&&(D.wrap=-D.wrap),D.status=D.wrap?v:O,t.adler=D.wrap===2?0:1,D.last_flush=f,s._tr_init(D),o):et(t,b)}function ft(t){var D=at(t);return D===o&&function(B){B.window_size=2*B.w_size,nt(B.head),B.max_lazy_match=c[B.level].max_lazy,B.good_match=c[B.level].good_length,B.nice_match=c[B.level].nice_length,B.max_chain_length=c[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=u-1,B.match_available=0,B.ins_h=0}(t.state),D}function ct(t,D,B,w,g,T){if(!t)return b;var Z=1;if(D===i&&(D=6),w<0?(Z=0,w=-w):15<w&&(Z=2,w-=16),g<1||S<g||B!==C||w<8||15<w||D<0||9<D||T<0||p<T)return et(t,b);w===8&&(w=9);var H=new it;return(t.state=H).strm=t,H.wrap=Z,H.gzhead=null,H.w_bits=w,H.w_size=1<<H.w_bits,H.w_mask=H.w_size-1,H.hash_bits=g+7,H.hash_size=1<<H.hash_bits,H.hash_mask=H.hash_size-1,H.hash_shift=~~((H.hash_bits+u-1)/u),H.window=new n.Buf8(2*H.w_size),H.head=new n.Buf16(H.hash_size),H.prev=new n.Buf16(H.w_size),H.lit_bufsize=1<<g+6,H.pending_buf_size=4*H.lit_bufsize,H.pending_buf=new n.Buf8(H.pending_buf_size),H.d_buf=1*H.lit_bufsize,H.l_buf=3*H.lit_bufsize,H.level=D,H.strategy=T,H.method=B,ft(t)}c=[new Y(0,0,0,0,function(t,D){var B=65535;for(B>t.pending_buf_size-5&&(B=t.pending_buf_size-5);;){if(t.lookahead<=1){if(lt(t),t.lookahead===0&&D===f)return r;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var w=t.block_start+B;if((t.strstart===0||t.strstart>=w)&&(t.lookahead=t.strstart-w,t.strstart=w,j(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-G&&(j(t,!1),t.strm.avail_out===0))return r}return t.insert=0,D===y?(j(t,!0),t.strm.avail_out===0?tt:F):(t.strstart>t.block_start&&(j(t,!1),t.strm.avail_out),r)}),new Y(4,4,8,4,dt),new Y(4,5,16,8,dt),new Y(4,6,32,32,dt),new Y(4,4,16,16,st),new Y(8,16,32,32,st),new Y(8,16,128,128,st),new Y(8,32,128,256,st),new Y(32,128,258,1024,st),new Y(32,258,258,4096,st)],h.deflateInit=function(t,D){return ct(t,D,C,15,8,0)},h.deflateInit2=ct,h.deflateReset=ft,h.deflateResetKeep=at,h.deflateSetHeader=function(t,D){return t&&t.state?t.state.wrap!==2?b:(t.state.gzhead=D,o):b},h.deflate=function(t,D){var B,w,g,T;if(!t||!t.state||5<D||D<0)return t?et(t,b):b;if(w=t.state,!t.output||!t.input&&t.avail_in!==0||w.status===666&&D!==y)return et(t,t.avail_out===0?-5:b);if(w.strm=t,B=w.last_flush,w.last_flush=D,w.status===v)if(w.wrap===2)t.adler=0,X(w,31),X(w,139),X(w,8),w.gzhead?(X(w,(w.gzhead.text?1:0)+(w.gzhead.hcrc?2:0)+(w.gzhead.extra?4:0)+(w.gzhead.name?8:0)+(w.gzhead.comment?16:0)),X(w,255&w.gzhead.time),X(w,w.gzhead.time>>8&255),X(w,w.gzhead.time>>16&255),X(w,w.gzhead.time>>24&255),X(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),X(w,255&w.gzhead.os),w.gzhead.extra&&w.gzhead.extra.length&&(X(w,255&w.gzhead.extra.length),X(w,w.gzhead.extra.length>>8&255)),w.gzhead.hcrc&&(t.adler=m(t.adler,w.pending_buf,w.pending,0)),w.gzindex=0,w.status=69):(X(w,0),X(w,0),X(w,0),X(w,0),X(w,0),X(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),X(w,3),w.status=O);else{var Z=C+(w.w_bits-8<<4)<<8;Z|=(2<=w.strategy||w.level<2?0:w.level<6?1:w.level===6?2:3)<<6,w.strstart!==0&&(Z|=32),Z+=31-Z%31,w.status=O,K(w,Z),w.strstart!==0&&(K(w,t.adler>>>16),K(w,65535&t.adler)),t.adler=1}if(w.status===69)if(w.gzhead.extra){for(g=w.pending;w.gzindex<(65535&w.gzhead.extra.length)&&(w.pending!==w.pending_buf_size||(w.gzhead.hcrc&&w.pending>g&&(t.adler=m(t.adler,w.pending_buf,w.pending-g,g)),P(t),g=w.pending,w.pending!==w.pending_buf_size));)X(w,255&w.gzhead.extra[w.gzindex]),w.gzindex++;w.gzhead.hcrc&&w.pending>g&&(t.adler=m(t.adler,w.pending_buf,w.pending-g,g)),w.gzindex===w.gzhead.extra.length&&(w.gzindex=0,w.status=73)}else w.status=73;if(w.status===73)if(w.gzhead.name){g=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>g&&(t.adler=m(t.adler,w.pending_buf,w.pending-g,g)),P(t),g=w.pending,w.pending===w.pending_buf_size)){T=1;break}T=w.gzindex<w.gzhead.name.length?255&w.gzhead.name.charCodeAt(w.gzindex++):0,X(w,T)}while(T!==0);w.gzhead.hcrc&&w.pending>g&&(t.adler=m(t.adler,w.pending_buf,w.pending-g,g)),T===0&&(w.gzindex=0,w.status=91)}else w.status=91;if(w.status===91)if(w.gzhead.comment){g=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>g&&(t.adler=m(t.adler,w.pending_buf,w.pending-g,g)),P(t),g=w.pending,w.pending===w.pending_buf_size)){T=1;break}T=w.gzindex<w.gzhead.comment.length?255&w.gzhead.comment.charCodeAt(w.gzindex++):0,X(w,T)}while(T!==0);w.gzhead.hcrc&&w.pending>g&&(t.adler=m(t.adler,w.pending_buf,w.pending-g,g)),T===0&&(w.status=103)}else w.status=103;if(w.status===103&&(w.gzhead.hcrc?(w.pending+2>w.pending_buf_size&&P(t),w.pending+2<=w.pending_buf_size&&(X(w,255&t.adler),X(w,t.adler>>8&255),t.adler=0,w.status=O)):w.status=O),w.pending!==0){if(P(t),t.avail_out===0)return w.last_flush=-1,o}else if(t.avail_in===0&&L(D)<=L(B)&&D!==y)return et(t,-5);if(w.status===666&&t.avail_in!==0)return et(t,-5);if(t.avail_in!==0||w.lookahead!==0||D!==f&&w.status!==666){var H=w.strategy===2?function(R,q){for(var J;;){if(R.lookahead===0&&(lt(R),R.lookahead===0)){if(q===f)return r;break}if(R.match_length=0,J=s._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++,J&&(j(R,!1),R.strm.avail_out===0))return r}return R.insert=0,q===y?(j(R,!0),R.strm.avail_out===0?tt:F):R.last_lit&&(j(R,!1),R.strm.avail_out===0)?r:M}(w,D):w.strategy===3?function(R,q){for(var J,V,rt,ht,ot=R.window;;){if(R.lookahead<=E){if(lt(R),R.lookahead<=E&&q===f)return r;if(R.lookahead===0)break}if(R.match_length=0,R.lookahead>=u&&0<R.strstart&&(V=ot[rt=R.strstart-1])===ot[++rt]&&V===ot[++rt]&&V===ot[++rt]){ht=R.strstart+E;do;while(V===ot[++rt]&&V===ot[++rt]&&V===ot[++rt]&&V===ot[++rt]&&V===ot[++rt]&&V===ot[++rt]&&V===ot[++rt]&&V===ot[++rt]&&rt<ht);R.match_length=E-(ht-rt),R.match_length>R.lookahead&&(R.match_length=R.lookahead)}if(R.match_length>=u?(J=s._tr_tally(R,1,R.match_length-u),R.lookahead-=R.match_length,R.strstart+=R.match_length,R.match_length=0):(J=s._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++),J&&(j(R,!1),R.strm.avail_out===0))return r}return R.insert=0,q===y?(j(R,!0),R.strm.avail_out===0?tt:F):R.last_lit&&(j(R,!1),R.strm.avail_out===0)?r:M}(w,D):c[w.level].func(w,D);if(H!==tt&&H!==F||(w.status=666),H===r||H===tt)return t.avail_out===0&&(w.last_flush=-1),o;if(H===M&&(D===1?s._tr_align(w):D!==5&&(s._tr_stored_block(w,0,0,!1),D===3&&(nt(w.head),w.lookahead===0&&(w.strstart=0,w.block_start=0,w.insert=0))),P(t),t.avail_out===0))return w.last_flush=-1,o}return D!==y?o:w.wrap<=0?1:(w.wrap===2?(X(w,255&t.adler),X(w,t.adler>>8&255),X(w,t.adler>>16&255),X(w,t.adler>>24&255),X(w,255&t.total_in),X(w,t.total_in>>8&255),X(w,t.total_in>>16&255),X(w,t.total_in>>24&255)):(K(w,t.adler>>>16),K(w,65535&t.adler)),P(t),0<w.wrap&&(w.wrap=-w.wrap),w.pending!==0?o:1)},h.deflateEnd=function(t){var D;return t&&t.state?(D=t.state.status)!==v&&D!==69&&D!==73&&D!==91&&D!==103&&D!==O&&D!==666?et(t,b):(t.state=null,D===O?et(t,-3):o):b},h.deflateSetDictionary=function(t,D){var B,w,g,T,Z,H,R,q,J=D.length;if(!t||!t.state||(T=(B=t.state).wrap)===2||T===1&&B.status!==v||B.lookahead)return b;for(T===1&&(t.adler=a(t.adler,D,J,0)),B.wrap=0,J>=B.w_size&&(T===0&&(nt(B.head),B.strstart=0,B.block_start=0,B.insert=0),q=new n.Buf8(B.w_size),n.arraySet(q,D,J-B.w_size,B.w_size,0),D=q,J=B.w_size),Z=t.avail_in,H=t.next_in,R=t.input,t.avail_in=J,t.next_in=0,t.input=D,lt(B);B.lookahead>=u;){for(w=B.strstart,g=B.lookahead-(u-1);B.ins_h=(B.ins_h<<B.hash_shift^B.window[w+u-1])&B.hash_mask,B.prev[w&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=w,w++,--g;);B.strstart=w,B.lookahead=u-1,lt(B)}return B.strstart+=B.lookahead,B.block_start=B.strstart,B.insert=B.lookahead,B.lookahead=0,B.match_length=B.prev_length=u-1,B.match_available=0,t.next_in=H,t.input=R,t.avail_in=Z,B.wrap=T,o},h.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(l,k,h){k.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(l,k,h){k.exports=function(c,n){var s,a,m,_,f,y,o,b,i,p,d,C,S,z,A,W,N,x,u,E,G,v,O,r,M;s=c.state,a=c.next_in,r=c.input,m=a+(c.avail_in-5),_=c.next_out,M=c.output,f=_-(n-c.avail_out),y=_+(c.avail_out-257),o=s.dmax,b=s.wsize,i=s.whave,p=s.wnext,d=s.window,C=s.hold,S=s.bits,z=s.lencode,A=s.distcode,W=(1<<s.lenbits)-1,N=(1<<s.distbits)-1;t:do{S<15&&(C+=r[a++]<<S,S+=8,C+=r[a++]<<S,S+=8),x=z[C&W];e:for(;;){if(C>>>=u=x>>>24,S-=u,(u=x>>>16&255)===0)M[_++]=65535&x;else{if(!(16&u)){if(!(64&u)){x=z[(65535&x)+(C&(1<<u)-1)];continue e}if(32&u){s.mode=12;break t}c.msg="invalid literal/length code",s.mode=30;break t}E=65535&x,(u&=15)&&(S<u&&(C+=r[a++]<<S,S+=8),E+=C&(1<<u)-1,C>>>=u,S-=u),S<15&&(C+=r[a++]<<S,S+=8,C+=r[a++]<<S,S+=8),x=A[C&N];r:for(;;){if(C>>>=u=x>>>24,S-=u,!(16&(u=x>>>16&255))){if(!(64&u)){x=A[(65535&x)+(C&(1<<u)-1)];continue r}c.msg="invalid distance code",s.mode=30;break t}if(G=65535&x,S<(u&=15)&&(C+=r[a++]<<S,(S+=8)<u&&(C+=r[a++]<<S,S+=8)),o<(G+=C&(1<<u)-1)){c.msg="invalid distance too far back",s.mode=30;break t}if(C>>>=u,S-=u,(u=_-f)<G){if(i<(u=G-u)&&s.sane){c.msg="invalid distance too far back",s.mode=30;break t}if(O=d,(v=0)===p){if(v+=b-u,u<E){for(E-=u;M[_++]=d[v++],--u;);v=_-G,O=M}}else if(p<u){if(v+=b+p-u,(u-=p)<E){for(E-=u;M[_++]=d[v++],--u;);if(v=0,p<E){for(E-=u=p;M[_++]=d[v++],--u;);v=_-G,O=M}}}else if(v+=p-u,u<E){for(E-=u;M[_++]=d[v++],--u;);v=_-G,O=M}for(;2<E;)M[_++]=O[v++],M[_++]=O[v++],M[_++]=O[v++],E-=3;E&&(M[_++]=O[v++],1<E&&(M[_++]=O[v++]))}else{for(v=_-G;M[_++]=M[v++],M[_++]=M[v++],M[_++]=M[v++],2<(E-=3););E&&(M[_++]=M[v++],1<E&&(M[_++]=M[v++]))}break}}break}}while(a<m&&_<y);a-=E=S>>3,C&=(1<<(S-=E<<3))-1,c.next_in=a,c.next_out=_,c.avail_in=a<m?m-a+5:5-(a-m),c.avail_out=_<y?y-_+257:257-(_-y),s.hold=C,s.bits=S}},{}],49:[function(l,k,h){var c=l("../utils/common"),n=l("./adler32"),s=l("./crc32"),a=l("./inffast"),m=l("./inftrees"),_=1,f=2,y=0,o=-2,b=1,i=852,p=592;function d(v){return(v>>>24&255)+(v>>>8&65280)+((65280&v)<<8)+((255&v)<<24)}function C(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new c.Buf16(320),this.work=new c.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(v){var O;return v&&v.state?(O=v.state,v.total_in=v.total_out=O.total=0,v.msg="",O.wrap&&(v.adler=1&O.wrap),O.mode=b,O.last=0,O.havedict=0,O.dmax=32768,O.head=null,O.hold=0,O.bits=0,O.lencode=O.lendyn=new c.Buf32(i),O.distcode=O.distdyn=new c.Buf32(p),O.sane=1,O.back=-1,y):o}function z(v){var O;return v&&v.state?((O=v.state).wsize=0,O.whave=0,O.wnext=0,S(v)):o}function A(v,O){var r,M;return v&&v.state?(M=v.state,O<0?(r=0,O=-O):(r=1+(O>>4),O<48&&(O&=15)),O&&(O<8||15<O)?o:(M.window!==null&&M.wbits!==O&&(M.window=null),M.wrap=r,M.wbits=O,z(v))):o}function W(v,O){var r,M;return v?(M=new C,(v.state=M).window=null,(r=A(v,O))!==y&&(v.state=null),r):o}var N,x,u=!0;function E(v){if(u){var O;for(N=new c.Buf32(512),x=new c.Buf32(32),O=0;O<144;)v.lens[O++]=8;for(;O<256;)v.lens[O++]=9;for(;O<280;)v.lens[O++]=7;for(;O<288;)v.lens[O++]=8;for(m(_,v.lens,0,288,N,0,v.work,{bits:9}),O=0;O<32;)v.lens[O++]=5;m(f,v.lens,0,32,x,0,v.work,{bits:5}),u=!1}v.lencode=N,v.lenbits=9,v.distcode=x,v.distbits=5}function G(v,O,r,M){var tt,F=v.state;return F.window===null&&(F.wsize=1<<F.wbits,F.wnext=0,F.whave=0,F.window=new c.Buf8(F.wsize)),M>=F.wsize?(c.arraySet(F.window,O,r-F.wsize,F.wsize,0),F.wnext=0,F.whave=F.wsize):(M<(tt=F.wsize-F.wnext)&&(tt=M),c.arraySet(F.window,O,r-M,tt,F.wnext),(M-=tt)?(c.arraySet(F.window,O,r-M,M,0),F.wnext=M,F.whave=F.wsize):(F.wnext+=tt,F.wnext===F.wsize&&(F.wnext=0),F.whave<F.wsize&&(F.whave+=tt))),0}h.inflateReset=z,h.inflateReset2=A,h.inflateResetKeep=S,h.inflateInit=function(v){return W(v,15)},h.inflateInit2=W,h.inflate=function(v,O){var r,M,tt,F,et,L,nt,P,j,X,K,$,lt,dt,st,Y,it,at,ft,ct,t,D,B,w,g=0,T=new c.Buf8(4),Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!v||!v.state||!v.output||!v.input&&v.avail_in!==0)return o;(r=v.state).mode===12&&(r.mode=13),et=v.next_out,tt=v.output,nt=v.avail_out,F=v.next_in,M=v.input,L=v.avail_in,P=r.hold,j=r.bits,X=L,K=nt,D=y;t:for(;;)switch(r.mode){case b:if(r.wrap===0){r.mode=13;break}for(;j<16;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}if(2&r.wrap&&P===35615){T[r.check=0]=255&P,T[1]=P>>>8&255,r.check=s(r.check,T,2,0),j=P=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&P)<<8)+(P>>8))%31){v.msg="incorrect header check",r.mode=30;break}if((15&P)!=8){v.msg="unknown compression method",r.mode=30;break}if(j-=4,t=8+(15&(P>>>=4)),r.wbits===0)r.wbits=t;else if(t>r.wbits){v.msg="invalid window size",r.mode=30;break}r.dmax=1<<t,v.adler=r.check=1,r.mode=512&P?10:12,j=P=0;break;case 2:for(;j<16;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}if(r.flags=P,(255&r.flags)!=8){v.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){v.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=P>>8&1),512&r.flags&&(T[0]=255&P,T[1]=P>>>8&255,r.check=s(r.check,T,2,0)),j=P=0,r.mode=3;case 3:for(;j<32;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}r.head&&(r.head.time=P),512&r.flags&&(T[0]=255&P,T[1]=P>>>8&255,T[2]=P>>>16&255,T[3]=P>>>24&255,r.check=s(r.check,T,4,0)),j=P=0,r.mode=4;case 4:for(;j<16;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}r.head&&(r.head.xflags=255&P,r.head.os=P>>8),512&r.flags&&(T[0]=255&P,T[1]=P>>>8&255,r.check=s(r.check,T,2,0)),j=P=0,r.mode=5;case 5:if(1024&r.flags){for(;j<16;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}r.length=P,r.head&&(r.head.extra_len=P),512&r.flags&&(T[0]=255&P,T[1]=P>>>8&255,r.check=s(r.check,T,2,0)),j=P=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(L<($=r.length)&&($=L),$&&(r.head&&(t=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),c.arraySet(r.head.extra,M,F,$,t)),512&r.flags&&(r.check=s(r.check,M,$,F)),L-=$,F+=$,r.length-=$),r.length))break t;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(L===0)break t;for($=0;t=M[F+$++],r.head&&t&&r.length<65536&&(r.head.name+=String.fromCharCode(t)),t&&$<L;);if(512&r.flags&&(r.check=s(r.check,M,$,F)),L-=$,F+=$,t)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(L===0)break t;for($=0;t=M[F+$++],r.head&&t&&r.length<65536&&(r.head.comment+=String.fromCharCode(t)),t&&$<L;);if(512&r.flags&&(r.check=s(r.check,M,$,F)),L-=$,F+=$,t)break t}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;j<16;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}if(P!==(65535&r.check)){v.msg="header crc mismatch",r.mode=30;break}j=P=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),v.adler=r.check=0,r.mode=12;break;case 10:for(;j<32;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}v.adler=r.check=d(P),j=P=0,r.mode=11;case 11:if(r.havedict===0)return v.next_out=et,v.avail_out=nt,v.next_in=F,v.avail_in=L,r.hold=P,r.bits=j,2;v.adler=r.check=1,r.mode=12;case 12:if(O===5||O===6)break t;case 13:if(r.last){P>>>=7&j,j-=7&j,r.mode=27;break}for(;j<3;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}switch(r.last=1&P,j-=1,3&(P>>>=1)){case 0:r.mode=14;break;case 1:if(E(r),r.mode=20,O!==6)break;P>>>=2,j-=2;break t;case 2:r.mode=17;break;case 3:v.msg="invalid block type",r.mode=30}P>>>=2,j-=2;break;case 14:for(P>>>=7&j,j-=7&j;j<32;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}if((65535&P)!=(P>>>16^65535)){v.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&P,j=P=0,r.mode=15,O===6)break t;case 15:r.mode=16;case 16:if($=r.length){if(L<$&&($=L),nt<$&&($=nt),$===0)break t;c.arraySet(tt,M,F,$,et),L-=$,F+=$,nt-=$,et+=$,r.length-=$;break}r.mode=12;break;case 17:for(;j<14;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}if(r.nlen=257+(31&P),P>>>=5,j-=5,r.ndist=1+(31&P),P>>>=5,j-=5,r.ncode=4+(15&P),P>>>=4,j-=4,286<r.nlen||30<r.ndist){v.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;j<3;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}r.lens[Z[r.have++]]=7&P,P>>>=3,j-=3}for(;r.have<19;)r.lens[Z[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},D=m(0,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,D){v.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;Y=(g=r.lencode[P&(1<<r.lenbits)-1])>>>16&255,it=65535&g,!((st=g>>>24)<=j);){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}if(it<16)P>>>=st,j-=st,r.lens[r.have++]=it;else{if(it===16){for(w=st+2;j<w;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}if(P>>>=st,j-=st,r.have===0){v.msg="invalid bit length repeat",r.mode=30;break}t=r.lens[r.have-1],$=3+(3&P),P>>>=2,j-=2}else if(it===17){for(w=st+3;j<w;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}j-=st,t=0,$=3+(7&(P>>>=st)),P>>>=3,j-=3}else{for(w=st+7;j<w;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}j-=st,t=0,$=11+(127&(P>>>=st)),P>>>=7,j-=7}if(r.have+$>r.nlen+r.ndist){v.msg="invalid bit length repeat",r.mode=30;break}for(;$--;)r.lens[r.have++]=t}}if(r.mode===30)break;if(r.lens[256]===0){v.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,B={bits:r.lenbits},D=m(_,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,D){v.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},D=m(f,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,D){v.msg="invalid distances set",r.mode=30;break}if(r.mode=20,O===6)break t;case 20:r.mode=21;case 21:if(6<=L&&258<=nt){v.next_out=et,v.avail_out=nt,v.next_in=F,v.avail_in=L,r.hold=P,r.bits=j,a(v,K),et=v.next_out,tt=v.output,nt=v.avail_out,F=v.next_in,M=v.input,L=v.avail_in,P=r.hold,j=r.bits,r.mode===12&&(r.back=-1);break}for(r.back=0;Y=(g=r.lencode[P&(1<<r.lenbits)-1])>>>16&255,it=65535&g,!((st=g>>>24)<=j);){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}if(Y&&!(240&Y)){for(at=st,ft=Y,ct=it;Y=(g=r.lencode[ct+((P&(1<<at+ft)-1)>>at)])>>>16&255,it=65535&g,!(at+(st=g>>>24)<=j);){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}P>>>=at,j-=at,r.back+=at}if(P>>>=st,j-=st,r.back+=st,r.length=it,Y===0){r.mode=26;break}if(32&Y){r.back=-1,r.mode=12;break}if(64&Y){v.msg="invalid literal/length code",r.mode=30;break}r.extra=15&Y,r.mode=22;case 22:if(r.extra){for(w=r.extra;j<w;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}r.length+=P&(1<<r.extra)-1,P>>>=r.extra,j-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;Y=(g=r.distcode[P&(1<<r.distbits)-1])>>>16&255,it=65535&g,!((st=g>>>24)<=j);){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}if(!(240&Y)){for(at=st,ft=Y,ct=it;Y=(g=r.distcode[ct+((P&(1<<at+ft)-1)>>at)])>>>16&255,it=65535&g,!(at+(st=g>>>24)<=j);){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}P>>>=at,j-=at,r.back+=at}if(P>>>=st,j-=st,r.back+=st,64&Y){v.msg="invalid distance code",r.mode=30;break}r.offset=it,r.extra=15&Y,r.mode=24;case 24:if(r.extra){for(w=r.extra;j<w;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}r.offset+=P&(1<<r.extra)-1,P>>>=r.extra,j-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){v.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(nt===0)break t;if($=K-nt,r.offset>$){if(($=r.offset-$)>r.whave&&r.sane){v.msg="invalid distance too far back",r.mode=30;break}lt=$>r.wnext?($-=r.wnext,r.wsize-$):r.wnext-$,$>r.length&&($=r.length),dt=r.window}else dt=tt,lt=et-r.offset,$=r.length;for(nt<$&&($=nt),nt-=$,r.length-=$;tt[et++]=dt[lt++],--$;);r.length===0&&(r.mode=21);break;case 26:if(nt===0)break t;tt[et++]=r.length,nt--,r.mode=21;break;case 27:if(r.wrap){for(;j<32;){if(L===0)break t;L--,P|=M[F++]<<j,j+=8}if(K-=nt,v.total_out+=K,r.total+=K,K&&(v.adler=r.check=r.flags?s(r.check,tt,K,et-K):n(r.check,tt,K,et-K)),K=nt,(r.flags?P:d(P))!==r.check){v.msg="incorrect data check",r.mode=30;break}j=P=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;j<32;){if(L===0)break t;L--,P+=M[F++]<<j,j+=8}if(P!==(4294967295&r.total)){v.msg="incorrect length check",r.mode=30;break}j=P=0}r.mode=29;case 29:D=1;break t;case 30:D=-3;break t;case 31:return-4;case 32:default:return o}return v.next_out=et,v.avail_out=nt,v.next_in=F,v.avail_in=L,r.hold=P,r.bits=j,(r.wsize||K!==v.avail_out&&r.mode<30&&(r.mode<27||O!==4))&&G(v,v.output,v.next_out,K-v.avail_out)?(r.mode=31,-4):(X-=v.avail_in,K-=v.avail_out,v.total_in+=X,v.total_out+=K,r.total+=K,r.wrap&&K&&(v.adler=r.check=r.flags?s(r.check,tt,K,v.next_out-K):n(r.check,tt,K,v.next_out-K)),v.data_type=r.bits+(r.last?64:0)+(r.mode===12?128:0)+(r.mode===20||r.mode===15?256:0),(X==0&&K===0||O===4)&&D===y&&(D=-5),D)},h.inflateEnd=function(v){if(!v||!v.state)return o;var O=v.state;return O.window&&(O.window=null),v.state=null,y},h.inflateGetHeader=function(v,O){var r;return v&&v.state&&2&(r=v.state).wrap?((r.head=O).done=!1,y):o},h.inflateSetDictionary=function(v,O){var r,M=O.length;return v&&v.state?(r=v.state).wrap!==0&&r.mode!==11?o:r.mode===11&&n(1,O,M,0)!==r.check?-3:G(v,O,M,M)?(r.mode=31,-4):(r.havedict=1,y):o},h.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(l,k,h){var c=l("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];k.exports=function(_,f,y,o,b,i,p,d){var C,S,z,A,W,N,x,u,E,G=d.bits,v=0,O=0,r=0,M=0,tt=0,F=0,et=0,L=0,nt=0,P=0,j=null,X=0,K=new c.Buf16(16),$=new c.Buf16(16),lt=null,dt=0;for(v=0;v<=15;v++)K[v]=0;for(O=0;O<o;O++)K[f[y+O]]++;for(tt=G,M=15;1<=M&&K[M]===0;M--);if(M<tt&&(tt=M),M===0)return b[i++]=20971520,b[i++]=20971520,d.bits=1,0;for(r=1;r<M&&K[r]===0;r++);for(tt<r&&(tt=r),v=L=1;v<=15;v++)if(L<<=1,(L-=K[v])<0)return-1;if(0<L&&(_===0||M!==1))return-1;for($[1]=0,v=1;v<15;v++)$[v+1]=$[v]+K[v];for(O=0;O<o;O++)f[y+O]!==0&&(p[$[f[y+O]]++]=O);if(N=_===0?(j=lt=p,19):_===1?(j=n,X-=257,lt=s,dt-=257,256):(j=a,lt=m,-1),v=r,W=i,et=O=P=0,z=-1,A=(nt=1<<(F=tt))-1,_===1&&852<nt||_===2&&592<nt)return 1;for(;;){for(x=v-et,E=p[O]<N?(u=0,p[O]):p[O]>N?(u=lt[dt+p[O]],j[X+p[O]]):(u=96,0),C=1<<v-et,r=S=1<<F;b[W+(P>>et)+(S-=C)]=x<<24|u<<16|E|0,S!==0;);for(C=1<<v-1;P&C;)C>>=1;if(C!==0?(P&=C-1,P+=C):P=0,O++,--K[v]==0){if(v===M)break;v=f[y+p[O]]}if(tt<v&&(P&A)!==z){for(et===0&&(et=tt),W+=r,L=1<<(F=v-et);F+et<M&&!((L-=K[F+et])<=0);)F++,L<<=1;if(nt+=1<<F,_===1&&852<nt||_===2&&592<nt)return 1;b[z=P&A]=tt<<24|F<<16|W-i|0}}return P!==0&&(b[W+P]=v-et<<24|64<<16|0),d.bits=tt,0}},{"../utils/common":41}],51:[function(l,k,h){k.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(l,k,h){var c=l("../utils/common"),n=0,s=1;function a(g){for(var T=g.length;0<=--T;)g[T]=0}var m=0,_=29,f=256,y=f+1+_,o=30,b=19,i=2*y+1,p=15,d=16,C=7,S=256,z=16,A=17,W=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=new Array(2*(y+2));a(G);var v=new Array(2*o);a(v);var O=new Array(512);a(O);var r=new Array(256);a(r);var M=new Array(_);a(M);var tt,F,et,L=new Array(o);function nt(g,T,Z,H,R){this.static_tree=g,this.extra_bits=T,this.extra_base=Z,this.elems=H,this.max_length=R,this.has_stree=g&&g.length}function P(g,T){this.dyn_tree=g,this.max_code=0,this.stat_desc=T}function j(g){return g<256?O[g]:O[256+(g>>>7)]}function X(g,T){g.pending_buf[g.pending++]=255&T,g.pending_buf[g.pending++]=T>>>8&255}function K(g,T,Z){g.bi_valid>d-Z?(g.bi_buf|=T<<g.bi_valid&65535,X(g,g.bi_buf),g.bi_buf=T>>d-g.bi_valid,g.bi_valid+=Z-d):(g.bi_buf|=T<<g.bi_valid&65535,g.bi_valid+=Z)}function $(g,T,Z){K(g,Z[2*T],Z[2*T+1])}function lt(g,T){for(var Z=0;Z|=1&g,g>>>=1,Z<<=1,0<--T;);return Z>>>1}function dt(g,T,Z){var H,R,q=new Array(p+1),J=0;for(H=1;H<=p;H++)q[H]=J=J+Z[H-1]<<1;for(R=0;R<=T;R++){var V=g[2*R+1];V!==0&&(g[2*R]=lt(q[V]++,V))}}function st(g){var T;for(T=0;T<y;T++)g.dyn_ltree[2*T]=0;for(T=0;T<o;T++)g.dyn_dtree[2*T]=0;for(T=0;T<b;T++)g.bl_tree[2*T]=0;g.dyn_ltree[2*S]=1,g.opt_len=g.static_len=0,g.last_lit=g.matches=0}function Y(g){8<g.bi_valid?X(g,g.bi_buf):0<g.bi_valid&&(g.pending_buf[g.pending++]=g.bi_buf),g.bi_buf=0,g.bi_valid=0}function it(g,T,Z,H){var R=2*T,q=2*Z;return g[R]<g[q]||g[R]===g[q]&&H[T]<=H[Z]}function at(g,T,Z){for(var H=g.heap[Z],R=Z<<1;R<=g.heap_len&&(R<g.heap_len&&it(T,g.heap[R+1],g.heap[R],g.depth)&&R++,!it(T,H,g.heap[R],g.depth));)g.heap[Z]=g.heap[R],Z=R,R<<=1;g.heap[Z]=H}function ft(g,T,Z){var H,R,q,J,V=0;if(g.last_lit!==0)for(;H=g.pending_buf[g.d_buf+2*V]<<8|g.pending_buf[g.d_buf+2*V+1],R=g.pending_buf[g.l_buf+V],V++,H===0?$(g,R,T):($(g,(q=r[R])+f+1,T),(J=N[q])!==0&&K(g,R-=M[q],J),$(g,q=j(--H),Z),(J=x[q])!==0&&K(g,H-=L[q],J)),V<g.last_lit;);$(g,S,T)}function ct(g,T){var Z,H,R,q=T.dyn_tree,J=T.stat_desc.static_tree,V=T.stat_desc.has_stree,rt=T.stat_desc.elems,ht=-1;for(g.heap_len=0,g.heap_max=i,Z=0;Z<rt;Z++)q[2*Z]!==0?(g.heap[++g.heap_len]=ht=Z,g.depth[Z]=0):q[2*Z+1]=0;for(;g.heap_len<2;)q[2*(R=g.heap[++g.heap_len]=ht<2?++ht:0)]=1,g.depth[R]=0,g.opt_len--,V&&(g.static_len-=J[2*R+1]);for(T.max_code=ht,Z=g.heap_len>>1;1<=Z;Z--)at(g,q,Z);for(R=rt;Z=g.heap[1],g.heap[1]=g.heap[g.heap_len--],at(g,q,1),H=g.heap[1],g.heap[--g.heap_max]=Z,g.heap[--g.heap_max]=H,q[2*R]=q[2*Z]+q[2*H],g.depth[R]=(g.depth[Z]>=g.depth[H]?g.depth[Z]:g.depth[H])+1,q[2*Z+1]=q[2*H+1]=R,g.heap[1]=R++,at(g,q,1),2<=g.heap_len;);g.heap[--g.heap_max]=g.heap[1],function(ot,mt){var wt,bt,vt,pt,_t,jt,yt=mt.dyn_tree,Ht=mt.max_code,ve=mt.stat_desc.static_tree,_e=mt.stat_desc.has_stree,we=mt.stat_desc.extra_bits,Vt=mt.stat_desc.extra_base,Et=mt.stat_desc.max_length,Ot=0;for(pt=0;pt<=p;pt++)ot.bl_count[pt]=0;for(yt[2*ot.heap[ot.heap_max]+1]=0,wt=ot.heap_max+1;wt<i;wt++)Et<(pt=yt[2*yt[2*(bt=ot.heap[wt])+1]+1]+1)&&(pt=Et,Ot++),yt[2*bt+1]=pt,Ht<bt||(ot.bl_count[pt]++,_t=0,Vt<=bt&&(_t=we[bt-Vt]),jt=yt[2*bt],ot.opt_len+=jt*(pt+_t),_e&&(ot.static_len+=jt*(ve[2*bt+1]+_t)));if(Ot!==0){do{for(pt=Et-1;ot.bl_count[pt]===0;)pt--;ot.bl_count[pt]--,ot.bl_count[pt+1]+=2,ot.bl_count[Et]--,Ot-=2}while(0<Ot);for(pt=Et;pt!==0;pt--)for(bt=ot.bl_count[pt];bt!==0;)Ht<(vt=ot.heap[--wt])||(yt[2*vt+1]!==pt&&(ot.opt_len+=(pt-yt[2*vt+1])*yt[2*vt],yt[2*vt+1]=pt),bt--)}}(g,T),dt(q,ht,g.bl_count)}function t(g,T,Z){var H,R,q=-1,J=T[1],V=0,rt=7,ht=4;for(J===0&&(rt=138,ht=3),T[2*(Z+1)+1]=65535,H=0;H<=Z;H++)R=J,J=T[2*(H+1)+1],++V<rt&&R===J||(V<ht?g.bl_tree[2*R]+=V:R!==0?(R!==q&&g.bl_tree[2*R]++,g.bl_tree[2*z]++):V<=10?g.bl_tree[2*A]++:g.bl_tree[2*W]++,q=R,ht=(V=0)===J?(rt=138,3):R===J?(rt=6,3):(rt=7,4))}function D(g,T,Z){var H,R,q=-1,J=T[1],V=0,rt=7,ht=4;for(J===0&&(rt=138,ht=3),H=0;H<=Z;H++)if(R=J,J=T[2*(H+1)+1],!(++V<rt&&R===J)){if(V<ht)for(;$(g,R,g.bl_tree),--V!=0;);else R!==0?(R!==q&&($(g,R,g.bl_tree),V--),$(g,z,g.bl_tree),K(g,V-3,2)):V<=10?($(g,A,g.bl_tree),K(g,V-3,3)):($(g,W,g.bl_tree),K(g,V-11,7));q=R,ht=(V=0)===J?(rt=138,3):R===J?(rt=6,3):(rt=7,4)}}a(L);var B=!1;function w(g,T,Z,H){K(g,(m<<1)+(H?1:0),3),function(R,q,J,V){Y(R),X(R,J),X(R,~J),c.arraySet(R.pending_buf,R.window,q,J,R.pending),R.pending+=J}(g,T,Z)}h._tr_init=function(g){B||(function(){var T,Z,H,R,q,J=new Array(p+1);for(R=H=0;R<_-1;R++)for(M[R]=H,T=0;T<1<<N[R];T++)r[H++]=R;for(r[H-1]=R,R=q=0;R<16;R++)for(L[R]=q,T=0;T<1<<x[R];T++)O[q++]=R;for(q>>=7;R<o;R++)for(L[R]=q<<7,T=0;T<1<<x[R]-7;T++)O[256+q++]=R;for(Z=0;Z<=p;Z++)J[Z]=0;for(T=0;T<=143;)G[2*T+1]=8,T++,J[8]++;for(;T<=255;)G[2*T+1]=9,T++,J[9]++;for(;T<=279;)G[2*T+1]=7,T++,J[7]++;for(;T<=287;)G[2*T+1]=8,T++,J[8]++;for(dt(G,y+1,J),T=0;T<o;T++)v[2*T+1]=5,v[2*T]=lt(T,5);tt=new nt(G,N,f+1,y,p),F=new nt(v,x,0,o,p),et=new nt(new Array(0),u,0,b,C)}(),B=!0),g.l_desc=new P(g.dyn_ltree,tt),g.d_desc=new P(g.dyn_dtree,F),g.bl_desc=new P(g.bl_tree,et),g.bi_buf=0,g.bi_valid=0,st(g)},h._tr_stored_block=w,h._tr_flush_block=function(g,T,Z,H){var R,q,J=0;0<g.level?(g.strm.data_type===2&&(g.strm.data_type=function(V){var rt,ht=4093624447;for(rt=0;rt<=31;rt++,ht>>>=1)if(1&ht&&V.dyn_ltree[2*rt]!==0)return n;if(V.dyn_ltree[18]!==0||V.dyn_ltree[20]!==0||V.dyn_ltree[26]!==0)return s;for(rt=32;rt<f;rt++)if(V.dyn_ltree[2*rt]!==0)return s;return n}(g)),ct(g,g.l_desc),ct(g,g.d_desc),J=function(V){var rt;for(t(V,V.dyn_ltree,V.l_desc.max_code),t(V,V.dyn_dtree,V.d_desc.max_code),ct(V,V.bl_desc),rt=b-1;3<=rt&&V.bl_tree[2*E[rt]+1]===0;rt--);return V.opt_len+=3*(rt+1)+5+5+4,rt}(g),R=g.opt_len+3+7>>>3,(q=g.static_len+3+7>>>3)<=R&&(R=q)):R=q=Z+5,Z+4<=R&&T!==-1?w(g,T,Z,H):g.strategy===4||q===R?(K(g,2+(H?1:0),3),ft(g,G,v)):(K(g,4+(H?1:0),3),function(V,rt,ht,ot){var mt;for(K(V,rt-257,5),K(V,ht-1,5),K(V,ot-4,4),mt=0;mt<ot;mt++)K(V,V.bl_tree[2*E[mt]+1],3);D(V,V.dyn_ltree,rt-1),D(V,V.dyn_dtree,ht-1)}(g,g.l_desc.max_code+1,g.d_desc.max_code+1,J+1),ft(g,g.dyn_ltree,g.dyn_dtree)),st(g),H&&Y(g)},h._tr_tally=function(g,T,Z){return g.pending_buf[g.d_buf+2*g.last_lit]=T>>>8&255,g.pending_buf[g.d_buf+2*g.last_lit+1]=255&T,g.pending_buf[g.l_buf+g.last_lit]=255&Z,g.last_lit++,T===0?g.dyn_ltree[2*Z]++:(g.matches++,T--,g.dyn_ltree[2*(r[Z]+f+1)]++,g.dyn_dtree[2*j(T)]++),g.last_lit===g.lit_bufsize-1},h._tr_align=function(g){K(g,2,3),$(g,S,G),function(T){T.bi_valid===16?(X(T,T.bi_buf),T.bi_buf=0,T.bi_valid=0):8<=T.bi_valid&&(T.pending_buf[T.pending++]=255&T.bi_buf,T.bi_buf>>=8,T.bi_valid-=8)}(g)}},{"../utils/common":41}],53:[function(l,k,h){k.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(l,k,h){(function(c){(function(n,s){if(!n.setImmediate){var a,m,_,f,y=1,o={},b=!1,i=n.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(n);p=p&&p.setTimeout?p:n,a={}.toString.call(n.process)==="[object process]"?function(z){process.nextTick(function(){C(z)})}:function(){if(n.postMessage&&!n.importScripts){var z=!0,A=n.onmessage;return n.onmessage=function(){z=!1},n.postMessage("","*"),n.onmessage=A,z}}()?(f="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",S,!1):n.attachEvent("onmessage",S),function(z){n.postMessage(f+z,"*")}):n.MessageChannel?((_=new MessageChannel).port1.onmessage=function(z){C(z.data)},function(z){_.port2.postMessage(z)}):i&&"onreadystatechange"in i.createElement("script")?(m=i.documentElement,function(z){var A=i.createElement("script");A.onreadystatechange=function(){C(z),A.onreadystatechange=null,m.removeChild(A),A=null},m.appendChild(A)}):function(z){setTimeout(C,0,z)},p.setImmediate=function(z){typeof z!="function"&&(z=new Function(""+z));for(var A=new Array(arguments.length-1),W=0;W<A.length;W++)A[W]=arguments[W+1];var N={callback:z,args:A};return o[y]=N,a(y),y++},p.clearImmediate=d}function d(z){delete o[z]}function C(z){if(b)setTimeout(C,0,z);else{var A=o[z];if(A){b=!0;try{(function(W){var N=W.callback,x=W.args;switch(x.length){case 0:N();break;case 1:N(x[0]);break;case 2:N(x[0],x[1]);break;case 3:N(x[0],x[1],x[2]);break;default:N.apply(s,x)}})(A)}finally{d(z),b=!1}}}}function S(z){z.source===n&&typeof z.data=="string"&&z.data.indexOf(f)===0&&C(+z.data.slice(f.length))}})(typeof self>"u"?c===void 0?this:c:self)}).call(this,typeof At<"u"?At:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(fe);var ir=fe.exports;const ar=ae(ir);var pe={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(I,U){(function(l,k){I.exports=k()})(At,function l(){var k=typeof self<"u"?self:typeof window<"u"?window:k!==void 0?k:{},h=!k.document&&!!k.postMessage,c=k.IS_PAPA_WORKER||!1,n={},s=0,a={parse:function(x,u){var E=(u=u||{}).dynamicTyping||!1;if(N(E)&&(u.dynamicTypingFunction=E,E={}),u.dynamicTyping=E,u.transform=!!N(u.transform)&&u.transform,u.worker&&a.WORKERS_SUPPORTED){var G=function(){if(!a.WORKERS_SUPPORTED)return!1;var O=(M=k.URL||k.webkitURL||null,tt=l.toString(),a.BLOB_URL||(a.BLOB_URL=M.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",tt,")();"],{type:"text/javascript"})))),r=new k.Worker(O),M,tt;return r.onmessage=C,r.id=s++,n[r.id]=r}();return G.userStep=u.step,G.userChunk=u.chunk,G.userComplete=u.complete,G.userError=u.error,u.step=N(u.step),u.chunk=N(u.chunk),u.complete=N(u.complete),u.error=N(u.error),delete u.worker,void G.postMessage({input:x,config:u,workerId:G.id})}var v=null;return a.NODE_STREAM_INPUT,typeof x=="string"?(x=function(O){return O.charCodeAt(0)===65279?O.slice(1):O}(x),v=u.download?new f(u):new o(u)):x.readable===!0&&N(x.read)&&N(x.on)?v=new b(u):(k.File&&x instanceof File||x instanceof Object)&&(v=new y(u)),v.stream(x)},unparse:function(x,u){var E=!1,G=!0,v=",",O=`\r
`,r='"',M=r+r,tt=!1,F=null,et=!1;(function(){if(typeof u=="object"){if(typeof u.delimiter!="string"||a.BAD_DELIMITERS.filter(function(j){return u.delimiter.indexOf(j)!==-1}).length||(v=u.delimiter),(typeof u.quotes=="boolean"||typeof u.quotes=="function"||Array.isArray(u.quotes))&&(E=u.quotes),typeof u.skipEmptyLines!="boolean"&&typeof u.skipEmptyLines!="string"||(tt=u.skipEmptyLines),typeof u.newline=="string"&&(O=u.newline),typeof u.quoteChar=="string"&&(r=u.quoteChar),typeof u.header=="boolean"&&(G=u.header),Array.isArray(u.columns)){if(u.columns.length===0)throw new Error("Option columns is empty");F=u.columns}u.escapeChar!==void 0&&(M=u.escapeChar+r),(typeof u.escapeFormulae=="boolean"||u.escapeFormulae instanceof RegExp)&&(et=u.escapeFormulae instanceof RegExp?u.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var L=new RegExp(p(r),"g");if(typeof x=="string"&&(x=JSON.parse(x)),Array.isArray(x)){if(!x.length||Array.isArray(x[0]))return nt(null,x,tt);if(typeof x[0]=="object")return nt(F||Object.keys(x[0]),x,tt)}else if(typeof x=="object")return typeof x.data=="string"&&(x.data=JSON.parse(x.data)),Array.isArray(x.data)&&(x.fields||(x.fields=x.meta&&x.meta.fields||F),x.fields||(x.fields=Array.isArray(x.data[0])?x.fields:typeof x.data[0]=="object"?Object.keys(x.data[0]):[]),Array.isArray(x.data[0])||typeof x.data[0]=="object"||(x.data=[x.data])),nt(x.fields||[],x.data||[],tt);throw new Error("Unable to serialize unrecognized input");function nt(j,X,K){var $="";typeof j=="string"&&(j=JSON.parse(j)),typeof X=="string"&&(X=JSON.parse(X));var lt=Array.isArray(j)&&0<j.length,dt=!Array.isArray(X[0]);if(lt&&G){for(var st=0;st<j.length;st++)0<st&&($+=v),$+=P(j[st],st);0<X.length&&($+=O)}for(var Y=0;Y<X.length;Y++){var it=lt?j.length:X[Y].length,at=!1,ft=lt?Object.keys(X[Y]).length===0:X[Y].length===0;if(K&&!lt&&(at=K==="greedy"?X[Y].join("").trim()==="":X[Y].length===1&&X[Y][0].length===0),K==="greedy"&&lt){for(var ct=[],t=0;t<it;t++){var D=dt?j[t]:t;ct.push(X[Y][D])}at=ct.join("").trim()===""}if(!at){for(var B=0;B<it;B++){0<B&&!ft&&($+=v);var w=lt&&dt?j[B]:B;$+=P(X[Y][w],B)}Y<X.length-1&&(!K||0<it&&!ft)&&($+=O)}}return $}function P(j,X){if(j==null)return"";if(j.constructor===Date)return JSON.stringify(j).slice(1,25);var K=!1;et&&typeof j=="string"&&et.test(j)&&(j="'"+j,K=!0);var $=j.toString().replace(L,M);return(K=K||E===!0||typeof E=="function"&&E(j,X)||Array.isArray(E)&&E[X]||function(lt,dt){for(var st=0;st<dt.length;st++)if(-1<lt.indexOf(dt[st]))return!0;return!1}($,a.BAD_DELIMITERS)||-1<$.indexOf(v)||$.charAt(0)===" "||$.charAt($.length-1)===" ")?r+$+r:$}}};if(a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!h&&!!k.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=d,a.ParserHandle=i,a.NetworkStreamer=f,a.FileStreamer=y,a.StringStreamer=o,a.ReadableStreamStreamer=b,k.jQuery){var m=k.jQuery;m.fn.parse=function(x){var u=x.config||{},E=[];return this.each(function(O){if(!(m(this).prop("tagName").toUpperCase()==="INPUT"&&m(this).attr("type").toLowerCase()==="file"&&k.FileReader)||!this.files||this.files.length===0)return!0;for(var r=0;r<this.files.length;r++)E.push({file:this.files[r],inputElem:this,instanceConfig:m.extend({},u)})}),G(),this;function G(){if(E.length!==0){var O,r,M,tt,F=E[0];if(N(x.before)){var et=x.before(F.file,F.inputElem);if(typeof et=="object"){if(et.action==="abort")return O="AbortError",r=F.file,M=F.inputElem,tt=et.reason,void(N(x.error)&&x.error({name:O},r,M,tt));if(et.action==="skip")return void v();typeof et.config=="object"&&(F.instanceConfig=m.extend(F.instanceConfig,et.config))}else if(et==="skip")return void v()}var L=F.instanceConfig.complete;F.instanceConfig.complete=function(nt){N(L)&&L(nt,F.file,F.inputElem),v()},a.parse(F.file,F.instanceConfig)}else N(x.complete)&&x.complete()}function v(){E.splice(0,1),G()}}}function _(x){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(u){var E=A(u);E.chunkSize=parseInt(E.chunkSize),u.step||u.chunk||(E.chunkSize=null),this._handle=new i(E),(this._handle.streamer=this)._config=E}).call(this,x),this.parseChunk=function(u,E){if(this.isFirstChunk&&N(this._config.beforeFirstChunk)){var G=this._config.beforeFirstChunk(u);G!==void 0&&(u=G)}this.isFirstChunk=!1,this._halted=!1;var v=this._partialLine+u;this._partialLine="";var O=this._handle.parse(v,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var r=O.meta.cursor;this._finished||(this._partialLine=v.substring(r-this._baseIndex),this._baseIndex=r),O&&O.data&&(this._rowCount+=O.data.length);var M=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(c)k.postMessage({results:O,workerId:a.WORKER_ID,finished:M});else if(N(this._config.chunk)&&!E){if(this._config.chunk(O,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);O=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(O.data),this._completeResults.errors=this._completeResults.errors.concat(O.errors),this._completeResults.meta=O.meta),this._completed||!M||!N(this._config.complete)||O&&O.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),M||O&&O.meta.paused||this._nextChunk(),O}this._halted=!0},this._sendError=function(u){N(this._config.error)?this._config.error(u):c&&this._config.error&&k.postMessage({workerId:a.WORKER_ID,error:u,finished:!1})}}function f(x){var u;(x=x||{}).chunkSize||(x.chunkSize=a.RemoteChunkSize),_.call(this,x),this._nextChunk=h?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(E){this._input=E,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(u=new XMLHttpRequest,this._config.withCredentials&&(u.withCredentials=this._config.withCredentials),h||(u.onload=W(this._chunkLoaded,this),u.onerror=W(this._chunkError,this)),u.open(this._config.downloadRequestBody?"POST":"GET",this._input,!h),this._config.downloadRequestHeaders){var E=this._config.downloadRequestHeaders;for(var G in E)u.setRequestHeader(G,E[G])}if(this._config.chunkSize){var v=this._start+this._config.chunkSize-1;u.setRequestHeader("Range","bytes="+this._start+"-"+v)}try{u.send(this._config.downloadRequestBody)}catch(O){this._chunkError(O.message)}h&&u.status===0&&this._chunkError()}},this._chunkLoaded=function(){u.readyState===4&&(u.status<200||400<=u.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:u.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(E){var G=E.getResponseHeader("Content-Range");return G===null?-1:parseInt(G.substring(G.lastIndexOf("/")+1))}(u),this.parseChunk(u.responseText)))},this._chunkError=function(E){var G=u.statusText||E;this._sendError(new Error(G))}}function y(x){var u,E;(x=x||{}).chunkSize||(x.chunkSize=a.LocalChunkSize),_.call(this,x);var G=typeof FileReader<"u";this.stream=function(v){this._input=v,E=v.slice||v.webkitSlice||v.mozSlice,G?((u=new FileReader).onload=W(this._chunkLoaded,this),u.onerror=W(this._chunkError,this)):u=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var v=this._input;if(this._config.chunkSize){var O=Math.min(this._start+this._config.chunkSize,this._input.size);v=E.call(v,this._start,O)}var r=u.readAsText(v,this._config.encoding);G||this._chunkLoaded({target:{result:r}})},this._chunkLoaded=function(v){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(v.target.result)},this._chunkError=function(){this._sendError(u.error)}}function o(x){var u;_.call(this,x=x||{}),this.stream=function(E){return u=E,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var E,G=this._config.chunkSize;return G?(E=u.substring(0,G),u=u.substring(G)):(E=u,u=""),this._finished=!u,this.parseChunk(E)}}}function b(x){_.call(this,x=x||{});var u=[],E=!0,G=!1;this.pause=function(){_.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){_.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(v){this._input=v,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){G&&u.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),u.length?this.parseChunk(u.shift()):E=!0},this._streamData=W(function(v){try{u.push(typeof v=="string"?v:v.toString(this._config.encoding)),E&&(E=!1,this._checkIsFinished(),this.parseChunk(u.shift()))}catch(O){this._streamError(O)}},this),this._streamError=W(function(v){this._streamCleanUp(),this._sendError(v)},this),this._streamEnd=W(function(){this._streamCleanUp(),G=!0,this._streamData("")},this),this._streamCleanUp=W(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function i(x){var u,E,G,v=Math.pow(2,53),O=-v,r=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,M=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,tt=this,F=0,et=0,L=!1,nt=!1,P=[],j={data:[],errors:[],meta:{}};if(N(x.step)){var X=x.step;x.step=function(Y){if(j=Y,lt())$();else{if($(),j.data.length===0)return;F+=Y.data.length,x.preview&&F>x.preview?E.abort():(j.data=j.data[0],X(j,tt))}}}function K(Y){return x.skipEmptyLines==="greedy"?Y.join("").trim()==="":Y.length===1&&Y[0].length===0}function $(){return j&&G&&(st("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),G=!1),x.skipEmptyLines&&(j.data=j.data.filter(function(Y){return!K(Y)})),lt()&&function(){if(!j)return;function Y(at,ft){N(x.transformHeader)&&(at=x.transformHeader(at,ft)),P.push(at)}if(Array.isArray(j.data[0])){for(var it=0;lt()&&it<j.data.length;it++)j.data[it].forEach(Y);j.data.splice(0,1)}else j.data.forEach(Y)}(),function(){if(!j||!x.header&&!x.dynamicTyping&&!x.transform)return j;function Y(at,ft){var ct,t=x.header?{}:[];for(ct=0;ct<at.length;ct++){var D=ct,B=at[ct];x.header&&(D=ct>=P.length?"__parsed_extra":P[ct]),x.transform&&(B=x.transform(B,D)),B=dt(D,B),D==="__parsed_extra"?(t[D]=t[D]||[],t[D].push(B)):t[D]=B}return x.header&&(ct>P.length?st("FieldMismatch","TooManyFields","Too many fields: expected "+P.length+" fields but parsed "+ct,et+ft):ct<P.length&&st("FieldMismatch","TooFewFields","Too few fields: expected "+P.length+" fields but parsed "+ct,et+ft)),t}var it=1;return!j.data.length||Array.isArray(j.data[0])?(j.data=j.data.map(Y),it=j.data.length):j.data=Y(j.data,0),x.header&&j.meta&&(j.meta.fields=P),et+=it,j}()}function lt(){return x.header&&P.length===0}function dt(Y,it){return at=Y,x.dynamicTypingFunction&&x.dynamicTyping[at]===void 0&&(x.dynamicTyping[at]=x.dynamicTypingFunction(at)),(x.dynamicTyping[at]||x.dynamicTyping)===!0?it==="true"||it==="TRUE"||it!=="false"&&it!=="FALSE"&&(function(ft){if(r.test(ft)){var ct=parseFloat(ft);if(O<ct&&ct<v)return!0}return!1}(it)?parseFloat(it):M.test(it)?new Date(it):it===""?null:it):it;var at}function st(Y,it,at,ft){var ct={type:Y,code:it,message:at};ft!==void 0&&(ct.row=ft),j.errors.push(ct)}this.parse=function(Y,it,at){var ft=x.quoteChar||'"';if(x.newline||(x.newline=function(D,B){D=D.substring(0,1048576);var w=new RegExp(p(B)+"([^]*?)"+p(B),"gm"),g=(D=D.replace(w,"")).split("\r"),T=D.split(`
`),Z=1<T.length&&T[0].length<g[0].length;if(g.length===1||Z)return`
`;for(var H=0,R=0;R<g.length;R++)g[R][0]===`
`&&H++;return H>=g.length/2?`\r
`:"\r"}(Y,ft)),G=!1,x.delimiter)N(x.delimiter)&&(x.delimiter=x.delimiter(Y),j.meta.delimiter=x.delimiter);else{var ct=function(D,B,w,g,T){var Z,H,R,q;T=T||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var J=0;J<T.length;J++){var V=T[J],rt=0,ht=0,ot=0;R=void 0;for(var mt=new d({comments:g,delimiter:V,newline:B,preview:10}).parse(D),wt=0;wt<mt.data.length;wt++)if(w&&K(mt.data[wt]))ot++;else{var bt=mt.data[wt].length;ht+=bt,R!==void 0?0<bt&&(rt+=Math.abs(bt-R),R=bt):R=bt}0<mt.data.length&&(ht/=mt.data.length-ot),(H===void 0||rt<=H)&&(q===void 0||q<ht)&&1.99<ht&&(H=rt,Z=V,q=ht)}return{successful:!!(x.delimiter=Z),bestDelimiter:Z}}(Y,x.newline,x.skipEmptyLines,x.comments,x.delimitersToGuess);ct.successful?x.delimiter=ct.bestDelimiter:(G=!0,x.delimiter=a.DefaultDelimiter),j.meta.delimiter=x.delimiter}var t=A(x);return x.preview&&x.header&&t.preview++,u=Y,E=new d(t),j=E.parse(u,it,at),$(),L?{meta:{paused:!0}}:j||{meta:{paused:!1}}},this.paused=function(){return L},this.pause=function(){L=!0,E.abort(),u=N(x.chunk)?"":u.substring(E.getCharIndex())},this.resume=function(){tt.streamer._halted?(L=!1,tt.streamer.parseChunk(u,!0)):setTimeout(tt.resume,3)},this.aborted=function(){return nt},this.abort=function(){nt=!0,E.abort(),j.meta.aborted=!0,N(x.complete)&&x.complete(j),u=""}}function p(x){return x.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function d(x){var u,E=(x=x||{}).delimiter,G=x.newline,v=x.comments,O=x.step,r=x.preview,M=x.fastMode,tt=u=x.quoteChar===void 0||x.quoteChar===null?'"':x.quoteChar;if(x.escapeChar!==void 0&&(tt=x.escapeChar),(typeof E!="string"||-1<a.BAD_DELIMITERS.indexOf(E))&&(E=","),v===E)throw new Error("Comment character same as delimiter");v===!0?v="#":(typeof v!="string"||-1<a.BAD_DELIMITERS.indexOf(v))&&(v=!1),G!==`
`&&G!=="\r"&&G!==`\r
`&&(G=`
`);var F=0,et=!1;this.parse=function(L,nt,P){if(typeof L!="string")throw new Error("Input must be a string");var j=L.length,X=E.length,K=G.length,$=v.length,lt=N(O),dt=[],st=[],Y=[],it=F=0;if(!L)return vt();if(x.header&&!nt){var at=L.split(G)[0].split(E),ft=[],ct={},t=!1;for(var D in at){var B=at[D];N(x.transformHeader)&&(B=x.transformHeader(B,D));var w=B,g=ct[B]||0;for(0<g&&(t=!0,w=B+"_"+g),ct[B]=g+1;ft.includes(w);)w=w+"_"+g;ft.push(w)}if(t){var T=L.split(G);T[0]=ft.join(E),L=T.join(G)}}if(M||M!==!1&&L.indexOf(u)===-1){for(var Z=L.split(G),H=0;H<Z.length;H++){if(Y=Z[H],F+=Y.length,H!==Z.length-1)F+=G.length;else if(P)return vt();if(!v||Y.substring(0,$)!==v){if(lt){if(dt=[],ot(Y.split(E)),pt(),et)return vt()}else ot(Y.split(E));if(r&&r<=H)return dt=dt.slice(0,r),vt(!0)}}return vt()}for(var R=L.indexOf(E,F),q=L.indexOf(G,F),J=new RegExp(p(tt)+p(u),"g"),V=L.indexOf(u,F);;)if(L[F]!==u)if(v&&Y.length===0&&L.substring(F,F+$)===v){if(q===-1)return vt();F=q+K,q=L.indexOf(G,F),R=L.indexOf(E,F)}else if(R!==-1&&(R<q||q===-1))Y.push(L.substring(F,R)),F=R+X,R=L.indexOf(E,F);else{if(q===-1)break;if(Y.push(L.substring(F,q)),bt(q+K),lt&&(pt(),et))return vt();if(r&&dt.length>=r)return vt(!0)}else for(V=F,F++;;){if((V=L.indexOf(u,V+1))===-1)return P||st.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:dt.length,index:F}),wt();if(V===j-1)return wt(L.substring(F,V).replace(J,u));if(u!==tt||L[V+1]!==tt){if(u===tt||V===0||L[V-1]!==tt){R!==-1&&R<V+1&&(R=L.indexOf(E,V+1)),q!==-1&&q<V+1&&(q=L.indexOf(G,V+1));var rt=mt(q===-1?R:Math.min(R,q));if(L.substr(V+1+rt,X)===E){Y.push(L.substring(F,V).replace(J,u)),L[F=V+1+rt+X]!==u&&(V=L.indexOf(u,F)),R=L.indexOf(E,F),q=L.indexOf(G,F);break}var ht=mt(q);if(L.substring(V+1+ht,V+1+ht+K)===G){if(Y.push(L.substring(F,V).replace(J,u)),bt(V+1+ht+K),R=L.indexOf(E,F),V=L.indexOf(u,F),lt&&(pt(),et))return vt();if(r&&dt.length>=r)return vt(!0);break}st.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:dt.length,index:F}),V++}}else V++}return wt();function ot(_t){dt.push(_t),it=F}function mt(_t){var jt=0;if(_t!==-1){var yt=L.substring(V+1,_t);yt&&yt.trim()===""&&(jt=yt.length)}return jt}function wt(_t){return P||(_t===void 0&&(_t=L.substring(F)),Y.push(_t),F=j,ot(Y),lt&&pt()),vt()}function bt(_t){F=_t,ot(Y),Y=[],q=L.indexOf(G,F)}function vt(_t){return{data:dt,errors:st,meta:{delimiter:E,linebreak:G,aborted:et,truncated:!!_t,cursor:it+(nt||0)}}}function pt(){O(vt()),dt=[],st=[]}},this.abort=function(){et=!0},this.getCharIndex=function(){return F}}function C(x){var u=x.data,E=n[u.workerId],G=!1;if(u.error)E.userError(u.error,u.file);else if(u.results&&u.results.data){var v={abort:function(){G=!0,S(u.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:z,resume:z};if(N(E.userStep)){for(var O=0;O<u.results.data.length&&(E.userStep({data:u.results.data[O],errors:u.results.errors,meta:u.results.meta},v),!G);O++);delete u.results}else N(E.userChunk)&&(E.userChunk(u.results,v,u.file),delete u.results)}u.finished&&!G&&S(u.workerId,u.results)}function S(x,u){var E=n[x];N(E.userComplete)&&E.userComplete(u),E.terminate(),delete n[x]}function z(){throw new Error("Not implemented.")}function A(x){if(typeof x!="object"||x===null)return x;var u=Array.isArray(x)?[]:{};for(var E in x)u[E]=A(x[E]);return u}function W(x,u){return function(){x.apply(u,arguments)}}function N(x){return typeof x=="function"}return c&&(k.onmessage=function(x){var u=x.data;if(a.WORKER_ID===void 0&&u&&(a.WORKER_ID=u.workerId),typeof u.input=="string")k.postMessage({workerId:a.WORKER_ID,results:a.parse(u.input,u.config),finished:!0});else if(k.File&&u.input instanceof File||u.input instanceof Object){var E=a.parse(u.input,u.config);E&&k.postMessage({workerId:a.WORKER_ID,results:E,finished:!0})}}),(f.prototype=Object.create(_.prototype)).constructor=f,(y.prototype=Object.create(_.prototype)).constructor=y,(o.prototype=Object.create(o.prototype)).constructor=o,(b.prototype=Object.create(_.prototype)).constructor=b,a})})(pe);var or=pe.exports;const me=ae(or),lr=I=>new Promise(U=>{const l=new FileReader;l.onload=function(k){var h;(h=k.target)!=null&&h.result&&ar.loadAsync(k.target.result).then(function(c){U(c)})},l.readAsArrayBuffer(I)}),Xt=async I=>{const U=[],l=[];for(let k=0;k<I.length;k++){const h=I[k];if(h.type==="application/x-zip-compressed"){const c=await lr(h),n=[];c.forEach(function(s,a){(a.name.endsWith(".csv")||a.name.endsWith(".xml"))&&n.push({object:a})}),U.push({name:h.name,files:n})}else h.type==="text/csv"||h.type==="text/xml"?l.push(h):ut("Unsupported file: "+h.name,"error")}return[U,l]},cr=I=>{const U=[];return I.forEach((l,k)=>{l.files.forEach((h,c)=>{U.push({file:c,zip:k})})}),U},ge=I=>{const U=Zt(I);if(U)return Te(U==null?void 0:U.blocksProps,U==null?void 0:U.desktop,U==null?void 0:U.innerBlocks)},be=I=>{var h;((h=I.at(-1))==null?void 0:h.length)===1&&I.pop();const U=I.reduce((c,n)=>Math.max(c,n.length),0),l={alignment:Tt.alignment,enableMaxWidth:!1,cellMinWidth:120,sortHorizontal:!1,sortVertical:!1,borderCollapse:"collapse !important",tableSpacingX:3,tableSpacingY:3,cols:U,cellsWidthAutoCount:U,tdSumMaxWidth:120*U+20*U,fontColor:"#000000",linkColor:"#000000",fontSize:15,tableBorder:Yt(Tt.tableBorder),innerBorder:Yt(Tt.innerBorder),headerInnerBorder:!0,scrollX:!1,disableThemeStyles:!1,extraStyles:btoa(""),stickyFirstColumn:!1,stickyTopRow:!1,paginationEnable:!1,paginationTopRowAsHeader:"false",rowsPerPage:"10",rowsChangeable:!1,searchEnable:!1,searchKeepHeader:"true",searchPosition:"left",role:"table",directives:Ae(Tt),responsiveDirectives:ze(Tt.responsive)},k=[];return I.forEach((c,n)=>{const s=[];c.forEach((a,m)=>{s.push({props:{autoWidth:"true",autoHeight:"true",padding:"10px",vAlign:"center",xIndex:m,yIndex:n,colspan:1,rowspan:1,hideOnMobile:!1},blocks:[{type:"text",props:{text:`<p>${a}</p>`,color:"#000000",fontSize:"15px"}}]})}),k.push({props:{},cells:s})}),JSON.stringify({props:l,rows:k})},hr=I=>new Promise((U,l)=>{if(I.type==="text/csv")me.parse(I,{complete(k){if(k.errors.length>0){l("Failed to parse the file: "+I.name);return}const h=k.data;U(be(h))}});else if(I.type==="text/xml"){const k=new FileReader;k.onload=function(h){var n;if(!((n=h.target)!=null&&n.result)){l("No content found!");return}const c=ge(h.target.result);U(JSON.stringify(c))},k.readAsText(I)}else l("Unsupported file: "+I.name)}),dr=I=>new Promise((U,l)=>{I.async("text").then(k=>{if(I.name.endsWith(".csv"))me.parse(k,{complete(h){if(h.errors.length>0){l("Failed to parse the file: "+I.name);return}const c=h.data;U(be(c))}});else if(I.name.endsWith(".xml")){const h=ge(k);U(JSON.stringify(h))}else l("Unsupported file: "+I.name),U(null)})}),ur=async({setLoadings:I,zips:U,rawFiles:l,keepTitles:k})=>{I.current({});const h=cr(U),c=h.length+l.length,n=ut(`[0/${c}] Importing tables...`,"progress");let s=1,a=0;for(;a<c;){const m=[];for(let _=0;_<5;_++){let f="";try{let y=a+_,o=null,b,i;if(y<l.length)i=l[y],f=y,o=await hr(i),b=i.name.replace(/\.([a-z]+)$/,"");else if(y<c){y=y-l.length;const p=h[y];i=U[p.zip].files[p.file],f=p.zip+"_"+p.file,o=await dr(i.object),b=i.object.name.replace(/\.([a-z]+)$/,"")}if(!o){s++;continue}I.current(p=>({...p,[f]:1})),m.push(new Promise(p=>{fetch(WPTB_CFG.ADMIN_URL+"?action=save_table",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({title:k?b:void 0,content:o,security_code:WPTB_CFG.SECURITY_CODE})}).then(d=>{if(d.ok)I.current(C=>({...C,[f]:2}));else throw new Error(d.statusText)}).catch(d=>{I.current(C=>({...C,[f]:d.message||"Something went wrong..."}))}).finally(()=>{s++,p(!0)})}))}catch(y){s++,I.current(o=>({...o,[f]:typeof y=="string"?y:y.message||"Something went wrong..."}))}finally{Kt(n,{progress:s/c*100,message:`[${s}/${c}] Importing tables...`})}}await Promise.all(m),a+=5}Kt(n,{type:"success",message:`[${c}] Tables imported successfully!`,spawned_at:Date.now(),duration:5e3})},Jt=I=>I?I===1?ne:I===2?Ie:e.jsx(oe,{content:I,children:Oe}):"",fr=({setPage:I})=>{const[U,l]=Q.useState(!1),[k,h]=Q.useState(!0),[c,n]=Q.useState([]),[s,a]=Q.useState([]),[m,_]=Q.useState({}),[f,y]=Q.useState(!1),o=Q.useRef(_);Q.useEffect(()=>{o.current=_},[_]);const b=async S=>{if(S.preventDefault(),S.stopPropagation(),l(!1),f){ut("Please wait for the previous import to finish.","error");return}const[z,A]=await Xt(S.dataTransfer.files);n([...c,...z]),a([...s,...A])},i=async S=>{if(f){S.target.value="",ut("Please wait for the previous import to finish.","error");return}const[z,A]=await Xt(Array.from(S.target.files));n([...c,...z]),a([...s,...A]),S.target.value=""},p=(S,z)=>{n(A=>{const W=[...A];return z!==void 0?W[S].files.splice(z,1):W.splice(S,1),W})},d=S=>{a(z=>{if(S===void 0)return[];const A=[...z];return A.splice(S,1),A})},C=async()=>{if(f){ut("Please wait for the previous import to finish.","error");return}y(!0),await ur({setLoadings:o,zips:c,rawFiles:s,keepTitles:k}),y(!1)};return e.jsxs("div",{className:"wptb-v2-page",children:[e.jsx(It,{setPage:I,page:"import"}),e.jsxs("div",{className:"wptb-v2-page-content",children:[e.jsx("div",{className:"wptb-v2-page-content-top",children:e.jsx("h3",{children:"Import Table"})}),e.jsxs("div",{className:gt("wptb-v2-page-content-main wptb-v2-import-page",{"wptb-v2-import-page-has-files":c.length>0||s.length>0}),children:[e.jsxs("div",{className:"wptb-v2-import-page-main-area",children:[e.jsxs("div",{className:"wptb-v2-import-page-file-area",children:[e.jsx("h3",{children:"Pick files"}),e.jsxs("div",{className:gt("wptb-v2-import-page-dropzone",{"wptb-v2-import-page-dropzone-dragover":U}),onDragOver:S=>{l(!0),S.preventDefault(),S.stopPropagation()},onDragLeave:()=>l(!1),onDrop:b,children:[e.jsx("p",{className:"wptb-v2-import-page-dropzone-text",children:"Drag and drop your files here"}),e.jsx("p",{className:"wptb-v2-import-page-dropzone-types",children:"(csv, xml, zip)"}),e.jsx("div",{className:"wptb-v2-divider",children:"or"}),e.jsxs("label",{children:["Browse files",e.jsx("input",{type:"file",accept:".csv, .xml, .zip",onChange:i,multiple:!0})]})]})]}),(c.length>0||s.length>0)&&e.jsxs("div",{className:"wptb-v2-import-page-preview",children:[e.jsxs("h3",{children:["To be imported",e.jsx("button",{type:"button",title:"Clear Files",onClick:()=>{n([]),a([])},children:Ft})]}),s.length>0&&e.jsxs("div",{className:"wptb-v2-import-page-preview-item",children:[e.jsxs("p",{children:["Single tables",!f&&e.jsx("button",{type:"button",onClick:()=>d(),children:Rt})]}),e.jsx("ul",{children:s.map((S,z)=>e.jsxs("li",{children:[S.name,e.jsxs("div",{className:"wptb-v2-import-page-preview-status",children:[Jt(m[z]),!f&&e.jsx("button",{type:"button",onClick:()=>d(z),children:Rt})]})]},`${S.name}_${z}`))})]}),c.map((S,z)=>e.jsxs("div",{className:"wptb-v2-import-page-preview-item",children:[e.jsxs("p",{children:[S.name,!f&&e.jsx("button",{type:"button",onClick:()=>p(z),children:Rt})]}),e.jsx("ul",{children:S.files.map((A,W)=>e.jsxs("li",{children:[A.object.name,e.jsxs("div",{className:"wptb-v2-import-page-preview-status",children:[Jt(m[`${z}_${W}`]),!f&&e.jsx("button",{type:"button",onClick:()=>p(z,W),children:Rt})]})]},`${A.object.name}_${W}`))})]},S.name))]})]}),e.jsxs("div",{className:"wptb-v2-import-page-form",children:[e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:k,onChange:()=>h(!k)}),e.jsx("p",{children:"Preserve table titles"})]}),e.jsxs("button",{type:"button",onClick:C,disabled:f,children:[f?e.jsx(Ne,{}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 20 20",children:e.jsx("path",{fill:"currentColor",d:"M9 6c0-1.6.8-3 2-4h-1c-3.9 0-7 .9-7 2c0 1 2.6 1.8 6 2m3.8 4.8c-.9.1-1.9.2-2.8.2c-3.9 0-7-.9-7-2v3c0 1.1 3.1 2 7 2s7-.9 7-2v-2c-.9.7-1.9 1-3 1c-.4 0-.8-.1-1.2-.2M10 15c-3.9 0-7-.9-7-2v3c0 1.1 3.1 2 7 2s7-.9 7-2v-3c0 1.1-3.1 2-7 2m0-5h1c-1-.7-1.7-1.8-1.9-3C5.7 6.9 3 6 3 5v3c0 1.1 3.1 2 7 2m4 0c2.2 0 4-1.8 4-4s-1.8-4-4-4s-4 1.8-4 4s1.8 4 4 4m-1-4V3h2v3h2l-3 3l-3-3z"})}),"Import"]})]})]})]})]})},pr=({onSelect:I,onAllSelect:U,apiData:l,searchTxt:k,setSearch:h,items:c,sorting:n})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"wptb-v2-export-page-header",children:[e.jsx("h2",{children:"All Tables"}),e.jsxs("div",{className:"wptb-v2-export-page-search",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 48 48",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"4",children:[e.jsx("path",{d:"M21 38c9.389 0 17-7.611 17-17S30.389 4 21 4S4 11.611 4 21s7.611 17 17 17Z"}),e.jsx("path",{strokeLinecap:"round",d:"M26.657 14.343A7.98 7.98 0 0 0 21 12a7.98 7.98 0 0 0-5.657 2.343m17.879 18.879l8.485 8.485"})]})}),e.jsx("input",{type:"search",placeholder:"Search...",value:k,onChange:s=>h(s.target.value)})]})]}),e.jsxs("p",{className:"wptb-pagination-info",children:["Showing ",e.jsx("b",{children:l.page_start})," to ",e.jsx("b",{children:l.page_end})," of"," ",e.jsx("b",{children:l.total_count})," entries"]}),e.jsx(le,{onSelect:I,onAllCheck:U,sorting:n,isLoading:l.loading,items:c,columns:["title","modified","id"],checkbox:!0})]}),mr=({onUnSelect:I,onAllUnSelect:U,items:l})=>{const k=he("modified","desc"),[h,c]=Q.useState(""),[n,s]=Q.useState(l);Q.useEffect(()=>{s(l)},[l]),Q.useEffect(()=>{if(h==="")return s(l);const m=l.filter(_=>_.title.toLowerCase().includes(h.toLowerCase()));s(m)},[h,l]);const a=k[0];return Q.useEffect(()=>s(m=>(a.order==="asc"?m.sort((_,f)=>_[a.by].toString().localeCompare(f[a.by].toString())):m.sort((_,f)=>f[a.by].toString().localeCompare(_[a.by].toString())),[...m])),[a]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"wptb-v2-export-page-header",children:[e.jsx("h2",{children:"To Export"}),e.jsxs("div",{className:"wptb-v2-export-page-search",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 48 48",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"4",children:[e.jsx("path",{d:"M21 38c9.389 0 17-7.611 17-17S30.389 4 21 4S4 11.611 4 21s7.611 17 17 17Z"}),e.jsx("path",{strokeLinecap:"round",d:"M26.657 14.343A7.98 7.98 0 0 0 21 12a7.98 7.98 0 0 0-5.657 2.343m17.879 18.879l8.485 8.485"})]})}),e.jsx("input",{type:"search",placeholder:"Search...",value:h,onChange:m=>c(m.target.value)})]})]}),e.jsx(le,{onSelect:I,onAllCheck:U,sorting:k,items:n,columns:["title","modified","id"],checkbox:!0,checked:!0,noItemsMessage:"No tables selected"})]})},Wt=document.createElement("a"),gr=async(I,U)=>{new FormData().append("ids",I);try{const k=new FormData;k.append("nonce",WPTB_CFG.EXPORT_KEY),k.append("action","wptb_table_export_main_export"),k.append("ids",JSON.stringify(I.split(","))),k.append("export_type",U.toLocaleUpperCase());const h=await fetch(WPTB_CFG.ADMIN_URL,{method:"POST",body:k});let c,n="";if(h.headers.get("content-type")==="application/octet-stream"){const m=h.headers.get("content-disposition"),f=new RegExp(/filename="(.+\..+)"/,"g").exec(m||"");if(f===null)throw new Error("Invalid file name header!");n=f[1],c=await h.blob()}else c=await h.json();const a=window.URL.createObjectURL(c);Wt.href=a,Wt.download=n,Wt.click(),window.URL.revokeObjectURL(a),ut('File downloaded as "'+n+'"',"success")}catch(k){ut(k.message||"Something went wrong","error")}},br={xml:e.jsxs(e.Fragment,{children:[e.jsx("b",{children:"XML:"})," an exact copy of your tables will be exported, ideal for backing up and sharing your tables with your other WordPress sites that uses WP Table Builder."]}),csv:e.jsxs(e.Fragment,{children:[e.jsx("b",{children:"CSV:"})," only text content of your tables will be exported, ideal for usage within other apps/plugins."]})},vr=({setPage:I})=>{const U=Q.useRef(),[l,k]=Q.useState(1),h=he("modified","desc"),[c,n]=Q.useState(""),[s,a]=Q.useState([]),[m,_]=Q.useState(""),[f,y]=Q.useState("xml"),[o,b]=Q.useState(!1),[i,p,d]=de({page:l,search:c,sort:h[0],abortCtrl:U.current,skipTables:m});Q.useEffect(()=>{a(i.posts)},[i.posts]);const[C,S]=Q.useState([]),z=u=>{const E=m+","+u.id;_(E.replace(/^,/,"")),S([...C,u]),a(s.filter(G=>G.id!==u.id)),s.length<=1&&d()},A=u=>{S(C.filter(G=>G.id!==u.id)),a([...s,u]);let E=m.replace(u.id.toString(),"");E=E.replace(/,,/,","),E=E.replace(/(^,)|(,$)/,""),_(E)},W=()=>{if(!s.length)return;const u=[...C];let E=m;s.forEach(G=>{u.push(G),E=E+","+G.id}),E=E.replace(/^,/,""),S(u),_(E),d()},N=()=>{C.length&&(S([]),_(""),a([...s,...C]))},x=()=>{if(!o){if(!m){ut("No tables selected","error");return}b(!0),gr(m,f).then(()=>{b(!1),N()})}};return e.jsxs("div",{className:"wptb-v2-page",children:[e.jsx(It,{setPage:I,page:"export"}),e.jsxs("div",{className:"wptb-v2-page-content",children:[e.jsx("div",{className:"wptb-v2-page-content-top",children:e.jsx("h3",{children:"Export Table"})}),e.jsxs("div",{className:"wptb-v2-export-page",children:[e.jsxs("div",{className:"wptb-v2-export-page-unselected",children:[e.jsx(pr,{onSelect:z,onAllSelect:W,apiData:i,setSearch:n,searchTxt:c,items:s,sorting:h}),e.jsx(Re,{apiData:i,setPage:k})]}),e.jsxs("div",{className:"wptb-v2-export-page-exchange",children:[e.jsx("button",{type:"button",onClick:W,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",children:[e.jsx("path",{d:"M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}),e.jsx("path",{fill:"currentColor",d:"m15.06 5.283l5.657 5.657a1.5 1.5 0 0 1 0 2.12l-5.656 5.658a1.5 1.5 0 0 1-2.122-2.122l3.096-3.096H4.5a1.5 1.5 0 0 1 0-3h11.535L12.94 7.404a1.5 1.5 0 0 1 2.122-2.121Z"})]})})}),e.jsx("button",{type:"button",onClick:N,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",children:[e.jsx("path",{d:"M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}),e.jsx("path",{fill:"currentColor",d:"M3.283 10.94a1.5 1.5 0 0 0 0 2.12l5.656 5.658a1.5 1.5 0 1 0 2.122-2.122L7.965 13.5H19.5a1.5 1.5 0 0 0 0-3H7.965l3.096-3.096a1.5 1.5 0 1 0-2.122-2.121z"})]})})})]}),e.jsxs("div",{className:"wptb-v2-export-page-selected",children:[e.jsx(mr,{onUnSelect:A,onAllUnSelect:N,items:C}),e.jsxs("div",{className:"wptb-v2-export-page-form",children:[e.jsx("p",{children:"Format:"}),e.jsxs("select",{value:f,onChange:u=>y(u.target.value),children:[e.jsx("option",{value:"xml",children:"XML"}),e.jsx("option",{value:"csv",children:"CSV"})]}),e.jsx(oe,{content:br[f],className:"wptb-v2-export-page-form-info",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10m-1-7v2h2v-2zm2-1.645A3.502 3.502 0 0 0 12 6.5a3.5 3.5 0 0 0-3.433 2.813l1.962.393A1.5 1.5 0 1 1 12 11.5a1 1 0 0 0-1 1V14h2z"})})}),e.jsxs("button",{type:"button",disabled:o,onClick:x,children:[o?e.jsx(Gt,{}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 256 256",children:e.jsx("path",{fill:"currentColor",d:"M74.34 85.66a8 8 0 0 1 11.32-11.32L120 108.69V24a8 8 0 0 1 16 0v84.69l34.34-34.35a8 8 0 0 1 11.32 11.32l-48 48a8 8 0 0 1-11.32 0ZM240 136v64a16 16 0 0 1-16 16H32a16 16 0 0 1-16-16v-64a16 16 0 0 1 16-16h52.4a4 4 0 0 1 2.83 1.17L111 145a24 24 0 0 0 34 0l23.8-23.8a4 4 0 0 1 2.8-1.2H224a16 16 0 0 1 16 16m-40 32a12 12 0 1 0-12 12a12 12 0 0 0 12-12"})}),"Export"]})]})]})]})]})]})},_r=I=>typeof I=="number"||parseInt(I).toString()===I,wr=({table:I,setPage:U})=>{const l=Be(),[k,h]=Q.useState(!1),[c,n]=Q.useState(I);Q.useEffect(()=>{if(n(I),l(Pe({isSaving:!1,activeBlock:void 0,timeTravel:{lastSaved:/[^0-9]/.test(I)?void 0:0,cursor:0,total:0}})),!_r(I)){if(!Lt.getState().table[I]){history.replaceState(null,"","?page=wptb"),U("tables");return}h(!0);return}h(!1);const m=new AbortController,_=`${WPTB_CFG.API_BASE}/v1/table?id=${I}`;return fetch(_,{signal:m.signal,headers:{"X-WP-Nonce":WPTB_CFG.NONCE.wp_rest}}).then(f=>f.json()).then(f=>{if(!f.table){ut("Table not found","error",5e3),history.replaceState(null,"","?page=wptb"),U("tables");return}const y=Zt(f.table);y.title=f.name,y.id=I,y.tags=f.tags,y.is_template=f.is_template,Lt.dispatch(ie({id:I,table:y})),h(!0)}).catch(f=>null),()=>m.abort()},[I,U,l]);const s=([m,_])=>{m==="saved"&&(n(_.toString()),l(Le({oldId:I,newId:_.toString()})),history.replaceState(null,"","?page=wptb-builder&table="+_))},a=()=>{if(history.length>2){history.back();return}U("tables")};return e.jsx(Fe,{id:c,isLoaded:k,onSave:s,onClose:a})},yr=()=>{var s,a,m,_,f,y;const[I,U]=Q.useState(!1),[l,k]=Q.useState(WPTB_CFG.SETTINGS.general||{}),h=o=>{var b;if((b=l.allowed_roles)!=null&&b.includes(o)){const i=l.allowed_roles.filter(p=>p!==o);k({...l,allowed_roles:i})}else{const i=[...l.allowed_roles||[],o];k({...l,allowed_roles:i})}},c=async()=>{if(!I){U(!0);try{const o=new FormData;o.append("nonce",WPTB_CFG.SETTINGS.nonce.general),o.append("action","wp_table_builder_settings"),o.append("options",JSON.stringify(l));const b=await fetch(WPTB_CFG.ADMIN_URL,{method:"POST",body:o}),i=await b.json();if(!b.ok){ut(i.message||"Something went wrong","error");return}if(i.error){ut(i.error,"error");return}ut(i.message||"Settings saved successfully","success"),WPTB_CFG.SETTINGS.general=l}catch(o){console.log(o)}finally{U(!1)}}},n=()=>{k(WPTB_CFG.SETTINGS.general||{})};return e.jsxs("div",{children:[e.jsxs("div",{className:"wptb-v2-general-settings wptb-v2-settings-area",children:[e.jsxs("div",{className:"wptb-v2-setting-group",children:[e.jsx("h3",{children:"Allowed User Roles"}),e.jsxs("div",{className:"wptb-v2-setting-group-items",children:[e.jsx(xt,{label:"Administrator",checked:(s=l.allowed_roles)==null?void 0:s.includes("administrator"),onChange:()=>h("administrator")}),e.jsx(xt,{label:"Editor",checked:(a=l.allowed_roles)==null?void 0:a.includes("editor"),onChange:()=>h("editor")}),e.jsx(xt,{label:"Author",checked:(m=l.allowed_roles)==null?void 0:m.includes("author"),onChange:()=>h("author")}),e.jsx(xt,{label:"Contributor",checked:(_=l.allowed_roles)==null?void 0:_.includes("contributor"),onChange:()=>h("contributor")}),e.jsx(xt,{label:"Subscriber",checked:(f=l.allowed_roles)==null?void 0:f.includes("subscriber"),onChange:()=>h("subscriber")}),e.jsx(xt,{label:"Translator",checked:(y=l.allowed_roles)==null?void 0:y.includes("translator"),onChange:()=>h("translator")})]})]}),e.jsxs("div",{className:"wptb-v2-setting-group",children:[e.jsx("h3",{children:"Table Settings"}),e.jsxs("div",{className:"wptb-v2-setting-group-items",children:[e.jsx(xt,{label:"Show edit link in frontend",checked:!!l.allow_edit_link_frontend,onChange:()=>k({...l,allow_edit_link_frontend:!l.allow_edit_link_frontend})}),e.jsx(xt,{label:"Give credits to WP Table Builder",checked:!!l.give_credits_to_wp_table_builder,onChange:()=>k({...l,give_credits_to_wp_table_builder:!l.give_credits_to_wp_table_builder})}),e.jsx(xt,{label:"Restrict users access to own tables",checked:!!l.restrict_users_to_their_tables,onChange:()=>k({...l,restrict_users_to_their_tables:!l.restrict_users_to_their_tables})}),e.jsx(xt,{label:"Disable Emoji to Image conversion",checked:!!l.emoji_image_conversion_disabled_status,onChange:()=>k({...l,emoji_image_conversion_disabled_status:!l.emoji_image_conversion_disabled_status})}),e.jsx(xt,{label:"Disable theme styles",checked:!!l.disable_theme_styles_for_all,onChange:()=>k({...l,disable_theme_styles_for_all:!l.disable_theme_styles_for_all})})]})]}),e.jsxs("div",{className:"wptb-v2-setting-group",children:[e.jsx("h3",{children:"Plugin Options"}),e.jsxs("div",{className:"wptb-v2-setting-group-items",children:[e.jsx(ce,{rtl:!0,label:"Take over the entire screen in builder",checked:!!l.take_over_entire_screen,onChange:o=>k({...l,take_over_entire_screen:o})}),e.jsx(zt,{label:"Sidebar Location",value:l.panel_location||"left",onChange:o=>k({...l,panel_location:o}),options:[{value:"left",label:"Left"},{value:"right",label:"Right"}]}),e.jsx(xt,{label:"Enable Version Sync",checked:!!l.enable_version_sync,onChange:()=>k({...l,enable_version_sync:!l.enable_version_sync})})]})]})]}),e.jsxs("div",{className:"wptb-v2-setting-btns",children:[e.jsx("button",{type:"button",className:"wptb-btn-revert",onClick:n,disabled:I,children:"Revert"}),e.jsxs("button",{type:"button",className:"wptb-btn-save",onClick:c,disabled:I,children:[I&&Nt," Save"]})]})]})},xr=()=>{var n;const[I,U]=Q.useState(((n=WPTB_CFG.SETTINGS)==null?void 0:n.table_style)||""),[l,k]=Q.useState(!1),h=async()=>{if(!l){k(!0);try{const s=new FormData;s.append("nonce",WPTB_CFG.SETTINGS.nonce.styles),s.append("action","wptb-general-styles"),s.append("styles",I);const a=await fetch(WPTB_CFG.ADMIN_URL,{method:"POST",body:s}),m=await a.json();if(!a.ok){ut(m.message||"Something went wrong","error");return}if(m.error){ut(m.error,"error");return}ut(m.message||"Settings saved successfully","success"),WPTB_CFG.SETTINGS.table_style=I}catch(s){console.log(s)}finally{k(!1)}}},c=()=>{U(WPTB_CFG.SETTINGS.table_style||"")};return e.jsxs("div",{children:[e.jsxs("div",{className:"wptb-v2-settings-area wptb-v2-table-settings",children:[e.jsx("p",{children:"These styles will be applied to all tables."}),e.jsx(De,{label:"Custom CSS",rows:10,value:I,onChange:U})]}),e.jsxs("div",{className:"wptb-v2-setting-btns",children:[e.jsx("button",{type:"button",className:"wptb-btn-revert",onClick:c,disabled:l,children:"Revert"}),e.jsxs("button",{type:"button",className:"wptb-btn-save",onClick:h,disabled:l,children:[l&&Nt," Save"]})]})]})},kr=()=>{var _,f;const[I,U]=Q.useState(!1),[l,k]=Q.useState(!1),[h,c]=Q.useState(((_=WPTB_CFG.SETTINGS)==null?void 0:_.lazy_load)||{enabled:!1}),[n,s]=Q.useState(WPTB_CFG.SETTINGS.lazy_load_pro),a=async()=>{if(!I){U(!0);try{const y=new FormData;y.append("nonce",WPTB_CFG.SETTINGS.nonce.lazy_load),y.append("action","wptb_lazy_load");const o={...h,...n,visibilityPercentage:parseInt(n.visibilityPercentage).toString(),iconSize:parseInt(n.iconSize).toString(),imageLoadAnimationSpeed:parseInt(n.imageLoadAnimationSpeed).toString(),imageLoadAnimationPerspective:parseInt(n.imageLoadAnimationPerspective).toString(),iconAnimationOptions:{none:"none",heartBeat:"heartbeat",rotate:"rotate",flip:"flip",jump:"jump"},imageLoadAnimationOptions:{none:"none",slideIn:"slide in",growSling:"grow sling",flash:"flash",flip:"flip"}};y.append("settings",JSON.stringify(o));const b=await fetch(WPTB_CFG.ADMIN_URL,{method:"POST",body:y}),i=await b.json();if(!b.ok){ut(i.message||"Something went wrong","error");return}if(i.error){ut(i.error,"error");return}ut(i.message||"Settings saved successfully","success"),WPTB_CFG.SETTINGS.lazy_load=h,WPTB_CFG.SETTINGS.lazy_load_pro=n}catch(y){console.log(y)}finally{U(!1)}}},m=()=>{c(WPTB_CFG.SETTINGS.lazy_load),s(WPTB_CFG.SETTINGS.lazy_load_pro)};return e.jsxs("div",{children:[e.jsxs("div",{className:"wptb-v2-settings-area wptb-v2-lazy-load-settings",children:[e.jsxs("div",{children:[e.jsx(Bt,{title:"Enable Lazy Load",initialOpen:!0,className:"wptb-v2-lazy-load-group",children:e.jsx(ce,{label:"Enable Lazy Loading Images",checked:!!h.enabled,onChange:y=>c({enabled:y})})}),e.jsxs("div",{className:"wptb-v2-lazy-load-preview",children:[e.jsx("h4",{children:"Preview"}),e.jsxs("div",{className:"wptb-v2-lazy-load-preview-image",children:[e.jsx("img",{src:WPTB_CFG.PLUGIN_URL+"/v2/assets/images/wptb-logo.png",className:`${n.imageLoadAnimation} to-${n.imageLoadAnimationDirection}`,style:{"--transition-speed":1/Number(n.imageLoadAnimationSpeed)+"s"},"data-visible":l}),(n==null?void 0:n.imageLoadAnimation)==="flash"&&e.jsx("div",{style:{background:n.flashColor}})]}),e.jsxs("div",{className:"wptb-v2-lazy-load-preview-btns",children:[e.jsx("button",{type:"button",className:"wptb-v2-lazy-load-preview-reset",disabled:!l,onClick:()=>k(!1),children:"Reset"}),e.jsx("button",{type:"button",className:"wptb-v2-lazy-load-preview-reload",disabled:l,onClick:()=>k(!0),children:"Load Image"})]}),e.jsxs("div",{className:"wptb-v2-lazy-load-notice",children:[e.jsx("h5",{children:"important:"}),e.jsx("p",{children:"After enable, if you are getting any conflicts with your third party lazy load plugin, please whitelist table image elements with wptb-image-element-target class name from plugin settings."})]})]})]}),e.jsxs("div",{className:"wptb-v2-lazy-load-pro",children:[e.jsx(Ue,{name:"global.lazy_load",props:n,setProps:s}),e.jsxs(We,{name:"global.lazy_load",children:[e.jsxs(Bt,{title:"General Options",initialOpen:!0,className:"wptb-v2-lazy-load-group",children:[e.jsx(Dt,{label:"Visibility Percentage",value:n==null?void 0:n.visibilityPercentage,allowedUnits:{"%":{}}}),e.jsx(Ut,{label:"Background Color",value:n==null?void 0:n.backgroundColor})]}),e.jsxs(Bt,{title:"Icon Options",initialOpen:!0,className:"wptb-v2-lazy-load-group",children:[e.jsx(Me,{label:"Icon",value:(f=n==null?void 0:n.iconName)==null?void 0:f.name}),e.jsx(Ut,{label:"Icon Color",value:n==null?void 0:n.iconColor}),e.jsx(Dt,{label:"Icon Size",value:n==null?void 0:n.iconSize}),e.jsx(zt,{label:"Icon Animation",value:n==null?void 0:n.iconAnimation,options:[{value:"none",label:"None"},{value:"heartbeat",label:"Heartbeat"},{value:"rotate",label:"Rotate"},{value:"flip",label:"Flip"},{value:"jump",label:"Jump"}]})]}),e.jsxs(Bt,{title:"Image Load Options",initialOpen:!0,className:"wptb-v2-lazy-load-group",children:[e.jsx(zt,{label:"Animation",value:n==null?void 0:n.imageLoadAnimation,options:[{value:"none",label:"None"},{value:"slide-in",label:"Slide In"},{value:"grow-sling",label:"Grow Sling"},{value:"flash",label:"Flash"},{value:"flip",label:"Flip"}]}),(n==null?void 0:n.imageLoadAnimation)==="slide-in"&&e.jsx(zt,{label:"Direction",value:n==null?void 0:n.imageLoadAnimationDirection,options:[{value:"left",label:"To Left"},{value:"right",label:"To Right"},{value:"top",label:"To Top"},{value:"bottom",label:"To Bottom"}]}),(n==null?void 0:n.imageLoadAnimation)==="flash"&&e.jsx(Ut,{label:"Flash Color",value:n==null?void 0:n.flashColor}),(n==null?void 0:n.imageLoadAnimation)==="flip"&&e.jsxs(e.Fragment,{children:[e.jsx(zt,{label:"Direction",value:n==null?void 0:n.imageLoadAnimationDirection,options:[{value:"left",label:"To Left"},{value:"right",label:"To Right"}]}),e.jsx(Dt,{label:"Perspective",value:n==null?void 0:n.imageLoadAnimationPerspective})]}),e.jsx(Mt,{label:"Speed",value:Number(n==null?void 0:n.imageLoadAnimationSpeed)||5,max:10})]})]})]})]}),e.jsxs("div",{className:"wptb-v2-setting-btns",children:[e.jsx("button",{type:"button",className:"wptb-btn-revert",onClick:m,disabled:I,children:"Revert"}),e.jsxs("button",{type:"button",className:"wptb-btn-save",onClick:a,disabled:I,children:[I&&Nt," Save"]})]})]})};let kt=null;const Cr=I=>{const U={},l=document.createElement("div");return l.innerHTML=I,l.querySelectorAll("h4").forEach(h=>{var n,s;const c=(n=h.textContent)==null?void 0:n.trim();c&&(U[c]=((s=h.nextElementSibling)==null?void 0:s.outerHTML)||"")}),U},Sr=()=>{const[I,U]=Q.useState(kt===null),[l,k]=Q.useState(!1),[h,c]=Q.useState(kt),[n,s]=Q.useState((kt==null?void 0:kt.version)||"");Q.useEffect(()=>{if(kt!==null){U(!1),c(kt),s(kt.version);return}fetch("https://api.wordpress.org/plugins/info/1.0/wp-table-builder.json").then(m=>m.json()).then(m=>{if(kt)return;const _={};Object.keys(m.versions).reverse().slice(1,6).forEach(y=>{_[y]=m.versions[y]}),kt={version:m.version,versions:_,changelog:Cr(m.sections.changelog),latest:Object.keys(m.versions).at(-2)},c(kt),s(kt.version)}).finally(()=>{U(!1)})},[]);const a=async()=>{if(l)return;k(!0);const m=new FormData;m.append("action","version_control_manager"),m.append("nonce",WPTB_CFG.SETTINGS.nonce.version),m.append("version",n);try{const _=await fetch(WPTB_CFG.ADMIN_URL,{method:"POST",body:m}),f=await _.json();if(!_.ok){ut(f.message||"Something went wrong","error");return}if(f.error){ut(f.error,"error");return}ut(f.message||"Settings saved successfully","success"),window.location.reload()}catch{ut("Something went wrong","error")}k(!1)};return e.jsxs("div",{className:"wptb-v2-settings-area wptb-v2-version-settings",children:[I||!h?e.jsx("div",{className:"wptb-v2-loading",children:e.jsx(Gt,{})}):e.jsxs("div",{className:"wptb-v2-version-settings-content",children:[e.jsxs("div",{className:"wptb-v2-version-settings-control",children:[e.jsx("p",{className:"wptb-v2-version-settings-encourage",children:"If you are having issues with the current version of the plugin, you can rollback to a previous version."}),e.jsxs("div",{className:"wptb-v2-version-settings-info",children:[e.jsx("div",{children:"Current Version"}),e.jsxs("div",{children:[e.jsx("div",{className:gt({"wptb-v2-version-settings-info-success":h.latest===WPTB_CFG.SETTINGS.version,"wptb-v2-version-settings-info-warning":h.latest!==WPTB_CFG.SETTINGS.version})}),e.jsx("span",{children:WPTB_CFG.SETTINGS.version})]}),e.jsx("div",{children:"Latest Version"}),e.jsxs("div",{children:[e.jsx("div",{className:gt({"wptb-v2-version-settings-info-success":h.latest===WPTB_CFG.SETTINGS.version,"wptb-v2-version-settings-info-warning":h.latest!==WPTB_CFG.SETTINGS.version})}),e.jsx("span",{children:h.latest})]}),e.jsx("div",{children:"Install"}),e.jsx("div",{children:e.jsx("select",{value:n,onChange:m=>s(m.target.value),children:Object.keys(h.versions).map(m=>e.jsx("option",{value:m,children:m},m))})})]}),e.jsxs("div",{className:"wptb-v2-version-settings-warning",children:[e.jsx("h5",{children:"warning:"}),e.jsx("p",{children:"Previous versions may be unstable and unsecure, continue with your own risk and take a backup."})]})]}),e.jsxs("div",{className:"wptb-v2-version-settings-log",children:[e.jsx("h4",{children:n}),e.jsx("div",{dangerouslySetInnerHTML:{__html:h.changelog[n]||""}})]})]}),e.jsx("div",{className:"wptb-v2-setting-btns",children:e.jsxs("button",{type:"button",className:"wptb-btn-save",disabled:l,onClick:a,children:[l&&Nt," Install ",n]})})]})},Qt={general:yr,tableStyles:xr,lazyLoad:kr,version:Sr},jr=({setPage:I})=>{const[U,l]=Q.useState("general"),[k,h]=Q.useState(!1),[c,n]=Q.useState(!1),s=async()=>{if(n(!1),!k){h(!0);try{const a=new FormData;a.append("nonce",WPTB_CFG.SETTINGS.nonce.general),a.append("action","wptb_toggle_legacy_builder");const m=await fetch(WPTB_CFG.ADMIN_URL,{method:"POST",body:a}),_=await m.json();if(!m.ok){ut(_.message||"Something went wrong","error");return}if(_.error){ut(_.error,"error");return}ut(_.message||"Settings saved successfully","success"),window.location.replace(window.location.href.replace("wptb-settings","wp-table-builder-settings"))}catch(a){console.log(a)}finally{h(!1)}}};return e.jsxs("div",{className:"wptb-v2-page wptb-v2-settings-page",children:[e.jsx(It,{setPage:I,page:"settings"}),e.jsxs("div",{className:"wptb-v2-page-content",children:[e.jsxs("div",{className:"wptb-v2-page-content-top",children:[e.jsx("h2",{children:St("WP Table Builder")}),e.jsxs("button",{type:"button",className:"wptb-v2-switch-builder",disabled:k,onClick:()=>n(!0),children:[k&&Nt," Switch to Legacy Builder"]})]}),e.jsxs("div",{className:"wptb-v2-page-content-main",children:[e.jsxs("div",{className:"wptb-v2-settings-tabs",children:[e.jsx("button",{className:U==="general"?"wptb-v2-active":"",onClick:()=>l("general"),children:"General"}),e.jsx("button",{className:U==="tableStyles"?"wptb-v2-active":"",onClick:()=>l("tableStyles"),children:"Table Styles"}),e.jsx("button",{className:U==="lazyLoad"?"wptb-v2-active":"",onClick:()=>l("lazyLoad"),children:"Lazy Load"}),e.jsx("button",{className:U==="version"?"wptb-v2-active":"",onClick:()=>l("version"),children:"Version Control"})]}),e.jsx("div",{children:Qt[U]&&Q.createElement(Qt[U])})]})]}),c&&e.jsxs(se,{onClose:()=>n(!1),title:"Are you sure to switch?",icon:ee,children:[e.jsx("p",{children:"Are you sure you want to miss out on the new features and next generation experience? You can always switch back to the legacy builder."}),e.jsxs("div",{className:"wptb-v2-modal-actions",children:[e.jsx("button",{type:"button",onClick:s,children:"Yes"}),e.jsx("button",{type:"button",onClick:()=>n(!1),children:"No"})]})]})]})},Er={tables:tr,builder:wr,create:sr,import:fr,export:vr,settings:jr},te=()=>{var l,k;const I=new URLSearchParams(window.location.search),U={};for(const[h,c]of I)U[h]=c;return U.page=((k=(l=U.page)==null?void 0:l.replace("wptb",""))==null?void 0:k.substring(1))||"tables",U};function Tr(){const[I,U]=Q.useState({}),l=(k,h)=>{h=h||{};const n={page:k==="tables"?"wptb":`wptb-${k}`};for(const a in h){const m=h[a];m&&(n[a]=m)}const s=new URLSearchParams(n).toString();window.history.pushState(null,"","?"+s),h.page=k,U(h)};return Q.useEffect(()=>{const k=()=>{const h=te();U(h)};return U(te()),window.addEventListener("popstate",k),()=>{window.removeEventListener("popstate",k)}},[]),[I,l]}const Ar=()=>{const[I,U]=Tr(),l=Er[I.page];if(l)return e.jsx(l,{...I,setPage:U})};document.addEventListener("DOMContentLoaded",()=>{const I=document.querySelector("#wptb-app-root");!I||typeof WPTB>"u"||Ge(I).render(e.jsx(Ze.StrictMode,{children:e.jsxs(He,{store:Lt,children:[e.jsx(Ar,{}),e.jsx(Ve,{}),e.jsx(qe,{})]})}))});
