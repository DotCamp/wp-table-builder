document.addEventListener("DOMContentLoaded",function(){var e,t,n=(e=window.location.href,!!(t=new RegExp("[?&]table(=([^&#]*)|&|#|$)").exec(e))&&(t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):""));if(n){var l=new XMLHttpRequest,a=ajaxurl+"?action=get_table&id="+n;l.open("GET",a,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.onreadystatechange=function(e){if(4==this.readyState&&200==this.status){var t=JSON.parse(l.responseText);return document.getElementById("wptb-setup-name").value=t[0],document.getElementsByClassName("wptb-table-generator")[0].style.display="none",document.getElementsByClassName("wptb-table-setup")[0].appendChild(WPTB_Parser(t[1])),WPTB_LeftPanel(),void WPTB_Settings()}},l.send(null)}document.counter=new ElementCounters,document.select=new MultipleSelect,WPTB_Initializer(),settings=WPTB_Settings()});var WPTB_Button=function(e){var t=document.createElement("div"),n=document.createElement("div"),l=document.createElement("a");return this.kind="button",t.classList.add("wptb-button-container","wptb-size-M"),n.classList.add("wptb-button-wrapper"),l.classList.add("wptb-button"),l.classList.add("editable"),l.innerHTML=null!=e?e:"Button Text",n.appendChild(l),t.appendChild(n),this.getDOMElement=function(){return t},applyGenericItemSettings(this),this},WPTB_Cell=function(e,t){(t=document.createElement("td")).style.padding=jQuery("#wptb-table-padding-number").val()+"px";var n=jQuery("#wptb-table-inner-border-number").val();return""!=n&&0!=parseInt(n)?t.style.border=n+"px solid "+jQuery("#wptb-table-border-color").val():t.style.border="1px dashed #969fa6",t.draggable=!1,t.classList.add("wptb-droppable","wptb-cell"),t.onclick=e,t.ondragenter=function(e){(e.dataTransfer.getData("wptbElement")||e.dataTransfer.getData("node"))&&this.classList.add("wptb-drop-here-empty")},t.ondragover=function(e){e.preventDefault()},t.ondragleave=function(){this.classList.remove("wptb-drop-here-empty")},t.ondrop=function(e){var t,n,l,a,r,o;if(e.preventDefault(),l=new WPTB_Space,e.dataTransfer.getData("wptbElement")||e.dataTransfer.getData("node"))return e.dataTransfer.getData("wptbElement")?(t="list"==(o=e.dataTransfer.getData("wptbElement"))?new WPTB_List:"image"==o?new WPTB_Image:"text"==o?new WPTB_Text:"button"==o?new WPTB_Button:void 0,""==this.innerHTML&&this.appendChild(new WPTB_Space),this.appendChild(t.getDOMElement())):(n=e.dataTransfer.getData("node"),t=document.getElementsByClassName(n)[0],""==this.innerHTML&&(a=t.nextSibling,r=t.parentNode,null!=a&&r.removeChild(a),this.appendChild(new WPTB_Space)),this.appendChild(t)),this.appendChild(l),this.classList.remove("wptb-drop-here-empty"),!0},this.getDOMElement=function(){return t},this.setCoords=function(e,t){var n=this.getDOMElement();n.dataset.yIndex=e,n.dataset.xIndex=t},this.getCoords=function(){var e,t=this.getDOMElement();return e.x=t.dataset.xIndex,e.y=t.dataset.yIndex,e},this.appendElement=function(e){getDOMElement().appendChild(e)},this},ElementCounters=function(){var t=[];return t.text=0,t.image=0,t.list=0,t.button=0,this.increment=function(e){e in t&&t[e]++},this.nextIndex=function(e){if(e in t)return t[e]+1},this},WPTB_ElementOptions=function(o,e){var t,s=o.getDOMElement();prop=document.querySelector(".wptb-"+o.kind+"-options-prototype").cloneNode(!0),prop.classList.remove("wptb-"+o.kind+"-options-prototype"),t="wptb-options-"+o.kind+"-"+e;for(var n=prop.getElementsByClassName("wptb-element-property"),l=0;l<n.length;l++)n[l].dataset.element=t;if(prop.classList.add(t),document.getElementById("element-options-group").appendChild(prop),s.onclick=function(){var e=this.className.match(/wptb-element-((.+-)\d+)/i),t=".wptb-"+e[2]+"options.wptb-options-"+e[1];document.getElementById("add-elements").getElementsByTagName("a")[0].classList.remove("active"),document.getElementById("element-options").getElementsByTagName("a")[0].classList.add("active"),document.getElementsByClassName("wptb-elements-container")[0].style.display="none",document.getElementsByClassName("wptb-settings-section")[0].style.display="none",document.getElementById("element-options-group").style.display="block";for(var n,l,a=document.getElementById("element-options-group").childNodes,r=0;r<a.length;r++)a[r].style&&(a[r].style.display="none");switch(document.querySelector(t).style.display="block",o.kind){case"text":jQuery(prop).find("[data-type=color]").wpColorPicker({defaultColor:s.style.color}),prop.querySelector("[type=number][data-type=font-size]").value=prop.querySelector("[type=ran][data-type=font-size]").value=s.style.fontSize.substring(0,s.style.fontSize.length-2);break;case"list":l=s.querySelector("article").style.justifyContent,n=s.querySelector("article .wptb-list-item-style-dot li").style.listStyleType,prop.querySelector("[type=ran][data-type=list-class]").selectedIndex="decimal"==n?0:1,prop.querySelector("[type=ran][data-type=list-style-type]").selectedIndex="circle"==n?0:"square"==n?1:2,prop.querySelector("[type=ran][data-type=list-alignment]").selectedIndex="flex-start"==l?0:"center"==l?1:2;break;case"image":break;case"button":jQuery(prop).find("[data-type=button-color]").wpColorPicker({defaultColor:s.style.backgroundColor})}},"button"==o.kind){var a=prop.getElementsByClassName("wptb-btn-size-btn");for(l=0;l<a.length;l++)a[l].onclick=function(){var e=this.innerHTML,t=this.dataset.element.match(/wptb-options-(.+)-(\d+)/i),n=t[1],l=t[2],a=document.getElementsByClassName("wptb-element-"+n+"-"+l)[0];a.classList.remove("wptb-size-S"),a.classList.remove("wptb-size-M"),a.classList.remove("wptb-size-L"),a.classList.remove("wptb-size-XL"),a.classList.add("wptb-size-"+e);for(var r=prop.getElementsByClassName("wptb-btn-size-btn"),o=0;o<r.length;o++)r[o].classList.remove("selected");this.classList.add("selected")}}var r=prop.getElementsByClassName("wptb-element-property");for(l=0;l<r.length;l++){if(r[l].classList.contains("wptb-color-picker")&&jQuery(r[l]).wpColorPicker({change:function(e,t){var n,l,a,r=e.target;l=(n=r.dataset.element.match(/wptb-options-(.+)-(\d+)/i))[1],a=n[2],affectedEl=document.getElementsByClassName("wptb-element-"+l+"-"+a)[0],"button"==l?"button-text-color"==r.dataset.type?affectedEl.getElementsByClassName("wptb-button")[0].style.color=t.color.toString():affectedEl.getElementsByClassName("wptb-button")[0].style.backgroundColor=t.color.toString():affectedEl.style.color=t.color.toString()}}),"font-size"===r[l].dataset.type)r[l].parentNode.parentNode.getElementsByClassName("wptb-text-font-size-slider")[0].oninput=function(){this.parentNode.parentNode.getElementsByClassName("wptb-text-font-size-number")[0].value=this.value,this.parentNode.parentNode.getElementsByClassName("wptb-text-font-size-number")[0].onchange()};if("image-size"===r[l].dataset.type)r[l].parentNode.parentNode.getElementsByClassName("wptb-image-size-slider")[0].oninput=function(){this.parentNode.parentNode.getElementsByClassName("wptb-image-width-number")[0].value=this.value,this.parentNode.parentNode.getElementsByClassName("wptb-image-width-number")[0].onchange()};r[l].onchange=function(e){var t=this.dataset.element.match(/wptb-options-(.+)-(\d+)/i),n=t[1],l=t[2],a=document.getElementsByClassName("wptb-element-"+n+"-"+l)[0],r=this.value;switch(this.dataset.type){case"src":a.getElementsByTagName("img")[0].src=this.value;break;case"alternative-text":a.getElementsByTagName("img")[0].alt=this.value;break;case"image-link":a.getElementsByTagName("a")[0].href=this.value;break;case"button-link-target":1==this.checked?a.getElementsByTagName("a")[0].target="_blank":a.getElementsByTagName("a")[0].target="_self";break;case"image-size":a.getElementsByTagName("img")[0].style.width=this.value+"%",a.getElementsByTagName("img")[0].style.height="auto",this.parentNode.parentNode.getElementsByClassName("wptb-image-size-slider")[0].value=this.value;break;case"image-alignment":"center"!=this.value?(a.getElementsByTagName("img")[0].style.display="inline",a.getElementsByTagName("img")[0].style.float=this.value,a.getElementsByTagName("img")[0].style.margin="inherit"):(a.getElementsByTagName("img")[0].style.float="none",a.getElementsByTagName("img")[0].style.display="block",a.getElementsByTagName("img")[0].style.margin="0 auto");break;case"font-size":a.style.fontSize=r+"px";break;case"button-alignment":var o="";o="left"==this.value?"start":"right"==this.value?"flex-end":"center",a.getElementsByClassName("wptb-button-wrapper")[0].style.justifyContent=o;break;case"button-link":a.getElementsByTagName("a")[0].href=this.value;break;case"button-link-target":1==this.checked?a.getElementsByTagName("a")[0].target="_blank":a.getElementsByTagName("a")[0].target="_self";break;case"button-color":break;case"list-alignment":o="";o="left"==this.value?"flex-start":"right"==this.value?"flex-end":"center";for(var s=a.querySelectorAll("article"),i=0;i<s.length;i++)s[i].style.justifyContent=o;break;case"list-class":if("unordered"==r){e.target.parentNode.parentNode.querySelector("[data-type=list-style-type]").parentNode.style.display="flex",document.querySelector("#wptb-list-icon-select-label").style.display="flex";var d=a.querySelectorAll("article .wptb-list-item-style-dot li");for(i=0;i<d.length;i++)d[i].style.listStyleType="disc";document.querySelector("[data-type=list-style-type]").value="disc"}else{e.target.parentNode.parentNode.querySelector("[data-type=list-style-type]").parentNode.style.display="none",document.querySelector("#wptb-list-icon-select-label").style.display="none";for(d=a.querySelectorAll("article .wptb-list-item-style-dot li"),i=0;i<d.length;i++)d[i].style.listStyleType="decimal"}break;case"list-style-type":for(d=a.querySelectorAll("article .wptb-list-item-style-dot li"),i=0;i<d.length;i++)d[i].style.listStyleType=r.toLowerCase()}}}},WPTB_Image=function(e){var t=document.createElement("div"),n=document.createElement("a"),l=document.createElement("img");return this.kind="image",n.appendChild(l),t.appendChild(n),this.getDOMElement=function(){return t},applyGenericItemSettings(this),file_frame=wp.media.frames.file_frame=wp.media({title:"Select a image to upload",button:{text:"Use this image"},multiple:!1}),file_frame.on("select",function(){attachment=file_frame.state().get("selection").first().toJSON(),l.src=attachment.url}),null==e?file_frame.open():l.src=e,this},WPTB_Initializer=function(){var e=document.body;columnsDecrementButton=e.getElementsByClassName("wptb-input-number-decrement")[0],columnsIncrementButton=e.getElementsByClassName("wptb-input-number-increment")[0],rowsDecrementButton=e.getElementsByClassName("wptb-input-number-decrement")[1],rowsIncrementButton=e.getElementsByClassName("wptb-input-number-increment")[1],columnsInput=document.getElementById("wptb-columns-number"),rowsInput=document.getElementById("wptb-rows-number"),columnsDecrementButton.onclick=function(){1<columnsInput.value&&columnsInput.value--},columnsIncrementButton.onclick=function(){columnsInput.value<10&&columnsInput.value++},rowsDecrementButton.onclick=function(){1<rowsInput.value&&rowsInput.value--},rowsIncrementButton.onclick=function(){rowsInput.value<10&&rowsInput.value++},document.getElementById("wptb-generate-table").onclick=function(){var e=document.getElementById("wptb-columns-number").value,t=document.getElementById("wptb-rows-number").value;WPTB_Table(e,t)}},WPTB_LeftPanel=function(){var r=document.getElementsByClassName("wptb-preview-table")[0],e=document.getElementsByClassName("wptb-element");function t(e){for(var t,n,l=r.getElementsByTagName("td"),a=0;a<l.length;a++)l[a].style.border=document.querySelector("#wptb-table-inner-border-number").value+"px solid "+(t=jQuery("#wptb-table-border-color").val(),void 0,(n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t))?"rgb("+parseInt(n[1],16)+","+parseInt(n[2],16)+","+parseInt(n[3],16)+")":null)}function n(e){for(var t=r.getElementsByTagName("td"),n=0;n<t.length;n++)t[n].style.padding=e+"px"}function l(e){r.style.border=e+"px solid"}jQuery("#wptb-even-row-bg").wpColorPicker({change:function(e,t){for(var n=r.getElementsByTagName("tr"),l=1;l<n.length;l+=2){tds=n[l].getElementsByTagName("td");for(var a=0;a<tds.length;a++)tds[a].style.backgroundColor=t.color.toString()}}}),jQuery("#wptb-odd-row-bg").wpColorPicker({change:function(e,t){for(var n=r.getElementsByTagName("tr"),l=2;l<n.length;l+=2){tds=n[l].getElementsByTagName("td");for(var a=0;a<tds.length;a++)tds[a].style.backgroundColor=t.color.toString()}}}),jQuery("#wptb-table-header-bg").wpColorPicker({change:function(e,t){for(var n=r.getElementsByTagName("tr")[0].getElementsByTagName("td"),l=0;l<n.length;l++)n[l].style.backgroundColor=t.color.toString()}}),jQuery("#wptb-table-border-color").wpColorPicker({change:function(e,t){var n=r.getElementsByTagName("td");r.style.border=document.querySelector("#wptb-table-border-number").value+"px solid "+t.color.toString();for(var l=0;l<n.length;l++)n[l].style.border=document.querySelector("#wptb-table-inner-border-number").value+"px solid "+t.color.toString()}}),document.getElementById("wptb-table-cell-slider").oninput=function(){document.getElementById("wptb-table-cell-number").value=this.value,n(this.value)},document.getElementById("wptb-table-cell-number").onchange=function(){document.getElementById("wptb-table-cell-slider").value=this.value,n(this.value)},document.getElementById("wptb-table-border-slider").oninput=function(){document.getElementById("wptb-table-border-number").value=this.value,l(this.value)},document.getElementById("wptb-table-border-number").onchange=function(){document.getElementById("wptb-table-border-slider").value=this.value,l(this.value)},document.getElementById("wptb-table-inner-border-slider").oninput=function(){document.getElementById("wptb-table-inner-border-number").value=this.value,t(this.value)},document.getElementById("wptb-table-inner-border-number").onchange=function(){document.getElementById("wptb-table-inner-border-slider").value=this.value,t(this.value)},document.getElementById("wptb-inner-border-check").onchange=function(){!function(e){var t=null!=document.querySelector("#wptb-table-border-color").value?document.querySelector("#wptb-table-border-color").value:"rgb(0,0,0)";if("checked"==e){document.getElementById("wptb-apply-inner-border").style.marginBottom="0px";for(var n=document.getElementsByClassName("wptb-preview-table")[0].getElementsByTagName("td"),l=0;l<n.length;l++)n[l].style.border="1px solid "+t;document.getElementById("wptb-inner-border-settings").classList.add("visible")}else for(document.getElementById("wptb-inner-border-settings").classList.remove("visible"),n=document.getElementsByClassName("wptb-preview-table")[0].getElementsByTagName("td"),l=0;l<n.length;l++)n[l].style.border="0px solid "+t}(this.checked?"checked":"unchecked")};for(var a=0;a<e.length;a++)e[a].ondragstart=function(e){e.dataTransfer.setData("wptbElement",this.dataset.wptbElement)};document.getElementById("wptb-activate-cell-management-mode").onclick=r.toggleTableEditMode,document.getElementById("wptb-add-end-row").onclick=r.addRowToTheEnd,document.getElementById("wptb-add-start-row").onclick=r.addRowToTheStart,document.getElementById("wptb-add-row-before").onclick=r.addRowBefore,document.getElementById("wptb-add-row-after").onclick=r.addRowAfter,document.getElementById("wptb-add-end-column").onclick=r.addColumnEnd,document.getElementById("wptb-add-start-column").onclick=r.addColumnStart,document.getElementById("wptb-add-column-before").onclick=r.addColumnBefore,document.getElementById("wptb-add-column-after").onclick=r.addColumnAfter,document.getElementById("wptb-delete-column").onclick=r.deleteColumn,document.getElementById("wptb-delete-row").onclick=r.deleteRow,document.getElementById("wptb-merge-cells").onclick=r.mergeCells,document.getElementById("wptb-split-cell").onclick=r.splitCell,document.getElementById("add-elements").onclick=function(){document.getElementById("element-options").getElementsByTagName("a")[0].classList.remove("active"),document.getElementById("add-elements").getElementsByTagName("a")[0].classList.add("active"),document.getElementsByClassName("wptb-elements-container")[0].style.display="table",document.getElementsByClassName("wptb-settings-section")[0].style.display="block",document.getElementById("element-options-group").style.display="none"}},WPTB_List=function(e){var t,n=document.createElement("ul"),l=document.createElement("div");if(this.kind="list",""===e);else if(e)for(a=0;a<e.length;a++)t=new WPTB_ListItem(e[a]),n.appendChild(t.getDOMElement());else for(var a=0;a<3;a++)t=new WPTB_ListItem("List Item "+(a+1)),n.appendChild(t.getDOMElement());return l.appendChild(n),this.getDOMElement=function(){return l},applyGenericItemSettings(this),this},WPTB_ListItem=function a(e){null==e&&(e="New List Item");var n=document.createElement("article"),t=document.createElement("div"),l=document.createElement("div"),r=document.createElement("li");return t.classList.add("wptb-list-item-style-dot"),l.classList.add("wptb-list-item-content"),r.classList.add("wptb-bullet"),n.appendChild(t),n.appendChild(l),t.appendChild(r),l.innerHTML=e,l.onkeyup=window.listItemKeyListener,n.onmouseenter=function(e){var t=document.createElement("span"),n=document.createElement("span"),l=document.createElement("span");l.classList.add("wptb-actions"),t.classList.add("dashicons","dashicons-trash","delete-action"),n.classList.add("dashicons","dashicons-admin-page","duplicate-action"),this.classList.add("wptb-directlyhovered"),t.onclick=function(){var e=this.parentNode.parentNode;e.parentNode.removeChild(e)},n.onclick=function(e){var t=e.target.parentNode.parentNode,n=t.querySelector(".wptb-list-item-content").innerHTML,l=new a(n);t.parentNode.appendChild(l.getDOMElement())},l.append(n,t),this.appendChild(l)},n.onmouseleave=function(e){this.classList.remove("wptb-directlyhovered");var t=this.parentNode.querySelector(".wptb-actions");null!=t&&t.parentNode.removeChild(t)},l.onkeydown=function(e){var t;if(13===(null!=e.which?e.which:e.keyCode)&&(void 0===window.dontAddItems||!0!==window.dontAddItems))return e.preventDefault(),t=new a(this.innerHTML),n.parentNode.insertBefore(t.getDOMElement(),n),l.innerHTML="New List Item",t.getDOMElement().querySelector(".wptb-list-item-content").focus(),!1},this.getDOMElement=function(){return n},this},MultipleSelect=function(){var a=[],n=!1;return this.activateMultipleSelectMode=function(){a=[];for(var e=document.getElementsByClassName("wptb-preview-table")[0].getElementsByTagName("td"),t=0;t<e.length;t++)e[t].classList.remove("wptb-highlighted");n=!0},this.deactivateMultipleSelectMode=function(){n=!1},this.isActivated=function(){return n},this.pushSelectedCell=function(e){n&&(a.push(e),e.classList.add("wptb-highlighted"))},this.selectedCells=function(){return a},this.flushSelectedCells=function(){a=[]},this.getFirst=function(){for(var e,t=1e3,n=1e3,l=a.length-1;0<=l;l--)t>=a[l].dataset.xIndex&&n>=a[l].dataset.yIndex&&(e=a[l],t=a[l].dataset.xIndex,n=a[l].dataset.yIndex);return e},this.getLast=function(){for(var e,t=-1,n=-1,l=a.length-1;0<=l;l--)t<=a[l].dataset.xIndex&&n<=a[l].dataset.yIndex&&(e=a[l],t=a[l].dataset.xIndex,n=a[l].dataset.yIndex);return e},this.removeAllButFirst=function(){for(var e=this.getFirst(),t=1;t<a.length;t++)a[t].classList.add("wptb-fused-cell-"+e.dataset.xIndex+"-"+e.dataset.yIndex)},this},WPTB_Parser=function(e){var t=0;function n(){return t>=e.length?-1:e[t++]}function i(){var e=n(),t=e;if("["===e){do{if(-1===(e=n()))return-1;t+=e}while("]"!=e);return ctoken=t,!0}}function d(){return ctoken}function c(e){if(m(ctoken)!==e)throw"There was an error with the file and therefore the table could not be rendered";i()}function m(e){var t=e.indexOf(" "),n=e.substring(1,t);return-1==t?e:"["+n+"]"}function p(){for(var e,t,n,l=ctoken.split(" "),a=[],r=1;r<l.length;r++)t=(e=l[r].trim().split("="))[0],n=e[1].substring(1,e[1].length-1).split('"').join(""),a[t]=n;return a}function s(){var e="";t--;do{if(char=n(),-1===char)return-1;e+=char}while("["!=char);return e=e.substring(0,e.length-1),t--,e}function l(){var e,t,n,l,a;switch(m(d())){case"[text]":attr=p(),l=attr,c("[text]"),html=s(),(a=new WPTB_Text(html)).getDOMElement().style.fontSize=l.size,a.getDOMElement().style.color=l.color,i(),c("[/text]"),e=a;break;case"[list]":attr=p(),e=function(e){var t,n,l=new WPTB_List("");for(c("[list]"),t="numbered"==e.class?"decimal":e["style-type"];l.getDOMElement().getElementsByTagName("ul")[0].appendChild((n=void 0,c("[item]"),html=s(),n=new WPTB_ListItem(html),i(),c("[/item]"),n).getDOMElement()),"[item]"==m(ctoken););c("[/list]");for(var a=l.getDOMElement().querySelectorAll("article"),r=0;r<a.length;r++)a[r].style.justifyContent=e.align;var o=l.getDOMElement().querySelectorAll("article .wptb-list-item-style-dot li");for(r=0;r<o.length;r++)o[r].style.listStyleType=t;return l}(attr);break;case"[button]":attr=p(),t=attr,c("[button]"),html=s(),(n=new WPTB_Button(html)).getDOMElement().classList.add("wptb-size-"+t.size),n.getDOMElement().getElementsByClassName("wptb-button-wrapper")[0].style.justifyContent=t.alignment,n.getDOMElement().getElementsByClassName("wptb-button")[0].style.backgroundColor=t.color,n.getDOMElement().getElementsByClassName("wptb-button")[0].style.color=t.textcolor,n.getDOMElement().querySelector(".wptb-button-wrapper a").href=t.link,n.getDOMElement().querySelector(".wptb-button-wrapper a").target=t.newtab,i(),c("[/button]"),e=n;break;case"[img]":attr=p(),e=function(e){var t;return t=new WPTB_Image(attr.src),c("[img]"),t.getDOMElement().getElementsByTagName("img")[0].style.width=attr.width,t.getDOMElement().getElementsByTagName("img")[0].alt=attr.alt,t.getDOMElement().getElementsByTagName("a")[0].href=attr.link,t.getDOMElement().getElementsByTagName("a")[0].target=attr.newtab,"center"!=attr.alignment?(t.getDOMElement().getElementsByTagName("img")[0].style.display="inline",t.getDOMElement().getElementsByTagName("img")[0].style.float=this.value,t.getDOMElement().getElementsByTagName("img")[0].style.margin="inherit"):(t.getDOMElement().getElementsByTagName("img")[0].style.float="none",t.getDOMElement().getElementsByTagName("img")[0].style.display="block",t.getDOMElement().getElementsByTagName("img")[0].style.margin="0 auto"),t.getDOMElement().getElementsByTagName("img")[0],t}()}return e.getDOMElement()}function a(){var e=new WPTB_Cell,t=p();return c("[td]"),null!=t.colspan&&(e.getDOMElement().colSpan=parseInt(t.colspan)),null!=t.rowspan&&(e.getDOMElement().rowSpan=parseInt(t.rowspan)),function(e){var t;if("[img]"==m(ctoken)||"[text]"==m(ctoken)||"[list]"==m(ctoken)||"[button]"==m(ctoken))for(t=new WPTB_Space,e.appendChild(t);"[img]"==m(ctoken)||"[text]"==m(ctoken)||"[list]"==m(ctoken)||"[button]"==m(ctoken);)e.appendChild(l()),t=new WPTB_Space,e.appendChild(t)}(e.getDOMElement()),c("[/td]"),e.getDOMElement()}function u(e){for(;e.appendChild(a()),"[td]"==d(););}return function(){i();var e=document.createElement("table");e.classList.add("wptb-preview-table");var t,n=p();c("[table]"),(t=e.insertRow()).classList.add("wptb-row","wptb-table-head"),c("[tr]"),u(t),c("[/tr]"),function(e){for(;"[tr]"===m(d());){var t=e.insertRow();t.classList.add("wptb-row"),c("[tr]"),u(t),c("[/tr]")}}(e),c("[/table]");for(var l=e.getElementsByTagName("tr")[0].getElementsByTagName("td"),a=0;a<l.length;a++)l[a].style.backgroundColor=n["data-bg1"];for(var r=e.getElementsByTagName("tr"),o=1;o<r.length;o+=2)for(l=r[o].getElementsByTagName("td"),a=0;a<l.length;a++)l[a].style.backgroundColor=n["data-bg2"];for(o=2;o<r.length;o+=2)for(l=r[o].getElementsByTagName("td"),a=0;a<l.length;a++)l[a].style.backgroundColor=n["data-bg3"];var s=e.getElementsByTagName("td");for(o=0;o<s.length;o++)s[o].style.padding=n.padding,s[o].style.border=n["inner-border"]+" solid "+n["border-color"],e.style.border=n["outer-border"]+" solid "+n["border-color"];return jQuery("#wptb-table-header-bg").val(n["data-bg1"]),jQuery("#wptb-even-row-bg").val(n["data-bg2"]),jQuery("#wptb-odd-row-bg").val(n["data-bg3"]),jQuery("#wptb-table-border-color").val(n["border-color"]),jQuery("#wptb-table-inner-border-number,#wptb-table-inner-border-slider").val(n["inner-border"]),jQuery("#wptb-table-border-number,#wptb-table-border-slider").val(n["outer-border"]),e}()},WPTB_Settings=function(){var e=document.getElementsByClassName("wptb-element");for(var t=0;t<e.length;t++)e[t].ondragstart=function(e){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("wptbElement",e.target.dataset.wptbElement)};document.getElementsByClassName("wptb-save-btn")[0].onclick=function(){var n,l=new XMLHttpRequest,e=ajaxurl+"?action=save_table",a=document.getElementById("wptb-setup-name").value.trim(),t=WPTB_Stringifier(document.getElementsByClassName("wptb-preview-table")[0]);if(""===a)return(n=document.getElementById("wptb-messaging-area")).innerHTML='<div class="wptb-error wptb-message">Error: You must assign a name to the table before saving it.</div>',n.classList.add("wptb-warning"),void setTimeout(function(){n.removeChild(n.firstChild)},4e3);var r,o,s="title="+a+"&content="+t;((rs=(r=window.location.href,!!(o=new RegExp("[?&]table(=([^&#]*)|&|#|$)").exec(r))&&(o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"")))||(rs=document.wptbId))&&(s+="&id="+rs),l.open("POST",e,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.onreadystatechange=function(e){if(4==this.readyState&&200==this.status){var t=JSON.parse(l.responseText);n=document.getElementById("wptb-messaging-area"),"saved"==t[0]?(document.wptbId=t[1],n.innerHTML='<div class="wptb-success wptb-message">Table "'+a+'" was successfully saved.</div>'):n.innerHTML='<div class="wptb-success wptb-message">Table "'+a+'" was successfully updated.</div>',n.classList.add("wptb-success"),setTimeout(function(){n.removeChild(n.firstChild)},4e3)}},l.send(s)}},WPTB_Space=function s(e){return spaceBetween=document.createElement("div"),spaceBetween.classList.add("wptb-space-between"),spaceBetween.ondragenter=function(){this.classList.add("visible")},spaceBetween.ondragover=function(e){e.preventDefault()},spaceBetween.ondragleave=function(){this.classList.remove("visible")},spaceBetween.ondrop=function(e){e.stopPropagation();for(var t,n,l,a,r=e.target.nextSibling,o=e.target;!o.classList.contains("wptb-droppable");)o=o.parentNode;e.dataTransfer.getData("wptbElement")?(t=(a=e.dataTransfer.getData("wptbElement")).includes("list")?new WPTB_List:a.includes("image")?new WPTB_Image:a.includes("text")?new WPTB_Text:a.includes("button")?new WPTB_Button:void 0,this.classList.remove("visible"),null==r?(o.appendChild(t.getDOMElement()),o.appendChild(new s)):(o.insertBefore(t.getDOMElement(),r),o.insertBefore(new s,r))):(alert(e.dataTransfer.getData("node")),n=(t=document.getElementsByClassName(e.dataTransfer.getData("node"))[0]).nextSibling,l=t.parentNode,null!=n&&l.removeChild(n),null==r?(o.appendChild(t),o.appendChild(new s)):(o.insertBefore(t,r),o.insertBefore(new s,r))),this.classList.remove("visible")},spaceBetween},WPTB_Stringifier=function e(t){if(null==t||null==t.tagName)return"";var n,l,a,r,o,s,i,d,c,m,p,u,g,b,y,f,w,h,v,E,B,N,T="",C=t.childNodes;switch(t.tagName.toLowerCase()){case"table":o=t.style.borderWidth,n=t.getElementsByTagName("td")[0].style.padding,innerBorder=t.getElementsByTagName("td")[0].style.borderWidth,l=t.rows[0].getElementsByTagName("td")[0].style.backgroundColor.replace(/\s/g,""),i=t.style.borderColor.replace(/\s/g,""),1<t.rows.length&&(a=t.rows[1].getElementsByTagName("td")[0].style.backgroundColor.replace(/\s/g,"")),2<t.rows.length&&(r=t.rows[2].getElementsByTagName("td")[0].style.backgroundColor.replace(/\s/g,"")),T+='[table border-color="'+(null!=i&&""!=i?i:"transparent")+'" padding="'+(null!=n&&""!=n?n:"0px")+'" inner-border="'+(null!=innerBorder&&""!=innerBorder&&"solid"==t.getElementsByTagName("td")[0].style.borderStyle?innerBorder:"0px")+'" outer-border="'+(null!=o&&""!=o?o:"0px")+'" data-bg1="'+(null!=l&&""!=l?l:"transparent")+'" data-bg2="'+(null!=a&&""!=a?a:"transparent")+'" data-bg3="'+(null!=r&&""!=r?r:"transparent")+'"]';for(var k=0;k<C.length;k++)T+=e(C[k]);T+="[/table]";break;case"tbody":for(k=0;k<C.length;k++)T+=e(C[k]);break;case"tr":T+="[tr]";for(k=0;k<C.length;k++)T+=e(C[k]);T+="[/tr]";break;case"td":colspan=t.colSpan,rowspan=t.rowSpan,s=t.classList.contains(/^wptb-fused-cell-(\d+)$/),T+="[td"+(null!=colspan&&1<colspan?' colspan="'+colspan+'"':"")+(null!=rowspan&&1<rowspan?' rowspan="'+rowspan+'"':"")+(s?' hidden="true"':"")+"]";for(k=0;k<C.length;k++)T+=e(C[k]);T+="[/td]";break;case"div":if(!t.classList.contains("wptb-ph-element"))return"";var S,x=t.className.match(/wptb-element-(.+)-(\d+)/i);if(null==x)return;switch(x[1]){case"list":if(!(S=t.getElementsByTagName("ul")[0]))return"";d="decimal"==(c=S.getElementsByTagName("li")[0].style.listStyleType)?"numbered":"unordered",T+="[list"+(null!=(m=S.getElementsByTagName("article")[0].style.justifyContent)?' align="'+m+'"':'align="left"')+(null!=d?' class="'+d+'"':'class="unordered"')+(null!=c?' style-type="'+c+'"':"")+"]",listitems=S.getElementsByTagName("article");for(k=0;k<listitems.length;k++)T+="[item]",T+=listitems[k].getElementsByClassName("wptb-list-item-content")[0].innerHTML,T+="[/item]";T+="[/list]";break;case"image":if(!(S=t.getElementsByTagName("img")[0]))return"";h=S.src,v=S.style.width,alt=S.alt,B=void 0,t.getElementsByTagName("a")[0]&&""!=t.getElementsByTagName("a")[0].href&&(B=t.getElementsByTagName("a")[0].href),E="inline"!=S.style.display?"center":S.style.float,N=t.getElementsByTagName("a")[0].target,T+="[img"+(null!=h?' src="'+h+'"':'src=""')+(null!=v?' width="'+v+'"':'width="100%;"')+(null!=alt?' alt="'+alt+'"':'alt=""')+(null!=E?' alignment="'+E+'"':'alignment="left"')+(null!=B?' link="'+B+'"':'href="#"')+(null!=N?' newtab="'+N+'"':'newtab="false"')+"]";break;case"text":if(!(S=t.getElementsByClassName("editable")[0]))return"";T+="[text"+(null!=(f=S.parentNode.style.fontSize)?' size="'+f+'"':"")+(null!=(w=S.parentNode.style.color.replace(/\s/g,""))?' color="'+w+'"':"")+"]",T+=S.innerHTML,T+="[/text]";break;case"button":if(!(S=t.getElementsByClassName("editable")[0]))return"";u=S.style.backgroundColor.replace(/\s/g,""),p=t.className.match(/wptb-size-(\w)/i)[1],(g=t.getElementsByTagName("a")[0].style.color)||(g="rgb(255,255,255)"),b=void 0,t.getElementsByTagName("a")[0]&&""!=t.getElementsByTagName("a")[0].href&&(b=t.getElementsByTagName("a")[0].href),y=t.getElementsByClassName("wptb-button-wrapper")[0].style.justifyContent,buttonOpenInNewTab=t.getElementsByTagName("a")[0].target,""==buttonOpenInNewTab&&(buttonOpenInNewTab="_self"),T+="[button"+(null!=g?' textcolor="'+g+'"':'textcolor="rgb(255,255,255)"')+(null!=u?' color="'+u+'"':"rgb(50,157,63)")+(null!=p?' size="'+p+'"':' size="M"')+(null!=y?' alignment="'+y+'"':' alignment="center"')+(null!=b?' link="'+b+'"':' link="#"')+(null!=buttonOpenInNewTab?' newtab="'+buttonOpenInNewTab+'"':'newtab="_self"')+"]",T+=S.innerHTML,T+="[/button]"}break;default:T+=""}return null!=t.nextSibling&&e(t.nextSibling),T},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},array=[],WPTB_Table=function(e,t){for(var b,n,l,y,a=document.getElementsByClassName("wptb-settings-items"),r=document.getElementsByClassName("wptb-table-setup")[0],f=function(e){var t,n=this.rowSpan,l=this.colSpan,a=document.getElementsByClassName("no-cell-action"),r=document.getElementsByClassName("single-action"),o=document.getElementsByClassName("multiple-select-action"),s=v(this),i=s[0],d=s[1];if(document.select.isActivated()){if(this.className.match(/wptb-highlighted/)){this.classList.remove("wptb-highlighted");for(var c=0;c<n;c++)for(var m=0;m<l;m++)array[i+c][d+m]=0}else{this.classList.add("wptb-highlighted");for(c=0;c<n;c++)for(m=0;m<l;m++)array[i+c][d+m]=1}if(0===(t=document.getElementsByClassName("wptb-highlighted").length)){for(c=0;c<o.length;c++)o[c].classList.remove("visible");for(c=0;c<a.length;c++)a[c].classList.add("visible");for(c=0;c<r.length;c++)r[c].classList.remove("visible")}else if(1===t){for(c=0;c<o.length;c++)o[c].classList.remove("visible");for(c=0;c<a.length;c++)a[c].classList.remove("visible");for(c=0;c<r.length;c++)r[c].classList.add("visible")}else{for(c=0;c<o.length;c++)b.isSquare(array)?o[c].classList.add("visible"):o[c].classList.remove("visible");for(c=0;c<a.length;c++)a[c].classList.remove("visible");for(c=0;c<r.length;c++)r[c].classList.remove("visible")}}},i=function(){for(var e,t=[],n=[],l=0;l<y;l++)t[l]=0;for(l=0;l<b.rows.length;l++){e=[];var a=b.rows[l].getElementsByTagName("td");for(items=0;items<a.length;items++){for(var r=0;r<a[items].colSpan;r++)e.push(1);if(1<a[items].rowSpan)for(r=0;r<a[items].colSpan;r++)t[items+r]={justAssigned:!0,amount:a[items].rowSpan}}for(r=0;r<y;r++)"object"==_typeof(t[r])&&0<t[r].amount&&(t[r].amount--,t[r].justAssigned?t[r].justAssigned=!1:e.push(1));n.push(e)}return n},d=function(e){for(var t=[],n=0;n<y;n++)t[n]=0;if(-1==e)return t;for(n=0;n<=e;n++){cellsBuffer=b.rows[n].getElementsByTagName("td");for(var l=cellPointer=0;l<y;l+=stepsToMove)if(stepsToMove=1,t[l])t[l]--;else if(celda=cellsBuffer[cellPointer++],1<celda.rowSpan){for(k=0;k<celda.colSpan;k++)t[l+k]=celda.rowSpan-1;stepsToMove=celda.colSpan}else 1<celda.colSpan&&(stepsToMove=celda.colSpan)}return t},w=function(e){for(var t=0;t<e.length;t++){for(var n=0;n<e[t].length;n++)" "+e[t][n];"\n"}b.isSquare(e)},h=function(){for(var e=document.getElementsByClassName("no-cell-action"),t=document.getElementsByClassName("single-action"),n=document.getElementsByClassName("multiple-select-action"),l=b.getElementsByClassName("wptb-highlighted");l.length;)l[0].classList.remove("wptb-highlighted");for(var a=0;a<array.length;a++)for(var r=0;r<array[a].length;r++)array[a][r]=0;for(a=0;a<n.length;a++)n[a].classList.remove("visible");for(a=0;a<e.length;a++)e[a].classList.add("visible");for(a=0;a<t.length;a++)t[a].classList.remove("visible")},v=function(e){for(var t=[],n=0;n<y;n++)t[n]=0;for(n=0;n<b.rows.length;n++)for(var l=b.rows[n].getElementsByTagName("td"),a=cellPointer=0;a<y;a+=stepsToMove)if(stepsToMove=1,t[a])t[a]--;else{var r=l[cellPointer++];if(r==e)return[n,a];if(1<r.rowSpan){for(k=0;k<r.colSpan;k++)t[a+k]=r.rowSpan-1;stepsToMove=r.colSpan}else 1<r.colSpan&&(stepsToMove=r.colSpan)}},o=0;o<a.length;o++)"wptb-apply-inner-border"!==a[o].id&&a[o].classList.add("visible");(b=document.createElement("table")).classList.add("wptb-preview-table"),jQuery("#wptb-table-header-bg").val(""),jQuery("#wptb-even-row-bg").val(""),jQuery("#wptb-odd-row-bg").val(""),jQuery("#wptb-table-border-color").val(""),jQuery("#wptb-table-inner-border-number,#wptb-table-inner-border-slider").val("0"),jQuery("#wptb-table-border-number,#wptb-table-border-slider").val("0"),jQuery("#wptb-table-padding-number,#wptb-table-padding-slider").val("15"),(n=b.insertRow(-1)).classList.add("wptb-table-head","wptb-row");for(o=0;o<e;o++)(l=new WPTB_Cell(f)).setCoords(0,o),n.appendChild(l.getDOMElement());for(o=1;o<t;o++){(n=b.insertRow(-1)).classList.add("wptb-row");for(var s=0;s<e;s++)(l=new WPTB_Cell(f)).setCoords(o,s),n.appendChild(l.getDOMElement())}b.toggleTableEditMode=function(){var e=document.getElementById("edit-bar");e.classList.contains("visible")?(document.select.deactivateMultipleSelectMode(),e.classList.remove("visible")):(document.select.activateMultipleSelectMode(),e.classList.add("visible"))},b.recalculateIndexes=function(){for(var e,t=this.getElementsByTagName("tr"),n=0,l=0;l<t.length;l++){e=t[l].getElementsByTagName("td");for(var a=0;a<e.length;a++)0==l?(e[a].parentNode.className="",e[a].style.backgroundColor=jQuery("#wptb-table-header-bg").val(),e[a].parentNode.classList.add("wptb-row","wptb-table-head")):(e[a].style.backgroundColor=l%2==0?jQuery("#wptb-odd-row-bg").val():jQuery("#wptb-even-row-bg").val(),e[a].parentNode.className="",e[a].parentNode.classList.add("wptb-row")),e[a].dataset.xIndex=a,e[a].dataset.yIndex=l;n<a&&(n=a)}this.columns=n},b.addColumnEnd=function(){for(var e=0;e<b.rows.length;e++)td=new WPTB_Cell(f),b.rows[e].appendChild(td.getDOMElement()),array[e].push(0);y++,recalculateIndexes(),h()},b.addColumnStart=function(){for(var e=0;e<b.rows.length;e++)td=new WPTB_Cell(f),firstCell=b.rows[e].getElementsByTagName("td")[0],firstCell?b.rows[e].insertBefore(td.getDOMElement(),firstCell):b.rows[e].appendChild(td.getDOMElement()),array[e].push(0);y++,recalculateIndexes(),h()},b.addColumnAfter=function(e){for(var t,n,l,a,r,o=b.rows,s=document.querySelector(".wptb-highlighted"),i=null!=e&&"number"==typeof e?e:v(s)[1],d=!1,c=[],m=0;m<y;m++)c.push(0);for(m=0;m<o.length;m++){cellPointer=0,t=o[m].getElementsByTagName("td"),d=!1;for(var p=0;p<y;p+=n){if(n=1,d){l=new WPTB_Cell(f),r&&o[m].contains(r)?(a=r.nextSibling)?o[m].insertBefore(l.getDOMElement(),a):o[m].appendChild(l.getDOMElement()):o[m].insertBefore(l.getDOMElement(),t[0]);break}if(0<c[p])i==p&&(d=!0);else if(1<(r=t[cellPointer++]).rowSpan){n=r.colSpan;for(var u=0;u<r.colSpan;u++)c[p+u]=r.rowSpan,p+u==i&&(d=!0)}else if(1<r.colSpan){n=r.colSpan;for(u=0;u<r.colSpan;u++)p+u==i&&(d=!0)}else p==i&&(d=!0)}for(var g=0;g<y;g++)0<c[g]&&c[g]--}for(m=0;m<array.length;m++)array[m].push(0);y++,w(array),b.recalculateIndexes(),h()},b.addColumnBefore=function(){var e=document.querySelector(".wptb-highlighted"),t=v(e)[1];0===t?b.addColumnStart():b.addColumnAfter(t-1)},b.addRowToTheEnd=function(){for(var e,t,n=b.insertRow(-1),l=0;l<y;l++)e=new WPTB_Cell(f),n.appendChild(e.getDOMElement());t=Array.from(array[0]),array.push(t),w(array),b.recalculateIndexes(),h()},b.addRowToTheStart=function(){for(var e=b.insertRow(0),t=0;t<y;t++)td=new WPTB_Cell(f),e.appendChild(td.getDOMElement());aux=Array.from(array[0]),array.push(aux),w(array),b.recalculateIndexes(),h()},b.addRowBefore=function(){var e,t=document.querySelector(".wptb-highlighted"),n=v(t)[0],l=b.insertRow(n),a=d(n-1);noPending=a.filter(function(e){return 0==e});for(var r=0;r<noPending.length;r++){var o=new WPTB_Cell(f);l.appendChild(o.getDOMElement())}arr=i();for(r=0;r<arr.length;r++)if(arr[r].length,arr[r].length<y)for(var s=arr[r].length;s<y;s++)o=new WPTB_Cell(f),b.rows[r].appendChild(o.getDOMElement());e=Array.from(array[0]),array.push(e),w(array),b.recalculateIndexes(),h()},b.addRowAfter=function(){var e,t=document.querySelector(".wptb-highlighted"),n=v(t)[0],l=b.insertRow(n+1),a=d(n);noPending=a.filter(function(e){return 0==e});for(var r=0;r<noPending.length;r++)td=new WPTB_Cell(f),l.appendChild(td.getDOMElement());arr=i();for(r=0;r<arr.length;r++)if(arr[r].length,arr[r].length<y)for(var o=arr[r].length;o<y;o++)td=new WPTB_Cell(f),b.rows[r].appendChild(td.getDOMElement());e=Array.from(array[0]),array.push(e),w(array),b.recalculateIndexes(),h()},b.isSquare=function(e){for(var t,n,l=-1,a=-1,r=-1,o=-1,s=0,i=0;i<e.length;i++){for(var d=0;d<e[i].length;d++)if(1==e[i][d]){l=i,a=d;break}if(-1!==l&&-1!==a)break}for(i=e.length-1;-1<i;i--){for(d=e[i].length-1;-1<d;d--)if(1==e[i][d]){r=i,o=d;break}if(-1!==r&&-1!==o)break}for(i=l;i<r;i++)for(d=a;d<o;d++)if(0==e[i][d]||null==e[i][d])return!1;for(i=0;i<e.length;i++)for(d=0;d<e[i].length;d++)1==e[i][d]&&s++;return(t=r-l+1)*(n=o-a+1)===s&&[t,n]},b.mergeCells=function(){for(var e=b.isSquare(array),t=e[0],n=e[1],l=document.querySelector(".wptb-highlighted"),a=[].slice.call(document.getElementsByClassName("wptb-highlighted"),1),r=0;r<a.length;r++){a[r].parentNode.removeChild(a[r])}l.colSpan=n,l.rowSpan=t,h()},b.splitCell=function(){var e=document.getElementsByClassName("wptb-highlighted")[0];e.rowSpan,e.colSpan;e.rowSpan=1,e.colSpan=1,b.addLackingCells(),h()},b.findRowspannedCells=function(e){var t,n=[];if(actualPoints=function(e){for(var t=b.rows[e].getElementsByTagName("td"),n=0,l=0;l<t.length;l++)n+=t[l].colSpan;return n}(e),actualPoints===y)return[];t=y-actualPoints;for(var l=e-1;0<=l&&t;l--){var a=b.rows[l].getElementsByTagName("td");for(l=0;l<a.length;l++)1<a[l].rowSpan&&(n.push(a[l]),t-=a[l].colSpan)}return n},b.addLackingCells=function(){for(var e=[],t=0;t<b.rows.length;t++)e.push(0);for(t=0;t<b.rows.length;t++)for(var n=b.rows[t].getElementsByTagName("td"),l=0;l<n.length;l++)if(1<n[l].rowSpan)for(var a=1;a<n[l].rowSpan;a++)e[t+a]++;for(t=0;t<b.rows.length;t++){n=b.rows[t].getElementsByTagName("td");var r=0;for(l=0;l<n.length;l++)r+=n[l].colSpan;r+=e[t],difference=y-r;for(l=0;l<difference;l++){var o=new WPTB_Cell(f);b.rows[t].appendChild(o.getDOMElement())}}},b.deleteRow=function(){var e=document.querySelector(".wptb-highlighted"),t=v(e)[0],n=b.findRowspannedCells(t);for(o=0;o<n.length;o++)n[o].rowSpan--;b.getElementsByTagName("tbody")[0].removeChild(b.rows[t]),array.pop(),h(),b.addLackingCells()},b.deleteColumn=function(){for(var e,t,n=document.querySelector(".wptb-highlighted"),l=v(n)[1],a=[],r=0;r<y;r++)a.push(0);for(r=0;r<b.rows.length;r++){e=b.rows[r].getElementsByTagName("td"),stepsToMove=1;for(var o=cellPointer=0;o<y;o+=stepsToMove)if(stepsToMove=1,0==a[o]){if(1<(t=e[cellPointer++]).rowSpan){stepsToMove=t.colSpan;for(var s=0;s<t.colSpan;s++)a[o+s]=t.rowSpan;if(o<l&&l<=o+s-1){t.colSpan--;break}}else if(1<t.colSpan&&(stepsToMove=t.colSpan,o<l&&l<=o+t.colSpan-1)){t.colSpan--;break}if(l==o){b.rows[r].removeChild(t);break}}for(var i=0;i<a.length;i++)0<a[i]&&a[i]--}y--;for(r=0;r<b.rows.length;r++)null!=array[r]&&array[r].pop();h()},document.getElementsByClassName("wptb-table-generator")[0].style.display="none",array=function(){for(var e=[],t=[],n=0;n<b.rows.length;n++){for(var l=b.rows[n].getElementsByTagName("td"),a=0,r=0;r<l.length;r++)a+=l[r].colSpan;e.push(a)}y=Math.max.apply(null,e);var o=b.rows.length;for(n=0;n<o;n++)for(t[n]=[],r=0;r<y;r++)t[n].push(0);return w(t),t}(),h(),w(array),r.appendChild(b),b.recalculateIndexes(),WPTB_LeftPanel()},WPTB_Text=function(e){var t=document.createElement("div"),n=document.createElement("div"),l=document.createElement("p");return this.kind="text",n.classList.add("editable"),l.innerHTML=null!=e?e:"Text",n.appendChild(l),t.appendChild(n),this.getDOMElement=function(){return t},applyGenericItemSettings(this),this},applyGenericItemSettings=function(o){var s,i=o.getDOMElement(),e=document.counter.nextIndex(o.kind);i.onmouseenter=function(e){this.classList.add("wptb-directlyhovered");var t=document.createElement("span"),n=document.createElement("span"),l=document.createElement("span"),a=document.createElement("span");if(a.classList.add("wptb-actions"),t.classList.add("dashicons","dashicons-trash","delete-action"),n.classList.add("dashicons","dashicons-admin-page","duplicate-action"),l.classList.add("dashicons","dashicons-move","move-action"),l.draggable=!0,t.onclick=function(e){var t,n=this.parentNode.parentNode,l=n.parentNode,a=n.nextSibling;l.removeChild(n),l.removeChild(a),l.getElementsByClassName("wptb-ph-element").length||(t=l.getElementsByClassName("wptb-space-between")[0])&&l.removeChild(t)},n.onclick=function(e){if("list"==o.kind){for(var t=e.target.parentNode.parentNode.parentNode,n=[],l=e.target.parentNode.parentNode.querySelectorAll("ul article .wptb-list-item-content"),a=0;a<l.length;a++)n.push(l[a].innerHTML);var r=new WPTB_List(n);t.appendChild(r.getDOMElement())}else if("text"==o.kind){t=e.target.parentNode.parentNode.parentNode,r=new WPTB_Text(e.target.parentNode.parentNode.childNodes[0].innerHTML);t.appendChild(r.getDOMElement())}else if("image"==o.kind){t=e.target.parentNode.parentNode.parentNode,r=new WPTB_Image(e.target.parentNode.parentNode.childNodes[0].src);t.appendChild(r.getDOMElement())}else{t=e.target.parentNode.parentNode.parentNode,r=new WPTB_Button(e.target.parentNode.parentNode.childNodes[0].innerHTML);t.appendChild(r.getDOMElement())}},l.ondragstart=function(e){for(var t,n,l=this;""==l.className||!l.classList.contains("wptb-ph-element");)l=l.parentNode;n=(t=l.className.match(/wptb-element-(.+)-(\d+)/i))[1];var a=document.createElement("img");a.src="http://localhost/sandbox/wp-content/plugins/wp-table-builder/inc/admin/views/builder/icons/"+n+".png",e.dataTransfer.setDragImage(a,0,0),e.dataTransfer.setData("node","wptb-element-"+t[1]+"-"+t[2])},"button"===o.kind)tinyMCE.init({target:i.childNodes[0].childNodes[0],inline:!0,plugins:"link",dialog_type:"modal",theme:"modern",menubar:!1,fixed_toolbar_container:"#wpcd_fixed_toolbar",toolbar:"bold italic strikethrough",verify_html:!1,setup:function(e){e.on("init",function(e){tinyMCE.execCommand("mceRepaint")})},init_instance_callback:function(l){l.on("change",function(e){""==l.getContent().trim()&&l.setContent("<a class='wptb-button'>Button Text</a>")}),l.on("KeyDown",function(e){var t=l.selection.getRng(),n=e.keyCode;0!=t.startOffset||8!=n&&46!=n||(e.preventDefault(),l.setContent("<p class='wptb-button'></p>"))}),(window.currentEditor=l).on("focus",function(e){var t=document.getElementsByClassName("wptb-builder-panel")[0].offsetWidth;window.currentEditor&&55<=document.getElementById("wptb_builder").scrollTop&&"none"!=window.currentEditor.bodyElement.style.display?(document.getElementById("wpcd_fixed_toolbar").style.position="fixed",document.getElementById("wpcd_fixed_toolbar").style.right=t/2-document.getElementById("wpcd_fixed_toolbar").offsetWidth/2+"px",document.getElementById("wpcd_fixed_toolbar").style.top="100px"):(document.getElementById("wpcd_fixed_toolbar").style.position="static",delete document.getElementById("wpcd_fixed_toolbar").style.right,delete document.getElementById("wpcd_fixed_toolbar").style.top)})}});else if("text"===o.kind)tinyMCE.init({target:i.childNodes[0],inline:!0,plugins:"link, paste",dialog_type:"modal",theme:"modern",menubar:!1,fixed_toolbar_container:"#wpcd_fixed_toolbar",paste_as_text:!0,toolbar:"bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify",init_instance_callback:function(e){(window.currentEditor=e).on("focus",function(e){var t=document.getElementsByClassName("wptb-builder-panel")[0].offsetWidth;window.currentEditor&&55<=document.getElementById("wptb_builder").scrollTop&&"none"!=window.currentEditor.bodyElement.style.display?(document.getElementById("wpcd_fixed_toolbar").style.position="fixed",document.getElementById("wpcd_fixed_toolbar").style.right=t/2-document.getElementById("wpcd_fixed_toolbar").offsetWidth/2+"px",document.getElementById("wpcd_fixed_toolbar").style.top="100px"):(document.getElementById("wpcd_fixed_toolbar").style.position="static",delete document.getElementById("wpcd_fixed_toolbar").style.right,delete document.getElementById("wpcd_fixed_toolbar").style.top)})}});else{s=i.getElementsByClassName("wptb-list-item-content");for(var r=0;r<s.length;r++)tinyMCE.init({target:s[r],inline:!0,plugins:"link, paste",dialog_type:"modal",theme:"modern",menubar:!1,fixed_toolbar_container:"#wpcd_fixed_toolbar",paste_as_text:!0,toolbar:"bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify",init_instance_callback:function(e){(window.currentEditor=e).on("focus",function(e){var t=document.getElementsByClassName("wptb-builder-panel")[0].offsetWidth;window.currentEditor&&55<=document.getElementById("wptb_builder").scrollTop&&"none"!=window.currentEditor.bodyElement.style.display?(document.getElementById("wpcd_fixed_toolbar").style.position="fixed",document.getElementById("wpcd_fixed_toolbar").style.right=t/2-document.getElementById("wpcd_fixed_toolbar").offsetWidth/2+"px",document.getElementById("wpcd_fixed_toolbar").style.top="100px"):(document.getElementById("wpcd_fixed_toolbar").style.position="static",delete document.getElementById("wpcd_fixed_toolbar").style.right,delete document.getElementById("wpcd_fixed_toolbar").style.top)})}})}a.appendChild(l),a.appendChild(n),a.appendChild(t),this.appendChild(a)},i.onmouseleave=function(e){var t=this.getElementsByClassName("wptb-actions");t&&t[0]&&t[0].parentNode.removeChild(t[0]);this.classList.remove("wptb-directlyhovered")},i.classList.add("wptb-ph-element","wptb-element-"+o.kind+"-"+e),new WPTB_ElementOptions(o,e),document.counter.increment(o.kind)};