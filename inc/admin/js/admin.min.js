var applyGenericItemSettings=function(o,e){var t,s,n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=o.getDOMElement();if(null==e||1==n){t=document.counter.nextIndex(o.kind);var a=document.getElementsByClassName("wptb-ph-element");t=0<a.length?a.length+1:1}else e&&!n&&(t=e.split("-")[1]);i.onmouseenter=function(e){this.classList.add("wptb-directlyhovered");var t=document.createElement("span"),n=document.createElement("span"),a=document.createElement("span"),r=document.createElement("span");if(r.classList.add("wptb-actions"),t.classList.add("dashicons","dashicons-trash","delete-action"),n.classList.add("dashicons","dashicons-admin-page","duplicate-action"),a.classList.add("dashicons","dashicons-move","move-action"),a.draggable=!0,t.onclick=function(e){var t=this.parentNode.parentNode;t.parentNode.removeChild(t)},n.onclick=function(e){if("list"==o.kind){e.target.parentNode.parentNode.parentNode;for(var t=[],n=e.target.parentNode.parentNode.querySelectorAll("ul li .wptb-list-item-content"),a=0;a<n.length;a++)t.push(n[a].innerHTML);var r=new WPTB_List(t,i);i.parentNode.insertBefore(r.getDOMElement(),i.nextSibling)}else if("text"==o.kind){e.target.parentNode.parentNode.parentNode,r=new WPTB_Text(e.target.parentNode.parentNode.childNodes[0].innerHTML,i);i.parentNode.insertBefore(r.getDOMElement(),i.nextSibling)}else if("image"==o.kind){e.target.parentNode.parentNode.parentNode,r=new WPTB_Image(e.target.parentNode.parentNode.children[0].children[0].src,i);i.parentNode.insertBefore(r.getDOMElement(),i.nextSibling)}else{e.target.parentNode.parentNode.parentNode,r=new WPTB_Button(e.target.parentNode.parentNode.childNodes[0].innerHTML,i);i.parentNode.insertBefore(r.getDOMElement(),i.nextSibling)}},a.ondragstart=function(e){for(var t,n,a=this;""==a.className||!a.classList.contains("wptb-ph-element");)a=a.parentNode;this.parentNode.style.display="none",a.classList.add("moving-mode"),a.classList.remove("wptb-directlyhovered"),n=(t=a.className.match(/wptb-element-(.+)-(\d+)/i))[1];var r=document.createElement("img");r.src="http://localhost/sandbox/wp-content/plugins/wp-table-builder/inc/admin/views/builder/icons/"+n+".png",e.dataTransfer.setDragImage(r,0,0),e.dataTransfer.setData("node","wptb-element-"+t[1]+"-"+t[2])},"button"===o.kind)tinyMCE.init({target:i.childNodes[0].childNodes[0],inline:!0,plugins:"link",dialog_type:"modal",theme:"modern",menubar:!1,fixed_toolbar_container:"#wpcd_fixed_toolbar",toolbar:"bold italic strikethrough",verify_html:!1,setup:function(e){e.on("init",function(e){tinyMCE.execCommand("mceRepaint")})},init_instance_callback:function(a){a.on("change",function(e){""==a.getContent().trim()&&a.setContent("<a class='wptb-button'>Button Text</a>")}),a.on("KeyDown",function(e){var t=a.selection.getRng(),n=e.keyCode;0!=t.startOffset||8!=n&&46!=n||(e.preventDefault(),a.setContent("<p class='wptb-button'></p>"))}),(window.currentEditor=a).on("focus",function(e){var t=document.getElementsByClassName("wptb-builder-panel")[0].offsetWidth;window.currentEditor&&55<=document.getElementById("wptb_builder").scrollTop&&"none"!=window.currentEditor.bodyElement.style.display?(document.getElementById("wpcd_fixed_toolbar").style.position="fixed",document.getElementById("wpcd_fixed_toolbar").style.right=t/2-document.getElementById("wpcd_fixed_toolbar").offsetWidth/2+"px",document.getElementById("wpcd_fixed_toolbar").style.top="100px"):(document.getElementById("wpcd_fixed_toolbar").style.position="static",delete document.getElementById("wpcd_fixed_toolbar").style.right,delete document.getElementById("wpcd_fixed_toolbar").style.top)})}});else if("text"===o.kind)tinyMCE.init({target:i.childNodes[0],inline:!0,plugins:"link, paste",dialog_type:"modal",theme:"modern",menubar:!1,fixed_toolbar_container:"#wpcd_fixed_toolbar",paste_as_text:!0,toolbar:"bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify",init_instance_callback:function(e){(window.currentEditor=e).on("focus",function(e){var t=document.getElementsByClassName("wptb-builder-panel")[0].offsetWidth;window.currentEditor&&55<=document.getElementById("wptb_builder").scrollTop&&"none"!=window.currentEditor.bodyElement.style.display?(document.getElementById("wpcd_fixed_toolbar").style.position="fixed",document.getElementById("wpcd_fixed_toolbar").style.right=t/2-document.getElementById("wpcd_fixed_toolbar").offsetWidth/2+"px",document.getElementById("wpcd_fixed_toolbar").style.top="100px"):(document.getElementById("wpcd_fixed_toolbar").style.position="static",delete document.getElementById("wpcd_fixed_toolbar").style.right,delete document.getElementById("wpcd_fixed_toolbar").style.top)})}});else{s=i.getElementsByClassName("wptb-list-item-content");for(var l=0;l<s.length;l++)tinyMCE.init({target:s[l],inline:!0,plugins:"link, paste",dialog_type:"modal",theme:"modern",menubar:!1,fixed_toolbar_container:"#wpcd_fixed_toolbar",paste_as_text:!0,toolbar:"bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify",init_instance_callback:function(e){(window.currentEditor=e).on("focus",function(e){var t=document.getElementsByClassName("wptb-builder-panel")[0].offsetWidth;window.currentEditor&&55<=document.getElementById("wptb_builder").scrollTop&&"none"!=window.currentEditor.bodyElement.style.display?(document.getElementById("wpcd_fixed_toolbar").style.position="fixed",document.getElementById("wpcd_fixed_toolbar").style.right=t/2-document.getElementById("wpcd_fixed_toolbar").offsetWidth/2+"px",document.getElementById("wpcd_fixed_toolbar").style.top="100px"):(document.getElementById("wpcd_fixed_toolbar").style.position="static",delete document.getElementById("wpcd_fixed_toolbar").style.right,delete document.getElementById("wpcd_fixed_toolbar").style.top)})}})}r.appendChild(a),r.appendChild(n),r.appendChild(t),this.appendChild(r)},i.onmouseleave=function(e){this.classList.remove("wptb-directlyhovered");for(var t=0;e.target.querySelector(".wptb-actions")&&t<5;)e.target.querySelector(".wptb-actions").remove(),t++};var r=i.className.match(/wptb-element-(.+)-(\d+)/i);r&&i.classList.remove(r[0]),i.classList.contains("wptb-ph-element")||i.classList.add("wptb-ph-element"),i.classList.contains("wptb-element-"+o.kind+"-"+t)||i.classList.add("wptb-element-"+o.kind+"-"+t),new WPTB_ElementOptions(o,t,e),document.counter.increment(o.kind)};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}document.addEventListener("DOMContentLoaded",function(){var e,t,n=(e=window.location.href,!!(t=new RegExp("[?&]table(=([^&#]*)|&|#|$)").exec(e))&&(t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):""));if(n){var a=new XMLHttpRequest,r=ajaxurl+"?action=get_table&id="+n;a.open("GET",r,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(e){if(4==this.readyState&&200==this.status){var t=JSON.parse(a.responseText);document.getElementById("wptb-setup-name").value=t[0],document.getElementsByClassName("wptb-table-generator")[0].style.display="none";var n=document.getElementsByClassName("wptb-table-setup")[0];return console.log(t[1]),n.appendChild(t[1]),WPTB_Table(),WPTB_LeftPanel(),void WPTB_Settings()}},a.send(null)}document.counter=new ElementCounters,console.log(document.counter),document.select=new MultipleSelect,WPTB_Initializer(),settings=WPTB_Settings()});var WPTB_Button=function(e,t){var n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("a"),l=void 0,o=!1;if(n.classList.add("wptb-button-container","wptb-size-M","wptb-"),a.classList.add("wptb-button-wrapper"),r.classList.add("wptb-button"),r.classList.add("editable"),r.classList.add("editable"),r.innerHTML=null!=e?e:"Button Text",t){var s=t.className.match(/wptb-element-((.+-)\d+)/i);s&&Array.isArray(s)&&(l=s[1],o=!0);var i=[].concat(_toConsumableArray(t.attributes));if(0<i.length)for(var d=0;d<i.length;d++)n.setAttribute(i[d].name,i[d].value);var c=t.querySelector(".wptb-button-wrapper");if(c){var m=[].concat(_toConsumableArray(c.attributes));if(0<m.length)for(var p=0;p<m.length;p++)"style"==m[p].name&&a.setAttribute(m[p].name,m[p].value)}var u=t.querySelector(".wptb-button");if(u){var g=[].concat(_toConsumableArray(u.attributes));if(0<g.length)for(var b=0;b<g.length;b++)"style"!=g[b].name&&"href"!=g[b].name&&"target"!=g[b].name||r.setAttribute(g[b].name,g[b].value)}}return a.appendChild(r),n.appendChild(a),this.kind="button",this.getDOMElement=function(){return n},applyGenericItemSettings(this,l,o),this},WPTB_Cell=function(e,s){if(!s){(s=document.createElement("td")).style.padding=jQuery("#wptb-table-padding-number").val()+"px";var t=jQuery("#wptb-table-inner-border-number").val();""!=t&&0!=parseInt(t)&&(s.style.border=t+"px solid "+jQuery("#wptb-table-border-color").val()),s.classList.add("wptb-droppable","wptb-cell")}s.draggable=!1,e&&(s.onclick=e),WPTB_innerElementSet(s);var i=s.getElementsByClassName("wptb-ph-element");if(0<i.length)for(var n=function(e){var t=s.getElementsByClassName("wptb-space-between");if(0<t.length)for(var n=0;n<t.length;n++)WPTB_Space(t[n]);i[e].getDOMElement=function(){return i[e]},WPTB_innerElementSet(i[e]);var a=i[e].className.match(/wptb-element-((.+-)\d+)/i);if(a&&Array.isArray(a)){var r=a[1].split("-");if(i[e].kind=r[0],applyGenericItemSettings(i[e],a[1]),"list"==i[e].kind){var l=i[e].getElementsByTagName("li");if(0<l.length)for(var o=0;o<l.length;o++)WPTB_ListItem(void 0,l[o])}}},a=0;a<i.length;a++)n(a);return this.getDOMElement=function(){return s},this.setCoords=function(e,t){var n=this.getDOMElement();n.dataset.yIndex=e,n.dataset.xIndex=t},this.getCoords=function(){var e,t=this.getDOMElement();return e.x=t.dataset.xIndex,e.y=t.dataset.yIndex,e},this.appendElement=function(e){getDOMElement().appendChild(e)},this},WPTB_DropHandle=function(o,e){var s=void 0,i=void 0;if(0==document.getElementsByClassName("wptb-drop-handle").length){(s=document.createElement("div")).classList.add("wptb-drop-handle"),(i=document.createElement("div")).classList.add("wptb-drop-border-marker");var t=document.createElement("div"),n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div");t.classList.add("wptb-drop-border-marker-top"),n.classList.add("wptb-drop-border-marker-right"),a.classList.add("wptb-drop-border-marker-bottom"),r.classList.add("wptb-drop-border-marker-left"),i.appendChild(t),i.appendChild(n),i.appendChild(a),i.appendChild(r);var l=document.getElementsByTagName("body");0<l.length&&(l[0].appendChild(s),l[0].appendChild(i)),s.ondragenter=function(){},s.ondragover=function(e){e.preventDefault()},s.ondragleave=function(){},s.ondrop=function(e){e.preventDefault();var t,n=void 0;if(e.dataTransfer.getData("wptbElement")?n=(n=(t=e.dataTransfer.getData("wptbElement")).includes("list")?new WPTB_List:t.includes("image")?new WPTB_Image:t.includes("text")?new WPTB_Text:t.includes("button")?new WPTB_Button:void 0).getDOMElement():((n=document.getElementsByClassName(e.dataTransfer.getData("node"))[0]).classList.remove("moving-mode"),n.classList.remove("moving-into-same-elem")),"Drop Here"==s.dataset.text){if("td"==(o=s.getDOMParentElement()).nodeName.toLowerCase())s.getDOMParentElement().appendChild(n)}else{var a=s.getDOMParentElement(),r=a.parentNode;if("Abowe Element"==s.dataset.text)r.insertBefore(n,a);else if("Below Element"==s.dataset.text){var l=a.nextSibling;r.insertBefore(n,l)}}s.style.display="none",i.style.display="none",WPTB_innerElementSet(n)}}else s=document.getElementsByClassName("wptb-drop-handle")[0],i=document.getElementsByClassName("wptb-drop-border-marker")[0];if(!o||"td"!=o.nodeName.toLowerCase()||0==o.getElementsByClassName("wptb-ph-element").length){s.getDOMParentElement=function(){return o},s.style.width=o.offsetWidth+"px";var d=o.offsetHeight,c=o.getBoundingClientRect(),m=Number(c.left),p=void 0;if(s.style.left=m+"px",e.dataTransfer.getData("node")){var u=document.getElementsByClassName(e.dataTransfer.getData("node"))[0];o==u?(s.classList.add("moving-into-same-elem"),i.classList.add("moving-into-same-elem")):(s.classList.remove("moving-into-same-elem"),i.classList.remove("moving-into-same-elem"))}if(s.style.display="block",i.style.display="block","td"!=o.nodeName.toLowerCase()){var g=null==e.offsetY?e.layerY:e.offsetY;p=Number(c.top)-Number(11),s.dataset.text="Abowe Element",d/2<g&&(p=Number(c.top)+d-1,s.dataset.text="Below Element")}else s.dataset.text="Drop Here",p=Number(c.top)+d/2-5;s.style.top=p+"px",i.style.top=c.top+"px",i.style.left=c.left+"px",wptbDropBorderMarkerTop=i.querySelector(".wptb-drop-border-marker-top"),wptbDropBorderMarkerTop.style.width=Number(o.offsetWidth)-Number(1)+"px",wptbDropBorderMarkerRight=i.querySelector(".wptb-drop-border-marker-right"),wptbDropBorderMarkerRight.style.height=Number(c.bottom)-Number(c.top)-1+"px",wptbDropBorderMarkerRight.style.left=wptbDropBorderMarkerTop.style.width,wptbDropBorderMarkerBottom=i.querySelector(".wptb-drop-border-marker-bottom"),wptbDropBorderMarkerBottom.style.width=wptbDropBorderMarkerTop.style.width,wptbDropBorderMarkerBottom.style.top=wptbDropBorderMarkerRight.style.height,wptbDropBorderMarkerLeft=i.querySelector(".wptb-drop-border-marker-left"),wptbDropBorderMarkerLeft.style.height=wptbDropBorderMarkerRight.style.height}},ElementCounters=function(){var t=[];return t.text=0,t.image=0,t.list=0,t.button=0,this.increment=function(e){e in t&&t[e]++},this.nextIndex=function(e){if(e in t)return t[e]+1},this},WPTB_ElementOptions=function(e,t,n){var a,r=e.getDOMElement();prop=document.querySelector(".wptb-"+e.kind+"-options-prototype").cloneNode(!0),prop.classList.remove("wptb-"+e.kind+"-options-prototype"),a="wptb-options-"+e.kind+"-"+t;for(var l=prop.getElementsByClassName("wptb-element-property"),o=0;o<l.length;o++)l[o].dataset.element=a;if(prop.classList.add(a),document.getElementById("element-options-group").appendChild(prop),n)if("button"==e.kind){var s=document.getElementsByClassName("wptb-element-"+n)[0],i=void 0,d=void 0,c=void 0;if(s&&(c=s.className.match(/wptb-size-([a-z]+)/i)),c&&Array.isArray(c)){var m=prop.getElementsByClassName("wptb-btn-size-btn");for(o=0;o<m.length;o++)m[o].classList.remove("selected"),m[o].innerHTML==c[1]&&m[o].classList.add("selected")}if(s&&(i=s.getElementsByClassName("wptb-button-wrapper"),d=s.getElementsByClassName("wptb-button")),i){var p=i[0].style.justifyContent,u=prop.querySelector('select[data-type="button-alignment"]').getElementsByTagName("option"),g=void 0;"flex-start"==p?g="left":"center"!=p&&p?"flex-end"==p&&(g="right"):g="center";for(var b=0;b<u.length;b++)u[b].value==g&&(u[b].selected=!0)}if(d){var y=d[0].style.color,f=d[0].style.backgroundColor,v=d[0].getAttribute("href"),h=d[0].getAttribute("target"),w=prop.querySelector('input[data-type="button-text-color"]'),E=prop.querySelector('input[data-type="button-color"]'),B=prop.querySelector('input[data-type="button-link"]'),N=prop.querySelector('input[data-type="button-link-target"]'),C=N.getAttribute("id"),T=N.parentNode.getElementsByTagName("label")[0];C=C+"-"+n.split("-")[1],N.setAttribute("id",C),T.setAttribute("for",C),w.value=y,E.value=f,B.value=v,h&&"_blank"==h&&(N.checked=!0)}}else if("image"==e.kind){var S=document.getElementsByClassName("wptb-element-"+n);if(0<S.length){var x=S[0].getElementsByTagName("a");if(0<x.length){var I=x[0];if(I){I.onclick=function(e){e.preventDefault()};for(var k=I.style.textAlign,L=prop.querySelector('select[data-type="image-alignment"]').getElementsByTagName("option"),_=0;_<L.length;_++)L[_].value==k&&(L[_].selected=!0);var A=I.getAttribute("href"),D=prop.querySelector('input[data-type="image-link"]');A&&(D.value=A);var M=I.getAttribute("target"),P=prop.querySelector('input[data-type="image-link-target"]'),q=P.getAttribute("id"),W=P.parentNode.getElementsByTagName("label")[0];q=q+"-"+n.split("-")[1],P.setAttribute("id",q),W.setAttribute("for",q),M&&"_blank"==M&&(P.checked=!0);var O=I.getElementsByTagName("img");if(0<O.length){var R=O[0].style.width;if(R){var z=prop.querySelector('input[type="range"][data-type="image-size"]'),H=prop.querySelector('input[type="number"][data-type="image-size"]');z.value=parseInt(R),H.value=parseInt(R)}var j=O[0].getAttribute("alt");prop.querySelector('input[type="text"][data-type="alternative-text"]').value=j}}}}}else if("text"==e.kind){var Q=document.getElementsByClassName("wptb-element-"+n);if(0<Q.length){var G=Q[0].style.fontSize,J=Q[0].style.color,Y=prop.querySelector('input[type="range"][data-type="font-size"]'),F=prop.querySelector('input[type="number"][data-type="font-size"]'),K=prop.querySelector('input[type="text"][data-type="color"]');Y.value=parseInt(G),F.value=parseInt(G),K.value=J}}else if("list"==e.kind){var U=document.getElementsByClassName("wptb-element-"+n);if(0<U.length){var X=U[0].querySelectorAll("li");if(0<X.length){var $=X[0].style.listStyleType;if($&&"decimal"!=$){var V=prop.querySelector('select[data-type="list-class"]');if(V){V.value="unordered";for(var Z=V.parentNode.nextSibling,ee=0;ee<10&&"1"!=Z.nodeType;ee++)Z=Z.nextSibling;if(Z){var te=Z.getAttribute("id");Z.setAttribute("id",te+"-"+n),Z.style.display="flex"}var ne=prop.querySelector('select[data-type="list-style-type"]');ne&&(ne.parentNode.style.display="flex",ne.value=$)}}}var ae=U[0].getElementsByClassName("wptb-list-item-content");if(0<ae.length){for(var re=[],le=0;le<ae.length;le++){var oe=ae[le].querySelector("p");oe&&(oe.style.textAlign?re.push(oe.style.textAlign):re.push("left"))}var se=0,ie=0,de=0;if(0<re.length)for(var ce=0;ce<re.length;ce++)re[ce]&&("left"==re[ce]?se++:"center"==re[ce]?ie++:"right"==re[ce]&&de++);var me=prop.querySelector('select[data-type="list-alignment"]'),pe=Math.max(se,ie,de);se==pe?me.value="left":ie==pe?me.value="center":de==pe&&(me.value="right")}}}if(r.onclick=function(){var e=this.className.match(/wptb-element-((.+-)\d+)/i),t=".wptb-"+e[2]+"options.wptb-options-"+e[1];document.getElementById("add-elements").getElementsByTagName("a")[0].classList.remove("active"),document.getElementById("element-options").getElementsByTagName("a")[0].classList.add("active"),document.getElementsByClassName("wptb-elements-container")[0].style.display="none",document.getElementsByClassName("wptb-settings-section")[0].style.display="none",document.getElementById("element-options-group").style.display="block";for(var n=document.getElementById("element-options-group").childNodes,a=0;a<n.length;a++)n[a].style&&(n[a].style.display="none");document.querySelector(t).style.display="block"},"button"==e.kind){var ue=prop.getElementsByClassName("wptb-btn-size-btn");for(o=0;o<ue.length;o++)ue[o].onclick=function(){var e=this.innerHTML,t=this.dataset.element.match(/wptb-options-(.+)-(\d+)/i),n=t[1],a=t[2],r=document.getElementsByClassName("wptb-element-"+n+"-"+a)[0];r.classList.remove("wptb-size-S"),r.classList.remove("wptb-size-M"),r.classList.remove("wptb-size-L"),r.classList.remove("wptb-size-XL"),r.classList.add("wptb-size-"+e);for(var l=this.parentNode.getElementsByClassName("wptb-btn-size-btn"),o=0;o<l.length;o++)l[o].classList.remove("selected");this.classList.add("selected")}}var ge=prop.getElementsByClassName("wptb-element-property");for(o=0;o<ge.length;o++){if(ge[o].classList.contains("wptb-color-picker")&&jQuery(ge[o]).wpColorPicker({change:function(e,t){var n,a,r,l=e.target;a=(n=l.dataset.element.match(/wptb-options-(.+)-(\d+)/i))[1],r=n[2],affectedEl=document.getElementsByClassName("wptb-element-"+a+"-"+r)[0],"button"==a?"button-text-color"==l.dataset.type?affectedEl.getElementsByClassName("wptb-button")[0].style.color=t.color.toString():affectedEl.getElementsByClassName("wptb-button")[0].style.backgroundColor=t.color.toString():affectedEl.style.color=t.color.toString()}}),"font-size"===ge[o].dataset.type)ge[o].parentNode.parentNode.getElementsByClassName("wptb-text-font-size-slider")[0].oninput=function(){this.parentNode.parentNode.getElementsByClassName("wptb-text-font-size-number")[0].value=this.value,this.parentNode.parentNode.getElementsByClassName("wptb-text-font-size-number")[0].onchange()};if("image-size"===ge[o].dataset.type)ge[o].parentNode.parentNode.getElementsByClassName("wptb-image-size-slider")[0].oninput=function(){this.parentNode.parentNode.getElementsByClassName("wptb-image-width-number")[0].value=this.value,this.parentNode.parentNode.getElementsByClassName("wptb-image-width-number")[0].onchange()};ge[o].onchange=function(e){var t=this.dataset.element.match(/wptb-options-(.+)-(\d+)/i),n=t[1],a=t[2],r=document.getElementsByClassName("wptb-element-"+n+"-"+a)[0],l=this.value;switch(this.dataset.type){case"src":r.getElementsByTagName("img")[0].src=this.value;break;case"alternative-text":r.getElementsByTagName("img")[0].alt=this.value;break;case"image-link":r.getElementsByTagName("a")[0].href=this.value;break;case"image-link-target":1==this.checked?r.getElementsByTagName("a")[0].target="_blank":r.getElementsByTagName("a")[0].target="_self";break;case"image-size":r.getElementsByTagName("img")[0].style.width=this.value+"%",r.getElementsByTagName("img")[0].style.height="auto",this.parentNode.parentNode.getElementsByClassName("wptb-image-size-slider")[0].value=this.value;break;case"image-alignment":r.getElementsByTagName("img")[0].parentNode.style.textAlign=this.value;break;case"font-size":r.style.fontSize=l+"px";break;case"button-alignment":var o="";o="left"==this.value?"start":"right"==this.value?"flex-end":"center",r.getElementsByClassName("wptb-button-wrapper")[0].style.justifyContent=o;break;case"button-link":r.getElementsByTagName("a")[0].href=this.value;break;case"button-link-target":1==this.checked?r.getElementsByTagName("a")[0].target="_blank":r.getElementsByTagName("a")[0].target="_self";break;case"button-color":break;case"list-alignment":for(var s=r.querySelectorAll("li"),i=0;i<s.length;i++){var d=s[i].querySelector("p");d&&(d.style.textAlign=this.value)}break;case"list-class":var c=e.target.parentNode.parentNode.querySelector("[data-type=list-style-type]").parentNode,m=c.parentNode;if("unordered"==l){c.style.display="flex",m.querySelector(".wptb-list-icon-select-label").style.display="flex";var p=r.querySelectorAll("li");for(i=0;i<p.length;i++)p[i].style.listStyleType="disc";m.querySelector("[data-type=list-style-type]").value="disc"}else{c.style.display="none",m.querySelector(".wptb-list-icon-select-label").style.display="none";var u=r.querySelectorAll("li");for(i=0;i<u.length;i++)u[i].style.listStyleType="decimal"}break;case"list-style-type":for(u=r.querySelectorAll("li"),i=0;i<u.length;i++)u[i].style.listStyleType=l.toLowerCase()}}}},WPTB_Image=function(e,t){var n=void 0,a=void 0,r=!1;if(null==t){n=document.createElement("div");var l=document.createElement("a"),o=document.createElement("img");l.style.display="inline-block",l.appendChild(o),n.appendChild(l),l.onclick=function(e){e.preventDefault()},file_frame=wp.media.frames.file_frame=wp.media({title:"Select a image to upload",button:{text:"Use this image"},multiple:!1}),file_frame.on("select",function(){attachment=file_frame.state().get("selection").first().toJSON(),o.src=attachment.url}),null==e?file_frame.open():o.src=e}else{(n=t.cloneNode(!0)).getElementsByTagName("a")[0].onclick=function(e){e.preventDefault()};var s=t.className.match(/wptb-element-((.+-)\d+)/i);s&&Array.isArray(s)&&(a=s[1],r=!0)}return this.kind="image",this.getDOMElement=function(){return n},applyGenericItemSettings(this,a,r),this},WPTB_Initializer=function(){var e=document.body;columnsDecrementButton=e.getElementsByClassName("wptb-input-number-decrement")[0],columnsIncrementButton=e.getElementsByClassName("wptb-input-number-increment")[0],rowsDecrementButton=e.getElementsByClassName("wptb-input-number-decrement")[1],rowsIncrementButton=e.getElementsByClassName("wptb-input-number-increment")[1],columnsInput=document.getElementById("wptb-columns-number"),rowsInput=document.getElementById("wptb-rows-number"),columnsDecrementButton.onclick=function(){1<columnsInput.value&&columnsInput.value--},columnsIncrementButton.onclick=function(){columnsInput.value<10&&columnsInput.value++},rowsDecrementButton.onclick=function(){1<rowsInput.value&&rowsInput.value--},rowsIncrementButton.onclick=function(){rowsInput.value<10&&rowsInput.value++},document.getElementById("wptb-generate-table").onclick=function(){var e=document.getElementById("wptb-columns-number").value,t=document.getElementById("wptb-rows-number").value;WPTB_Table(e,t)}},WPTB_innerElementSet=function d(t){t.ondragenter=function(e){(e.dataTransfer.getData("wptbElement")||e.dataTransfer.getData("node"))&&(WPTB_DropHandle(this,e),t.classList.add("ondragenter"))},t.ondragover=function(e){e.preventDefault(),WPTB_DropHandle(this,e)},t.ondragleave=function(){},t.ondrop=function(e){this.classList.remove("ondragenter");var t=void 0,n=void 0;if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.getData("wptbElement")||e.dataTransfer.getData("node")){var a,r=void 0,l=void 0;if(0<document.getElementsByClassName("wptb-drop-handle").length&&(r=document.getElementsByClassName("wptb-drop-handle")[0]),0<document.getElementsByClassName("wptb-drop-border-marker").length&&(l=document.getElementsByClassName("wptb-drop-border-marker")[0]),e.dataTransfer.getData("wptbElement")?t=(t="list"==(a=e.dataTransfer.getData("wptbElement"))?new WPTB_List:"image"==a?new WPTB_Image:"text"==a?new WPTB_Text:"button"==a?new WPTB_Button:void 0).getDOMElement():(n=e.dataTransfer.getData("node"),(t=document.getElementsByClassName(n)[0]).classList.remove("moving-mode")),"block"==r.style.display)if("Drop Here"==r.dataset.text){r.getDOMParentElement().appendChild(t)}else{var o=r.getDOMParentElement(),s=o.parentNode;if("Abowe Element"==r.dataset.text)s.insertBefore(t,o);else if("Below Element"==r.dataset.text){var i=o.nextSibling;s.insertBefore(t,i)}}else this.appendChild(t);return r.style.display="none",l.style.display="none",d(t),!0}},t.onmouseover=function(e){t.classList.remove("ondragenter")}},WPTB_LeftPanel=function(){var l=document.getElementsByClassName("wptb-preview-table")[0],e=document.getElementsByClassName("wptb-element");function t(e,t){if(!(3<t)){var n=l.getElementsByTagName("tr");if(n.length>t){var a=n[t].style.backgroundColor,r=document.getElementById(e);r&&a&&(r.value=a)}}}function n(e){for(var t=l.getElementsByTagName("td"),n=0;n<t.length;n++)t[n].style.borderWidth=document.querySelector("#wptb-table-inner-border-number").value+"px",t[n].style.borderStyle="solid"}function a(e){for(var t=l.getElementsByTagName("td"),n=0;n<t.length;n++)t[n].style.padding=e+"px"}function r(e){l.style.borderWidth=e+"px",l.style.borderStyle="solid"}t("wptb-even-row-bg",1),jQuery("#wptb-even-row-bg").wpColorPicker({change:function(e,t){for(var n=l.getElementsByTagName("tr"),a=1;a<n.length;a+=2)n[a].style.backgroundColor=t.color.toString()},clear:function(){for(var e=l.getElementsByTagName("tr"),t=1;t<e.length;t+=2){e[t].style.backgroundColor="";for(var n=e[t].getElementsByTagName("td"),a=0;a<n.length;a++)n[a].style.backgroundColor=""}}}),t("wptb-odd-row-bg",2),jQuery("#wptb-odd-row-bg").wpColorPicker({change:function(e,t){for(var n=l.getElementsByTagName("tr"),a=2;a<n.length;a+=2)n[a].style.backgroundColor=t.color.toString()},clear:function(){for(var e=l.getElementsByTagName("tr"),t=2;t<e.length;t+=2){e[t].style.backgroundColor="";for(var n=e[t].getElementsByTagName("td"),a=0;a<n.length;a++)n[a].style.backgroundColor=""}}}),t("wptb-table-header-bg",0),jQuery("#wptb-table-header-bg").wpColorPicker({change:function(e,t){l.getElementsByTagName("tr")[0].style.backgroundColor=t.color.toString()},clear:function(){var e=l.getElementsByTagName("tr")[0];e.style.backgroundColor="";for(var t=e.getElementsByTagName("td"),n=0;n<t.length;n++)t[n].style.backgroundColor=""}}),function(){var e=document.getElementsByClassName("wptb-preview-table");if(0<e.length){var t=e[0].style.borderColor;if(t){var n=document.getElementById("wptb-table-border-color");n&&(n.value=t)}var a=e[0].style.borderWidth;if(a){var r=document.getElementById("wptb-table-border-slider"),l=document.getElementById("wptb-table-border-number");r&&(r.value=parseInt(a)),l&&(l.value=parseInt(a))}var o=e[0].querySelector("td").style.borderWidth;if(o){var s=document.getElementById("wptb-inner-border-check"),i=document.getElementById("wptb-apply-inner-border");if(o&&0<parseInt(o)){if(s&&(s.checked=!0,i)){i.classList.add("visible");var d=document.getElementById("wptb-table-inner-border-slider"),c=document.getElementById("wptb-table-inner-border-number");d.value=parseInt(o),c.value=parseInt(o)}}else s.checked=!1}(a&&0<parseInt(a)||o&&0<parseInt(o))&&(document.getElementById("wptb-table-border-color-set-area").style.display="")}}(),jQuery("#wptb-table-border-color").wpColorPicker({change:function(e,t){var n=l.getElementsByTagName("td");l.style.border=document.querySelector("#wptb-table-border-number").value+"px solid "+t.color.toString();for(var a=0;a<n.length;a++){var r=document.querySelector("#wptb-table-inner-border-number").value;document.getElementById("wptb-inner-border-check").checked&&(n[a].style.border=(0!=r?r:1)+"px solid "+t.color.toString())}},clear:function(){var e=l.getElementsByTagName("td");l.style.borderColor="";for(var t=0;t<e.length;t++)e[t].style.borderColor=""}}),function(){var e=document.getElementsByClassName("wptb-preview-table");if(0<e.length){var t=e[0].querySelector("td");if(t){var n=t.style.padding;if(n){var a=document.getElementById("wptb-table-cell-slider"),r=document.getElementById("wptb-table-cell-number");a&&(a.value=parseInt(n)),r&&(r.value=parseInt(n))}}}}(),document.getElementById("wptb-table-cell-slider").oninput=function(){document.getElementById("wptb-table-cell-number").value=this.value,a(this.value)},document.getElementById("wptb-table-cell-number").onchange=function(){document.getElementById("wptb-table-cell-slider").value=this.value,a(this.value)},document.getElementById("wptb-table-border-slider").oninput=function(){document.getElementById("wptb-table-border-number").value=this.value,r(this.value);var e=document.getElementById("wptb-inner-border-check").checked,t=document.getElementById("wptb-table-border-color-set-area");console.log(e),console.log(this.value),0==this.value&&0==e?t.style.display="none":t.style.display=""},document.getElementById("wptb-table-border-number").onchange=function(){document.getElementById("wptb-table-border-slider").value=this.value,r(this.value)},document.getElementById("wptb-table-inner-border-slider").oninput=function(){document.getElementById("wptb-table-inner-border-number").value=this.value,n(this.value)},document.getElementById("wptb-table-inner-border-number").onchange=function(){document.getElementById("wptb-table-inner-border-slider").value=this.value,n(this.value)},document.getElementById("wptb-inner-border-check").onchange=function(){var e=this.checked?"checked":"unchecked";!function(e){var t=null!=document.querySelector("#wptb-table-border-color").value?document.querySelector("#wptb-table-border-color").value:"rgb(0,0,0)";0!=document.querySelector("#wptb-table-inner-border-slider").value&&0!=document.querySelector("#wptb-table-inner-border-number").value||(document.querySelector("#wptb-table-inner-border-slider").value=1,document.querySelector("#wptb-table-inner-border-number").value=1);var n=document.querySelector("#wptb-table-inner-border-slider").value+"px";if("checked"==e){document.getElementById("wptb-apply-inner-border").style.marginBottom="0px";for(var a=document.getElementsByClassName("wptb-preview-table")[0].getElementsByTagName("td"),r=0;r<a.length;r++)a[r].style.border=n+" solid "+t;document.getElementById("wptb-apply-inner-border").classList.add("visible")}else for(document.getElementById("wptb-apply-inner-border").classList.remove("visible"),a=document.getElementsByClassName("wptb-preview-table")[0].getElementsByTagName("td"),r=0;r<a.length;r++)a[r].style.border="0px solid "+t}(e);var t=document.getElementById("wptb-table-border-slider").value,n=document.getElementById("wptb-table-border-color-set-area");n.style.display="unchecked"==e&&0==t?"none":""};for(var o=0;o<e.length;o++)e[o].ondragstart=function(e){e.dataTransfer.setData("wptbElement",this.dataset.wptbElement)};document.getElementById("wptb-activate-cell-management-mode").onclick=l.toggleTableEditMode,document.getElementById("wptb-table-edit-mode-close").onclick=l.toggleTableEditMode,document.getElementById("wptb-left-scroll-panel-curtain-close").onclick=l.toggleTableEditMode,document.getElementById("wptb-add-end-row").onclick=l.addRowToTheEnd,document.getElementById("wptb-add-start-row").onclick=l.addRowToTheStart,document.getElementById("wptb-add-row-before").onclick=l.addRowBefore,document.getElementById("wptb-add-row-after").onclick=l.addRowAfter,document.getElementById("wptb-add-end-column").onclick=l.addColumnEnd,document.getElementById("wptb-add-start-column").onclick=l.addColumnStart,document.getElementById("wptb-add-column-before").onclick=l.addColumnBefore,document.getElementById("wptb-add-column-after").onclick=l.addColumnAfter,document.getElementById("wptb-delete-column").onclick=l.deleteColumn,document.getElementById("wptb-delete-row").onclick=l.deleteRow,document.getElementById("wptb-merge-cells").onclick=l.mergeCells,document.getElementById("wptb-split-cell").onclick=l.splitCell,document.getElementById("add-elements").onclick=function(){document.getElementById("element-options").getElementsByTagName("a")[0].classList.remove("active"),document.getElementById("add-elements").getElementsByTagName("a")[0].classList.add("active"),document.getElementsByClassName("wptb-elements-container")[0].style.display="table",document.getElementsByClassName("wptb-settings-section")[0].style.display="block",document.getElementById("element-options-group").style.display="none"}},WPTB_List=function(e,t){var n,a=document.createElement("ul"),r=document.createElement("div"),l=void 0,o=!1;if(r.classList.add("wptb-list-item-container"),this.kind="list",""===e);else if(e){var s=t.className.match(/wptb-element-((.+-)\d+)/i);s&&Array.isArray(s)&&(l=s[1],o=!0);for(d=0;d<e.length;d++){var i=t.querySelector("li");n=new WPTB_ListItem(e[d],i,!0),a.appendChild(n.getDOMElement())}}else for(var d=0;d<3;d++)n=new WPTB_ListItem("List Item "+(d+1)),a.appendChild(n.getDOMElement());return r.appendChild(a),this.getDOMElement=function(){return r},applyGenericItemSettings(this,l,o),this},WPTB_ListItem=function r(e,t,n){var a=void 0;if(null==t||t&&n){null==e&&(e="New List Item");var l=document.createElement("li");if((s=document.createElement("div")).classList.add("wptb-list-item-content"),t){var o=t.getAttribute("style");o&&l.setAttribute("style",o)}l.appendChild(s),s.innerHTML=e,s.onkeyup=window.listItemKeyListener,a=!0}else{var s;(s=(l=t).getElementsByClassName("wptb-list-item-content")[0]).onkeyup=window.listItemKeyListener,a=!1}if(l.onmouseenter=function(e){var t=document.createElement("span"),n=document.createElement("span"),a=document.createElement("span");a.classList.add("wptb-actions"),t.classList.add("dashicons","dashicons-trash","delete-action"),n.classList.add("dashicons","dashicons-admin-page","duplicate-action"),this.classList.add("wptb-directlyhovered"),t.onclick=function(){var e=this.parentNode,t=this.parentNode.parentNode,n=t.parentNode;t.removeChild(e),n.removeChild(t)},n.onclick=function(e){var t=e.target.parentNode.parentNode,n=t.querySelector(".wptb-list-item-content").innerHTML,a=new r(n,t,!0);t.parentNode.insertBefore(a.getDOMElement(),l)},a.append(n,t),this.appendChild(a)},l.onmouseleave=function(e){this.classList.remove("wptb-directlyhovered");for(var t=0;e.target.querySelector(".wptb-actions")&&t<5;)e.target.querySelector(".wptb-actions").remove(),t++},s.onkeydown=function(e){var t,n=null!=e.which?e.which:e.keyCode,a=e.target.parentNode;if(13===n&&(void 0===window.dontAddItems||!0!==window.dontAddItems))return e.preventDefault(),t=new r(this.innerHTML,a,!0),l.parentNode.insertBefore(t.getDOMElement(),l),setTimeout(function(){s.innerHTML="New List Item"},5),!1},this.getDOMElement=function(){return l},a)return this},MultipleSelect=function(){var r=[],n=!1;return this.activateMultipleSelectMode=function(){r=[];for(var e=document.getElementsByClassName("wptb-preview-table")[0].getElementsByTagName("td"),t=0;t<e.length;t++)e[t].classList.remove("wptb-highlighted");n=!0},this.deactivateMultipleSelectMode=function(){n=!1},this.isActivated=function(){return n},this.pushSelectedCell=function(e){n&&(r.push(e),e.classList.add("wptb-highlighted"))},this.selectedCells=function(){return r},this.flushSelectedCells=function(){r=[]},this.getFirst=function(){for(var e,t=1e3,n=1e3,a=r.length-1;0<=a;a--)t>=r[a].dataset.xIndex&&n>=r[a].dataset.yIndex&&(e=r[a],t=r[a].dataset.xIndex,n=r[a].dataset.yIndex);return e},this.getLast=function(){for(var e,t=-1,n=-1,a=r.length-1;0<=a;a--)t<=r[a].dataset.xIndex&&n<=r[a].dataset.yIndex&&(e=r[a],t=r[a].dataset.xIndex,n=r[a].dataset.yIndex);return e},this.removeAllButFirst=function(){for(var e=this.getFirst(),t=1;t<r.length;t++)r[t].classList.add("wptb-fused-cell-"+e.dataset.xIndex+"-"+e.dataset.yIndex)},this},WPTB_Parser=function e(t){if(Array.isArray(t)){var n=void 0;if(1==t.length)return n.appendChild(document.createTextNode(t[0]));if(0 in t){var a=t[0];if(n=document.createElement(a),1 in t&&Array.isArray(t[1]))for(var r=t[1],l=0;l<r.length;l++)Array.isArray(r[l])&&n.setAttribute(r[l][0],r[l][1]);if(2 in t)if(Array.isArray(t[2]))for(var o=0;o<t[2].length;o++)"string"!=typeof t[2][o]||"p"!=a.toLowerCase()?e(t[2][o])&&n.appendChild(e(t[2][o])):n.appendChild(document.createTextNode(t[2][o]));else"string"==typeof t[2]&&n.appendChild(document.createTextNode(t[2]))}return n}return!1},WPTB_Settings=function(){var e=document.getElementsByClassName("wptb-element");for(var t=0;t<e.length;t++)e[t].ondragstart=function(e){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("wptbElement",e.target.dataset.wptbElement)},e[t].ondragend=function(){var e=document.querySelector(".wptb-drop-handle"),t=document.querySelector(".wptb-drop-border-marker");(e||t)&&(e.style.display="none",t.style.display="none")};document.getElementsByClassName("wptb-save-btn")[0].onclick=function(){var e=document.querySelector(".edit-bar");e&&e.classList.contains("visible")&&document.getElementsByClassName("wptb-preview-table")[0].toggleTableEditMode();var n=new XMLHttpRequest,t=ajaxurl+"?action=save_table",a=document.getElementById("wptb-setup-name").value.trim(),r=void 0,l=document.getElementsByClassName("wptb-preview-table")[0];if(console.log(l),""===a)return(r=document.getElementById("wptb-messaging-area")).innerHTML='<div class="wptb-error wptb-message">Error: You must assign a name to the table before saving it.</div>',r.classList.add("wptb-warning"),void setTimeout(function(){r.removeChild(r.firstChild)},4e3);l=JSON.stringify(l),console.log(l);var o,s,i="title="+a+"&content="+l;((rs=(o=window.location.href,!!(s=new RegExp("[?&]table(=([^&#]*)|&|#|$)").exec(o))&&(s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"")))||(rs=document.wptbId))&&(i+="&id="+rs),n.open("POST",t,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(e){if(4==this.readyState&&200==this.status){var t=JSON.parse(n.responseText);r=document.getElementById("wptb-messaging-area"),"saved"==t[0]?(document.wptbId=t[1],r.innerHTML='<div class="wptb-success wptb-message">Table "'+a+'" was successfully saved.</div>'):r.innerHTML='<div class="wptb-success wptb-message">Table "'+a+'" was successfully updated.</div>',r.classList.add("wptb-success"),setTimeout(function(){r.removeChild(r.firstChild)},4e3)}},n.send(i)}},WPTB_Space=function s(e){var t=void 0;if(e?t=e:(t=document.createElement("div")).classList.add("wptb-space-between"),t.ondragenter=function(){this.classList.add("visible")},t.ondragover=function(e){e.preventDefault()},t.ondragleave=function(){this.classList.remove("visible")},t.ondrop=function(e){e.stopPropagation();for(var t,n,a,r,l=e.target.nextSibling,o=e.target;!o.classList.contains("wptb-droppable");)o=o.parentNode;e.dataTransfer.getData("wptbElement")?(t=(r=e.dataTransfer.getData("wptbElement")).includes("list")?new WPTB_List:r.includes("image")?new WPTB_Image:r.includes("text")?new WPTB_Text:r.includes("button")?new WPTB_Button:void 0,this.classList.remove("visible"),null==l?(o.appendChild(t.getDOMElement()),o.appendChild(new s)):(o.insertBefore(t.getDOMElement(),l),o.insertBefore(new s,l))):(alert(e.dataTransfer.getData("node")),n=(t=document.getElementsByClassName(e.dataTransfer.getData("node"))[0]).nextSibling,a=t.parentNode,null!=n&&a.removeChild(n),null==l?(o.appendChild(t),o.appendChild(new s)):(o.insertBefore(t,l),o.insertBefore(new s,l))),this.classList.remove("visible")},!e)return t};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var WPTB_Stringifier=function e(t){1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(null==t)return"";if(null==t.tagName&&3==t.nodeType)return t.nodeValue;var n=[],a=void 0,r=!1,l=[].concat(_toConsumableArray(t.attributes)),o=[],s=[];if((t.parentNode.classList.contains("wptb-list-item-content")||t.parentNode.classList.contains("mce-content-body"))&&"p"==t.tagName.toLowerCase()?(a=t.childNodes,r=!0):a=0<t.children.length?t.children:t.childNodes,0<l.length)for(var i=0;i<l.length;i++)o[i]=[l[i].name,l[i].value];else o="";if(0<a.length)for(var d=0;d<a.length;d++){var c=e(a[d]);Array.isArray(c)||r?s[d]=c:"string"==typeof c&&c&&(s=c)}else s="";return n.push(t.tagName.toLowerCase(),o,s),n},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},array=[],WPTB_Table=function(e,t){var w,n,a,f,r=document.getElementsByClassName("wptb-settings-items"),l=document.getElementsByClassName("wptb-table-setup")[0],E=function(e){var t,n=this.rowSpan,a=this.colSpan,r=document.getElementsByClassName("no-cell-action"),l=document.getElementsByClassName("single-action"),o=document.getElementsByClassName("multiple-select-action"),s=C(this),i=s[0],d=s[1];if(document.select.isActivated()){if(this.className.match(/wptb-highlighted/)){this.classList.remove("wptb-highlighted");for(var c=0;c<n;c++)for(var m=0;m<a;m++)array[i+c][d+m]=0}else{this.classList.add("wptb-highlighted");for(c=0;c<n;c++)for(m=0;m<a;m++)array[i+c][d+m]=1}if(0===(t=document.getElementsByClassName("wptb-highlighted").length)){for(c=0;c<o.length;c++)o[c].classList.remove("visible"),o[c].setAttribute("disabled","disabled");for(c=0;c<r.length;c++)r[c].classList.add("visible"),r[c].removeAttribute("disabled");for(c=0;c<l.length;c++)l[c].classList.remove("visible"),l[c].setAttribute("disabled","disabled")}else if(1===t){for(c=0;c<o.length;c++)o[c].classList.remove("visible"),o[c].setAttribute("disabled","disabled");for(c=0;c<r.length;c++)r[c].classList.remove("visible"),r[c].setAttribute("disabled","disabled");for(c=0;c<l.length;c++)l[c].classList.add("visible"),l[c].removeAttribute("disabled")}else{for(c=0;c<o.length;c++)w.isSquare(array)?(o[c].classList.add("visible"),o[c].removeAttribute("disabled")):(o[c].classList.remove("visible"),o[c].setAttribute("disabled","disabled"));for(c=0;c<r.length;c++)r[c].classList.remove("visible"),r[c].setAttribute("disabled","disabled");for(c=0;c<l.length;c++)l[c].classList.remove("visible"),l[c].setAttribute("disabled","disabled")}}},B=function(e){for(var t=0;t<e.length;t++){for(var n=0;n<e[t].length;n++)" "+e[t][n];"\n"}w.isSquare(e)},N=function(){for(var e=document.getElementsByClassName("no-cell-action"),t=document.getElementsByClassName("single-action"),n=document.getElementsByClassName("multiple-select-action"),a=w.getElementsByClassName("wptb-highlighted");a.length;)a[0].classList.remove("wptb-highlighted");for(var r=0;r<array.length;r++)for(var l=0;l<array[r].length;l++)array[r][l]=0;for(r=0;r<n.length;r++)n[r].classList.remove("visible"),n[r].setAttribute("disabled","disabled");for(r=0;r<e.length;r++)e[r].classList.add("visible"),e[r].removeAttribute("disabled");for(r=0;r<t.length;r++)t[r].classList.remove("visible"),t[r].setAttribute("disabled","disabled")},C=function(e){for(var t=[],n=0;n<f;n++)t[n]=0;for(n=0;n<w.rows.length;n++)for(var a=w.rows[n].getElementsByTagName("td"),r=cellPointer=0;r<f;r+=stepsToMove)if(stepsToMove=1,t[r])t[r]--;else{var l=a[cellPointer++];if(l==e)return[n,r];if(1<l.rowSpan){for(var o=0;o<l.colSpan;o++)t[r+o]=l.rowSpan-1;stepsToMove=l.colSpan}else 1<l.colSpan&&(stepsToMove=l.colSpan)}};if(jQuery("#wptb-table-header-bg").val(""),jQuery("#wptb-even-row-bg").val(""),jQuery("#wptb-odd-row-bg").val(""),jQuery("#wptb-table-border-color").val(""),jQuery("#wptb-table-inner-border-number,#wptb-table-inner-border-slider").val("0"),jQuery("#wptb-table-border-number,#wptb-table-border-slider").val("0"),jQuery("#wptb-table-padding-number,#wptb-table-padding-slider").val("15"),e||t){for(var o=0;o<r.length;o++)"wptb-apply-inner-border"!==r[o].id&&r[o].classList.add("visible");(w=document.createElement("table")).classList.add("wptb-preview-table"),(n=w.insertRow(-1)).classList.add("wptb-table-head","wptb-row");for(o=0;o<e;o++)(a=new WPTB_Cell(E)).setCoords(0,o),n.appendChild(a.getDOMElement());for(o=1;o<t;o++){(n=w.insertRow(-1)).classList.add("wptb-row");for(var b=0;b<e;b++)(a=new WPTB_Cell(E)).setCoords(o,b),n.appendChild(a.getDOMElement())}}else{var s=document.getElementsByClassName("wptb-preview-table");if(0<s.length){var i=(w=s[0]).getElementsByTagName("td");if(0<i.length)for(var d=0;d<i.length;d++)WPTB_Cell(E,i[d])}}w.toggleTableEditMode=function(){var e=document.getElementsByClassName("edit-bar"),t=document.getElementById("cell_mode_background"),n=document.getElementById("wptb-left-scroll-panel-curtain"),a=document.getElementsByClassName("wptb-preview-table");if(0<a.length&&(a=a[0]),0<e.length)for(var r=0;r<e.length;r++)if(e[r].classList.contains("visible")){document.select.deactivateMultipleSelectMode(),e[r].classList.remove("visible"),t.classList.remove("visible"),n.classList.remove("visible"),a.classList.remove("wptb-preview-table-manage-cells");var l=a.getElementsByTagName("td");if(0<l.length)for(var o=0;o<l.length;o++)l[o].classList.remove("wptb-highlighted")}else document.select.activateMultipleSelectMode(),e[r].classList.add("visible"),t.classList.add("visible"),n.classList.add("visible"),a.classList.add("wptb-preview-table-manage-cells")},w.recalculateIndexes=function(){for(var e=this.getElementsByTagName("tr"),t=void 0,n=0,a=[],r=0;r<e.length;r++){0==r?(e[r].style.backgroundColor=jQuery("#wptb-table-header-bg").val(),e[r].classList.add("wptb-table-head")):(e[r].style.backgroundColor=r%2==0?jQuery("#wptb-odd-row-bg").val():jQuery("#wptb-even-row-bg").val(),e[r].classList.remove("wptb-table-head")),a[r],t=e[r].getElementsByTagName("td"),null==a[r]&&(a[r]=[]);for(var l=0,o=0;o<t.length;o++){if(null!=a[r][o])for(var s=0;s<100;s++){if(null==a[r][l]){a[r][l]=t[o],t[o].dataset.xIndex=l;break}l++}else a[r][o]=t[o],t[o].dataset.xIndex=l;if(t[o].dataset.yIndex=r,1<t[o].colSpan)for(var i=1;i<t[o].colSpan;i++)l++,a[r][l]="tdDummy";if(1<t[o].rowSpan)for(var d=1;d<t[o].rowSpan;d++){null==a[r+d]&&(a[r+d]=[]);for(var c=0;c<t[o].colSpan;c++)a[r+d][l-t[o].colSpan+1+c]="tdDummy"}l++}n<o&&(n=o)}this.columns=n},w.addColumnEnd=function(){var e=void 0,t=document.getElementsByClassName("wptb-preview-table"),n=void 0,a=void 0;0<t.length&&(n=t[0].querySelector("td")),n&&(a=n.getAttribute("style"));for(var r=0;r<w.rows.length;r++)e=new WPTB_Cell(E),a&&e.getDOMElement().setAttribute("style",a),w.rows[r].appendChild(e.getDOMElement()),array[r].push(0);f++,w.recalculateIndexes(),N()},w.addColumnStart=function(){var e=void 0,t=void 0,n=document.getElementsByClassName("wptb-preview-table"),a=void 0,r=void 0;0<n.length&&(a=n[0].querySelector("td")),a&&(r=a.getAttribute("style"));for(var l=0;l<w.rows.length;l++)e=new WPTB_Cell(E),r&&e.getDOMElement().setAttribute("style",r),(t=w.rows[l].getElementsByTagName("td")[0])?w.rows[l].insertBefore(e.getDOMElement(),t):w.rows[l].appendChild(e.getDOMElement()),array[l].push(0);f++,w.recalculateIndexes(),N()},w.addColumnAfter=function(e){for(var t=w.rows,n=void 0,a=void 0,r=document.querySelector(".wptb-highlighted"),l=r.getAttribute("style"),o=null!=e&&"number"==typeof e?e:C(r)[1],s=!1,i=void 0,d=void 0,c=void 0,m=[],p=void 0,u=0;u<f;u++)m.push(0);for(u=0;u<t.length;u++){n=0,a=t[u].getElementsByTagName("td"),s=!1;for(var g=0;g<f;g+=i){if(i=1,s){d=new WPTB_Cell(E),l&&d.getDOMElement().setAttribute("style",l),p&&t[u].contains(p)?(c=p.nextSibling)?t[u].insertBefore(d.getDOMElement(),c):t[u].appendChild(d.getDOMElement()):t[u].insertBefore(d.getDOMElement(),a[0]);break}if(0<m[g])o==g&&(s=!0);else if(1<(p=a[n++]).rowSpan){i=p.colSpan;for(var b=0;b<p.colSpan;b++)m[g+b]=p.rowSpan,g+b==o&&(s=!0)}else if(1<p.colSpan){i=p.colSpan;for(b=0;b<p.colSpan;b++)g+b==o&&(s=!0)}else g==o&&(s=!0)}for(var y=0;y<f;y++)0<m[y]&&m[y]--}for(u=0;u<array.length;u++)array[u].push(0);f++,B(array),w.recalculateIndexes(),N()},w.addColumnBefore=function(){var e=document.querySelector(".wptb-highlighted"),t=C(e)[1];0===t?w.addColumnStart():w.addColumnAfter(t-1)},w.addRowToTheEnd=function(){var e,t=w.insertRow(-1),n=void 0,a=document.getElementsByClassName("wptb-preview-table"),r=void 0,l=void 0;t.classList.add("wptb-row"),0<a.length&&(r=a[0].querySelector("td")),r&&(l=r.getAttribute("style"));for(var o=0;o<f;o++)n=new WPTB_Cell(E),l&&n.getDOMElement().setAttribute("style",l),t.appendChild(n.getDOMElement());e=Array.from(array[0]),array.push(e),B(array),w.recalculateIndexes(),N()},w.addRowToTheStart=function(){var e,t=w.insertRow(0),n=void 0,a=document.getElementsByClassName("wptb-preview-table"),r=void 0,l=void 0;t.classList.add("wptb-row"),0<a.length&&(r=a[0].querySelector("td")),r&&(l=r.getAttribute("style"));for(var o=0;o<f;o++)n=new WPTB_Cell(E),l&&n.getDOMElement().setAttribute("style",l),t.appendChild(n.getDOMElement());e=Array.from(array[0]),array.push(e),B(array),w.recalculateIndexes(),N()},w.addRowBefore=function(){for(var e=document.querySelector(".wptb-highlighted"),t=e.getAttribute("style"),n=C(e)[0],a=void 0,r=n-1;0<=r;r--){var l=w.rows[r].children,o=l.length;if(0<o)for(var s=0;s<o;s++)if(1==l[s].rowSpan){n=r,a=!0;break}if(a)break}0===n?w.addRowToTheStart():w.addRowAfter(n,t)},w.addRowAfter=function(e,t){var n,a=void 0;if(null!=e&&"number"==typeof e||null!=t)a=e;else{var r=document.querySelector(".wptb-highlighted");t=r.getAttribute("style"),a=(e=C(r)[0])+r.rowSpan-1}var l=0;if(a<w.rows.length-1){for(var o=0;o<=a;o++){var s=w.rows[o].children,i=s.length;if(0<i)for(var d=0;d<i;d++){a<s[d].rowSpan-1+o&&s[d].rowSpan++}}var c=w.rows[a+1].children,m=c.length;if(0<m)for(var p=0;p<m;p++)l+=c[p].colSpan}else l=array[0].length;var u=w.insertRow(a+1);for(u.classList.add("wptb-row"),b=0;b<l;b++){var g=new WPTB_Cell(E);g.getDOMElement().setAttribute("style",t),u.appendChild(g.getDOMElement())}n=Array.from(array[0]),array.push(n),B(array),w.recalculateIndexes(),N()},w.isSquare=function(e){for(var t,n,a=-1,r=-1,l=-1,o=-1,s=0,i=0;i<e.length;i++)for(var d=0;d<e[i].length;d++)1==e[i][d]&&((d<r||-1==r)&&(r=d),(i<a||-1==a)&&(a=i));for(i=e.length-1;-1<i;i--)for(d=e[i].length-1;-1<d;d--)1==e[i][d]&&(o<d&&(o=d),l<i&&(l=i));for(i=a;i<l;i++)for(d=r;d<o;d++)if(0==e[i][d]||null==e[i][d])return!1;for(i=0;i<e.length;i++)for(d=0;d<e[i].length;d++)1==e[i][d]&&s++;return(t=l-a+1)*(n=o-r+1)===s&&[t,n]},w.mergeCells=function(){for(var e=w.isSquare(array),t=e[0],n=e[1],a=document.querySelector(".wptb-highlighted"),r=[].slice.call(document.getElementsByClassName("wptb-highlighted"),1),l=[],o=0;o<r.length;o++){var s=r[o].getElementsByClassName("wptb-ph-element");if(0<s.length)for(var i=s.length,d=0;d<i;d++)l.push(s[d]);r[o].parentNode.removeChild(r[o])}if(0<l.length)for(var c=0;c<l.length;c++)a.appendChild(l[c]);a.colSpan=n,a.rowSpan=t,w.recalculateIndexes(),N()},w.splitCell=function(){var e=document.getElementsByClassName("wptb-highlighted")[0],t=e.rowSpan,n=e.colSpan,a=e.getAttribute("style"),r=C(e)[0],l=w.rows[r],o=e.dataset.xIndex;e.rowSpan=1;for(var s=e.colSpan=1;s<n;s++){var i=new WPTB_Cell(E);i.getDOMElement().setAttribute("style",a),e.nextSibling?l.insertBefore(i.getDOMElement(),e.nextSibling):l.appendChild(i.getDOMElement())}if(1<t)for(var d=1;d<t;d++){var c=void 0,m=w.rows[r+d],p=m.children,u=p.length;if(0<u)for(var g=0;g<u;g++)if(Number(p[g].dataset.xIndex)>Number(o)){c=p[g];break}for(var b=0;b<n;b++){var y=new WPTB_Cell(E);y.getDOMElement().setAttribute("style",a),null!=c?m.insertBefore(y.getDOMElement(),c):m.appendChild(y.getDOMElement())}}w.recalculateIndexes(),N()},w.findRowspannedCells=function(e){var t,n=[];if(actualPoints=function(e){for(var t=w.rows[e].getElementsByTagName("td"),n=0,a=0;a<t.length;a++)n+=t[a].colSpan;return n}(e),actualPoints===f)return[];t=f-actualPoints;for(var a=e-1;0<=a&&t;a--){var r=w.rows[a].getElementsByTagName("td");for(a=0;a<r.length;a++)1<r[a].rowSpan&&(n.push(r[a]),t-=r[a].colSpan)}return n},w.addLackingCells=function(){for(var e=[],t=0;t<w.rows.length;t++)e.push(0);for(t=0;t<w.rows.length;t++)for(var n=w.rows[t].getElementsByTagName("td"),a=0;a<n.length;a++)if(1<n[a].rowSpan)for(var r=1;r<n[a].rowSpan;r++)e[t+r]++;for(t=0;t<w.rows.length;t++){n=w.rows[t].getElementsByTagName("td");var l=0;for(a=0;a<n.length;a++)l+=n[a].colSpan;l+=e[t],difference=f-l;for(a=0;a<difference;a++){var o=new WPTB_Cell(E);w.rows[t].appendChild(o.getDOMElement())}}},w.deleteRow=function(){var e=document.querySelector(".wptb-highlighted"),t=e.getAttribute("style"),n=e.rowSpan,a=C(e)[0],r=void 0;null==n&&(n=1);for(var l=0;l<n;l++){var o=w.rows[a].children,s=w.rows[a+1],i=void 0,d=void 0,c=[];if(null!=s){d=(i=s.children).length;for(var m=0;m<o.length;m++)if(1<o[m].rowSpan){var p=new WPTB_Cell(E);p.getDOMElement().setAttribute("style",t),p.getDOMElement().colSpan=o[m].colSpan,p.getDOMElement().rowSpan=o[m].rowSpan-1;for(var u=void 0,g=0;g<d;g++)if(Number(i[g].dataset.xIndex)>Number(o[m].dataset.xIndex)){u=i[g];break}u?c.push([p,u]):c.push([p])}if(0<c.length)for(var b=0;b<c.length;b++)null!=c[b][1]?s.insertBefore(c[b][0].getDOMElement(),c[b][1]):s.appendChild(c[b][0].getDOMElement())}var y=w.rows;if(0<y.length)for(var f=0;f<a;f++){var v=y[f].children;if(0<v.length)for(var h=0;h<v.length;h++)v[h].rowSpan-1>=a-f&&v[h].rowSpan--}r=Array.from(array[0]),array.pop(r),B(array),w.getElementsByTagName("tbody")[0].removeChild(w.rows[a]),w.recalculateIndexes(),console.log(array)}N()},w.deleteColumn=function(){for(var e=document.querySelector(".wptb-highlighted"),t=e.dataset.xIndex,n=e.colSpan,a=0;a<n;a++){for(var r=0;r<w.rows.length;r++){var l=w.rows[r].children,o=l.length;if(0<o)for(var s=o-1;0<=s;s--){if(Number(l[s].dataset.xIndex)==Number(t)){1<l[s].colSpan?l[s].colSpan--:w.rows[r].removeChild(l[s]);break}if(Number(l[s].dataset.xIndex)<Number(t)&&Number(l[s].dataset.xIndex)+Number(l[s].colSpan-1)>=t){1<l[s].colSpan&&l[s].colSpan--;break}}}for(var i=0;i<w.rows.length;i++)null!=array[i]&&array[i].pop();f--,w.recalculateIndexes()}N()},document.getElementsByClassName("wptb-table-generator")[0].style.display="none",array=function(){for(var e=[],t=[],n=0;n<w.rows.length;n++){for(var a=w.rows[n].getElementsByTagName("td"),r=0,l=0;l<a.length;l++)r+=a[l].colSpan;e.push(r)}f=Math.max.apply(null,e);var o=w.rows.length;for(n=0;n<o;n++)for(t[n]=[],l=0;l<f;l++)t[n].push(0);return B(t),t}(),N(),B(array),l.appendChild(w),(e||t)&&w.recalculateIndexes(),WPTB_LeftPanel()};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var WPTB_Text=function(e,t){var n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("p"),l=void 0,o=!1;if(a.classList.add("editable"),r.innerHTML=null!=e?e:"Text",a.appendChild(r),n.appendChild(a),t){var s=t.className.match(/wptb-element-((.+-)\d+)/i);s&&Array.isArray(s)&&(l=s[1],o=!0);for(var i=[].concat(_toConsumableArray(t.attributes)),d=0;d<i.length;d++)n.setAttribute(i[d].name,i[d].value)}return this.kind="text",this.getDOMElement=function(){return n},applyGenericItemSettings(this,l,o),this};