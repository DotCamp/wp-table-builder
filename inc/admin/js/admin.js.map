{"version":3,"sources":["applyGenericItemSettings.js","wptb-builder.js","WPTB_Builder.js","WPTB_Button.js","WPTB_Cell.js","WPTB_ElementCounters.js","WPTB_ElementOptions.js","WPTB_Image.js","WPTB_Initializer.js","WPTB_LeftPanel.js","WPTB_List.js","WPTB_ListItem.js","WPTB_MultipleSelect.js","WPTB_Parser.js","WPTB_Settings.js","WPTB_Space.js","WPTB_Stringifier.js","WPTB_Table.js","WPTB_Text.js"],"names":["applyGenericItemSettings","element","kindIndexProt","node","getDOMElement","index","document","counter","nextIndex","kind","listItems","copy","onmouseenter","event","classList","add","btnDelete","createElement","btnCopy","btnMove","actions","previous","i","draggable","onclick","act","parentNode","el","space","nextSibling","num","space2","removeChild","getElementsByClassName","length","td","target","temp","srcList","querySelectorAll","DOMElement","getElementsByTagName","push","innerHTML","WPTB_List","appendChild","WPTB_Text","childNodes","insertBefore","WPTB_Space","WPTB_Image","children","src","WPTB_Button","ondragstart","parent","infArr","type","className","contains","match","img","dataTransfer","setDragImage","setData","tinyMCE","init","inline","plugins","dialog_type","theme","menubar","fixed_toolbar_container","toolbar","verify_html","setup","ed","on","execCommand","init_instance_callback","editor","e","getContent","trim","setContent","range","selection","getRng","KeyID","keyCode","startOffset","preventDefault","window","currentEditor","totalWidth","offsetWidth","getElementById","scrollTop","bodyElement","style","display","position","right","top","paste_as_text","onmouseleave","formerActions","par","remove","node_wptb_element_kind_num","WPTB_ElementOptions","increment","detectMode","url","location","href","regex","RegExp","results","exec","decodeURIComponent","replace","WPTB_Builder","table_id","http","XMLHttpRequest","ajaxurl","open","setRequestHeader","onreadystatechange","d","readyState","status","ans","JSON","parse","responseText","value","wptbTableSetupEl","WPTB_Parser","WPTB_Table","WPTB_LeftPanel","WPTB_Settings","send","ElementCounters","select","MultipleSelect","initializer","WPTB_Initializer","settings","addEventListener","text","DOMElementProt","elButton2","el_B","undefined","wptbElementMutch","Array","isArray","attributesContainer","attributes","setAttribute","name","wptbButtonWrapper","querySelector","wptbButtonWrapAttributes","wptbButton","wptbButtonAttributes","WPTB_Cell","callback","newElementProxy","highlightRow","parentRow","columnCount","parseInt","tds","classToAdd","ttd","highlightColumn","rowCount","table","tr","padding","jQuery","val","innerBorderWidth","border","ondragenter","div","getData","ondragover","ondragleave","ondrop","classId","t_space","spaceParent","wptbPhElement","wptbSpaceBetween","j","wptbElementTypeClass","wptbTypeElementArr","split","wptbArticle","WPTB_ListItem","setCoords","y","x","dataset","yIndex","xIndex","getCoords","coords","appendElement","priv","key","elemIdClass","prop","cloneNode","properties","affectedEl","wptbSize","b","buttonAlignment","justifyContent","buttonAlignmentSelect","selectOption","selectOptionVal","selected","buttonTextColor","color","buttonColor","backgroundColor","buttonHref","getAttribute","buttonLinkTarget","buttonTextColorInput","buttonBackgroundColorInput","buttonHrefInput","buttonLinkTargetInput","buttonLinkTargetInputId","buttonLinkTargetInputLabel","checked","affectedElChildren","a","tagName","toLowerCase","aTextAlign","textAlign","imageAlignmentSelect","imageLinkHref","inputImageLink","imageLinkTarget","imageLinkTargetInput","imageLinkTargetInputId","imageLinkTargetInputLabel","imgWidth","width","imageWidthInputRange","imageWidthInputNumber","imgAlternativeText","imageAlternativeTextInput","optionsClass","listStyleType","listJustifyContent","find","wpColorPicker","defaultColor","fontSize","substring","selectedIndex","buttons","size","n_Class","optionControls","change","ui","classe","ps","number","toString","slider","oninput","onchange","alt","height","jc","articles","bullets","anchor","file_frame","wp","media","frames","title","button","multiple","attachment","state","get","first","toJSON","MIN_COLUMNS","MIN_ROWS","MAX_COLUMNS","MAX_ROWS","tableGenerator","body","columnsDecrementButton","columnsIncrementButton","rowsDecrementButton","rowsIncrementButton","columnsInput","rowsInput","columns","rows","wptbElementButtons","hexToRgb","hex","result","tableRows","tableHeader","tableCells","addInnerBorderSize","addCellPadding","addInnerBorder","styles","marginBottom","addBorderSize","_val","wptbElement","toggleTableEditMode","addRowToTheEnd","addRowToTheStart","addRowBefore","addRowAfter","addColumnEnd","addColumnStart","addColumnBefore","addColumnAfter","deleteColumn","deleteRow","mergeCells","splitCell","innerElements","el_L","item","wptbListItemReturn","divdot","divcontent","libullet","styleDot","onkeyup","listItemKeyListener","article","content","html","duplicate","append","onkeydown","which","lastP","dontAddItems","setTimeout","selectedCells","multipleCellMode","activateMultipleSelectMode","deactivateMultipleSelectMode","isActivated","pushSelectedCell","cell","flushSelectedCells","getFirst","minXIndex","minYIndex","getLast","maxXIndex","maxYIndex","last","removeAllButFirst","code","elementHtml","createTextNode","elems","effectAllowed","t","messagingArea","WPTB_Stringifier","firstChild","stringify","params","rs","wptbId","action","data","elSpaceBetween","includes","spaceBetween","stopPropagation","p","alert","start","nodeType","nodeValue","int_elem_arr","attributes_list","internal_elements","inter_elem","array","wptbTableSetup","row","maxAmountOfCells","maxAmountOfRows","mark","rowSpan","cs","colSpan","markedCells","noCells","singleCells","multipleCells","column","isSquare","realTimeArray","carried","cols","matriz","items","k","justAssigned","amount","carriedRowspans","cellsBuffer","cellPointer","xPosition","stepsToMove","celda","drawTable","string","undoSelect","fillTableArray","colspansSums","cells","colspanSumInRow","Math","max","apply","getActualPointsInRow","points","search","skipInCols","id","insertRow","wptb_preview_table","bar","recalculateIndexes","trs","maxCols","firstCell","c_pos","pos","pendingInsertion","bro","currentCell","l","r","aux","from","rowspans","noPending","filter","elem","arr","rowStart","columnStart","rowEnd","columnEnd","itemsEstimate","dimensions","rowspan","colspan","slice","call","addLackingCells","findRowspannedCells","difference","actualPoints","sumRows","totalColspan","reduct","pop","cell_ref","buffer","elText2","elP"],"mappings":"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","file":"admin.js","sourcesContent":["var applyGenericItemSettings = function ( element, kindIndexProt ) {\r\n\tvar node = element.getDOMElement(),\r\n\t    index = document.counter.nextIndex(element.kind),\r\n\t    listItems,\r\n            copy;\r\n\r\n\tnode.onmouseenter = function (event) {\r\n\t\tthis.classList.add('wptb-directlyhovered');\r\n\t\tvar btnDelete = document.createElement('span'),\r\n\t\t    btnCopy = document.createElement('span'),\r\n\t\t    btnMove = document.createElement('span'),\r\n\t\t    actions = document.createElement('span'),\r\n                    previous, i;\r\n\t\tactions.classList.add('wptb-actions');\r\n\t\tbtnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\r\n\t\tbtnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\r\n\t\tbtnMove.classList.add(\"dashicons\", \"dashicons-move\", 'move-action');\r\n\t\tbtnMove.draggable = true;\r\n\t\tbtnDelete.onclick = function (event) {\r\n\t\t\tvar act = this.parentNode.parentNode,\r\n\t\t\t    el = act.parentNode,\r\n\t\t\t    space = act.nextSibling,\r\n                            num, space2;\r\n\t\t\tel.removeChild(act);\r\n\t\t\tel.removeChild(space);\r\n\t\t\tnum = el.getElementsByClassName('wptb-ph-element').length;\r\n\t\t\tif (!num) {\r\n\t\t\t\tspace2 = el.getElementsByClassName('wptb-space-between')[0];\r\n\t\t\t\tif (space2) {\r\n\t\t\t\t\tel.removeChild(space2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tbtnCopy.onclick = function (event) {\r\n\t\t\tif (element.kind == 'list') {\r\n\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    temp = [],\r\n\t\t\t\t    srcList = event.target.parentNode.parentNode.querySelectorAll('ul article .wptb-list-item-content'),\r\n                                    DOMElement = event.target.parentNode.parentNode.getElementsByTagName( 'article' )[0];\r\n\r\n\t\t\t\tfor (var i = 0; i < srcList.length; i++) {\r\n\t\t\t\t\ttemp.push(srcList[i].innerHTML);\r\n\t\t\t\t}\r\n\t\t\t\tvar copy = new WPTB_List( temp, DOMElement );\r\n\t\t\t\ttd.appendChild( copy.getDOMElement() );\r\n\t\t\t} else if (element.kind == 'text') {\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    copy = new WPTB_Text(event.target.parentNode.parentNode.childNodes[0].innerHTML, node);\r\n                            \r\n\t\t\t\tnode.parentNode.insertBefore( copy.getDOMElement(), node.nextSibling );\r\n                                node.parentNode.insertBefore( new WPTB_Space, copy.getDOMElement() );\r\n\t\t\t} else if ( element.kind == 'image' ) {\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    copy = new WPTB_Image( event.target.parentNode.parentNode.children[0].children[0].src, node );\r\n                            \r\n\t\t\t\tnode.parentNode.insertBefore( copy.getDOMElement(), node.nextSibling );\r\n                                node.parentNode.insertBefore( new WPTB_Space, copy.getDOMElement() );\r\n\t\t\t} else {\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    copy = new WPTB_Button( event.target.parentNode.parentNode.childNodes[0].innerHTML, node );\r\n                            \r\n                                node.parentNode.insertBefore( copy.getDOMElement(), node.nextSibling );\r\n                                node.parentNode.insertBefore( new WPTB_Space, copy.getDOMElement() );\r\n\t\t\t}\r\n\t\t};\r\n\t\tbtnMove.ondragstart = function (event) {\r\n\t\t\tvar parent = this, infArr, type;\r\n\r\n\t\t\twhile (parent.className == '' ||\r\n\t\t\t\t!parent.classList.contains('wptb-ph-element')) {\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t}\r\n\r\n\t\t\tinfArr = parent.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n\t\t\ttype = infArr[1];\r\n\r\n\t\t\tvar img = document.createElement(\"img\");\r\n\t\t\timg.src = \"http://localhost/sandbox/wp-content/plugins/wp-table-builder/inc/admin/views/builder/icons/\" + type + \".png\";\r\n\t\t\tevent.dataTransfer.setDragImage(img, 0, 0);\r\n\t\t\tevent.dataTransfer.setData('node', 'wptb-element-' + infArr[1] + '-' + infArr[2]);\r\n\t\t};\r\n\r\n\t\tif (element.kind === 'button') {\r\n\t\t\ttinyMCE.init({\r\n\t\t\t\ttarget: node.childNodes[0].childNodes[0],\r\n\t\t\t\tinline: true,\r\n\t\t\t\tplugins: \"link\",\r\n\t\t\t\tdialog_type: \"modal\",\r\n\t\t\t\ttheme: 'modern',\r\n\t\t\t\tmenubar: false,\r\n\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t\t\t\ttoolbar: 'bold italic strikethrough',\r\n\t\t\t\tverify_html: false,\r\n\t\t\t\tsetup: function (ed) {\r\n\t\t\t\t\ted.on(\"init\",\r\n\t\t\t\t\t\tfunction (ed) {\r\n\t\t\t\t\t\ttinyMCE.execCommand('mceRepaint');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tinit_instance_callback: function (editor) {\r\n\t\t\t\t\teditor.on('change', function (e) {\r\n\t\t\t\t\t\t// check if it becomes empty because if there's no value it's hard to edit the editor in button element\r\n\t\t\t\t\t\tif (editor.getContent().trim() == \"\") {\r\n\t\t\t\t\t\t\teditor.setContent(\"<a class='wptb-button'>Button Text</a>\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\teditor.on('KeyDown', function (e) {\r\n\t\t\t\t\t\tvar range = editor.selection.getRng();\r\n\t\t\t\t\t\tvar KeyID = e.keyCode;\r\n\t\t\t\t\t\tif (range.startOffset == 0 && (KeyID == 8 || KeyID == 46)) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\teditor.setContent(\"<p class='wptb-button'></p>\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\twindow.currentEditor = editor;\r\n\t\t\t\t\teditor.on('focus', function (e) {\r\n\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t\t\tif (window.currentEditor &&\r\n\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else if (element.kind === 'text') {\r\n\t\t\ttinyMCE.init({\r\n\t\t\t\ttarget: node.childNodes[0],\r\n\t\t\t\tinline: true,\r\n\t\t\t\tplugins: \"link, paste\",\r\n\t\t\t\tdialog_type: \"modal\",\r\n\t\t\t\ttheme: 'modern',\r\n\t\t\t\tmenubar: false,\r\n\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t\t\t\tpaste_as_text: true,\r\n\t\t\t\ttoolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\r\n\t\t\t\tinit_instance_callback: function (editor) {\r\n\t\t\t\t\twindow.currentEditor = editor;\r\n\t\t\t\t\teditor.on('focus', function (e) {\r\n\r\n\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t\t\tif (window.currentEditor &&\r\n\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t} else {\r\n\t\t\tlistItems = node.getElementsByClassName('wptb-list-item-content');\r\n\t\t\tfor (var i = 0; i < listItems.length; i++) {\r\n\t\t\t\ttinyMCE.init({\r\n\t\t\t\t\ttarget: listItems[i],\r\n\t\t\t\t\tinline: true,\r\n\t\t\t\t\tplugins: \"link, paste\",\r\n\t\t\t\t\tdialog_type: \"modal\",\r\n\t\t\t\t\ttheme: 'modern',\r\n\t\t\t\t\tmenubar: false,\r\n\t\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t\t\t\t\tpaste_as_text: true,\r\n\t\t\t\t\ttoolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\r\n\t\t\t\t\tinit_instance_callback: function (editor) {\r\n\t\t\t\t\t\twindow.currentEditor = editor;\r\n\t\t\t\t\t\teditor.on('focus', function (e) {\r\n\t\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t\t\t\tif (window.currentEditor &&\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tactions.appendChild(btnMove);\r\n\t\tactions.appendChild(btnCopy);\r\n\t\tactions.appendChild(btnDelete);\r\n\t\tthis.appendChild(actions);\r\n\t};\r\n\r\n\tnode.onmouseleave = function (event) {\r\n\t\tvar formerActions = this.getElementsByClassName('wptb-actions');\r\n\t\tif (formerActions && formerActions[0]) {\r\n\t\t\tlet par = formerActions[0].parentNode;\r\n\t\t\tpar.removeChild(formerActions[0]);\r\n\t\t}\r\n\t\tthis.classList.remove('wptb-directlyhovered');\r\n\t};\r\n        \r\n        let node_wptb_element_kind_num = node.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n        if ( node_wptb_element_kind_num ) {\r\n            node.classList.remove( node_wptb_element_kind_num[0] );\r\n        }\r\n        if ( ! node.classList.contains( 'wptb-ph-element' ) ) {\r\n            node.classList.add('wptb-ph-element' );\r\n            if( ! node.classList.contains( 'wptb-element-' + element.kind + '-' + index ) ) {\r\n                node.classList.add( 'wptb-element-' + element.kind + '-' + index );\r\n            }\r\n        } else {\r\n            if( ! node.classList.contains( 'wptb-element-' + element.kind + '-' + index ) ) {\r\n                node.classList.add( 'wptb-element-' + element.kind + '-' + index );\r\n            }\r\n        }\r\n\tnew WPTB_ElementOptions( element, index, kindIndexProt );\r\n\r\n\tdocument.counter.increment(element.kind);\r\n\r\n};","","(function () {\r\n\r\n\tfunction detectMode() {\r\n\t\tvar url = window.location.href,\r\n\t\t    regex = new RegExp('[?&]table(=([^&#]*)|&|#|$)'),\r\n\t\t    results = regex.exec(url);\r\n\t\tif (!results) return false;\r\n\t\tif (!results[2]) return '';\r\n\t\treturn decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n\t}\r\n\r\n\tvar WPTB_Builder = function () {\r\n            var table_id = detectMode();\r\n            if (table_id) {\r\n                var http = new XMLHttpRequest(),\r\n                    url = ajaxurl + \"?action=get_table\" + '&id=' + table_id;\r\n                http.open('GET', url, true);\r\n                http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n                http.onreadystatechange = function (d) {\r\n                    if (this.readyState == 4 && this.status == 200) {\r\n                        var ans = JSON.parse(http.responseText);\r\n                        document.getElementById('wptb-setup-name').value = ans[0];\r\n                        document.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\r\n                        let wptbTableSetupEl = document.getElementsByClassName('wptb-table-setup')[0];\r\n                        wptbTableSetupEl.appendChild( WPTB_Parser( ans[1] ) );\r\n                        WPTB_Table();\r\n                        WPTB_LeftPanel();\r\n                        WPTB_Settings();\r\n                        return;\r\n                    }\r\n                };\r\n                http.send(null);\r\n            }\r\n            document.counter = new ElementCounters();\r\n            document.select = new MultipleSelect();\r\n\r\n            var initializer = WPTB_Initializer();\r\n            settings = WPTB_Settings();\r\n\t};\r\n\r\n\tdocument.addEventListener('DOMContentLoaded', WPTB_Builder);\r\n})();","var WPTB_Button = function( text, DOMElementProt ) {\r\n    \r\n    var DOMElement = document.createElement('div'),\r\n        elButton2 = document.createElement('div'),\r\n        el_B = document.createElement('a'),\r\n        kindIndexProt = undefined;\r\n\r\n    DOMElement.classList.add('wptb-button-container', 'wptb-size-M', 'wptb-');\r\n    elButton2.classList.add('wptb-button-wrapper');\r\n    el_B.classList.add('wptb-button');\r\n    el_B.classList.add('editable');\r\n    el_B.classList.add('editable');\r\n    el_B.innerHTML = text != undefined ? text : 'Button Text';\r\n    \r\n    // Creation of a new button when copying to avoid errors when assigning new event handlers.\r\n    if ( DOMElementProt ) {\r\n        let wptbElementMutch = DOMElementProt.className.match( /wptb-element-((.+-)\\d+)/i );\r\n        if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\r\n            kindIndexProt = wptbElementMutch[1];\r\n        }; \r\n        var attributesContainer = [...DOMElementProt.attributes];\r\n        if ( attributesContainer.length > 0 ) {\r\n            for( let i = 0; i < attributesContainer.length; i++ ) {\r\n                DOMElement.setAttribute(attributesContainer[i].name, attributesContainer[i].value);\r\n            } \r\n        }\r\n        \r\n        var wptbButtonWrapper = DOMElementProt.querySelector( '.wptb-button-wrapper' );\r\n        if ( wptbButtonWrapper ) {\r\n            var wptbButtonWrapAttributes = [...wptbButtonWrapper.attributes];\r\n            if ( wptbButtonWrapAttributes.length > 0 ) {\r\n                for( let i = 0; i < wptbButtonWrapAttributes.length; i++ ) {\r\n                    if ( wptbButtonWrapAttributes[i].name == 'style') {\r\n                        elButton2.setAttribute( wptbButtonWrapAttributes[i].name, wptbButtonWrapAttributes[i].value );\r\n                    }\r\n                } \r\n            }\r\n        }\r\n        \r\n        var wptbButton = DOMElementProt.querySelector( '.wptb-button' );\r\n        if ( wptbButton ) {\r\n            var wptbButtonAttributes = [...wptbButton.attributes];\r\n            if ( wptbButtonAttributes.length > 0 ) {\r\n                for( let i = 0; i < wptbButtonAttributes.length; i++ ) {\r\n                    if ( wptbButtonAttributes[i].name == 'style' || \r\n                            wptbButtonAttributes[i].name == 'href' || \r\n                            wptbButtonAttributes[i].name == 'target' ) {\r\n                        el_B.setAttribute( wptbButtonAttributes[i].name, wptbButtonAttributes[i].value );\r\n                    }\r\n                } \r\n            }\r\n        }\r\n    }\r\n    \r\n    elButton2.appendChild(el_B);\r\n    DOMElement.appendChild(elButton2);\r\n    \r\n    this.kind = 'button';\r\n\r\n    this.getDOMElement = function () {\r\n            return DOMElement;\r\n    };\r\n\r\n    applyGenericItemSettings( this, kindIndexProt );\r\n\r\n    return this;\r\n};","var WPTB_Cell = function (callback, DOMElement) {\r\n\r\n    function newElementProxy(el) {\r\n        if (el == 'list') {\r\n            return new WPTB_List();\r\n        } else if (el == 'image') {\r\n            return new WPTB_Image();\r\n        } else if (el == 'text') {\r\n            return new WPTB_Text();\r\n        } else if (el == 'button') {\r\n            return new WPTB_Button();\r\n        }\r\n    }\r\n\r\n    function highlightRow(td) {\r\n        var parentRow = td.parentNode,\r\n            columnCount = parseInt(document.getElementById('wptb-columns-number').value),\r\n            tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n        for (var i = 0; i < tds.length; i++) {\r\n            tds[i].classList.remove('highlighted-row-first', 'highlighted-row-last', 'highlighted-row-inner', 'highlighted-column-first', 'highlighted-column-last', 'highlighted-column-inner');\r\n        }\r\n        for (var i = 0; i < columnCount; i++) {\r\n\r\n            var classToAdd = i == 0 ? 'highlighted-row-first' : i == columnCount - 1 ? 'highlighted-row-last' : 'highlighted-row-inner';\r\n            var ttd = parentRow.getElementsByTagName('td')[i];\r\n            if (ttd !== td) {\r\n                ttd.classList.add(classToAdd);\r\n            }\r\n        }\r\n    }\r\n\r\n    function highlightColumn(td) {\r\n\r\n        var index,\r\n            parentRow = td.parentNode;\r\n        columnCount = parseInt(document.getElementById('wptb-columns-number').value), rowCount = parseInt(document.getElementById('wptb-rows-number').value), table = document.getElementsByClassName('wptb-preview-table')[0];\r\n        for (var i = 0; i < columnCount; i++) {\r\n            if (parentRow.getElementsByTagName('td')[i] === td) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < rowCount; i++) {\r\n            var classToAdd = i == 0 ? 'highlighted-column-first' : i == rowCount - 1 ? 'highlighted-column-last' : 'highlighted-column-inner';\r\n            var tr = table.getElementsByTagName('tr')[i];\r\n            if (tr.getElementsByTagName('td')[index] !== td) {\r\n                tr.getElementsByTagName('td')[index].classList.add(classToAdd);\r\n            }\r\n        }\r\n    }\r\n    \r\n    if( ! DOMElement ) {\r\n        DOMElement = document.createElement(\"td\");\r\n\r\n        DOMElement.style.padding = jQuery('#wptb-table-padding-number').val() + 'px';\r\n\r\n        var innerBorderWidth = jQuery('#wptb-table-inner-border-number').val();\r\n\r\n        if (innerBorderWidth != '' && parseInt(innerBorderWidth) != 0) {\r\n            DOMElement.style.border = innerBorderWidth + 'px solid ' + jQuery('#wptb-table-border-color').val();\r\n        } else {\r\n            DOMElement.style.border = '1px dashed #969fa6';\r\n        }\r\n\r\n        DOMElement.classList.add('wptb-droppable', 'wptb-cell');\r\n    }\r\n\r\n    DOMElement.draggable = false;\r\n    if ( callback ) {\r\n        DOMElement.onclick = callback;\r\n    }\r\n\r\n    DOMElement.ondragenter = function (e) {\r\n        var div;\r\n        if (!e.dataTransfer.getData('wptbElement') && !e.dataTransfer.getData('node')) {\r\n            return;\r\n        }\r\n        this.classList.add('wptb-drop-here-empty');\r\n    };\r\n    \r\n    DOMElement.ondragover = function (e) {\r\n        e.preventDefault();\r\n    };\r\n    \r\n    DOMElement.ondragleave = function () {\r\n        this.classList.remove('wptb-drop-here-empty');\r\n    };\r\n\r\n    DOMElement.ondrop = function (e) {\r\n        var element, classId, space, t_space, spaceParent;\r\n        e.preventDefault();\r\n        space = new WPTB_Space();\r\n\r\n        if (!e.dataTransfer.getData('wptbElement') && !e.dataTransfer.getData('node')) {\r\n            return;\r\n        }\r\n\r\n        if (e.dataTransfer.getData('wptbElement')) {\r\n            element = newElementProxy(e.dataTransfer.getData('wptbElement'));\r\n            if (this.innerHTML == '') {\r\n                this.appendChild(new WPTB_Space());\r\n            }\r\n            this.appendChild(element.getDOMElement());\r\n            this.appendChild(space);\r\n        } else {\r\n            classId = e.dataTransfer.getData('node');\r\n            element = document.getElementsByClassName(classId)[0];\r\n            if (this.innerHTML == '') {\r\n                t_space = element.nextSibling;\r\n                spaceParent = element.parentNode;\r\n                if (t_space != undefined) {\r\n                    spaceParent.removeChild(t_space);\r\n                }\r\n                this.appendChild(new WPTB_Space());\r\n            }\r\n            this.appendChild(element);\r\n            this.appendChild(space);\r\n        }\r\n        this.classList.remove('wptb-drop-here-empty');\r\n        return true;\r\n    };\r\n    \r\n    let wptbPhElement = DOMElement.getElementsByClassName( 'wptb-ph-element' );\r\n                                            \r\n    if ( wptbPhElement.length > 0 ) {\r\n        for( let i = 0; i < wptbPhElement.length; i++ ) {\r\n\r\n            let wptbSpaceBetween = DOMElement.getElementsByClassName( 'wptb-space-between' );\r\n\r\n            if ( wptbSpaceBetween.length > 0 ) {\r\n                for( let j = 0; j < wptbSpaceBetween.length; j++ ) {\r\n                    WPTB_Space( wptbSpaceBetween[j] );\r\n                }\r\n            }\r\n\r\n            wptbPhElement[i].getDOMElement = function() {\r\n                return wptbPhElement[i];\r\n            }\r\n\r\n            let wptbElementTypeClass = wptbPhElement[i].className.match( /wptb-element-((.+-)\\d+)/i );\r\n\r\n            if( wptbElementTypeClass && Array.isArray( wptbElementTypeClass ) ) {\r\n                let wptbTypeElementArr = wptbElementTypeClass[1].split( '-' );\r\n                wptbPhElement[i].kind = wptbTypeElementArr[0];\r\n                \r\n                applyGenericItemSettings( wptbPhElement[i], wptbElementTypeClass[1] );\r\n                if ( wptbPhElement[i].kind == 'list' ) {\r\n                    let wptbArticle = wptbPhElement[i].getElementsByTagName( 'article' );\r\n                    if( wptbArticle.length > 0 ) {\r\n                        for ( let i = 0; i < wptbArticle.length; i++ ) {\r\n                            WPTB_ListItem( undefined, wptbArticle[i] );\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    };\r\n\r\n    this.setCoords = function (y, x) {\r\n        var el = this.getDOMElement();\r\n        el.dataset.yIndex = y;\r\n        el.dataset.xIndex = x;\r\n    };\r\n\r\n    this.getCoords = function () {\r\n        var coords,\r\n            el = this.getDOMElement();\r\n        coords.x = el.dataset.xIndex;\r\n        coords.y = el.dataset.yIndex;\r\n        return coords;\r\n    };\r\n\r\n    this.appendElement = function (node) {\r\n        getDOMElement().appendChild(node);\r\n    };\r\n\r\n    return this;\r\n};","var ElementCounters = function () {\r\n\r\n\tvar priv = [];\r\n\tpriv['text'] = 0;\r\n\tpriv['image'] = 0;\r\n\tpriv['list'] = 0;\r\n\tpriv['button'] = 0;\r\n\r\n\tthis.increment = function (key) {\r\n\t\tif (!(key in priv)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tpriv[key]++;\r\n\t}\r\n\r\n\tthis.nextIndex = function (key) {\r\n\t\tif (!(key in priv)) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\treturn priv[key] + 1;\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};","var WPTB_ElementOptions = function ( element, index, kindIndexProt ) {\r\n\r\n    var node = element.getDOMElement(), elemIdClass;\r\n\r\n        prop = document.querySelector(\".wptb-\" + element.kind + \"-options-prototype\").cloneNode(true);\r\n        prop.classList.remove(\"wptb-\" + element.kind + \"-options-prototype\"); // remove prototype from the class\r\n    elemIdClass = 'wptb-options-' + element.kind + \"-\" + index;\r\n\r\n    var properties = prop.getElementsByClassName('wptb-element-property');\r\n\r\n    for (var i = 0; i < properties.length; i++) {\r\n        properties[i].dataset.element = elemIdClass;\r\n    }\r\n\r\n    prop.classList.add(elemIdClass);\r\n    document.getElementById(\"element-options-group\").appendChild(prop);\r\n    \r\n    if ( kindIndexProt ) {\r\n        if ( element.kind == 'button' ) {\r\n            let affectedEl = document.getElementsByClassName( 'wptb-element-' + kindIndexProt )[0],\r\n                wptbButtonWrapper,\r\n                wptbButton,\r\n                wptbSize;\r\n        \r\n            if ( affectedEl ) {\r\n                wptbSize = affectedEl.className.match(/wptb-size-([a-z]+)/i);\r\n            }\r\n            \r\n            if( wptbSize && Array.isArray( wptbSize ) ) {\r\n                var b = prop.getElementsByClassName('wptb-btn-size-btn');\r\n                \r\n                for ( var i = 0; i < b.length; i++ ) {\r\n                    b[i].classList.remove( 'selected' );\r\n                    \r\n                    if ( b[i].innerHTML == wptbSize[1] ) {\r\n                        b[i].classList.add( 'selected' );\r\n                    }\r\n                }\r\n            }\r\n            \r\n            if( affectedEl ) {\r\n                wptbButtonWrapper = affectedEl.getElementsByClassName( 'wptb-button-wrapper' );\r\n                \r\n                wptbButton = affectedEl.getElementsByClassName( 'wptb-button' )\r\n            }\r\n            \r\n            if ( wptbButtonWrapper ) {\r\n                let buttonAlignment = wptbButtonWrapper[0].style.justifyContent,\r\n                buttonAlignmentSelect = prop.querySelector( 'select[data-type=\"button-alignment\"]' ),\r\n                    selectOption = buttonAlignmentSelect.getElementsByTagName( 'option' ),\r\n                    selectOptionVal;\r\n                \r\n                if ( buttonAlignment == 'flex-start' ) {\r\n                    selectOptionVal = 'left';\r\n                } else if ( buttonAlignment == 'center' || ! buttonAlignment ) {\r\n                    selectOptionVal = 'center';\r\n                } else if ( buttonAlignment == 'flex-end' ) {\r\n                    selectOptionVal = 'right';\r\n                }\r\n                \r\n                for ( let i = 0; i < selectOption.length; i++ ) {\r\n                    if ( selectOption[i].value == selectOptionVal ) {\r\n                        selectOption[i].selected = true;\r\n                    }\r\n                }\r\n            }\r\n            \r\n            if( wptbButton ) {\r\n                let buttonTextColor = wptbButton[0].style.color,\r\n                    buttonColor = wptbButton[0].style.backgroundColor,\r\n                    buttonHref = wptbButton[0].getAttribute( 'href' ), \r\n                    buttonLinkTarget = wptbButton[0].getAttribute( 'target' ),\r\n                    buttonTextColorInput = prop.querySelector( 'input[data-type=\"button-text-color\"]' ),\r\n                    buttonBackgroundColorInput = prop.querySelector( 'input[data-type=\"button-color\"]' ),\r\n                    buttonHrefInput = prop.querySelector( 'input[data-type=\"button-link\"]' ),\r\n                    buttonLinkTargetInput = prop.querySelector( 'input[data-type=\"button-link-target\"]' ),\r\n                    buttonLinkTargetInputId = buttonLinkTargetInput.getAttribute( 'id' ),\r\n                    buttonLinkTargetInputLabel = buttonLinkTargetInput.parentNode.getElementsByTagName( 'label' )[0];\r\n                    \r\n                buttonLinkTargetInputId = buttonLinkTargetInputId + '-' + kindIndexProt.split( '-' )[1];\r\n\r\n                buttonLinkTargetInput.setAttribute( 'id', buttonLinkTargetInputId );\r\n                buttonLinkTargetInputLabel.setAttribute( 'for', buttonLinkTargetInputId );\r\n            \r\n                buttonTextColorInput.value = buttonTextColor;\r\n                \r\n                buttonBackgroundColorInput.value = buttonColor;\r\n                \r\n                buttonHrefInput.value = buttonHref;\r\n                \r\n                if( buttonLinkTarget && buttonLinkTarget == '_blank') {\r\n                    buttonLinkTargetInput.checked=true;\r\n                }\r\n            }\r\n        } else if ( element.kind == 'image' ) {\r\n            let affectedEl = document.getElementsByClassName( 'wptb-element-' + kindIndexProt )[0],\r\n                affectedElChildren = [...affectedEl.children];\r\n            if ( affectedElChildren.length > 0 ) {\r\n                let a;\r\n                \r\n                for ( let i = 0; i < affectedElChildren.length; i++ ) {\r\n                    if ( affectedElChildren[i].tagName.toLowerCase() == 'a' ) {\r\n                        a = affectedElChildren[i];\r\n                    }\r\n                }\r\n                \r\n                if ( a ) {\r\n                    \r\n                    a.onclick = function( e ) {\r\n                        e.preventDefault();\r\n                    }\r\n                    // set select according to the alignment of the image\r\n                    let aTextAlign = a.style.textAlign,\r\n                    imageAlignmentSelect = prop.querySelector( 'select[data-type=\"image-alignment\"]' ),\r\n                    selectOption = imageAlignmentSelect.getElementsByTagName( 'option' );\r\n                    \r\n                    for ( let i = 0; i < selectOption.length; i++ ) {\r\n                        if ( selectOption[i].value == aTextAlign ) {\r\n                            selectOption[i].selected = true;\r\n                        }\r\n                    }\r\n                    \r\n                    // set text link for input field of setting panel\r\n                    let imageLinkHref = a.getAttribute( 'href' ),\r\n                        inputImageLink = prop.querySelector( 'input[data-type=\"image-link\"]' );\r\n                    if ( imageLinkHref ) {\r\n                        inputImageLink.value = imageLinkHref;\r\n                    }\r\n                    \r\n                    // set checkbox for target of link \r\n                    let imageLinkTarget = a.getAttribute( 'target' ),\r\n                        imageLinkTargetInput = prop.querySelector( 'input[data-type=\"image-link-target\"]' ),\r\n                        imageLinkTargetInputId = imageLinkTargetInput.getAttribute( 'id' ),\r\n                        imageLinkTargetInputLabel = imageLinkTargetInput.parentNode.getElementsByTagName( 'label' )[0];\r\n                \r\n                    imageLinkTargetInputId = imageLinkTargetInputId + '-' + kindIndexProt.split( '-' )[1];\r\n\r\n                    imageLinkTargetInput.setAttribute( 'id', imageLinkTargetInputId );\r\n                    imageLinkTargetInputLabel.setAttribute( 'for', imageLinkTargetInputId );\r\n                    \r\n                    if ( imageLinkTarget && imageLinkTarget == '_blank' ) {\r\n                        imageLinkTargetInput.checked = true;\r\n                    }\r\n                    \r\n                    let img = a.getElementsByTagName( 'img' );\r\n                    if ( img.length > 0 ) {\r\n                        // set value for input fields of image size\r\n                        let imgWidth = img[0].style.width;\r\n                        if ( imgWidth ) {\r\n                            let imageWidthInputRange = prop.querySelector( 'input[type=\"range\"][data-type=\"image-size\"]' ),\r\n                                imageWidthInputNumber = prop.querySelector( 'input[type=\"number\"][data-type=\"image-size\"]' );\r\n                        \r\n                            imageWidthInputRange.value = parseInt( imgWidth );\r\n                            imageWidthInputNumber.value = parseInt( imgWidth );\r\n                        }\r\n                        \r\n                        // set value for input field of alternative text image\r\n                        let imgAlternativeText = img[0].getAttribute('alt'),\r\n                            imageAlternativeTextInput = prop.querySelector( 'input[type=\"text\"][data-type=\"alternative-text\"]' );\r\n                    \r\n                        imageAlternativeTextInput.value = imgAlternativeText;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    node.onclick = function () {\r\n        var infArr = this.className.match(/wptb-element-((.+-)\\d+)/i),\r\n            optionsClass = '.wptb-' + infArr[2] + 'options' +\r\n                '.wptb-options-' + infArr[1];\r\n\r\n        document.getElementById('add-elements').getElementsByTagName('a')[0].classList.remove('active');\r\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.add('active');\r\n\r\n        document.getElementsByClassName('wptb-elements-container')[0].style.display = 'none';\r\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'none';\r\n        document.getElementById(\"element-options-group\").style.display = 'block';\r\n\r\n        var children = document.getElementById(\"element-options-group\").childNodes;\r\n        for (var i = 0; i < children.length; i++) {\r\n            if (children[i].style)\r\n                children[i].style.display = 'none';\r\n        }\r\n\r\n        document.querySelector(optionsClass).style.display = 'block';\r\n\r\n        var listStyleType, listJustifyContent;\r\n\r\n        switch (element.kind) {\r\n\r\n            case 'text':\r\n                jQuery(prop).find('[data-type=color]').wpColorPicker({ defaultColor: node.style.color });\r\n                prop.querySelector('[type=number][data-type=font-size]').value\r\n                    = prop.querySelector('[type=ran][data-type=font-size]').value\r\n                    = node.style.fontSize.substring(0, node.style.fontSize.length - 2);\r\n                break;\r\n            case 'list':\r\n                listJustifyContent = node.querySelector('article').style.justifyContent;\r\n                listStyleType = node.querySelector('article .wptb-list-item-style-dot li').style.listStyleType;\r\n                if ( prop.querySelector( '[type=ran][data-type=list-class]' ) ) {\r\n                    prop.querySelector('[type=ran][data-type=list-class]').selectedIndex = (listStyleType == 'decimal' ? 0 : 1);\r\n                }\r\n                if ( prop.querySelector('[type=ran][data-type=list-style-type]') ) {\r\n                    prop.querySelector('[type=ran][data-type=list-style-type]').selectedIndex = (listStyleType == 'circle' ? 0 : (listStyleType == 'square' ? 1 : 2));\r\n                }\r\n                if ( prop.querySelector('[type=ran][data-type=list-alignment]') ) {\r\n                    prop.querySelector('[type=ran][data-type=list-alignment]').selectedIndex = (listJustifyContent == 'flex-start' ? 0 : (listJustifyContent == 'center' ? 1 : 2));\r\n                }\r\n                break;\r\n            case 'image':\r\n                break;\r\n            case 'button':\r\n                jQuery(prop).find('[data-type=button-color]').wpColorPicker({ defaultColor: node.style.backgroundColor });\r\n                break;\r\n\r\n        }\r\n    };\r\n\r\n    if (element.kind == 'button') {\r\n        //We must add this special kind of property, since it is triggered with click event\r\n        var buttons = prop.getElementsByClassName('wptb-btn-size-btn');\r\n\r\n        for (var i = 0; i < buttons.length; i++) {\r\n            buttons[i].onclick = function () {\r\n                var size = this.innerHTML,\r\n                    n_Class = this.dataset.element,\r\n                    infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                    type = infArr[1],\r\n                    num = infArr[2],\r\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0];\r\n                affectedEl.classList.remove('wptb-size-S');\r\n                affectedEl.classList.remove('wptb-size-M');\r\n                affectedEl.classList.remove('wptb-size-L');\r\n                affectedEl.classList.remove('wptb-size-XL');\r\n                affectedEl.classList.add('wptb-size-' + size);\r\n                var b = this.parentNode.getElementsByClassName('wptb-btn-size-btn');\r\n                for (var i = 0; i < b.length; i++) {\r\n                    b[i].classList.remove('selected');\r\n                }\r\n                this.classList.add('selected');\r\n            }\r\n        }\r\n    }\r\n\r\n    var optionControls = prop.getElementsByClassName('wptb-element-property');\r\n\r\n    for (var i = 0; i < optionControls.length; i++) {\r\n        if (optionControls[i].classList.contains('wptb-color-picker')) {\r\n            jQuery(optionControls[i]).wpColorPicker({\r\n                change: function (event, ui) {\r\n                    var parent = event.target, classe, type, ps, number;\r\n                    classe = parent.dataset.element.match(/wptb-options-(.+)-(\\d+)/i);\r\n                    type = classe[1];\r\n                    number = classe[2];\r\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + number)[0];\r\n                    if (type == 'button') {\r\n                        if (parent.dataset.type == 'button-text-color') {\r\n                            affectedEl.getElementsByClassName('wptb-button')[0].style.color = ui.color.toString();\r\n                        } else {\r\n                            affectedEl.getElementsByClassName('wptb-button')[0].style.backgroundColor = ui.color.toString();\r\n                        }\r\n                    } else {\r\n                        affectedEl.style.color = ui.color.toString();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        if (optionControls[i].dataset.type === 'font-size') {\r\n            var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-text-font-size-slider')[0];\r\n            slider.oninput = function () {\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].value = this.value;\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].onchange();\r\n            }\r\n        }\r\n\r\n        if (optionControls[i].dataset.type === 'image-size') {\r\n            var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-image-size-slider')[0];\r\n            slider.oninput = function () {\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-image-width-number')[0].value = this.value;\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-image-width-number')[0].onchange();\r\n            }\r\n        }\r\n\r\n        optionControls[i].onchange = function (event) {\r\n\r\n            var n_Class = this.dataset.element,\r\n                infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                type = infArr[1],\r\n                num = infArr[2],\r\n                affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0],\r\n                val = this.value;\r\n\r\n            switch (this.dataset.type) {\r\n                case 'src':\r\n                    var img = affectedEl.getElementsByTagName(\"img\")[0];\r\n                    img.src = this.value;\r\n                    break;\r\n                case 'alternative-text':\r\n                    var img = affectedEl.getElementsByTagName('img')[0];\r\n                    img.alt = this.value;\r\n                    break;\r\n                case 'image-link':\r\n                    affectedEl.getElementsByTagName('a')[0].href = this.value;\r\n                    break;\r\n                case 'image-link-target':\r\n                    if (this.checked == true) {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_blank';\r\n                    } else {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_self';\r\n                    }\r\n                    break;\r\n                case 'image-size':\r\n                    affectedEl.getElementsByTagName('img')[0].style.width = this.value + '%';\r\n                    affectedEl.getElementsByTagName('img')[0].style.height = 'auto';\r\n                    this.parentNode.parentNode.getElementsByClassName('wptb-image-size-slider')[0].value = this.value;\r\n                    break;\r\n                case 'image-alignment':\r\n                    affectedEl.getElementsByTagName( 'img' )[0].parentNode.style.textAlign = this.value;\r\n                    break;\r\n                case 'font-size':\r\n                    affectedEl.style.fontSize = val + 'px';\r\n                    break;\r\n                case 'button-alignment':\r\n                    var jc = '';\r\n                    if (this.value == 'left') {\r\n                        jc = 'start';\r\n                    } else if (this.value == 'right') {\r\n                        jc = 'flex-end';\r\n                    } else {\r\n                        jc = 'center';\r\n                    }\r\n                    affectedEl.getElementsByClassName('wptb-button-wrapper')[0].style.justifyContent = jc;\r\n                    break;\r\n                case 'button-link':\r\n                    affectedEl.getElementsByTagName('a')[0].href = this.value;\r\n                    break;\r\n                case 'button-link-target':\r\n                    if (this.checked == true) {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_blank';\r\n                    } else {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_self';\r\n                    }\r\n                    break;\r\n                case 'button-color':\r\n                    break;\r\n                case 'list-alignment':\r\n                    var jc = '';\r\n                    if (this.value == 'left') {\r\n                        jc = 'flex-start';\r\n                    } else if (this.value == 'right') {\r\n                        jc = 'flex-end';\r\n                    } else {\r\n                        jc = 'center';\r\n                    }\r\n                    var articles = affectedEl.querySelectorAll('article');\r\n                    for (var i = 0; i < articles.length; i++) {\r\n                        articles[i].style.justifyContent = jc;\r\n                    }\r\n                    break;\r\n                case 'list-class':\r\n                    if (val == 'unordered') {\r\n                        event.target\r\n                            .parentNode\r\n                            .parentNode\r\n                            .querySelector('[data-type=list-style-type]')\r\n                            .parentNode\r\n                            .style\r\n                            .display = 'flex';\r\n                        document.querySelector('#wptb-list-icon-select-label').style.display = 'flex';\r\n                        var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                        for (var i = 0; i < bullets.length; i++) {\r\n                            bullets[i].style.listStyleType = 'disc';\r\n                        }\r\n                        document.querySelector('[data-type=list-style-type]').value = 'disc';\r\n                    } else {\r\n                        event.target\r\n                            .parentNode\r\n                            .parentNode\r\n                            .querySelector('[data-type=list-style-type]')\r\n                            .parentNode\r\n                            .style\r\n                            .display = 'none';\r\n                        document.querySelector('#wptb-list-icon-select-label').style.display = 'none';\r\n                        var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                        for (var i = 0; i < bullets.length; i++) {\r\n                            bullets[i].style.listStyleType = 'decimal';\r\n                        }\r\n                    }\r\n                    break;\r\n                case 'list-style-type':\r\n                    var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                    for (var i = 0; i < bullets.length; i++) {\r\n                        bullets[i].style.listStyleType = val.toLowerCase();\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n};","var WPTB_Image = function ( src, DOMElement ) {\r\n        let kindIndexProt;\r\n        if ( DOMElement == undefined ) {\r\n            var DOMElement = document.createElement('div'),\r\n\t    anchor = document.createElement('a'),\r\n\t    img = document.createElement('img');\r\n            anchor.style.display = 'inline-block';\r\n            anchor.appendChild(img);\r\n            DOMElement.appendChild(anchor);\r\n            \r\n            anchor.onclick = function( e ) {\r\n                e.preventDefault();\r\n            }\r\n            \r\n            file_frame = wp.media.frames.file_frame = wp.media({\r\n\t\ttitle: 'Select a image to upload',\r\n\t\tbutton: {\r\n\t\t\ttext: 'Use this image'\r\n\t\t},\r\n\t\tmultiple: false\r\n            });\r\n            // When an image is selected, run a callback.\r\n            file_frame.on('select', function () {\r\n                    attachment = file_frame.state().get('selection').first().toJSON();\r\n                    img.src = attachment.url;\r\n            });\r\n            // Finally, open the modal\r\n            if (src == undefined) {\r\n                    file_frame.open();\r\n            } else {\r\n                    img.src = src;\r\n            }\r\n        } else {\r\n            var DOMElement = DOMElement.cloneNode( true );\r\n            \r\n            let wptbElementMutch = DOMElement.className.match( /wptb-element-((.+-)\\d+)/i );\r\n            if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\r\n                kindIndexProt = wptbElementMutch[1];\r\n            };\r\n        }\r\n\t\r\n            \r\n        this.kind = 'image';\r\n        this.getDOMElement = function () {\r\n            return DOMElement;\r\n        };\r\n\tapplyGenericItemSettings( this, kindIndexProt );\r\n\r\n\treturn this;\r\n};","var WPTB_Initializer = function () {\r\n\r\n    const MIN_COLUMNS = 1,\r\n        MIN_ROWS = 1,\r\n        MAX_COLUMNS = 10,\r\n        MAX_ROWS = 10;\r\n\r\n    var tableGenerator = document.body;\r\n    columnsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[0],\r\n            columnsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[0],\r\n            rowsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[1],\r\n            rowsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[1],\r\n            columnsInput = document.getElementById('wptb-columns-number'),\r\n            rowsInput = document.getElementById('wptb-rows-number');\r\n\r\n    columnsDecrementButton.onclick = function () {\r\n            if (columnsInput.value > MIN_COLUMNS) {\r\n                    columnsInput.value--;\r\n            }\r\n    };\r\n\r\n    columnsIncrementButton.onclick = function () {\r\n            if (columnsInput.value < MAX_COLUMNS) {\r\n                    columnsInput.value++;\r\n            }\r\n    };\r\n\r\n    rowsDecrementButton.onclick = function () {\r\n            if (rowsInput.value > MIN_ROWS) {\r\n                    rowsInput.value--;\r\n            }\r\n    };\r\n\r\n    rowsIncrementButton.onclick = function () {\r\n            if (rowsInput.value < MAX_ROWS) {\r\n                    rowsInput.value++;\r\n            }\r\n    };\r\n\r\n    document.getElementById('wptb-generate-table').onclick = function () {\r\n            var columns = document.getElementById('wptb-columns-number').value,\r\n                rows = document.getElementById('wptb-rows-number').value;\r\n\r\n            WPTB_Table(columns, rows);\r\n    }\r\n\r\n};\r\n","var WPTB_LeftPanel = function () {\r\n\r\n    var table = document.getElementsByClassName('wptb-preview-table')[0],\r\n        wptbElementButtons = document.getElementsByClassName('wptb-element');\r\n\r\n    function hexToRgb(hex) {\r\n        var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n        return result ? 'rgb(' + parseInt(result[1], 16) + ',' + parseInt(result[2], 16) + ',' + parseInt(result[3], 16) + ')' : null;\r\n    }\r\n\r\n    jQuery('#wptb-even-row-bg').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableRows = table.getElementsByTagName('tr');\r\n            for (var i = 1; i < tableRows.length; i += 2) {\r\n                tds = tableRows[i].getElementsByTagName('td');\r\n                for (var j = 0; j < tds.length; j++) {\r\n                    tds[j].style.backgroundColor = ui.color.toString();\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    jQuery('#wptb-odd-row-bg').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableRows = table.getElementsByTagName('tr');\r\n            for (var i = 2; i < tableRows.length; i += 2) {\r\n                tds = tableRows[i].getElementsByTagName('td');\r\n                for (var j = 0; j < tds.length; j++) {\r\n                    tds[j].style.backgroundColor = ui.color.toString();\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    jQuery('#wptb-table-header-bg').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableHeader = table.getElementsByTagName('tr')[0],\r\n                tds = tableHeader.getElementsByTagName('td');\r\n            for (var j = 0; j < tds.length; j++) {\r\n                tds[j].style.backgroundColor = ui.color.toString();\r\n            }\r\n        }\r\n    });\r\n\r\n    jQuery('#wptb-table-border-color').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableCells = table.getElementsByTagName('td');\r\n            table.style.border = document.querySelector('#wptb-table-border-number').value + 'px solid ' + ui.color.toString();\r\n\r\n            for (var i = 0; i < tableCells.length; i++) {\r\n                tableCells[i].style.border = document.querySelector('#wptb-table-inner-border-number').value + 'px solid ' + ui.color.toString();\r\n            }\r\n        }\r\n    });\r\n\r\n    function addInnerBorderSize(value) {\r\n        var tableCells = table.getElementsByTagName('td');\r\n        for (var i = 0; i < tableCells.length; i++) {\r\n            tableCells[i].style.border = document.querySelector('#wptb-table-inner-border-number').value + 'px solid ' + hexToRgb(jQuery('#wptb-table-border-color').val());\r\n        }\r\n    }\r\n\r\n    function addCellPadding(value) {\r\n        var tableCells = table.getElementsByTagName('td');\r\n        for (var i = 0; i < tableCells.length; i++) {\r\n            tableCells[i].style.padding = value + 'px';\r\n        }\r\n    }\r\n\r\n    function addInnerBorder(checked) {\r\n        var styles, color = document.querySelector('#wptb-table-border-color').value != undefined ?\r\n            document.querySelector('#wptb-table-border-color').value : 'rgb(0,0,0)';\r\n\r\n        if (checked == 'checked') {\r\n            document.getElementById('wptb-apply-inner-border').style.marginBottom = '0px';\r\n            var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n            for (var i = 0; i < tableCells.length; i++) {\r\n                tableCells[i].style.border = '1px solid ' + color;\r\n            }\r\n            document.getElementById('wptb-inner-border-settings').classList.add('visible');\r\n        } else {\r\n            document.getElementById('wptb-inner-border-settings').classList.remove('visible');\r\n            var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n            for (var i = 0; i < tableCells.length; i++) {\r\n                tableCells[i].style.border = '0px solid ' + color;\r\n            }\r\n        }\r\n    }\r\n\r\n    function addBorderSize(value) {\r\n        table.style.border = value + 'px solid';\r\n    }\r\n\r\n    document.getElementById('wptb-table-cell-slider').oninput = function () {\r\n        document.getElementById('wptb-table-cell-number').value = this.value;\r\n        addCellPadding(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-cell-number').onchange = function () {\r\n        document.getElementById('wptb-table-cell-slider').value = this.value;\r\n        addCellPadding(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-border-slider').oninput = function () {\r\n        document.getElementById('wptb-table-border-number').value = this.value;\r\n        addBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-border-number').onchange = function () {\r\n        document.getElementById('wptb-table-border-slider').value = this.value;\r\n        addBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-inner-border-slider').oninput = function () {\r\n        document.getElementById('wptb-table-inner-border-number').value = this.value;\r\n        addInnerBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-inner-border-number').onchange = function () {\r\n        document.getElementById('wptb-table-inner-border-slider').value = this.value;\r\n        addInnerBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-inner-border-check').onchange = function () {\r\n        var _val = this.checked ? 'checked' : 'unchecked';\r\n        addInnerBorder(_val);\r\n    };\r\n\r\n    for (var i = 0; i < wptbElementButtons.length; i++) {\r\n        wptbElementButtons[i].ondragstart = function (e) {\r\n            e.dataTransfer.setData('wptbElement', this.dataset.wptbElement);\r\n        }\r\n    }\r\n\r\n    document.getElementById('wptb-activate-cell-management-mode').onclick = table.toggleTableEditMode;\r\n    document.getElementById('wptb-add-end-row').onclick = table.addRowToTheEnd;\r\n    document.getElementById('wptb-add-start-row').onclick = table.addRowToTheStart;\r\n    document.getElementById('wptb-add-row-before').onclick = table.addRowBefore;\r\n    document.getElementById('wptb-add-row-after').onclick = table.addRowAfter;\r\n    document.getElementById('wptb-add-end-column').onclick = table.addColumnEnd;\r\n    document.getElementById('wptb-add-start-column').onclick = table.addColumnStart;\r\n    document.getElementById('wptb-add-column-before').onclick = table.addColumnBefore;\r\n    document.getElementById('wptb-add-column-after').onclick = table.addColumnAfter;\r\n    document.getElementById('wptb-delete-column').onclick = table.deleteColumn;\r\n    document.getElementById('wptb-delete-row').onclick = table.deleteRow;\r\n    document.getElementById('wptb-merge-cells').onclick = table.mergeCells;\r\n    document.getElementById('wptb-split-cell').onclick = table.splitCell;\r\n    document.getElementById('add-elements').onclick = function () {\r\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.remove('active');\r\n        document.getElementById('add-elements').getElementsByTagName('a')[0].classList.add('active');\r\n        document.getElementsByClassName('wptb-elements-container')[0].style.display = 'table';\r\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'block';\r\n        document.getElementById(\"element-options-group\").style.display = 'none';\r\n    };\r\n\r\n};","var WPTB_List = function ( innerElements, DOMElementProt ) {\r\n\r\n    var el_L = document.createElement('ul'), item,\r\n        DOMElement = document.createElement('div');\r\n\r\n    this.kind = 'list';\r\n\r\n    if (innerElements === '') {\r\n        //Case for edit mode list\r\n    } else if (!innerElements) {\r\n        for (var i = 0; i < 3; i++) {\r\n            item = new WPTB_ListItem( 'List Item ' + (i + 1) );\r\n            el_L.appendChild(item.getDOMElement());\r\n        }\r\n    } else {\r\n        for (var i = 0; i < innerElements.length; i++) {\r\n            item = new WPTB_ListItem( innerElements[i], DOMElementProt, true );\r\n            el_L.appendChild(item.getDOMElement());\r\n        }\r\n    }\r\n    DOMElement.appendChild(el_L);\r\n    //window.addElementOptions('list', elList);\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    }\r\n    applyGenericItemSettings(this);\r\n\r\n    return this;\r\n\r\n};","var WPTB_ListItem = function ( text, DOMElementProt, copy ) {\r\n    let wptbListItemReturn;\r\n    if ( DOMElementProt == undefined || ( DOMElementProt && copy )) {\r\n        if (text == undefined) text = 'New List Item';\r\n        var DOMElement = document.createElement('article'),\r\n            divdot = document.createElement('div'),\r\n            divcontent = document.createElement('div'),\r\n            libullet = document.createElement('li');\r\n        divdot.classList.add('wptb-list-item-style-dot');\r\n        divcontent.classList.add('wptb-list-item-content');\r\n        libullet.classList.add('wptb-bullet');\r\n        if ( DOMElementProt ) {\r\n            let styleDot = DOMElementProt.querySelector( '.wptb-bullet' ).getAttribute( 'style' )\r\n            libullet.setAttribute( 'style', styleDot );\r\n        }\r\n        DOMElement.appendChild(divdot);\r\n        DOMElement.appendChild(divcontent);\r\n        divdot.appendChild(libullet);\r\n        divcontent.innerHTML = text;\r\n        divcontent.onkeyup = window.listItemKeyListener;\r\n        \r\n        wptbListItemReturn = true;\r\n    } else {\r\n        var DOMElement = DOMElementProt;\r\n        var divdot = DOMElement.getElementsByClassName( 'wptb-list-item-style-dot' )[0], \r\n            divcontent = DOMElement.getElementsByClassName( 'wptb-list-item-content' )[0], \r\n            libullet = divdot.getElementsByClassName( 'wptb-bullet' )[0];\r\n    \r\n        divcontent.onkeyup = window.listItemKeyListener;\r\n        \r\n        wptbListItemReturn = false;\r\n    }\r\n    \r\n    DOMElement.onmouseenter = function (event) {\r\n\r\n        var btnDelete = document.createElement('span'),\r\n            btnCopy = document.createElement('span'),\r\n            actions = document.createElement('span'),\r\n            previous,\r\n            i;\r\n        actions.classList.add('wptb-actions');\r\n        btnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\r\n        btnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\r\n        this.classList.add('wptb-directlyhovered');\r\n\r\n        btnDelete.onclick = function () {\r\n            var item = this.parentNode.parentNode,\r\n                parent = item.parentNode;\r\n            parent.removeChild(item);\r\n        };\r\n\r\n        btnCopy.onclick = function (event) {\r\n            var article = event.target.parentNode.parentNode,\r\n                content = article.querySelector('.wptb-list-item-content'),\r\n                html = content.innerHTML;\r\n            var duplicate = new WPTB_ListItem( html, article, true );\r\n            article.parentNode.insertBefore( duplicate.getDOMElement(), DOMElement );\r\n        };\r\n\r\n        actions.append(btnCopy, btnDelete);\r\n        this.appendChild(actions);\r\n    };\r\n\r\n    DOMElement.onmouseleave = function (event) {\r\n        this.classList.remove('wptb-directlyhovered');\r\n        var actions = this.parentNode.querySelector('.wptb-actions');\r\n        if (actions != undefined) {\r\n            var parent = actions.parentNode;\r\n            parent.removeChild(actions);\r\n        }\r\n    };\r\n\r\n    divcontent.onkeydown = function (event) {\r\n        var key = event.which != undefined ? event.which : event.keyCode,\r\n            article = event.target.parentNode,\r\n            duplicate,\r\n            lastP;\r\n        if (key !== 13 || window.dontAddItems !== undefined && window.dontAddItems === true) {\r\n            return;\r\n        }\r\n        event.preventDefault();\r\n        duplicate = new WPTB_ListItem( this.innerHTML, article, true );\r\n        DOMElement.parentNode.insertBefore(duplicate.getDOMElement(), DOMElement);\r\n        setTimeout( function(){\r\n            divcontent.innerHTML = 'New List Item';\r\n        }, 5 );\r\n\r\n        return false;\r\n    };\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    };\r\n    \r\n    if ( wptbListItemReturn ) {\r\n        return this;\r\n    }\r\n};","var MultipleSelect = function () {\r\n\r\n\tvar selectedCells = [],\r\n\t\tmultipleCellMode = false;\r\n\r\n\tthis.activateMultipleSelectMode = function () {\r\n\t\tselectedCells = [];\r\n\t\tvar tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\ttds[i].classList.remove('wptb-highlighted');\r\n\t\t}\r\n\t\tmultipleCellMode = true;\r\n\t}\r\n\r\n\tthis.deactivateMultipleSelectMode = function () {\r\n\t\tmultipleCellMode = false;\r\n\t}\r\n\r\n\tthis.isActivated = function () {\r\n\t\treturn multipleCellMode;\r\n\t}\r\n\r\n\tthis.pushSelectedCell = function (cell) {\r\n\t\tif (!multipleCellMode) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tselectedCells.push(cell);\r\n\t\tcell.classList.add('wptb-highlighted');\r\n\t};\r\n\r\n\tthis.selectedCells = function () {\r\n\t\treturn selectedCells;\r\n\t}\r\n\r\n\tthis.flushSelectedCells = function () {\r\n\t\tselectedCells = [];\r\n\t}\r\n\r\n\tthis.getFirst = function () {\r\n\t\tvar minXIndex = 1000, minYIndex = 1000, first;\r\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\r\n\t\t\tif (minXIndex >= selectedCells[i].dataset.xIndex\r\n\t\t\t\t&& minYIndex >= selectedCells[i].dataset.yIndex) {\r\n\t\t\t\tfirst = selectedCells[i];\r\n\t\t\t\tminXIndex = selectedCells[i].dataset.xIndex;\r\n\t\t\t\tminYIndex = selectedCells[i].dataset.yIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn first;\r\n\t}\r\n\r\n\tthis.getLast = function () {\r\n\t\tvar maxXIndex = -1, maxYIndex = -1, last;\r\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\r\n\t\t\tif (maxXIndex <= selectedCells[i].dataset.xIndex\r\n\t\t\t\t&& maxYIndex <= selectedCells[i].dataset.yIndex) {\r\n\t\t\t\tlast = selectedCells[i];\r\n\t\t\t\tmaxXIndex = selectedCells[i].dataset.xIndex;\r\n\t\t\t\tmaxYIndex = selectedCells[i].dataset.yIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn last;\r\n\t}\r\n\r\n\tthis.removeAllButFirst = function () {\r\n\t\tvar td = this.getFirst();\r\n\t\tfor (var i = 1; i < selectedCells.length; i++) {\r\n\t\t\tselectedCells[i].classList.add('wptb-fused-cell-' + td.dataset.xIndex + '-' + td.dataset.yIndex);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};","var WPTB_Parser = function (code) {\r\n    if( Array.isArray( code ) ) {\r\n        let elementHtml;\r\n        \r\n        if ( code.length == 1) {\r\n            return elementHtml.appendChild( document.createTextNode( code[0] ) );\r\n        }\r\n        if( 0 in code ) {\r\n            let tagName = code[0];\r\n            elementHtml =  document.createElement( tagName );\r\n            \r\n            if ( 1 in code ) {\r\n                if( Array.isArray( code[1] ) ) {\r\n                    let attributes = code[1];\r\n                    \r\n                    for( let i = 0; i < attributes.length; i++ ) {\r\n                        if( Array.isArray( attributes[i] ) ) {\r\n                            elementHtml.setAttribute(attributes[i][0], attributes[i][1]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            if ( 2 in code ) {\r\n                if ( Array.isArray( code[2] ) ) {\r\n                    for ( let i = 0; i < code[2].length; i++ ) {\r\n                        if ( typeof code[2][i] === 'string' && tagName.toLowerCase() == 'p' ) {\r\n                            elementHtml.appendChild( document.createTextNode( code[2][i] ) );\r\n                            continue;\r\n                        }\r\n                        if ( ! WPTB_Parser( code[2][i] ) ) continue;\r\n                        elementHtml.appendChild( WPTB_Parser( code[2][i] ) );\r\n                    }\r\n                } else if( typeof code[2] === 'string' ) {\r\n                    elementHtml.appendChild( document.createTextNode( code[2] ) );\r\n                }\r\n                \r\n            }\r\n        }\r\n        \r\n        return elementHtml;\r\n    } else {\r\n        return false;\r\n    }\r\n    \r\n}","var WPTB_Settings = function () {\r\n\r\n\tvar elems = document.getElementsByClassName('wptb-element');\r\n\r\n\tfunction detectMode() {\r\n\t\tvar url = window.location.href,\r\n\t\t    regex = new RegExp('[?&]table(=([^&#]*)|&|#|$)'),\r\n\t\t    results = regex.exec(url);\r\n\t\tif (!results) return false;\r\n\t\tif (!results[2]) return '';\r\n\t\treturn decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n\t}\r\n\r\n\tfor (var i = 0; i < elems.length; i++) {\r\n\t\telems[i].ondragstart = function (event) {\r\n\t\t\tevent.dataTransfer.effectAllowed = 'move';\r\n\t\t\tevent.dataTransfer.setData('wptbElement', event.target.dataset.wptbElement);\r\n\t\t}\r\n\t};\r\n\r\n\tdocument.getElementsByClassName('wptb-save-btn')[0].onclick = function () {\r\n\t\tlet http = new XMLHttpRequest(),\r\n\t\t    url = ajaxurl + \"?action=save_table\",\r\n\t\t    t = document.getElementById('wptb-setup-name').value.trim(),\r\n\t\t    messagingArea,\r\n                    code = WPTB_Stringifier(document.getElementsByClassName('wptb-preview-table')[0], true);\r\n                    \r\n\t\tif (t === '') {\r\n\t\t\tmessagingArea = document.getElementById('wptb-messaging-area');\r\n\t\t\tmessagingArea.innerHTML = '<div class=\"wptb-error wptb-message\">Error: You must assign a name to the table before saving it.</div>';\r\n\t\t\tmessagingArea.classList.add('wptb-warning');\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tmessagingArea.removeChild(messagingArea.firstChild);\r\n\t\t\t}, 4000);\r\n\t\t\treturn;\r\n\t\t}\r\n                code = JSON.stringify( code );\r\n\t\tvar params = 'title=' + t + '&content=' + code;\r\n\r\n\t\tif ((rs = detectMode()) || (rs = document.wptbId)) {\r\n\t\t\tparams += '&id=' + rs;\r\n\t\t}\r\n\r\n\t\thttp.open('POST', url, true);\r\n\t\thttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n\t\thttp.onreadystatechange = function (action) {\r\n\t\t\tif (this.readyState == 4 && this.status == 200) {\r\n\r\n\t\t\t\tvar data = JSON.parse(http.responseText);\r\n\t\t\t\tmessagingArea = document.getElementById('wptb-messaging-area');\r\n\r\n\t\t\t\tif (data[0] == 'saved') {\r\n\t\t\t\t\tdocument.wptbId = data[1];\r\n\t\t\t\t\tmessagingArea.innerHTML = '<div class=\"wptb-success wptb-message\">Table \"' + t + '\" was successfully saved.</div>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmessagingArea.innerHTML = '<div class=\"wptb-success wptb-message\">Table \"' + t + '\" was successfully updated.</div>';\r\n\t\t\t\t}\r\n\t\t\t\tmessagingArea.classList.add('wptb-success');\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tmessagingArea.removeChild(messagingArea.firstChild);\r\n\t\t\t\t}, 4000);\r\n\t\t\t}\r\n\t\t}\r\n\t\thttp.send(params);\r\n\t}\r\n};\r\n","var WPTB_Space = function ( elSpaceBetween ) {\r\n\r\n    function newElementProxy(el) {\r\n        if (el.includes('list')) {\r\n            return new WPTB_List();\r\n        } else if (el.includes('image')) {\r\n            return new WPTB_Image();\r\n        } else if (el.includes('text')) {\r\n            return new WPTB_Text();\r\n        } else if (el.includes('button')) {\r\n            return new WPTB_Button();\r\n        }\r\n    }\r\n    let spaceBetween;\r\n    if ( ! elSpaceBetween ) {\r\n        spaceBetween = document.createElement('div'), spaceBetween.classList.add('wptb-space-between');\r\n    } else {\r\n        spaceBetween = elSpaceBetween;\r\n    }\r\n\r\n    spaceBetween.ondragenter = function () {\r\n        this.classList.add('visible');\r\n    };\r\n    spaceBetween.ondragover = function (event) {\r\n        event.preventDefault();\r\n    };\r\n\r\n    spaceBetween.ondragleave = function () {\r\n        this.classList.remove('visible');\r\n    };\r\n\r\n    spaceBetween.ondrop = function (event) {\r\n        event.stopPropagation();\r\n\r\n        var p = event.target.nextSibling,\r\n            td = event.target,\r\n            element, t_space, spaceParent;\r\n\r\n        while (!td.classList.contains('wptb-droppable')) {\r\n            td = td.parentNode;\r\n        }\r\n\r\n        if (event.dataTransfer.getData('wptbElement')) {\r\n            element = newElementProxy(event.dataTransfer.getData('wptbElement'));\r\n            this.classList.remove('visible');\r\n\r\n            if (p == null) {\r\n                td.appendChild(element.getDOMElement());\r\n                td.appendChild(new WPTB_Space());\r\n            } else {\r\n                td.insertBefore(element.getDOMElement(), p);\r\n                td.insertBefore(new WPTB_Space(), p);\r\n            }\r\n\r\n        } else {\r\n            alert(event.dataTransfer.getData('node'));\r\n            element = document.getElementsByClassName(event.dataTransfer.getData('node'))[0];\r\n            t_space = element.nextSibling;\r\n            spaceParent = element.parentNode;\r\n            if (t_space != undefined) {\r\n                spaceParent.removeChild(t_space);\r\n            }\r\n\r\n            if (p == null) {\r\n                td.appendChild(element);\r\n                td.appendChild(new WPTB_Space());\r\n            } else {\r\n                td.insertBefore(element, p);\r\n                td.insertBefore(new WPTB_Space(), p);\r\n            }\r\n\r\n        }\r\n        this.classList.remove('visible');\r\n    };\r\n    \r\n    if ( ! elSpaceBetween ) {\r\n        return spaceBetween;\r\n    }\r\n};","var WPTB_Stringifier = function ( node, start = false ) {\r\n\r\n\tif ( node == undefined ) {\r\n\t\treturn '';\r\n\t} else if ( node.tagName == undefined && node.nodeType == 3 ) {\r\n            return node.nodeValue;\r\n        }\r\n        \r\n        let code = [],\r\n            children,\r\n            int_elem_arr = false,\r\n            attributes = [...node.attributes],\r\n            attributes_list = [],\r\n            internal_elements = [];\r\n            if ( ( node.parentNode.classList.contains( 'wptb-list-item-content' ) || \r\n                node.parentNode.classList.contains( 'mce-content-body' ) ) && \r\n            node.tagName.toLowerCase() == 'p' ) {\r\n                children = node.childNodes;\r\n                int_elem_arr = true;\r\n            } else if( node.children.length > 0 ) {\r\n                children = node.children;\r\n            } else {\r\n                children = node.childNodes;\r\n            }\r\n        if ( attributes.length > 0 ) {\r\n            for ( let i = 0; i < attributes.length; i++ ) {\r\n                attributes_list[i] = [attributes[i].name, attributes[i].value];\r\n            }\r\n        } else {\r\n            attributes_list = '';\r\n        }\r\n        \r\n        if ( children.length > 0 ) {\r\n            for ( let i = 0; i < children.length; i++) {\r\n                let inter_elem = WPTB_Stringifier(children[i]);\r\n                    \r\n                if ( Array.isArray( inter_elem ) || int_elem_arr ) {\r\n                    internal_elements[i] = inter_elem;\r\n                } else if ( typeof inter_elem === 'string' && inter_elem ) {\r\n                    internal_elements = inter_elem;\r\n                }\r\n            }\r\n        } else {\r\n            internal_elements = '';\r\n        }\r\n        \r\n        \r\n        code.push(node.tagName.toLowerCase(), attributes_list , internal_elements);\r\n        \r\n        return code;\r\n}","var array = [], WPTB_Table = function (columns, rows) {\r\n\r\n\t/* The members of the class */\r\n\tvar settings = document.getElementsByClassName('wptb-settings-items'),\r\n\t    wptbTableSetup = document.getElementsByClassName(\"wptb-table-setup\")[0],\r\n            table, row, cell,\r\n\t    maxAmountOfCells,\r\n\t    maxAmountOfRows;\r\n\r\n\t//HERE ARE THE PRIVATE FUNCTIONS\r\n\t/*\r\n  * This function toggles buttons visibility in cell edit mode\r\n  * (according to the amount of currently selected cells), and\r\n  * highlights visually the clicked cell if it is not highlighted, or\r\n  * removes highlight if clicked cell is already highlighted. \r\n  * It too toggles the bits of our abstract representation.\r\n  * @param Event this is the event instance of the click performed over a cell.\r\n  */\r\n\tvar mark = function (event) {\r\n\t\tvar rs = this.rowSpan,\r\n\t\t    cs = this.colSpan,\r\n\t\t    markedCells,\r\n\t\t    noCells = document.getElementsByClassName('no-cell-action'),\r\n\t\t    singleCells = document.getElementsByClassName('single-action'),\r\n\t\t    multipleCells = document.getElementsByClassName('multiple-select-action'),\r\n\t\t    position = getCoords(this),\r\n\t\t    row = position[0],\r\n\t\t    column = position[1];\r\n\t\tif (!document.select.isActivated()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.className.match(/wptb-highlighted/)) {\r\n\t\t\tthis.classList.remove('wptb-highlighted');\r\n\t\t\tfor (var i = 0; i < rs; i++) {\r\n\t\t\t\tfor (var j = 0; j < cs; j++) {\r\n\t\t\t\t\tarray[row + i][column + j] = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.classList.add('wptb-highlighted');\r\n\t\t\tfor (var i = 0; i < rs; i++) {\r\n\t\t\t\tfor (var j = 0; j < cs; j++) {\r\n\t\t\t\t\tarray[row + i][column + j] = 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tmarkedCells = document.getElementsByClassName('wptb-highlighted').length;\r\n\t\tif (markedCells === 0) {\r\n\t\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\t\tnoCells[i].classList.add('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\t\tsingleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t} else if (markedCells === 1) {\r\n\t\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\t\tnoCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\t\tsingleCells[i].classList.add('visible');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\t\tif (table.isSquare(array)) {\r\n\t\t\t\t\tmultipleCells[i].classList.add('visible');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\t\tnoCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\t\tsingleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t/* \r\n  * This function fills an array with 1's according to the actual design\r\n  * of HTML table.\r\n  * @returns an array of arrays containing an abstract representation\r\n  * of HTML table.\r\n  * @deprecated\r\n  * */\r\n\r\n\tvar realTimeArray = function () {\r\n\t\tvar carried = [], tds, cols, matriz = [];\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarried[i] = 0;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tcols = [];\r\n\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td');\r\n\r\n\t\t\tfor (items = 0; items < tds.length; items++) {\r\n\r\n\t\t\t\tfor (var k = 0; k < tds[items].colSpan; k++) {\r\n\t\t\t\t\tcols.push(1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (tds[items].rowSpan > 1) {\r\n\t\t\t\t\tfor (var k = 0; k < tds[items].colSpan; k++) {\r\n\t\t\t\t\t\tcarried[items + k] = {\r\n\t\t\t\t\t\t\tjustAssigned: true,\r\n\t\t\t\t\t\t\tamount: tds[items].rowSpan\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var k = 0; k < maxAmountOfCells; k++) {\r\n\t\t\t\tif ( typeof carried[k] == 'object' && carried[k].amount > 0 ) {\r\n\t\t\t\t\tcarried[k].amount--;\r\n\t\t\t\t\tif (carried[k].justAssigned) {\r\n\t\t\t\t\t\tcarried[k].justAssigned = false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcols.push(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tmatriz.push(cols);\r\n\r\n\t\t}\r\n\t\treturn matriz;\r\n\t};\r\n\r\n\t/*\r\n  * This function gets the number and position of cell spaces in current row that are occuped \r\n  * by upper rowspanned cells.\r\n  * @param number the number of row where we wish to calculate the carried rowspans up to.\r\n  * @return an array with the remaining rowspans in each column.\r\n  */\r\n\tvar carriedRowspans = function (row) {\r\n\t\tvar carried = [], tds, cols;\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarried[i] = 0;\r\n\t\t}\r\n\r\n\t\tif (row == -1) {\r\n\t\t\treturn carried;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i <= row; i++) {\r\n\t\t\tcellsBuffer = table.rows[i].getElementsByTagName('td');\r\n\t\t\tcellPointer = 0;\r\n\r\n\t\t\tfor (var xPosition = 0; xPosition < maxAmountOfCells; xPosition += stepsToMove) {\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (carried[xPosition]) {\r\n\t\t\t\t\tcarried[xPosition]--;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcelda = cellsBuffer[cellPointer++];\r\n\t\t\t\t\tif (celda.rowSpan > 1) {\r\n\t\t\t\t\t\tfor (k = 0; k < celda.colSpan; k++) {\r\n\t\t\t\t\t\t\tcarried[xPosition + k] = celda.rowSpan - 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstepsToMove = celda.colSpan;\r\n\t\t\t\t\t} else if (celda.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = celda.colSpan;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\treturn carried;\r\n\t};\r\n\r\n\t/*\r\n  * A helpful function for showing\r\n  * the abstract table in console.\r\n  * @param Array our abstract table.\r\n  */\r\n\tvar drawTable = function (a) {\r\n\t\tvar string = 'DRAWING TABLE:\\n';\r\n\t\tfor (var i = 0; i < a.length; i++) {\r\n\r\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\r\n\t\t\t\tstring += ' ' + a[i][j];\r\n\t\t\t}\r\n\t\t\tstring += '\\n';\r\n\t\t}\r\n\t\ttable.isSquare(a);\r\n\t};\r\n\r\n\t/*\r\n  * It resets all the bits of our abstract representation\r\n  * to 0 and removes the highlighting class of all cells.\r\n  */\r\n\r\n\tvar undoSelect = function () {\r\n\t\tvar noCells = document.getElementsByClassName('no-cell-action'),\r\n\t\t    singleCells = document.getElementsByClassName('single-action'),\r\n\t\t    multipleCells = document.getElementsByClassName('multiple-select-action'),\r\n\t\t    tds = table.getElementsByClassName('wptb-highlighted');\r\n\t\twhile (tds.length) {\r\n\t\t\ttds[0].classList.remove('wptb-highlighted');\r\n\t\t}\r\n\t\tfor (var i = 0; i < array.length; i++) {\r\n\t\t\tfor (var j = 0; j < array[i].length; j++) {\r\n\t\t\t\tarray[i][j] = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t}\r\n\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\tnoCells[i].classList.add('visible');\r\n\t\t}\r\n\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\tsingleCells[i].classList.remove('visible');\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n  * This fills the abstract representation of our table with \r\n  * zeros, at the start. the max amount of cells is the greatest sum\r\n  * of all colspans for row.\r\n  */\r\n\r\n\tvar fillTableArray = function () {\r\n\t\tvar colspansSums = [], a = [];\r\n\r\n\t\t//calculate max amount of cells inside a row\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar cells = table.rows[i].getElementsByTagName('td'),\r\n\t\t\t    colspanSumInRow = 0;\r\n\t\t\tfor (var j = 0; j < cells.length; j++) {\r\n\t\t\t\tcolspanSumInRow += cells[j].colSpan;\r\n\t\t\t}\r\n\t\t\tcolspansSums.push(colspanSumInRow);\r\n\t\t}\r\n\r\n\t\tmaxAmountOfCells = Math.max.apply(null, colspansSums);\r\n\t\t//calculate max rows\r\n\t\tvar maxAmountOfRows = table.rows.length;\r\n\r\n\t\t// fill with zeros from both values\r\n\t\tfor (var i = 0; i < maxAmountOfRows; i++) {\r\n\t\t\ta[i] = [];\r\n\t\t\tfor (var j = 0; j < maxAmountOfCells; j++) {\r\n\t\t\t\ta[i].push(0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdrawTable(a);\r\n\t\treturn a;\r\n\t};\r\n\r\n\t/*\r\n  * This function gets the sum of all colspans in a row.\r\n  * @param number the number of row to be used as reference.\r\n  */\r\n\tvar getActualPointsInRow = function (row) {\r\n\t\tvar tds = table.rows[row].getElementsByTagName('td'),\r\n\t\t    points = 0;\r\n\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\tpoints += tds[i].colSpan;\r\n\t\t}\r\n\t\treturn points;\r\n\t}\r\n\r\n\t/*\r\n  * This function gets us the exact coordinates of\r\n  * an exact cell, in a more reliable way than xIndex and yIndex,\r\n  * these last ones were meant to be used for getting the cell trough them.\r\n  * @param DOMElement the cell to get the coordinates.\r\n  */\r\n\tvar getCoords = function (search) {\r\n\t\tvar skipInCols = [], cell;\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tskipInCols[i] = 0;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar cellsBuffer = table.rows[i].getElementsByTagName('td');\r\n\t\t\tcellPointer = 0;\r\n\t\t\tfor (var xPosition = 0; xPosition < maxAmountOfCells; xPosition += stepsToMove) {\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (skipInCols[xPosition]) {\r\n\t\t\t\t\tskipInCols[xPosition]--;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar td = cellsBuffer[cellPointer++];\r\n\t\t\t\t\tif (td == search) {\r\n\t\t\t\t\t\treturn [i, xPosition];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (td.rowSpan > 1) {\r\n\t\t\t\t\t\tfor (k = 0; k < td.colSpan; k++) {\r\n\t\t\t\t\t\t\tskipInCols[xPosition + k] = td.rowSpan - 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstepsToMove = td.colSpan;\r\n\t\t\t\t\t} else if (td.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = td.colSpan;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tjQuery('#wptb-table-header-bg').val('');\r\n\tjQuery('#wptb-even-row-bg').val('');\r\n\tjQuery('#wptb-odd-row-bg').val('');\r\n\tjQuery('#wptb-table-border-color').val('');\r\n\tjQuery('#wptb-table-inner-border-number,#wptb-table-inner-border-slider').val('0');\r\n\tjQuery('#wptb-table-border-number,#wptb-table-border-slider').val('0');\r\n\tjQuery('#wptb-table-padding-number,#wptb-table-padding-slider').val('15');\r\n        \r\n        if ( columns || rows ) {\r\n            //END OF PRIVATE FUNCTIONS\r\n            for (var i = 0; i < settings.length; i++) {\r\n                    if (settings[i].id !== 'wptb-apply-inner-border') {\r\n                            settings[i].classList.add('visible');\r\n                    }\r\n            }\r\n\r\n            //Create a HTML Table element.\r\n            table = document.createElement('table');\r\n            table.classList.add('wptb-preview-table');\r\n\r\n            //Add the header row.\r\n            row = table.insertRow(-1);\r\n            row.classList.add('wptb-table-head', 'wptb-row');\r\n\r\n            for (var i = 0; i < columns; i++) {\r\n                    cell = new WPTB_Cell(mark);\r\n                    cell.setCoords(0, i);\r\n                    row.appendChild(cell.getDOMElement());\r\n            }\r\n\r\n            //Add the data rows.\r\n            for (var i = 1; i < rows; i++) {\r\n\r\n                    row = table.insertRow(-1);\r\n                    row.classList.add('wptb-row');\r\n\r\n                    for (var j = 0; j < columns; j++) {\r\n                            cell = new WPTB_Cell(mark);\r\n                            cell.setCoords(i, j);\r\n                            row.appendChild(cell.getDOMElement());\r\n                    }\r\n            }\r\n        } else {\r\n            let wptb_preview_table = document.getElementsByClassName( 'wptb-preview-table' );\r\n            \r\n            if ( wptb_preview_table.length > 0 ) {\r\n                table = wptb_preview_table[0];\r\n                \r\n                let cells = table.getElementsByTagName( 'td' );\r\n                \r\n                if ( cells.length > 0 ) {\r\n                    for ( let i = 0; i < cells.length; i++ ) {\r\n                        WPTB_Cell( mark, cells[i] );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\t\r\n\t/*\r\n  * This just toggles visibility of cell edit bar, and toggles \r\n  * cell selecting mode.\r\n  */\r\n\r\n\ttable.toggleTableEditMode = function () {\r\n\t\tvar bar = document.getElementById('edit-bar');\r\n\t\tif (bar.classList.contains('visible')) {\r\n\t\t\tdocument.select.deactivateMultipleSelectMode();\r\n\t\t\tbar.classList.remove('visible');\r\n\t\t} else {\r\n\t\t\tdocument.select.activateMultipleSelectMode();\r\n\t\t\tbar.classList.add('visible');\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n  * For assigning to each cell xIndex and y Index attributes,\r\n  * these are the column number and row number of cell in table. \r\n  */\r\n\r\n\ttable.recalculateIndexes = function () {\r\n\t\tvar trs = this.getElementsByTagName('tr'), tds, maxCols = 0;\r\n\r\n\t\tfor (var i = 0; i < trs.length; i++) {\r\n\t\t\ttds = trs[i].getElementsByTagName('td');\r\n\t\t\tfor (var j = 0; j < tds.length; j++) {\r\n\r\n\t\t\t\tif (i == 0) {\r\n\t\t\t\t\ttds[j].parentNode.className = '';\r\n\t\t\t\t\ttds[j].style.backgroundColor = jQuery('#wptb-table-header-bg').val();\r\n\t\t\t\t\ttds[j].parentNode.classList.add('wptb-row', 'wptb-table-head');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (i % 2 == 0) {\r\n\t\t\t\t\t\ttds[j].style.backgroundColor = jQuery('#wptb-odd-row-bg').val();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttds[j].style.backgroundColor = jQuery('#wptb-even-row-bg').val();\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttds[j].parentNode.className = '';\r\n\t\t\t\t\ttds[j].parentNode.classList.add('wptb-row');\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttds[j].dataset.xIndex = j;\r\n\t\t\t\ttds[j].dataset.yIndex = i;\r\n\t\t\t}\r\n\t\t\tif (j > maxCols) {\r\n\t\t\t\tmaxCols = j;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.columns = maxCols;\r\n\t}\r\n\r\n\t/*\r\n  * As simple as it is: adds a column to the end of table.\r\n  */\r\n\ttable.addColumnEnd = function () {\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\tarray[i].push(0);\r\n\t\t}\r\n\t\tmaxAmountOfCells++;\r\n\t\trecalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * As simple as it looks: adds a column to the start of table.\r\n  */\r\n\r\n\ttable.addColumnStart = function () {\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tfirstCell = table.rows[i].getElementsByTagName('td')[0];\r\n\t\t\tif (firstCell) {\r\n\t\t\t\ttable.rows[i].insertBefore(td.getDOMElement(), firstCell);\r\n\t\t\t} else {\r\n\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t}\r\n\t\t\tarray[i].push(0);\r\n\t\t}\r\n\r\n\t\tmaxAmountOfCells++;\r\n\t\trecalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Well, not so simple as previous functions.\r\n  * It adds a column after a certain column of reference.\r\n  * @param integer the column number to be used as reference.\r\n  *\tIf empty, then the first highlighted cell is used as reference.\r\n  */\r\n\r\n\ttable.addColumnAfter = function (c_pos) {\r\n\t\tvar rows = table.rows,\r\n\t\t    cellsBuffer,\r\n\t\t    cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    pos = c_pos != undefined && typeof c_pos === 'number' ? c_pos : getCoords(cell)[1],\r\n\t\t    pendingInsertion = false,\r\n\t\t    stepsToMove,\r\n                    td, bro,\r\n\t\t    carriedRowspans = [],\r\n\t\t    currentCell;\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarriedRowspans.push(0);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < rows.length; i++) {\r\n\t\t\tcellPointer = 0;\r\n\t\t\tcellsBuffer = rows[i].getElementsByTagName('td');\r\n\t\t\tpendingInsertion = false;\r\n\t\t\tfor (var xPosition = 0;\r\n\t\t\t\txPosition < maxAmountOfCells;\r\n\t\t\t\txPosition += stepsToMove) {\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (pendingInsertion) {\r\n\t\t\t\t\ttd = new WPTB_Cell(mark);\r\n\r\n\t\t\t\t\tif (currentCell && rows[i].contains(currentCell)) {\r\n\t\t\t\t\t\tbro = currentCell.nextSibling;\r\n\t\t\t\t\t\tif (bro) {\r\n\t\t\t\t\t\t\trows[i].insertBefore(td.getDOMElement(), bro);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\trows[i].appendChild(td.getDOMElement());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trows[i].insertBefore(td.getDOMElement(), cellsBuffer[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else if (carriedRowspans[xPosition] > 0) {\r\n\t\t\t\t\t// If no pending insertion, let's check if no rowspan from upper cells is pending in current position\r\n\t\t\t\t\tif (pos == xPosition) {\r\n\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurrentCell = cellsBuffer[cellPointer++];\r\n\t\t\t\t\tif (currentCell.rowSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = currentCell.colSpan;\r\n\t\t\t\t\t\tfor (var k = 0; k < currentCell.colSpan; k++) {\r\n\t\t\t\t\t\t\tcarriedRowspans[xPosition + k] = currentCell.rowSpan;\r\n\t\t\t\t\t\t\tif (xPosition + k == pos) {\r\n\t\t\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (currentCell.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = currentCell.colSpan;\r\n\t\t\t\t\t\tfor (var k = 0; k < currentCell.colSpan; k++) {\r\n\t\t\t\t\t\t\tif (xPosition + k == pos) {\r\n\t\t\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (xPosition == pos) {\r\n\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var l = 0; l < maxAmountOfCells; l++) {\r\n\t\t\t\tif (carriedRowspans[l] > 0)\r\n\t\t\t\t\tcarriedRowspans[l]--;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < array.length; i++) {\r\n\t\t\tarray[i].push(0);\r\n\t\t}\r\n\t\tmaxAmountOfCells++;\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\r\n\t};\r\n\r\n\t/*\r\n  * For preventing us to take a lot of time,\r\n  * This is just calling the function addColumnAfter, but\r\n  * using the previous column to current one as reference.\r\n  * @see addColumnAfter\r\n  */\r\n\r\n\ttable.addColumnBefore = function () {\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    pos = getCoords(cell)[1];\r\n\r\n\t\tif (pos === 0) {\r\n\t\t\ttable.addColumnStart();\r\n\t\t} else {\r\n\t\t\ttable.addColumnAfter(pos - 1);\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n  * Luckily, thisfunction is simple, \r\n  * it just add a row to the end of table.\r\n  */\r\n\r\n\ttable.addRowToTheEnd = function () {\r\n\t\tvar r = table.insertRow(-1),\r\n\t\t    td,\r\n\t\t    aux;\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Yet another simple function, \r\n  * it just add a row to the start of table.\r\n  */\r\n\r\n\ttable.addRowToTheStart = function () {\r\n\t\tvar r = table.insertRow(0);\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/* \r\n  * This function adds a row before the current one.\r\n  * Since the biggest factor of problem is a not-started but ongoing rowspan,\r\n  * the most of the troubles is not here.\r\n  */\r\n\r\n\ttable.addRowBefore = function () {\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    row = getCoords(cell)[0],\r\n\t\t    r = table.insertRow(row),\r\n\t\t    aux,\r\n\t\t    rowspans = carriedRowspans(row - 1);\r\n\r\n\t\tnoPending = rowspans.filter(function (elem) {\r\n\t\t\treturn elem == 0;\r\n\t\t});\r\n\r\n\t\tfor (var i = 0; i < noPending.length; i++) {\r\n\t\t\tvar td = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\r\n\t\tarr = realTimeArray();\r\n\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\r\n\t\t\tif (arr[i].length > maxAmountOfCells) {\r\n\t\t\t\t//Still not watched\r\n\t\t\t}\r\n\r\n\t\t\tif (arr[i].length < maxAmountOfCells) {\r\n\r\n\t\t\t\tfor (var j = arr[i].length; j < maxAmountOfCells; j++) {\r\n\t\t\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Well... by the name convention of the previous 3 functions,\r\n  * it's pretty obvious that this functions attaches a new\r\n  * row after highlighted cell row. The greatest obstacle it was\r\n  * the possibility of a TR not having the exact amount of columns\r\n  * occuped by actual node but rowspanned upper cells. For that purpose\r\n  * it was created the function realTimeArray.\r\n  * @see realTimeArray\r\n  */\r\n\r\n\ttable.addRowAfter = function () {\r\n\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    row = getCoords(cell)[0],\r\n\t\t    r = table.insertRow(row + 1),\r\n\t\t    aux,\r\n\t\t    rowspans = carriedRowspans(row);\r\n\r\n\t\tnoPending = rowspans.filter(function (elem) {\r\n\t\t\treturn elem == 0;\r\n\t\t});\r\n\r\n\t\tfor (var i = 0; i < noPending.length; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\r\n\t\tarr = realTimeArray();\r\n\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\r\n\t\t\tif (arr[i].length > maxAmountOfCells) {\r\n\t\t\t\t//Still not watched\r\n\t\t\t}\r\n\r\n\t\t\tif (arr[i].length < maxAmountOfCells) {\r\n\r\n\t\t\t\tfor (var j = arr[i].length; j < maxAmountOfCells; j++) {\r\n\t\t\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * This function checks the current selected cells\r\n  * make a rectangular shape.\r\n  * @param Array the abstract table.\r\n  * @return false, if not making a rectangle, or\r\n  *\tArray an array containing number of rows and columns, if selection makes a rectangle.\r\n  */\r\n\r\n\ttable.isSquare = function (a) {\r\n\t\tvar rowStart = -1,\r\n\t\t    columnStart = -1,\r\n\t\t    rowEnd = -1,\r\n\t\t    columnEnd = -1,\r\n\t\t    height,\r\n\t\t    width,\r\n\t\t    itemsEstimate = 0,\r\n\t\t    items = 0;\r\n\r\n\t\tfor (var i = 0; i < a.length; i++) {\r\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\r\n\t\t\t\tif (a[i][j] == 1) {\r\n\t\t\t\t\trowStart = i;\r\n\t\t\t\t\tcolumnStart = j;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (rowStart !== -1 && columnStart !== -1) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = a.length - 1; i > -1; i--) {\r\n\t\t\tfor (var j = a[i].length - 1; j > -1; j--) {\r\n\t\t\t\tif (a[i][j] == 1) {\r\n\t\t\t\t\trowEnd = i;\r\n\t\t\t\t\tcolumnEnd = j;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (rowEnd !== -1 && columnEnd !== -1) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = rowStart; i < rowEnd; i++) {\r\n\t\t\tfor (var j = columnStart; j < columnEnd; j++) {\r\n\t\t\t\tif (a[i][j] == 0 || a[i][j] == undefined) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < a.length; i++) {\r\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\r\n\t\t\t\tif (a[i][j] == 1) {\r\n\t\t\t\t\titems++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\theight = rowEnd - rowStart + 1;\r\n\t\twidth = columnEnd - columnStart + 1;\r\n\t\titemsEstimate = height * width;\r\n\r\n\t\tif (itemsEstimate !== items) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn [height, width];\r\n\t};\r\n\r\n\t/*\r\n  * This function merges all selected cells.\r\n  * Well, actually sets the colspan and rowspan of first \r\n  * upper left  cell in selection and deletes the another selected cells.\r\n  */\r\n\r\n\ttable.mergeCells = function () {\r\n\t\tvar dimensions = table.isSquare(array),\r\n\t\t    rowspan = dimensions[0],\r\n\t\t    colspan = dimensions[1],\r\n\t\t    first = document.querySelector('.wptb-highlighted'),\r\n\t\t    tds = [].slice.call(document.getElementsByClassName('wptb-highlighted'), 1);\r\n\r\n\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\tvar p = tds[i].parentNode;\r\n\t\t\tp.removeChild(tds[i]);\r\n\t\t}\r\n\r\n\t\tfirst.colSpan = colspan;\r\n\t\tfirst.rowSpan = rowspan;\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * This functions makes the exact inverse as above.\r\n  * It resets colspan and rowspan and appends \r\n  * the same amount in cells to the table.\r\n  * @bug\r\n  */\r\n\r\n\ttable.splitCell = function () {\r\n\t\tvar cell = document.getElementsByClassName('wptb-highlighted')[0],\r\n\t\t    rowspan = cell.rowSpan,\r\n\t\t    colspan = cell.colSpan;\r\n\t\tcell.rowSpan = 1;\r\n\t\tcell.colSpan = 1;\r\n\t\ttable.addLackingCells();\r\n\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Searches for rowspanned cells up to row number meeting it.\r\n  * @param number the number of row where the function\r\n  * must search up to.\r\n  */\r\n\r\n\ttable.findRowspannedCells = function (row) {\r\n\t\tvar array = [],\r\n\t\t    difference;\r\n\t\tactualPoints = getActualPointsInRow(row);\r\n\t\tif (actualPoints === maxAmountOfCells) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tdifference = maxAmountOfCells - actualPoints;\r\n\r\n\t\tfor (var i = row - 1; i >= 0 && difference; i--) {\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td');\r\n\t\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\t\tif (tds[i].rowSpan > 1) {\r\n\t\t\t\t\tarray.push(tds[i]);\r\n\t\t\t\t\tdifference -= tds[i].colSpan;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn array;\r\n\r\n\t}\r\n\r\n\t/*\r\n  * This function explores the table and adds \r\n  * a cell for each lacking one for each row\r\n  * to meet an even amount of cells.\r\n  */\r\n\r\n\ttable.addLackingCells = function () {\r\n\t\tvar sumRows = [];\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tsumRows.push(0);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td');\r\n\t\t\tfor (var j = 0; j < tds.length; j++) {\r\n\t\t\t\tif (tds[j].rowSpan > 1) {\r\n\t\t\t\t\tfor (var k = 1; k < tds[j].rowSpan; k++) {\r\n\t\t\t\t\t\tsumRows[i + k]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td'),\r\n\t\t\t    totalColspan = 0;\r\n\t\t\tfor (var j = 0; j < tds.length; j++) {\r\n\t\t\t\ttotalColspan += tds[j].colSpan;\r\n\t\t\t}\r\n\t\t\ttotalColspan += sumRows[i];\r\n\t\t\tdifference = maxAmountOfCells - totalColspan;\r\n\t\t\tfor (var j = 0; j < difference; j++) {\r\n\t\t\t\tvar td = new WPTB_Cell(mark);\r\n\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/*\r\n  * This function deletes the row of currently\r\n  * selected cell. \r\n  */\r\n\r\n\ttable.deleteRow = function () {\r\n\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    row = getCoords(cell)[0],\r\n\t\t    reduct = table.findRowspannedCells(row);\r\n\r\n\t\tfor (i = 0; i < reduct.length; i++) {\r\n\t\t\treduct[i].rowSpan--;\r\n\t\t}\r\n\r\n\t\ttable.getElementsByTagName('tbody')[0].removeChild(table.rows[row]);\r\n\t\tarray.pop();\r\n\t\tundoSelect();\r\n\t\ttable.addLackingCells();\r\n\t}\r\n\r\n\t/*\r\n  * This function deletes the column of currently\r\n  * selected cell. Again, this is way more complicated than\r\n  * delete row case.\r\n  */\r\n\r\n\ttable.deleteColumn = function () {\r\n\r\n\t\tvar cell_ref = document.querySelector('.wptb-highlighted'),\r\n\t\t    column = getCoords(cell_ref)[1],\r\n                    buffer, cell,\r\n\t\t    carriedRowspans = [];\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarriedRowspans.push(0);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tbuffer = table.rows[i].getElementsByTagName('td');\r\n\t\t\tstepsToMove = 1;\r\n\t\t\tcellPointer = 0;\r\n\t\t\tfor (var j = 0; j < maxAmountOfCells; j += stepsToMove) {\r\n\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (carriedRowspans[j] == 0) {\r\n\t\t\t\t\tcell = buffer[cellPointer++];\r\n\t\t\t\t\tif (cell.rowSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = cell.colSpan;\r\n\t\t\t\t\t\tfor (var k = 0; k < cell.colSpan; k++) {\r\n\t\t\t\t\t\t\tcarriedRowspans[j + k] = cell.rowSpan;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (column > j && column <= j + k - 1) {\r\n\t\t\t\t\t\t\t//cell.style.backgroundColor = 'pink';\r\n\t\t\t\t\t\t\tcell.colSpan--;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (cell.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = cell.colSpan;\r\n\r\n\t\t\t\t\t\tif (column > j && column <= j + cell.colSpan - 1) {\r\n\t\t\t\t\t\t\t//cell.style.backgroundColor = 'pink';\r\n\t\t\t\t\t\t\tcell.colSpan--;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (column == j) {\r\n\t\t\t\t\t\t\ttable.rows[i].removeChild(cell);\r\n\t\t\t\t\t\t\t//cell.style.backgroundColor = 'pink';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var l = 0; l < carriedRowspans.length; l++) {\r\n\t\t\t\tif (carriedRowspans[l] > 0) {\r\n\t\t\t\t\tcarriedRowspans[l]--;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\tmaxAmountOfCells--;\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tif (array[i] != undefined)\r\n\t\t\t\tarray[i].pop();\r\n\t\t}\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\tdocument.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\r\n\r\n\tarray = fillTableArray();\r\n\r\n\tundoSelect();\r\n\tdrawTable(array);\r\n\r\n\twptbTableSetup.appendChild(table);\r\n\r\n\ttable.recalculateIndexes();\r\n\r\n\tWPTB_LeftPanel();\r\n\r\n};","var WPTB_Text = function ( text , DOMElementProt ) {\r\n            var DOMElement = document.createElement('div'),\r\n                elText2 = document.createElement('div'),\r\n                elP = document.createElement('p');\r\n\r\n            elText2.classList.add('editable');\r\n            elP.innerHTML = text != undefined ? text : 'Text';\r\n            elText2.appendChild(elP);\r\n            DOMElement.appendChild(elText2);\r\n        if ( DOMElementProt ) {\r\n            var attributes = [...DOMElementProt.attributes];\r\n            for( let i = 0; i < attributes.length; i++ ) {\r\n                DOMElement.setAttribute(attributes[i].name, attributes[i].value);\r\n            }\r\n        } \r\n\r\n\tthis.kind = 'text';\r\n\tthis.getDOMElement = function () {\r\n            return DOMElement;\r\n\t};\r\n\tapplyGenericItemSettings( this );\r\n\r\n\treturn this;\r\n        \r\n};"]}