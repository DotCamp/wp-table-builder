{"version":3,"sources":["applyGenericItemSettings.js","wptb-builder.js","WPTB_Builder.js","WPTB_Button.js","WPTB_Cell.js","WPTB_ElementCounters.js","WPTB_ElementOptions.js","WPTB_Image.js","WPTB_Initializer.js","WPTB_LeftPanel.js","WPTB_List.js","WPTB_ListItem.js","WPTB_MultipleSelect.js","WPTB_Parser.js","WPTB_Settings.js","WPTB_Space.js","WPTB_Stringifier.js","WPTB_Table.js","WPTB_Text.js"],"names":["applyGenericItemSettings","element","node","getDOMElement","index","document","counter","nextIndex","kind","listItems","onmouseenter","event","classList","add","btnDelete","createElement","btnCopy","btnMove","actions","previous","i","draggable","onclick","act","parentNode","el","removeChild","td","target","temp","srcList","querySelectorAll","length","push","innerHTML","copy","WPTB_List","appendChild","WPTB_Text","childNodes","WPTB_Image","src","WPTB_Button","ondragstart","parent","infArr","type","className","contains","match","img","console","log","dataTransfer","setDragImage","setData","tinyMCE","init","inline","plugins","dialog_type","theme","menubar","fixed_toolbar_container","toolbar","setup","ed","on","execCommand","init_instance_callback","editor","e","getContent","setContent","range","selection","getRng","KeyID","keyCode","startOffset","preventDefault","window","currentEditor","totalWidth","getElementsByClassName","offsetWidth","getElementById","scrollTop","bodyElement","style","display","position","right","top","paste_as_text","onmouseleave","formerActions","par","remove","WPTB_ElementOptions","increment","detectMode","url","location","href","regex","RegExp","results","exec","decodeURIComponent","replace","WPTB_Builder","table_id","http","XMLHttpRequest","ajaxurl","open","setRequestHeader","onreadystatechange","d","readyState","status","WPTB_Parser","responseText","send","ElementCounters","select","MultipleSelect","initializer","WPTB_Initializer","settings","WPTB_Settings","addEventListener","text","DOMElement","elButton2","el_B","undefined","WPTB_Cell","newElementProxy","highlightRow","parentRow","columnCount","parseInt","value","tds","getElementsByTagName","classToAdd","ttd","highlightColumn","rowCount","table","tr","relativeActions","cells","_wptbManagementModeActive","dataset","activeCell","ondragenter","div","getData","ondragover","ondragleave","ondrop","classId","space","t_space","spaceParent","WPTB_Space","nextSibling","onmousedown","activateMultipleSelectMode","pushSelectedCell","onmouseover","onmouseup","deactivateMultipleSelectMode","setCoords","y","x","yIndex","xIndex","getCoords","coords","appendElement","priv","key","elemIdClass","prop","querySelector","cloneNode","properties","optionsClass","children","buttons","size","n_Class","num","affectedEl","b","optionControls","jQuery","wpColorPicker","change","ui","classe","ps","number","backgroundColor","color","toString","slider","oninput","onchange","val","alt","width","height","fontSize","bullets","listStyleType","toLowerCase","file_frame","wp","media","frames","title","button","multiple","attachment","state","get","first","toJSON","MIN_COLUMNS","MIN_ROWS","MAX_COLUMNS","MAX_ROWS","tableGenerator","body","columnsDecrementButton","columnsIncrementButton","rowsDecrementButton","rowsIncrementButton","columnsInput","rowsInput","columns","rows","WPTB_Table","WPTB_LeftPanel","wptbElementButtons","tableRows","j","tableHeader","addInnerBorderSize","tableCells","border","addCellPadding","padding","addInnerBorder","checked","styles","marginBottom","addBorderSize","_val","wptbElement","addRowToTheEnd","addRowToTheStart","addRowBefore","addRowAfter","addColumnToTheEnd","addColumnToTheStart","addColumnBefore","addColumnAfter","deleteColumn","deleteRow","mergeCells","splitCell","innerElements","el_L","item","WPTB_ListItem","divdot","divcontent","libullet","onkeyup","listItemKeyListener","article","content","html","duplicate","append","onkeydown","which","lastP","dontAddItems","insertBefore","focus","selectedCells","multipleCellMode","cell","flushSelectedCells","getFirst","minXIndex","minYIndex","getLast","maxXIndex","maxYIndex","last","removeAllButFirst","code","pos","getChar","getToken","char","token","ctoken","getCurrentToken","getExpectedToken","expected","getWordFromToken","p","indexOf","word","substring","getAttributesFromToken","elems","split","pair","attr","trim","parseAllHTML","analizeElement","t","analizeElements","analizeRows","tableNode","insertRow","analizeTds","analizeTd","row","analizeHeader","header","analizeRoot","n","effectAllowed","getAttribute","messagingArea","WPTB_Stringifier","setTimeout","params","spaceBetween","stopPropagation","tagName","margin","bg1","bg2","bg3","colSpan","rowSpan","isHidden","listClass","buttonSize","buttonColor","buttonBorder","fontColor","fontFamily","additionalCSS","additionalClass","additionalID","borderSize","innerBorder","colspan","rowspan","trueNode","nodeContent","listitems","wptbTableSetup","recalculateIndexes","trs","maxCols","addColumn","referenceTd","newTd","_this","xCoord","k","evt","addRow","referenceRow","active","tbody","firstCell","lastCell","Math","abs","classn","hidden","elText2","elP"],"mappings":"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","file":"admin.js","sourcesContent":["var applyGenericItemSettings = function(element){\r\n\tvar node = element.getDOMElement(),\r\n\t\tindex = document.counter.nextIndex(element.kind),\r\n\t\tlistItems;\r\n\r\n\tnode.onmouseenter = function(event){\r\n        this.classList.add('wptb-directlyhovered');\r\n        var btnDelete = document.createElement('span'),\r\n            btnCopy = document.createElement('span'),\r\n            btnMove = document.createElement('span'),\r\n            actions = document.createElement('span'),\r\n            previous, i;\r\n        actions.classList.add('wptb-actions');\r\n        btnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\r\n        btnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\r\n        btnMove.classList.add(\"dashicons\",\"dashicons-move\", 'move-action');\r\n        btnMove.draggable = true;\r\n        btnDelete.onclick = function (event) {\r\n\t        var act = this.parentNode.parentNode,\r\n\t            el = act.parentNode;\r\n\t        el.removeChild(act); \r\n\t    };\r\n        btnCopy.onclick = function(event){\r\n        \tif(element.kind=='list'){\r\n\r\n\t\t        var td = event.target.parentNode.parentNode.parentNode,\r\n\t\t            temp = [],\r\n\t\t            srcList = event.target.parentNode.parentNode.querySelectorAll('ul article .wptb-list-item-content');\r\n\r\n\t\t        for (var i = 0; i < srcList.length; i++) {\r\n\t\t            temp.push(srcList[i].innerHTML);\r\n\t\t        }\r\n\t\t        var copy = new WPTB_List(temp);\r\n\t\t        td.appendChild(copy.getDOMElement());\r\n    \r\n        \t}\r\n        \telse if(element.kind=='text'){\r\n        \t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t            \tcopy = new WPTB_Text(event.target.parentNode.parentNode.childNodes[0].innerHTML);\r\n\t        \ttd.appendChild(copy.getDOMElement());\r\n        \t}else if(element.kind=='image'){\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t            \tcopy = new WPTB_Image(event.target.parentNode.parentNode.childNodes[0].src);\r\n\t        \ttd.appendChild(copy.getDOMElement());\r\n        \t}\r\n        \telse{\r\n        \t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t            copy = new WPTB_Button(event.target.parentNode.parentNode.childNodes[0].innerHTML);\r\n\t\t        td.appendChild(copy.getDOMElement());\r\n        \t}\r\n        };\r\n        btnMove.ondragstart = function(event){\r\n        \tvar parent = this,infArr,type;\r\n\r\n        \twhile(parent.className == '' || \r\n        \t\t! parent.classList.contains('wptb-ph-element') ){\r\n        \t\tparent = parent.parentNode;\r\n        \t}\r\n\r\n\r\n        \tinfArr = parent.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n\t\t\ttype = infArr[1];\r\n\r\n        \tvar img = document.createElement(\"img\");\r\n        \timg.src = \"http://localhost/sandbox/wp-content/plugins/wp-table-builder/inc/admin/views/builder/icons/\"+type+\".png\";\r\n        \tconsole.log(img.src);\r\n\t\t    event.dataTransfer.setDragImage(img, 0, 0);\r\n\t\t    event.dataTransfer.setData('node','wptb-element-'+infArr[1]+'-'+infArr[2]);\r\n        \t};\r\n\r\n\r\n        if(element.kind === 'button'){\r\n        \ttinyMCE.init({\r\n\t            target: node.childNodes[0].childNodes[0],\r\n\t            inline: true,\r\n\t            plugins: \"link\",\r\n\t            dialog_type: \"modal\",\r\n\t            theme: 'modern',\r\n\t            menubar: false,\r\n\t            fixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t            toolbar: 'bold italic strikethrough',\r\n\t            setup: function (ed) {\r\n\t                ed.on(\"init\",\r\n\t                    function (ed) {\r\n\t                        tinyMCE.execCommand('mceRepaint');\r\n\t                    }\r\n\t                );\r\n\t            },\r\n\t            init_instance_callback: function (editor) {\r\n\t                editor.on('change', function (e) {\r\n\t                    // check if it becomes empty because if there's no value it's hard to edit the editor in button element\r\n\t                    if (editor.getContent() == \"\") {\r\n\t                        editor.setContent(\"<p class='wptb-button'>Button Text</p>\");\r\n\t                    }\r\n\t                });\r\n\t                editor.on('KeyDown', function (e) {\r\n\t                    var range = editor.selection.getRng();\r\n\t                    var KeyID = e.keyCode;\r\n\t                    if (range.startOffset == 0 && (KeyID == 8 || KeyID == 46)) {\r\n\t                        e.preventDefault();\r\n\t                        editor.setContent(\"<p class='wptb-button'></p>\");\r\n\t                    }\r\n\t                });\r\n\r\n\t                window.currentEditor = editor;\r\n\t                editor.on('focus', function (e) {\r\n\t                    \r\n\t                    var totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t        if (window.currentEditor &&\r\n\t\t\t\t            document.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t            window.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t        } else {\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t            delete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t            delete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t        }\r\n\t                });\r\n            \r\n\t            }\r\n\t        });\r\n        }\r\n        else if(element.kind === 'text'){\r\n        \ttinyMCE.init({\r\n\t            target: node.childNodes[0],\r\n\t            inline: true,\r\n\t            plugins: \"link, paste\",\r\n\t            dialog_type: \"modal\",\r\n\t            theme: 'modern',\r\n\t            menubar: false,\r\n\t            fixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t            paste_as_text: true,\r\n\t            toolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\r\n\t            init_instance_callback: function (editor) {\r\n\t                window.currentEditor = editor;\r\n\t                editor.on('focus', function (e) {\r\n\t                \t\r\n\t                    var totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t        if (window.currentEditor &&\r\n\t\t\t\t            document.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t            window.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t        } else {\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t            delete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t            delete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t        }\r\n\t                });\r\n\t            }\r\n\t        });\r\n\r\n        }\r\n        else{\r\n        \tlistItems = node.getElementsByClassName('wptb-list-item-content');\r\n        \tfor (var i = 0; i < listItems.length; i++) {\r\n        \t\ttinyMCE.init({\r\n\t\t            target: listItems[i],\r\n\t\t            inline: true,\r\n\t\t            plugins: \"link, paste\",\r\n\t\t            dialog_type: \"modal\",\r\n\t\t            theme: 'modern',\r\n\t\t            menubar: false,\r\n\t\t            fixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t\t            paste_as_text: true,\r\n\t\t            toolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\r\n\t\t            init_instance_callback: function (editor) {\r\n\t\t                window.currentEditor = editor;\r\n\t\t                editor.on('focus', function (e) {\r\n\t\t                    var totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t        if (window.currentEditor &&\r\n\t\t\t\t            document.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t            window.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t        } else {\r\n\t\t\t\t            document.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t            delete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t            delete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t        }\r\n\t\t                });\r\n\t\t            }\r\n\t\t        });\r\n        \t}\r\n        }\r\n\r\n        actions.appendChild(btnMove);\r\n        actions.appendChild(btnCopy);\r\n        actions.appendChild(btnDelete);\r\n        this.appendChild(actions);\r\n\t};\r\n\r\n\tnode.onmouseleave = function(event){\r\n\t\tvar formerActions = this.getElementsByClassName('wptb-actions');\r\n        if (formerActions && formerActions[0]) {\r\n            let par = formerActions[0].parentNode;\r\n            par.removeChild(formerActions[0]);\r\n        }\r\n        this.classList.remove('wptb-directlyhovered');\r\n\t};\r\n\r\n\tnode.classList.add('wptb-ph-element', 'wptb-element-'+element.kind+'-' +\r\n           index);\r\n\r\n\tnew WPTB_ElementOptions(element,index);\r\n\r\n\tdocument.counter.increment(element.kind);\r\n     \r\n};","","(function(){  \r\n\r\n\tfunction detectMode() {\r\n\t    var url = window.location.href, \r\n\t    \tregex = new RegExp('[?&]table(=([^&#]*)|&|#|$)'),\r\n\t        results = regex.exec(url);\r\n\t    if (!results) return false;\r\n\t    if (!results[2]) return '';\r\n\t    return decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n\t}\r\n\t\r\n\tvar WPTB_Builder = function(){ \r\n\t\tvar table_id = detectMode();\r\n\t\tif(table_id){\r\n\t\t\tvar http = new XMLHttpRequest(),\r\n        \turl = ajaxurl+\"?action=get_table\"+'&id='+table_id;\r\n\t\t\thttp.open('GET', url, true);\r\n\t\t\thttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n\t\t\thttp.onreadystatechange = function(d) {\r\n\t            if (this.readyState == 4 && this.status == 200) {\r\n            \t\tdocument.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\r\n\t                document.getElementsByClassName('wptb-table-setup')[0].appendChild(WPTB_Parser(http.responseText));\r\n\t            }\r\n\t\t\t}\r\n\t\t\thttp.send(null);\r\n\t\t}\r\n\t\tdocument.counter = new ElementCounters();\r\n\t\tdocument.select = new MultipleSelect();\r\n\r\n\t\tvar initializer = WPTB_Initializer();\r\n\t\t\tsettings = WPTB_Settings();\r\n\t};\r\n\r\n\tdocument.addEventListener('DOMContentLoaded', WPTB_Builder); \r\n})();","var WPTB_Button = function(text){\r\n        var DOMElement = document.createElement('div'),\r\n        \telButton2 = document.createElement('div'),\r\n        \tel_B = document.createElement('p');\r\n\r\n\t\tthis.kind = 'button';\r\n\r\n        DOMElement.classList.add('wptb-button-container');\r\n        elButton2.classList.add('wptb-button-wrapper');\r\n        el_B.classList.add('wptb-button');\r\n        el_B.classList.add('editable');\r\n        el_B.innerHTML = text != undefined ? text : 'Button Text';\r\n        elButton2.appendChild(el_B);\r\n        DOMElement.appendChild(elButton2);\r\n\r\n        this.getDOMElement = function (){ \r\n        \treturn DOMElement;\r\n        }\r\n\r\n        applyGenericItemSettings(this);\r\n\r\n        return this;\r\n};","var WPTB_Cell = function(DOMElement){\r\n\r\n\t\tfunction newElementProxy(el){\r\n\t\t\tif(el == 'list'){\r\n                return new WPTB_List();\r\n            }\r\n            else if(el == 'image'){\r\n                return new WPTB_Image();\r\n            }   \r\n            else if(el == 'text'){\r\n                return new WPTB_Text();\r\n            }\r\n            else if(el == 'button'){\r\n                return new WPTB_Button();\r\n            }\r\n\t\t}\r\n\r\n        function highlightRow(td){\r\n            var parentRow = td.parentNode,\r\n                columnCount = parseInt(document.getElementById('wptb-columns-number').value),\r\n                tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n                for (var i = 0; i < tds.length; i++) {\r\n                    tds[i].classList.remove('highlighted-row-first','highlighted-row-last','highlighted-row-inner',\r\n                                            'highlighted-column-first','highlighted-column-last','highlighted-column-inner');\r\n                }\r\n                for (var i = 0; i < columnCount; i++) {\r\n\r\n                    var classToAdd = (i == 0 ? 'highlighted-row-first' : \r\n                                    (i == columnCount-1 ? 'highlighted-row-last' \r\n                                        : 'highlighted-row-inner'));\r\n                    var ttd = parentRow.getElementsByTagName('td')[i];\r\n                    if(ttd!==td){\r\n                    ttd.classList.add(classToAdd);\r\n                    }\r\n                }\r\n        }\r\n\r\n        function highlightColumn(td){\r\n           \r\n            var index,\r\n                parentRow = td.parentNode;\r\n                columnCount = parseInt(document.getElementById('wptb-columns-number').value),\r\n                rowCount = parseInt(document.getElementById('wptb-rows-number').value),\r\n                table = document.getElementsByClassName('wptb-preview-table')[0];\r\n                for (var i = 0; i < columnCount; i++) {\r\n                    if(parentRow.getElementsByTagName('td')[i] === td ){\r\n                        index = i;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                for (var i = 0; i < rowCount; i++) {\r\n                    var classToAdd = (i == 0 ? 'highlighted-column-first' : \r\n                                    (i == rowCount-1 ? 'highlighted-column-last' \r\n                                        : 'highlighted-column-inner'));\r\n                    var tr = table.getElementsByTagName('tr')[i];\r\n                    if(tr.getElementsByTagName('td')[index]!==td){\r\n                        tr.getElementsByTagName('td')[index].classList.add(classToAdd);\r\n                    }\r\n                }\r\n        }\r\n        \r\n        DOMElement = document.createElement(\"td\");\r\n\r\n        DOMElement.draggable = false;\r\n        \r\n        DOMElement.classList.add('wptb-droppable', 'wptb-cell');  \r\n\r\n        DOMElement.onclick = function(){\r\n\r\n        \tvar relativeActions, cells;\r\n\r\n        \tif(window._wptbManagementModeActive){\r\n        \t\treturn;\r\n        \t}\r\n        \tif(this.classList.contains('wptb-highlighted')){\r\n        \t\t//this.classList.remove('wptb-highlighted');\r\n        \t}\r\n        \telse{\r\n        \t\trelativeActions = document.getElementsByClassName('wptb-relative-action');\r\n        \t\tcells = document.getElementsByTagName('td');\r\n\r\n        \t\tfor (var i = 0; i < relativeActions.length; i++) {        \t\t\t \r\n        \t\t\trelativeActions[i].dataset.activeCell = this;\r\n        \t\t}\r\n\r\n        \t\tfor (var i = 0; i < cells.length; i++) {\r\n        \t\t\tcells[i].classList.remove('wptb-highlighted');\r\n        \t\t}\r\n\r\n        \t\tthis.classList.add('wptb-highlighted');    \r\n                highlightRow(this);\r\n                highlightColumn(this);\r\n\r\n        \t}\r\n        \t\r\n        };\r\n\r\n        DOMElement.ondragenter = function(e){\r\n        \tvar div;\r\n            if(!e.dataTransfer.getData('wptbElement') \r\n                && !e.dataTransfer.getData('node')){\r\n                return;\r\n            }\r\n        \tthis.classList.add('wptb-drop-here-empty');\r\n        }\r\n\r\n        DOMElement.ondragover = function(e){\r\n        \te.preventDefault();\r\n        }\r\n\r\n        DOMElement.ondragleave = function(){\r\n        \tthis.classList.remove('wptb-drop-here-empty');\r\n\r\n        }\r\n\r\n        DOMElement.ondrop = function(e){\r\n        \tvar element, classId, space, t_space, spaceParent;\r\n        \te.preventDefault();\r\n            space = new WPTB_Space();\r\n\r\n            console.log(e.dataTransfer);\r\n\r\n            if(!e.dataTransfer.getData('wptbElement') \r\n                && !e.dataTransfer.getData('node')){\r\n                return;\r\n            }\r\n\r\n            if(e.dataTransfer.getData('wptbElement')){\r\n        \t   element = newElementProxy(e.dataTransfer.getData('wptbElement'));\r\n                if(this.innerHTML==''){\r\n                    this.appendChild(new WPTB_Space());\r\n                }\r\n                this.appendChild(element.getDOMElement());\r\n                this.appendChild(space);\r\n        \t}\r\n            else{\r\n\r\n                classId = e.dataTransfer.getData('node');\r\n                element = document.getElementsByClassName(classId)[0];\r\n                if(this.innerHTML==''){\r\n                    t_space = element.nextSibling;\r\n                    spaceParent = element.parentNode;\r\n                    if(t_space != undefined){\r\n                        spaceParent.removeChild(t_space);\r\n                    }\r\n                    this.appendChild(new WPTB_Space());\r\n                }\r\n                this.appendChild(element);\r\n                this.appendChild(space);\r\n            }\r\n        \tthis.classList.remove('wptb-drop-here-empty');\r\n        \treturn true;\r\n        }\r\n\r\n        DOMElement.onmousedown = function(){\r\n            console.log(\"MOUSE DOWN!\");\r\n            document.select.activateMultipleSelectMode();\r\n            document.select.pushSelectedCell(this);\r\n        };\r\n\r\n        DOMElement.onmouseover = function(){\r\n            document.select.pushSelectedCell(this);\r\n        };\r\n\r\n        DOMElement.onmouseup = function(){\r\n            console.log(\"MOUSE UP!\");\r\n            document.select.deactivateMultipleSelectMode();\r\n        };\r\n\r\n        this.getDOMElement = function (){ \r\n        \treturn DOMElement;\r\n        }\r\n\r\n        this.setCoords = function(y,x){\r\n        \tvar el = this.getDOMElement();\r\n        \tel.dataset.yIndex = y;\r\n        \tel.dataset.xIndex = x;\r\n        }\r\n\r\n        this.getCoords = function(){\r\n        \tvar coords,\r\n        \t\tel = this.getDOMElement();\r\n        \tcoords.x = el.dataset.xIndex;\r\n        \tcoords.y = el.dataset.yIndex;\r\n        \treturn coords;\r\n        }\r\n\r\n        this.appendElement = function(node){\r\n        \tgetDOMElement().appendChild(node);\r\n        }\r\n\r\n        return this;\r\n\r\n};","var ElementCounters = function(){\r\n\tvar priv = [];\r\n\tpriv['text'] = 0;\r\n\tpriv['image'] = 0;\r\n\tpriv['list'] = 0;\r\n\tpriv['button'] = 0; \r\n\r\n\tthis.increment = function(key){\r\n\r\n\t\tif(! (key in priv) ){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tpriv[key]++;\r\n\t}\r\n\tthis.nextIndex = function(key){\r\n\r\n\t\tif(! (key in priv) ){\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\treturn priv[key] + 1;\r\n\t}\r\n\treturn this;\r\n};","var WPTB_ElementOptions = function(element,index){\r\n\r\n\tvar node = element.getDOMElement(), elemIdClass;\r\n\r\n\tprop = document.querySelector(\".wptb-\" + element.kind + \"-options-prototype\").cloneNode(true);\r\n    prop.classList.remove(\"wptb-\" + element.kind + \"-options-prototype\"); // remove prototype from the class\r\n    elemIdClass='wptb-options-' + element.kind + \"-\" +  index;\r\n\r\n    var properties = prop.getElementsByClassName('wptb-element-property');\r\n\r\n    for (var i = 0; i < properties.length; i++) {\r\n    \tproperties[i].dataset.element = elemIdClass;\r\n    }\r\n\r\n    prop.classList.add(elemIdClass);\r\n    document.getElementById(\"element-options-group\").appendChild(prop);\r\n\r\n    node.onclick = function(){\r\n        var infArr = this.className.match(/wptb-element-((.+-)\\d+)/i),\r\n\t\t\toptionsClass = '.wptb-' + infArr[2] + 'options' +\r\n                        '.wptb-options-' + infArr[1];\r\n\r\n    \tdocument.getElementById('add-elements').getElementsByTagName('a')[0].classList.remove('active');\r\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.add('active');\r\n\t\t\r\n\t\tdocument.getElementsByClassName('wptb-elements-container')[0].style.display = 'none';\r\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'none';\r\n        document.getElementById(\"element-options-group\").style.display = 'block';\r\n\r\n        var children = document.getElementById(\"element-options-group\").childNodes;\r\n        for (var i = 0; i < children.length; i++) {\r\n            if (children[i].style)\r\n                children[i].style.display = 'none';\r\n        }\r\n\r\n        document.querySelector(optionsClass).style.display = 'block';\r\n    };\r\n\r\n    if(element.kind == 'button'){\r\n        //We must add this special kind of property, since it is triggered with click event\r\n        var buttons = prop.getElementsByClassName('wptb-btn-size-btn');\r\n\r\n        for (var i = 0; i < buttons.length; i++) {\r\n            buttons[i].onclick = function(){\r\n                console.log('Now we should change button size');\r\n                var size = this.innerHTML,\r\n                n_Class = this.dataset.element,\r\n                infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                type = infArr[1],\r\n                num = infArr[2],\r\n                affectedEl = document.getElementsByClassName('wptb-element-'+type+'-'+num)[0];\r\n                affectedEl.classList.remove('wptb-size-S');\r\n                affectedEl.classList.remove('wptb-size-M');\r\n                affectedEl.classList.remove('wptb-size-L');\r\n                affectedEl.classList.remove('wptb-size-XL');\r\n                affectedEl.classList.add('wptb-size-'+size);\r\n                var b = prop.getElementsByClassName('wptb-btn-size-btn');\r\n                for (var i = 0; i < b.length; i++) {\r\n                    b[i].classList.remove('selected');\r\n                }\r\n                this.classList.add('selected');\r\n            }\r\n        }\r\n    }\r\n\r\n    var optionControls = prop.getElementsByClassName('wptb-element-property');\r\n\r\n    for (var i = 0; i < optionControls.length; i++) {\r\n    \tif(optionControls[i].classList.contains('wptb-color-picker')){\r\n    \t\tjQuery(optionControls[i]).wpColorPicker({\r\n                change: function(event, ui){\r\n                    var parent = event.target, classe, type, ps, number;\r\n \r\n\r\n\r\n                    classe = parent.dataset.element.match(/wptb-options-(.+)-(\\d+)/i);\r\n                    type = classe[1];\r\n                    number = classe[2]; \r\n                    affectedEl = document.getElementsByClassName('wptb-element-'+type+'-'+number)[0];\r\n                    if(type=='button'){\r\n                        affectedEl.getElementsByClassName('wptb-button')[0].style.backgroundColor = ui.color.toString();\r\n                    }\r\n                    else{\r\n                        ps = affectedEl.getElementsByTagName(\"p\");\r\n                        for (var i = 0; i < ps.length; i++) {\r\n                                ps[i].style.color =  ui.color.toString();\r\n                        } \r\n                    }\r\n                }\r\n            });\r\n    \t}\r\n\r\n        if(optionControls[i].dataset.type === 'font-size'){\r\n            var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-text-font-size-slider')[0];\r\n            slider.oninput = function(){\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].value = this.value;\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].onchange();\r\n            }\r\n        }\r\n\r\n    \toptionControls[i].onchange = function(event){\r\n\r\n    \t\tvar n_Class = this.dataset.element,\r\n    \t\t\tinfArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n\t\t\t\ttype = infArr[1],\r\n                num = infArr[2],\r\n    \t\t\taffectedEl = document.getElementsByClassName('wptb-element-'+type+'-'+num)[0],\r\n    \t\t\tval = this.value;\r\n \r\n\r\n    \t\tswitch(this.dataset.type){\r\n                case 'src':\r\n                        var img = affectedEl.getElementsByTagName(\"img\")[0];\r\n                        img.src=this.value;\r\n                        break; \r\n                    case 'alternative-text':\r\n                        var img = affectedEl.getElementsByTagName(\"img\")[0];\r\n                        img.alt=this.value;\r\n                        break;\r\n                    case 'image-width':\r\n                        var img = affectedEl.getElementsByTagName(\"img\")[0];\r\n                        console.log(img,this.value);\r\n                        img.width=this.value;\r\n                        break; \r\n                    case 'image-height':\r\n                        var img = affectedEl.getElementsByTagName(\"img\")[0];\r\n                        img.height=this.value;\r\n                        break; \r\n    \t\t\tcase 'font-size':\r\n                        var ps = affectedEl.getElementsByTagName(\"p\");\r\n                        for (var i = 0; i < ps.length; i++) {\r\n                            ps[i].style.fontSize =  val + 'px';\r\n                        }\r\n\r\n                        this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-slider')[0].value = this.value;\r\n                        \r\n                        break;\r\n                    case 'color':\r\n                        var ps = affectedEl.getElementsByTagName(\"p\");\r\n                        for (var i = 0; i < ps.length; i++) {\r\n                            ps[i].style.color =  val;\r\n                        } \r\n                        break;\r\n                    case 'button-color': console.log('Event called!'); \r\n                                        break;\r\n                    case 'list-class': \r\n                        if (val == 'unordered') {\r\n                            event.target\r\n                                .parentNode\r\n                                .parentNode\r\n                                .querySelector('[data-type=list-style-type]')\r\n                                .parentNode\r\n                                .style\r\n                                .display= 'flex';\r\n                            var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                            for (var i = 0; i < bullets.length; i++) {\r\n                                bullets[i].style.listStyleType= 'disc';\r\n                            }\r\n                            document.querySelector('[data-type=list-style-type]').value = 'disc';\r\n                        } else {\r\n                            event.target\r\n                                .parentNode\r\n                                .parentNode\r\n                                .querySelector('[data-type=list-style-type]')\r\n                                .parentNode\r\n                                .style\r\n                                .display= 'none';\r\n                            var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                            for (var i = 0; i < bullets.length; i++) {\r\n                                bullets[i].style.listStyleType= 'decimal';\r\n                            } \r\n                        }\r\n                        break; \r\n                    case 'list-style-type':\r\n                            var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                            for (var i = 0; i < bullets.length; i++) {\r\n                                bullets[i].style.listStyleType= val.toLowerCase();\r\n                            } \r\n                        break;\r\n    \t\t}\r\n    \t};\r\n    }\r\n};","var WPTB_Image = function(src){\r\n        var DOMElement = document.createElement('div'),\r\n        \timg = document.createElement('img');\r\n\r\n\t\tthis.kind = 'image';\r\n\r\n        DOMElement.appendChild(img);\r\n\r\n        this.getDOMElement = function (){ \r\n        \treturn DOMElement;\r\n        }\r\n        applyGenericItemSettings(this);\r\n\r\n        file_frame = wp.media.frames.file_frame = wp.media({\r\n                                        title: 'Select a image to upload',\r\n                                        button: {\r\n                                                text: 'Use this image',\r\n                                        },\r\n                                        multiple: false  \r\n                                });\r\n                                // When an image is selected, run a callback.\r\n                                file_frame.on( 'select', function() {\r\n                                        attachment = file_frame.state().get('selection').first().toJSON();\r\n                                        img.src = attachment.url; \r\n                                });\r\n                                        // Finally, open the modal\r\n        if(src==undefined){\r\n                file_frame.open();\r\n        }\r\n        else{\r\n                img.src=src;\r\n        }\r\n\r\n        return this;\r\n};","var WPTB_Initializer = function(){\r\n\tconst MIN_COLUMNS = 1,\r\n\t\t  MIN_ROWS = 1,\r\n\t\t  MAX_COLUMNS = 10,\r\n\t\t  MAX_ROWS = 10;\r\n\r\n\tvar tableGenerator = document.body;\r\n\t\tcolumnsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[0],\r\n\t\tcolumnsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[0],\r\n\t\trowsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[1],\r\n\t\trowsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[1],\r\n\t\tcolumnsInput = document.getElementById('wptb-columns-number'),\r\n\t\trowsInput = document.getElementById('wptb-rows-number');\r\n\r\n\r\n\t\tcolumnsDecrementButton.onclick = function(){\r\n\t\t\tif(columnsInput.value > MIN_COLUMNS){\r\n\t\t\t\tcolumnsInput.value--;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tcolumnsIncrementButton.onclick = function(){\r\n\t\t\tif(columnsInput.value < MAX_COLUMNS){\r\n\t\t\t\tcolumnsInput.value++;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\trowsDecrementButton.onclick = function(){\r\n\t\t\tif(rowsInput.value > MIN_ROWS){\r\n\t\t\t\trowsInput.value--;\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\trowsIncrementButton.onclick = function(){\r\n\t\t\tif(rowsInput.value < MAX_ROWS){\r\n\t\t\t\trowsInput.value++;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\tdocument.getElementById('wptb-generate-table').onclick = function(){\r\n\r\n\t\t\t var columns = document.getElementById('wptb-columns-number').value,\r\n\t\t\t \t rows = document.getElementById('wptb-rows-number').value;\r\n\r\n\t\t\t WPTB_Table(columns, rows);\r\n\t\t}\r\n\r\n};","var WPTB_LeftPanel = function(){\r\n\tvar table = document.getElementsByClassName('wptb-preview-table')[0],\r\n\twptbElementButtons = document.getElementsByClassName('wptb-element');\r\n\r\n\tjQuery('#wptb-even-row-bg').wpColorPicker({\r\n\t\tchange: function(event,ui){\r\n                var tableRows = table.getElementsByTagName('tr');\r\n                for (var i = 1; i < tableRows.length; i+=2) {\r\n                \ttds = tableRows[i].getElementsByTagName('td');\r\n                \tfor (var j = 0; j < tds.length; j++) {\r\n                \t\ttds[j].style.backgroundColor = ui.color.toString();\r\n                \t} \r\n                }\r\n    \t}\r\n\t}); \r\n    jQuery('#wptb-odd-row-bg').wpColorPicker({\r\n    \tchange: function(event,ui){\r\n                var tableRows = table.getElementsByTagName('tr');\r\n                for (var i = 2; i < tableRows.length; i+=2) {\r\n                \ttds = tableRows[i].getElementsByTagName('td');\r\n                \tfor (var j = 0; j < tds.length; j++) {\r\n                \t\ttds[j].style.backgroundColor = ui.color.toString();\r\n                \t} \r\n                }\r\n    \t}\r\n    });\r\n    jQuery('#wptb-table-header-bg').wpColorPicker({\r\n    \tchange: function(event,ui){\r\n                var tableHeader = table.getElementsByTagName('tr')[0],\r\n                \ttds = tableHeader.getElementsByTagName('td');\r\n                \tfor (var j = 0; j < tds.length; j++) {\r\n                \t\ttds[j].style.backgroundColor = ui.color.toString();\r\n                \t} \r\n    \t}\r\n    });\r\n\r\n\r\n\r\n    function addInnerBorderSize(value) {\r\n                var tableCells = table.getElementsByTagName('td');\r\n                for (var i = 0; i < tableCells.length; i++) {\r\n                    tableCells[i].style.border = value + 'px solid';\r\n                }\r\n    }\r\n\r\n    function addCellPadding(value) {\r\n                var tableCells = table.getElementsByTagName('td');\r\n                for (var i = 0; i < tableCells.length; i++) {\r\n                    tableCells[i].style.padding = value + 'px';\r\n                }\r\n    }\r\n\r\n\r\n    function addInnerBorder(checked) {\r\n                var styles;\r\n\r\n                if (checked == 'checked') {\r\n                    document.getElementById('wptb-apply-inner-border').style.marginBottom = '0px';\r\n                    var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n                    for (var i = 0; i < tableCells.length; i++) {\r\n                        tableCells[i].style.border = '1px solid';\r\n                    }\r\n\r\n                    document.getElementById('wptb-inner-border-settings').classList.add('visible');\r\n                } else {\r\n                    document.getElementById('wptb-inner-border-settings').classList.remove('visible');\r\n                    var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n                    for (var i = 0; i < tableCells.length; i++) {\r\n                        tableCells[i].style.border = '';\r\n                    }\r\n                }\r\n    }\r\n\r\n    function addBorderSize(value) {\r\n                table.style.border = value + 'px solid';\r\n    }\r\n\r\n    document.getElementById('wptb-table-cell-slider').oninput = function () {\r\n            document.getElementById('wptb-table-cell-number').value = this.value;\r\n            addCellPadding(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-cell-number').onchange = function () {\r\n            document.getElementById('wptb-table-cell-slider').value = this.value;\r\n            addCellPadding(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-border-slider').oninput = function () {\r\n            document.getElementById('wptb-table-border-number').value = this.value;\r\n            addBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-border-number').onchange = function () {\r\n            document.getElementById('wptb-table-border-slider').value = this.value;\r\n            addBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-inner-border-slider').oninput = function () {\r\n            document.getElementById('wptb-table-inner-border-number').value = this.value;\r\n            addInnerBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-inner-border-number').onchange = function () {\r\n            document.getElementById('wptb-table-inner-border-slider').value = this.value;\r\n            addInnerBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-inner-border-check').onchange = function () {\r\n                var _val = this.checked ? 'checked' : 'unchecked';\r\n                addInnerBorder(_val);\r\n            };\r\n\r\n\tfor (var i = 0; i < wptbElementButtons.length; i++) {\r\n\t\twptbElementButtons[i].ondragstart = function(e){\r\n\t\t\te.dataTransfer.setData('wptbElement',this.dataset.wptbElement);\r\n\t\t}\r\n\t}\r\n\r\n\tdocument.getElementById('wptb-add-end-row').onclick = table.addRowToTheEnd;\r\n\tdocument.getElementById('wptb-add-start-row').onclick = table.addRowToTheStart;\r\n\tdocument.getElementById('wptb-add-row-before').onclick = table.addRowBefore;\r\n\tdocument.getElementById('wptb-add-row-after').onclick = table.addRowAfter;\r\n\tdocument.getElementById('wptb-add-end-column').onclick = table.addColumnToTheEnd;\r\n\tdocument.getElementById('wptb-add-start-column').onclick = table.addColumnToTheStart;\r\n\tdocument.getElementById('wptb-add-column-before').onclick = table.addColumnBefore;\r\n\tdocument.getElementById('wptb-add-column-after').onclick = table.addColumnAfter;\r\n    document.getElementById('wptb-delete-column').onclick = table.deleteColumn;\r\n    document.getElementById('wptb-delete-row').onclick = table.deleteRow;\r\n    document.getElementById('wptb-merge-cells').onclick = table.mergeCells;\r\n    document.getElementById('wptb-split-cell').onclick = table.splitCell;\r\n\tdocument.getElementById('add-elements').onclick = function(){\r\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.remove('active');\r\n        document.getElementById('add-elements').getElementsByTagName('a')[0].classList.add('active');\r\n        document.getElementsByClassName('wptb-elements-container')[0].style.display = 'table';\r\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'block';\r\n        document.getElementById(\"element-options-group\").style.display = 'none';\r\n\t};\r\n};","var WPTB_List = function(innerElements){\r\n    \tvar el_L = document.createElement('ul'), item,\r\n\t\t\tDOMElement = document.createElement('div');\r\n\r\n\t\tthis.kind = 'list';\r\n\r\n        if (!innerElements)\r\n            for (var i = 0; i < 3; i++) {\r\n            \titem = new WPTB_ListItem('List Item ' + (i + 1));\r\n                el_L.appendChild(item.getDOMElement());\r\n            }\r\n        else {\r\n            for (var i = 0; i < innerElements.length; i++) {\r\n            \titem = new WPTB_ListItem(innerElements[i]);\r\n                el_L.appendChild(item.getDOMElement());\r\n            }\r\n        } \r\n        DOMElement.appendChild(el_L);\r\n        //window.addElementOptions('list', elList);\r\n\r\n        this.getDOMElement = function (){ \r\n        \treturn DOMElement;\r\n        }\r\n        applyGenericItemSettings(this);\r\n\r\n        return this;\r\n};","var WPTB_ListItem = function(text){\r\n\r\n        if (text == undefined) text = 'New List Item';\r\n        var DOMElement = document.createElement('article'),\r\n        \tdivdot = document.createElement('div'),\r\n            divcontent = document.createElement('div'),\r\n            libullet = document.createElement('li');\r\n        divdot.classList.add('wptb-list-item-style-dot');\r\n        divcontent.classList.add('wptb-list-item-content');\r\n        libullet.classList.add('wptb-bullet');\r\n        DOMElement.appendChild(divdot);\r\n        DOMElement.appendChild(divcontent);\r\n        divdot.appendChild(libullet);\r\n        divcontent.innerHTML = text;\r\n        divcontent.onkeyup = window.listItemKeyListener;\r\n\r\n        DOMElement.onmouseenter = function (event) {\r\n\r\n            var btnDelete = document.createElement('span'),\r\n                btnCopy = document.createElement('span'),\r\n                actions = document.createElement('span'),\r\n                previous, i;\r\n            actions.classList.add('wptb-actions');\r\n            btnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\r\n            btnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\r\n            this.classList.add('wptb-directlyhovered');\r\n\r\n            btnDelete.onclick = function () {\r\n                var item = this.parentNode.parentNode,\r\n                    parent = item.parentNode;\r\n                parent.removeChild(item);\r\n            };\r\n\r\n            btnCopy.onclick = function (event) {\r\n                console.log('Clicking item');\r\n                var article = event.target.parentNode.parentNode,\r\n                    content = article.querySelector('.wptb-list-item-content'),\r\n                    html = content.innerHTML;\r\n                var duplicate = new WPTB_ListItem(html);\r\n                article.parentNode.appendChild(duplicate.getDOMElement());\r\n            };\r\n\r\n            actions.append(btnCopy, btnDelete);\r\n            this.appendChild(actions);\r\n        };\r\n\r\n        DOMElement.onmouseleave = function (event) {\r\n            this.classList.remove('wptb-directlyhovered');\r\n            var actions = this.parentNode.querySelector('.wptb-actions');\r\n            if (actions != undefined) {\r\n                let parent = actions.parentNode;\r\n                parent.removeChild(actions);\r\n            }\r\n        };\r\n\r\n        divcontent.onkeydown = function (event) {\r\n            var key = (event.which != undefined) ? event.which :\r\n                event.keyCode, \r\n                duplicate, lastP;\r\n            if (key !== 13 ||\r\n                (window.dontAddItems !== undefined && window.dontAddItems === true)) {\r\n                return;\r\n            }\r\n            event.preventDefault();\r\n            duplicate = new WPTB_ListItem(this.innerHTML);\r\n            console.log('duplicate',duplicate.getDOMElement());\r\n            DOMElement.parentNode.insertBefore(duplicate.getDOMElement(),DOMElement);\r\n            console.log(divcontent);\r\n            divcontent.innerHTML = 'New List Item';\r\n            duplicate.getDOMElement().querySelector('.wptb-list-item-content').focus();\r\n\r\n            return false;\r\n        };\r\n\r\n        this.getDOMElement = function (){ \r\n        \treturn DOMElement;\r\n        }\r\n\r\n        return this;\r\n\r\n};","var MultipleSelect = function(){\r\n\t\r\n\tvar selectedCells = [],\r\n\t\tmultipleCellMode = false; \r\n\r\n\tthis.activateMultipleSelectMode = function(){\r\n\t\tselectedCells = [];\r\n\t\tvar tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\ttds[i].classList.remove('wptb-highlighted');\r\n\t\t}\r\n\t\tmultipleCellMode = true;\r\n\t}\r\n\r\n\tthis.deactivateMultipleSelectMode = function(){\r\n\t\tconsole.log(selectedCells);\r\n\t\tmultipleCellMode = false;\r\n\t}\r\n\r\n\tthis.pushSelectedCell = function(cell){ \r\n\t\tif(!multipleCellMode){ \r\n\t\t\treturn;\r\n\t\t}\r\n\t\tselectedCells.push(cell); \r\n\t\tcell.classList.add('wptb-highlighted');\r\n\t};\r\n\r\n\tthis.selectedCells = function(){\r\n\t\treturn selectedCells;\r\n\t}\r\n\r\n\tthis.flushSelectedCells = function(){\r\n\t\tselectedCells = [];\r\n\t}\r\n\r\n\tthis.getFirst = function(){\r\n\t\tvar minXIndex = 1000, minYIndex = 1000, first;\r\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) { \r\n\t\t\tif(minXIndex >= selectedCells[i].dataset.xIndex \r\n\t\t\t\t&& minYIndex >= selectedCells[i].dataset.yIndex)\r\n\t\t\t{ \r\n\t\t\t\tfirst = selectedCells[i];\r\n\t\t\t\tminXIndex = selectedCells[i].dataset.xIndex ;\r\n\t\t\t\tminYIndex = selectedCells[i].dataset.yIndex ;\r\n\t\t\t}\r\n\t\t} \r\n\t\treturn first;\r\n\t}\r\n\r\n\tthis.getLast = function(){\r\n\t\tvar maxXIndex = -1, maxYIndex = -1, last;\r\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) { \r\n\t\t\tif(maxXIndex <= selectedCells[i].dataset.xIndex \r\n\t\t\t\t&& maxYIndex <= selectedCells[i].dataset.yIndex)\r\n\t\t\t{  \r\n\t\t\t\tlast = selectedCells[i];\r\n\t\t\t\tmaxXIndex = selectedCells[i].dataset.xIndex ;\r\n\t\t\t\tmaxYIndex = selectedCells[i].dataset.yIndex ;\r\n\t\t\t}\r\n\t\t} \r\n\t\treturn last;\r\n\t}\r\n\r\n\tthis.removeAllButFirst = function(){\r\n\t\tvar td = this.getFirst();\r\n\t\tfor (var i = 1; i < selectedCells.length; i++) {\r\n\t\t    selectedCells[i].classList.add('wptb-fused-cell-'+td.dataset.xIndex+'-'+td.dataset.yIndex);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n};","var WPTB_Parser = function(code){\r\n\tvar node, pos=0;\r\n\r\n\tfunction getChar(){\r\n\t\tif(pos>=code.length){\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\treturn code[pos++];\r\n\t}\r\n\r\n\tfunction getToken(){\r\n\t\tvar char = getChar(),\r\n\t\t\ttoken=char; \r\n\r\n\t\tif(char !== '['){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tdo{\r\n\t\t\tchar = getChar();\r\n\t\t\tif(char === -1){\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\ttoken+=char;\r\n\t\t}while(char != ']');\r\n \r\n\t\tctoken = token; \r\n\t\t\r\n\t\treturn true;\r\n\t}\r\n\r\n\tfunction getCurrentToken(){\r\n\t\treturn ctoken;\r\n\t}\r\n\r\n\tfunction getExpectedToken(expected){ \r\n\t\tif(getWordFromToken(ctoken) !== expected){\r\n\t\t\tthrow 'There was an error with the file and therefore the table could not be rendered'; \r\n\t\t}\r\n\t\t\r\n\t\tgetToken();\r\n\t}\r\n\r\n\tfunction getWordFromToken(token){ \r\n\t\tvar p = token.indexOf(' '),\r\n\t\tword = token.substring(1,p);\r\n\t\tif(p == -1){ //This is, if token tag has no attributes\r\n\t\t\treturn token;\r\n\t\t}\r\n\t\treturn '['+word+']';\r\n\t}\r\n\r\n\tfunction getAttributesFromToken(){\r\n\t\tvar elems = ctoken.split(' '),\r\n\t\t\tpair,\r\n\t\t\tkey,\r\n\t\t\tvalue,\r\n\t\t\tattr = [];\r\n\t\t\r\n\t\tfor (var i = 1; i < elems.length; i++) {\r\n\t\t\tpair = elems[i].trim().split('='); \r\n\t\t\tkey = pair[0];\r\n\t\t\tvalue = pair[1].substring(1,pair[1].length-1);\r\n\t\t\tattr[key] = value;\r\n\t\t}\r\n \r\n\r\n\t\treturn attr;\r\n\t}\r\n\r\n\tfunction parseAllHTML(){\r\n\t\tvar html='';\r\n\t\tpos--;\r\n\r\n\t\tdo{\r\n\t\t\tchar = getChar();\r\n\t\t\tif(char === -1){\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\thtml+=char;\r\n\t\t}while(char != '[');\r\n\r\n\t\thtml = html.substring(0,html.length-1);\r\n\r\n\t\tpos--;\r\n \r\n\t\treturn html;\r\n\t\t\r\n\t}\r\n\r\n\tfunction analizeElement(){\r\n\t\tvar t = getWordFromToken(getCurrentToken()), html, node;\r\n\t\t\t\r\n\t\tswitch(t){\r\n\t\t\tcase '[text]': attr = getAttributesFromToken();\r\n\t\t\t\t\t\t\tconsole.log('Attributes',attr);\r\n\t\t\t\t\t\t\t getExpectedToken('[text]'); \r\n\t\t\t\t\t\t\thtml = parseAllHTML();\r\n\t\t\t\t\t\t\tnode = new WPTB_Text(html);\r\n\t\t\t\t\t\t\tconsole.log(html);\r\n\t\t\t\t\t\t\tgetToken();\r\n\t\t\t\t\t\t\tgetExpectedToken('[/text]'); \r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\tcase '[button]': attr = getAttributesFromToken();\r\n\t\t\t\t\t\t\tconsole.log('Attributes',attr);\r\n\t\t\t\t\t\t\tgetExpectedToken('[button]'); \r\n\t\t\t\t\t\t\thtml = parseAllHTML();\r\n\t\t\t\t\t\t\tnode = new WPTB_Button(html);\r\n\t\t\t\t\t\t\tgetToken();\r\n\t\t\t\t\t\t\tgetExpectedToken('[/button]'); \r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\tcase '[img]': attr = getAttributesFromToken();\r\n\t\t\t\t\t\t\tconsole.log('Attributes',attr);\r\n\t\t\t\t\t\t\tnode = new WPTB_Image(attr['src']);\r\n\t\t\t\t\t\t\tgetExpectedToken('[img]'); \r\n\t\t\t\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn node.getDOMElement();\r\n\t}\r\n\r\n\tfunction analizeElements(td){\r\n\t\tdo{\r\n\t\t\ttd.appendChild(analizeElement());\r\n\t\t}while(getCurrentToken()=='[image]' \r\n\t\t\t\t|| getCurrentToken()=='[text]' \r\n\t\t\t\t|| getCurrentToken()=='[list]'\r\n\t\t\t\t|| getCurrentToken()=='[button]' );\r\n\t}\r\n\r\n\tfunction analizeRows(tableNode){\r\n\t\tconsole.log('Tr',tr);\r\n\t\tdo{\r\n\t\t\tvar tr = tableNode.insertRow();  \r\n\t\t\ttr.classList.add('wptb-row');\r\n\t\t\tgetExpectedToken('[tr]');\r\n\t\t\tanalizeTds(tr);\r\n\t\t\tgetExpectedToken('[/tr]');\r\n\t\t}while(getWordFromToken(getCurrentToken()) === '[tr]');\r\n\t}\r\n\r\n\tfunction analizeTd(){\r\n\t\tvar td = new WPTB_Cell();\r\n\t\tgetExpectedToken('[td]');\r\n\t\tanalizeElements(td.getDOMElement());\r\n\t\tgetExpectedToken('[/td]');\r\n\t\treturn td.getDOMElement();\r\n\t}\r\n\r\n\tfunction analizeTds(row){\r\n\t\tdo{\r\n\t\t\trow.appendChild(analizeTd());\r\n\t\t}while(getCurrentToken()=='[td]');\r\n\t}\r\n\r\n\tfunction analizeHeader(tableNode){ \r\n\t\tvar header = tableNode.insertRow(); \r\n\t\theader.classList.add('wptb-row','wptb-table-head');\r\n\t\tconsole.log('Tr',header); \r\n\t\tgetExpectedToken('[tr]');\r\n\t\tanalizeTds(header);\r\n\t\tgetExpectedToken('[/tr]');\r\n\t}\r\n\r\n\tfunction analizeRoot(){\r\n\t\tgetToken();\r\n\t\tvar n = document.createElement('table');\r\n\t\tn.classList.add('wptb-preview-table');\r\n\t\tgetExpectedToken('[table]');\r\n\t\tanalizeHeader(n);\r\n\t\tanalizeRows(n);\r\n\t\tgetExpectedToken('[/table]');\r\n\t\treturn n;\r\n\t}\r\n\r\n\tnode = analizeRoot();\r\n\r\n\treturn node;\r\n};","var WPTB_Settings = function(){\r\n\t\r\n\tvar elems = document.getElementsByClassName('wptb-element');\r\n\r\n\tfor (var i = 0; i < elems.length; i++) {\r\n\t\telems[i].ondragstart = function(event){\r\n\t\tevent.dataTransfer.effectAllowed = 'move';\r\n        event.dataTransfer.setData(\"text/plain\", event.target.getAttribute('id'));\r\n\t}\r\n\t};\r\n\r\n\tdocument.getElementsByClassName('wptb-save-btn')[0].onclick = function(){\r\n\t\tvar http = new XMLHttpRequest(),\r\n        \turl = ajaxurl+\"?action=save_table\",\r\n        \tt = document.getElementById('wptb-setup-name').value.trim(), \r\n\t\t\tmessagingArea,\r\n\t\t\tcode = WPTB_Stringifier(document.getElementsByClassName('wptb-preview-table')[0]);\r\n\t\t\t\r\n\t\tif(t === ''){\r\n\t\t\tmessagingArea = document.getElementsByClassName('wptb-messaging')[0];\r\n\t\t\tmessagingArea.innerHTML = 'Error: You must assign a name to the table before saving it.';\r\n\t\t\tmessagingArea.classList.add('warning');\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\tmessagingArea.classList.remove('warning');\r\n\t\t\t},5000);\r\n\t\t}\r\n        console.log('Ajax called');\r\n\t\tvar params = 'title='+t+'&content='+code;\r\n\t\thttp.open('POST', url, true);\r\n\t\thttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n\t\thttp.onreadystatechange = function(d) {\r\n            if (this.readyState == 4 && this.status == 200) {\r\n                messagingArea = document.getElementById('wptb-messaging-area');\r\n\t\t\t\tmessagingArea.innerHTML = 'Success: table \"'+t+'\" was successfully saved.';\r\n\t\t\t\tmessagingArea.classList.add('success');\r\n\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\tmessagingArea.classList.remove('success');\r\n\t\t\t\t},5000);\r\n            }\r\n\t\t}\r\n\t\thttp.send(params);\r\n\t}\r\n};\r\n","var WPTB_Space = function(text){\r\n\r\n    function newElementProxy(el){\r\n            if(el == 'list'){\r\n                return new WPTB_List();\r\n            }\r\n            else if(el == 'image'){\r\n                return new WPTB_Image();\r\n            }   \r\n            else if(el == 'text'){\r\n                return new WPTB_Text();\r\n            }\r\n            else if(el == 'button'){\r\n                return new WPTB_Button();\r\n            }\r\n    }\r\n\r\n    spaceBetween = document.createElement('div'),\r\n    spaceBetween.classList.add('wptb-space-between');\r\n\r\n    spaceBetween.ondragenter = function(){\r\n        this.classList.add('visible');\r\n    };\r\n    spaceBetween.ondragover = function(event){\r\n                event.preventDefault();\r\n        };\r\n\r\n    spaceBetween.ondragleave = function(){\r\n        this.classList.remove('visible');\r\n    };\r\n\r\n    spaceBetween.ondrop = function(event){\r\n        event.stopPropagation();\r\n        \r\n                var p = event.target.nextSibling,\r\n                td = event.target,\r\n                element, t_space,spaceParent; \r\n\r\n                while(!td.classList.contains('wptb-droppable')){\r\n                    td = td.parentNode;\r\n                }\r\n\r\n        if(event.dataTransfer.getData('wptbElement'))\r\n        {\r\n            element = newElementProxy(event.dataTransfer.getData('wptbElement')); \r\n            this.classList.remove('visible');\r\n                \r\n \r\n\r\n            if(p == null){\r\n                td.appendChild(element.getDOMElement());\r\n                td.appendChild(new WPTB_Space());\r\n            }\r\n            else{\r\n                td.insertBefore(element.getDOMElement(),p);\r\n                td.insertBefore(new WPTB_Space(),p);\r\n            } \r\n \r\n\r\n         }\r\n\r\n        else\r\n        {  \r\n                    element = document.getElementsByClassName(event.dataTransfer.getData('node'))[0];\r\n\r\n                    t_space = element.nextSibling;\r\n                    spaceParent = element.parentNode;\r\n                    if(t_space != undefined){\r\n                        spaceParent.removeChild(t_space);\r\n                    }\r\n\r\n                    if(p == null){\r\n                     td.appendChild(element);\r\n                     td.appendChild(new WPTB_Space());\r\n                    }\r\n                    else{\r\n                        td.insertBefore(element,p);\r\n                        td.insertBefore(new WPTB_Space(),p);\r\n                    }  \r\n\r\n            }\r\n        this.classList.remove('visible');\r\n        };\r\n\r\n    return spaceBetween;\r\n};","var WPTB_Stringifier = function(node){\r\n\r\n\tif(node == undefined || node.tagName == undefined){\r\n\t\treturn '';\r\n\t}\r\n\r\n\tvar code='', children = node.childNodes,\r\n\tpadding, margin, bg1, bg2, bg3, border,\r\n\tcolSpan, rowSpan, isHidden, // Table Attributes\r\n\tlistClass, listStyleType, //list attributes\r\n\tbuttonSize, buttonColor, buttonBorder, //button attributes\r\n\tfontSize, fontColor, fontFamily, //text attributes\r\n\tsrc,width,height, //image attributes\r\n\tadditionalCSS, additionalClass, additionalID; // A few global attributes I wanted to add.\r\n\r\n\tswitch(node.tagName.toLowerCase()){\r\n\t\tcase 'table':  \r\n\t\t\t\t\t\tborder = node.style.borderSize;\r\n\t\t\t\t\t\tmargin = node.getElementsByTagName('td')[0].style.margin;\r\n\t\t\t\t\t\tpadding = node.getElementsByTagName('td')[0].style.padding;\r\n\t\t\t\t\t\tinnerBorder = node.getElementsByTagName('td')[0].style.borderSize;\r\n\t\t\t\t\t\tbg1 = node.rows[0].getElementsByTagName('td')[0].style.backgroundColor;\r\n\r\n\t\t\t\t\t\tif(node.rows.length > 1){\r\n\t\t\t\t\t\t\tbg2 = node.rows[1].getElementsByTagName('td')[0].style.backgroundColor;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(node.rows.length > 2){\r\n\t\t\t\t\t\t\tbg3 = node.rows[2].getElementsByTagName('td')[0].style.backgroundColor;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconsole.log(innerBorder); \r\n\t\t\t\t\t\tcode += '[table'\r\n\t\t\t\t\t\t\t\t+(margin != undefined && margin != '' ? ' margin=\"'+margin+'\"' : '')\r\n\t\t\t\t\t\t\t\t+(padding != undefined && padding != '' ? ' padding=\"'+padding+'\"' : '')\r\n\t\t\t\t\t\t\t\t+(innerBorder != undefined ? ' inner-border=\"'+innerBorder+'\"' : '')\r\n\t\t\t\t\t\t\t\t+(bg1 != undefined ? ' data-bg1=\"'+bg1+'\"' : '')\r\n\t\t\t\t\t\t\t\t+(bg2 != undefined ? ' data-bg2=\"'+bg2+'\"' : '')\r\n\t\t\t\t\t\t\t\t+(bg3 != undefined ? ' data-bg3=\"'+bg3+'\"' : '')\r\n\t\t\t\t\t\t\t\t+']';\r\n\r\n\t\t\t\t\t\tfor (var i = 0; i < children.length; i++) {\r\n\t\t\t\t\t\t\tcode += WPTB_Stringifier(children[i]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcode +='[/table]';\r\n\t\t\t\t\tbreak;\r\n\t\tcase 'tbody': \r\n\t\t\t\t\tfor (var i = 0; i < children.length; i++) {\r\n\t\t\t\t\t\t\tcode += WPTB_Stringifier(children[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\tcase 'tr': \r\n\t\t\t\t\tcode += '[tr]';\r\n\r\n\t\t\t\t\t\tfor (var i = 0; i < children.length; i++) {\r\n\t\t\t\t\t\t\tcode += WPTB_Stringifier(children[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcode +='[/tr]';\r\n\t\t\t\t\t\tbreak;\r\n\t\tcase 'td': colspan = node.colSpan;\r\n\t\t\t\t   rowspan = node.rowSpan;\r\n\t\t\t\t   isHidden = node.classList.contains(/^wptb-fused-cell-(\\d+)$/);\r\n\t\t\t\t\tcode += '[td'\r\n\t\t\t\t\t\t\t\t+(colspan != undefined && colspan > 1 ? ' colspan=\"'+colspan+'\"' : '')\r\n\t\t\t\t\t\t\t\t+(rowspan != undefined && rowspan > 1 ? ' rowspan=\"'+rowspan+'\"' : '')\r\n\t\t\t\t\t\t\t\t+(isHidden ? ' hidden=\"true\"' : '')\r\n\t\t\t\t\t+']';\r\n\r\n\t\t\t\t\t\tfor (var i = 0; i < children.length; i++) {\r\n\t\t\t\t\t\t\tcode += WPTB_Stringifier(children[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tcode +='[/td]';\r\n\t\t\t\t\t\tbreak;\r\n\t\tcase 'div': \r\n\t\t\t\t\tif(node.classList.contains('wptb-ph-element')){ \r\n\t\t\t\t\t\t\r\n\t\t\t        var infArr = node.className.match(/wptb-element-(.+)-(\\d+)/i),\r\n\t\t\t        \toptionsClass, trueNode,\r\n\t\t\t        \tnodeContent;\r\n\t\t\t        \tif(infArr == undefined){\r\n\t\t\t        \t\treturn;\r\n\t\t\t        \t} \r\n\t\t\t\t\t\tswitch(infArr[1]){\r\n\t\t\t\t\t\t\tcase 'list': \r\n\t\t\t\t\t\t\t\t\t\ttrueNode = node.getElementsByTagName('ul')[0];\r\n\t\t\t\t\t\t\t\t\t\tif(!trueNode){\r\n\t\t\t\t\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tlistStyleType = trueNode.getElementsByTagName('li')[0].style.listStyleType;\r\n\t\t\t\t\t\t\t\t\t\tlistClass = listStyleType == 'decimal' ? 'numbered' : 'unordered';\r\n\r\n\t\t\t\t\t\t\t\t\t\tcode += '[list'\r\n\t\t\t\t\t\t\t\t\t\t+(listClass != undefined ? ' class=\"'+listClass+'\"' : 'class=\"unordered\"')\r\n\t\t\t\t\t\t\t\t\t\t+(listStyleType != undefined ? ' style-type=\"'+listStyleType+'\"' : '')\r\n\t\t\t\t\t\t\t\t\t\t+']';\r\n\t\t\t\t\t\t\t\t\t\tlistitems = trueNode.getElementsByTagName('article');\r\n\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < listitems.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\tcode+='[item]';\r\n\t\t\t\t\t\t\t\t\t\t\tcode += listitems[i]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.getElementsByClassName('wptb-list-item-content')[0]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.innerHTML;\r\n\t\t\t\t\t\t\t\t\t\t\tcode+='[/item]';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tcode += '[/list]';\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'image': \r\n\r\n\t\t\t\t\t\t\t\t\t\ttrueNode = node.getElementsByTagName('img')[0];\r\n\t\t\t\t\t\t\t\t\t\tif(!trueNode){\r\n\t\t\t\t\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\r\n\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t\tsrc = trueNode.src;\r\n\t\t\t\t\t\t\t\t\t\twidth = trueNode.width;\r\n\t\t\t\t\t\t\t\t\t\theight = trueNode.height;\r\n\t\t\t\t\t\t\t\t\t\talt = trueNode.alt;\r\n\t\t\t\t\t\t\t\t\t\tcode += '[img'+\r\n\t\t\t\t\t\t\t\t\t\t+(src != undefined ? ' src=\"'+src+'\"' : '')\r\n\t\t\t\t\t\t\t\t\t\t+(width != undefined ? ' width=\"'+width+'\"' : '')\r\n\t\t\t\t\t\t\t\t\t\t+(height != undefined ? ' height=\"'+height+'\"' : '')\r\n\t\t\t\t\t\t\t\t\t\t+']';\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'text': \r\n\t\t\t\t\t\t\t\t\t\ttrueNode = node.getElementsByClassName('editable')[0];\r\n\t\t\t\t\t\t\t\t\t\tif(!trueNode){\r\n\t\t\t\t\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\r\n\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t\tfontSize = trueNode.getElementsByTagName('p')[0].style.fontSize;\r\n\t\t\t\t\t\t\t\t\t\tfontColor = trueNode.getElementsByTagName('p')[0].style.color;\r\n\t\t\t\t\t\t\t\t\t\tcode += '[text'\r\n\t\t\t\t\t\t\t\t\t\t+(fontSize != undefined ? ' size=\"'+fontSize+'\"' : '')\r\n\t\t\t\t\t\t\t\t\t\t+(fontColor != undefined ? ' color=\"'+fontColor+'\"' : '')\r\n\t\t\t\t\t\t\t\t\t\t+']';\r\n\t\t\t\t\t\t\t\t\t\tcode+= trueNode.innerHTML;\r\n\t\t\t\t\t\t\t\t\t\tcode += '[/text]';\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'button': \r\n\t\t\t\t\t\t\t\t\t\ttrueNode = node.getElementsByClassName('editable')[0];\r\n\t\t\t\t\t\t\t\t\t\tif(!trueNode){\r\n\t\t\t\t\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tbuttonColor = trueNode.style.backgroundColor;\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(node);\r\n\t\t\t\t\t\t\t\t\t\tbuttonSize = node.className.match(/wptb-size-(.+)/i)[1];\r\n\r\n\t\t\t\t\t\t\t\t\t\tcode += '[button'\r\n\t\t\t\t\t\t\t\t\t\t+(buttonColor != undefined ? ' color=\"'+buttonColor+'\"' : '')\r\n\t\t\t\t\t\t\t\t\t\t+(buttonSize != undefined ? ' size=\"'+buttonSize+'\"' : '')\r\n\t\t\t\t\t\t\t\t\t\t+']';\r\n\t\t\t\t\t\t\t\t\t\tcode += trueNode.innerHTML;\r\n\t\t\t\t\t\t\t\t\t\tcode += '[/button]';\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{ \r\n\t\t\t\t\t\treturn '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\tdefault: \r\n\t\t\t\tcode+= '';\r\n\t\t\t\tbreak;\r\n\t}\r\n\r\n\tif(node.nextSibling != undefined){\r\n\t\tWPTB_Stringifier(node.nextSibling);\r\n\t}\r\n\r\n\treturn code;\r\n};","var WPTB_Table = function(columns, rows){\r\n\t\t\t\r\n\t\t\tvar settings = document.getElementsByClassName('wptb-settings-items'),\r\n\t\t\t\twptbTableSetup = document.getElementsByClassName(\"wptb-table-setup\")[0],\r\n\t\t\t\ttable, row, cell;\r\n\r\n            for (var i = 0; i < settings.length; i++) {\r\n                settings[i].classList.add('visible');\r\n            }\r\n\r\n            document.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\r\n            \r\n\r\n            //Create a HTML Table element.\r\n            table = document.createElement('table');\r\n            table.classList.add('wptb-preview-table');\r\n\r\n\r\n            //Add the header row.\r\n            row = table.insertRow(-1);\r\n            row.classList.add('wptb-table-head', 'wptb-row');\r\n\r\n            for (var i = 0; i < columns; i++) {\r\n                cell = new WPTB_Cell();\r\n                cell.setCoords(0,i); \r\n                row.appendChild(cell.getDOMElement()); \r\n            }\r\n\r\n            //Add the data rows.\r\n            for (var i = 1; i < rows; i++) {\r\n\r\n                row = table.insertRow(-1);\r\n                row.classList.add('wptb-row');\r\n\r\n                for (var j = 0; j < columns; j++) {\r\n                    cell = new WPTB_Cell();\r\n                \tcell.setCoords(i,j); \r\n                    row.appendChild(cell.getDOMElement());\r\n                }\r\n            }\r\n\r\n    \t\ttable.recalculateIndexes = function(){\r\n    \t\t\tvar trs = this.getElementsByTagName('tr'), tds, maxCols= 0;\r\n\r\n\t\t        for (var i = 0; i < trs.length; i++) {\r\n\t\t            tds = trs[i].getElementsByTagName('td');\r\n\t\t            for (var j = 0; j < tds.length; j++) {\r\n\r\n\t\t                if(i==0){ \r\n\t\t                    tds[j].parentNode.className=''; \r\n\t\t                    tds[j].parentNode.classList.add('wptb-row','wptb-table-head');\r\n\t\t                }\r\n\t\t                else{\r\n\t\t                    tds[j].parentNode.className=''; \r\n\t\t                    tds[j].parentNode.classList.add('wptb-row'); \r\n\t\t                }\r\n\r\n\t\t                tds[j].dataset.xIndex = j;\r\n\t\t                tds[j].dataset.yIndex = i;\r\n\t\t            }\r\n\t\t            if(j > maxCols){\r\n\t\t            \tmaxCols = j;\r\n\t\t            }\r\n\t\t        } \r\n\t\t    \tthis.columns = maxCols; \r\n\t\t    \tconsole.log('Table dimensions: '+trs.length+' rows ,'+maxCols+' columns');\r\n    \t\t}\r\n\r\n    \t\ttable.addColumn = function(pos){\r\n\t\t        var referenceTd, newTd, _this, xCoord;\r\n\t\t        referenceTd = this.getElementsByClassName('wptb-highlighted')[0];\r\n\t\t        console.log('Table',this.rows.length);\r\n\t\t        for (var i = 0; i < this.rows.length; i++) {\r\n\t\t            console.log('Iteration '+(i+1));\r\n\t\t            var newTd = new WPTB_Cell(); \r\n\r\n\t\t            if(pos == 'before' || pos == 'after')\r\n\t\t            {\r\n\t\t        \t\txCoord = referenceTd.dataset.xIndex;\r\n\t\t                referenceTd = this.rows[i].getElementsByTagName('td')[0];\r\n\t\t                for (var  j= 0; j < xCoord; j++) {\r\n\t\t                \treferenceTd = this.rows[i].childNodes[j];\r\n\t\t                }\r\n\t\t                \r\n\t\t                if(pos=='before'){\r\n\t\t        \t\t\tconsole.log('referenceTd',referenceTd);\r\n\t\t                    this.rows[i].insertBefore(newTd.getDOMElement(),referenceTd);\r\n\t\t                    \r\n\t\t                    var buttons = document.getElementsByClassName('wptb-relative-action');\r\n\t\t                    for (var k = 0; k < buttons.length; k++) {\r\n\t\t                        buttons[k].dataset.xIndex++;\r\n\t\t                    } \r\n\t\t                }\r\n\t\t                else{\r\n\t\t                    this.rows[i].insertBefore(newTd.getDOMElement(),referenceTd.nextSibling);\r\n\t\t                }\r\n\t\t            }\r\n\t\t            else if(pos=='end'){\r\n\t\t                this.rows[i].appendChild(newTd.getDOMElement());  \r\n\t\t            }\r\n\t\t            else{\r\n\t\t            \treferenceTd = this.rows[i].getElementsByTagName('td')[0];\r\n\t\t            \tthis.rows[i].insertBefore(newTd.getDOMElement(),referenceTd);\r\n\t\t            }\r\n\t\t            table.columns++;\r\n\t\t        }\r\n\r\n\t\t        this.recalculateIndexes();\r\n\t\t    };\r\n\r\n    \t\ttable.addColumnToTheEnd = function(evt){\r\n\t\t        table.addColumn('end',this.dataset.activeCell);\r\n\t\t    };\r\n\r\n\t\t    table.addColumnToTheStart = function(evt){\r\n\t\t        table.addColumn('start',this.dataset.activeCell);\r\n\t\t    };\r\n\r\n\t\t    table.addColumnBefore = function(){\r\n\t\t        table.addColumn('before',this.dataset.activeCell);\r\n\t\t    };\r\n\r\n\t\t    table.addColumnAfter = function(){\r\n\t\t        table.addColumn('after',this.dataset.activeCell);\r\n\t\t    };\r\n\r\n    \t\ttable.addRow = function(pos){\r\n    \t\t\tvar _this, row, referenceRow = undefined;\r\n\t\t            \r\n\t\t        if(pos == 'end' || pos == 'start'){ \r\n\t\t            row = this.insertRow( pos == 'end' ? -1 : 0);\r\n\t\t        }else{\r\n\t\t            row = document.createElement('tr');\r\n\t\t        }\r\n\t\t            \r\n\t\t        for (var j = 0; j < this.columns; j++) {\r\n\t\t            var cell = new WPTB_Cell();\r\n\t\t            row.appendChild(cell.getDOMElement());\r\n\t\t        }\r\n\r\n\t\t        row.classList.add('wptb-row'); \r\n\r\n\t\t        if(pos == 'before' || pos == 'after' ){\r\n\t\t        \t_this = this.getElementsByClassName('wptb-highlighted')[0];\r\n\t\t            referenceRow = this.getElementsByTagName('tr')[_this.dataset.yIndex];\r\n\t\t            if(pos == \"before\"){\r\n\t\t                this.getElementsByTagName('tbody')[0].insertBefore(row,referenceRow);\r\n\t\t                var buttons = document.getElementsByClassName('wptb-relative-action');\r\n\t\t                for (var i = 0; i < buttons.length; i++) {\r\n\t\t                    buttons[i].dataset.yIndex++;\r\n\t\t                } \r\n\t\t            }else{\r\n\t\t                this.getElementsByTagName('tbody')[0].insertBefore(row,referenceRow.nextSibling);\r\n\t\t            }\r\n\t\t        }\r\n\r\n\t\t        if(pos =='before' || pos == 'start'){\r\n\t\t        \tvar active = document.querySelector('wptb-highlighted');\r\n\t\t        \tif(active){\r\n\t\t        \t\tactive.onclick();\r\n\t\t        \t}\r\n\t\t        }\r\n\r\n\t\t        this.recalculateIndexes();\r\n    \t\t};\r\n\r\n    \t\ttable.addRowToTheEnd = function(evt){\r\n\t\t        table.addRow('end');\r\n\t\t    };\r\n\r\n\t\t    table.addRowToTheStart = function(evt){\r\n\t\t        table.addRow('start');\r\n\t\t    };\r\n\r\n\t\t    table.addRowBefore = function(){\r\n\t\t        table.addRow('before');\r\n\t\t    };\r\n\r\n\t\t    table.addRowAfter = function(){\r\n\t\t        table.addRow('after');\r\n\t\t    };\r\n\r\n\t\t    table.deleteRow = function(e){\t        \r\n\t\t        var cell = document.getElementsByClassName('wptb-highlighted')[0],\r\n\t\t        \tindex = cell.dataset.yIndex,\r\n\t\t        \ttable = document.getElementsByClassName('wptb-preview-table')[0],\r\n\t\t            row = table.getElementsByTagName('tr')[index],\r\n\t\t            rowCount = table.rows.length,\r\n\t\t            tbody = row.parentNode;\r\n\t\t        if((rowCount==1 && columnCount==1) || tbody == undefined){\r\n\t\t             return;\r\n\t\t         }\r\n\t\t        tbody.removeChild(row);  \r\n\t\t        this.recalculateIndexes();\r\n\t\t    };\r\n\r\n\t\t    table.deleteColumn= function(e){\r\n\t\t        var cell = document.getElementsByClassName('wptb-highlighted')[0],\r\n\t\t        \tnum = cell.dataset.xIndex,\r\n\t\t        \ttable = document.getElementsByClassName('wptb-preview-table')[0],\r\n\t\t            rowCount = table.rows.length;\r\n\r\n\t\t        if((rowCount==1 && columnCount==1)){\r\n\t\t             return;\r\n\t\t         }\r\n\t\t        for (var i = 0; i < rowCount; i++) {\r\n\t\t             var td = table.getElementsByTagName('tr')[i].getElementsByTagName('td')[num],\r\n\t\t                tr = td.parentNode;\r\n\t\t             tr.removeChild(td);\r\n\t\t        }        \r\n\t\t        this.recalculateIndexes();\r\n\t\t    };\r\n\r\n\t\t    table.mergeCells = function(){\t    \t\r\n\t\t        var firstCell = document.select.getFirst(),\r\n\t\t            lastCell = document.select.getLast(),\r\n\t\t            colspan = Math.abs(lastCell.dataset.xIndex - firstCell.dataset.xIndex) + 1,\r\n\t\t            rowspan = Math.abs(lastCell.dataset.yIndex - firstCell.dataset.yIndex) + 1;\r\n\r\n\t\t            console.log(firstCell);\r\n\t\t            console.log(lastCell);\r\n\t\t            console.log(colspan+' '+rowspan);\r\n\t\t        \r\n\t\t        document.select.removeAllButFirst();\r\n\t\t        \r\n\t\t        if( colspan > 1 ){\r\n\t\t            firstCell.colSpan = colspan;\r\n\t\t        }\r\n\r\n\t\t        if( rowspan > 1 ){\r\n\t\t            firstCell.rowSpan = rowspan;\r\n\t\t        }\r\n\t\t        table.recalculateIndexes();\r\n\t\t    };\r\n\r\n\t\t    table.splitCell = function(){\r\n\t\t        var cell = document.getElementsByClassName('wptb-highlighted')[0],\r\n\t\t        \tclassn, hidden; \r\n\t\t        if(cell.colSpan == 1 && cell.rowSpan == 1){\r\n\t\t        \treturn;\r\n\t\t        }\r\n\r\n\t\t        cell.colSpan = 1;\r\n\t\t        cell.rowSpan = 1;\r\n\r\n\t\t        classn = 'wptb-fused-cell-'+cell.dataset.xIndex+'-'+cell.dataset.yIndex;\r\n\t\t        hidden = document.getElementsByClassName(classn);\r\n\t\t        console.log('Initial:',hidden);\r\n\r\n\t\t        for (; hidden.length; ) {\r\n\t\t        \tconsole.log(hidden[0]);\r\n\t\t        \thidden[0].classList.remove(classn);\r\n\t\t        }\r\n\t\t        table.recalculateIndexes();\r\n\t\t    };\r\n\r\n            wptbTableSetup.appendChild(table);\r\n\r\n            table.recalculateIndexes();\r\n\r\n\t\t    WPTB_LeftPanel();\r\n\r\n             \r\n};","var WPTB_Text = function(text){\r\n        var DOMElement = document.createElement('div'),\r\n                elText2 = document.createElement('div'),\r\n                elP = document.createElement('p');\r\n\r\n                this.kind = 'text';\r\n\r\n        elText2.classList.add('editable');\r\n        elP.innerHTML = text != undefined ? text : 'Text';\r\n        elText2.appendChild(elP);\r\n        DOMElement.appendChild(elText2);\r\n\r\n        this.getDOMElement = function (){ \r\n                return DOMElement;\r\n        }\r\n        applyGenericItemSettings(this);\r\n\r\n        return this;\r\n};"]}