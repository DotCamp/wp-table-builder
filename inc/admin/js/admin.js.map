{"version":3,"sources":["WPTB_Builder.js","WPTB_Button.js","WPTB_Cell.js","WPTB_ElementCounters.js","WPTB_ElementOptions.js","WPTB_Image.js","WPTB_Initializer.js","WPTB_LeftPanel.js","WPTB_List.js","WPTB_ListItem.js","WPTB_MultipleSelect.js","WPTB_Parser.js","WPTB_Settings.js","WPTB_Space.js","WPTB_Stringifier.js","WPTB_Table.js","WPTB_Text.js","applyGenericItemSettings.js","wptb-builder.js"],"names":["detectMode","url","window","location","href","regex","RegExp","results","exec","decodeURIComponent","replace","WPTB_Builder","table_id","http","XMLHttpRequest","ajaxurl","open","setRequestHeader","onreadystatechange","d","readyState","status","document","getElementsByClassName","style","display","appendChild","WPTB_Parser","responseText","send","counter","ElementCounters","select","MultipleSelect","initializer","WPTB_Initializer","settings","WPTB_Settings","addEventListener","WPTB_Button","text","DOMElement","createElement","elButton2","el_B","kind","classList","add","innerHTML","undefined","getDOMElement","applyGenericItemSettings","WPTB_Cell","callback","console","log","newElementProxy","el","WPTB_List","WPTB_Image","WPTB_Text","highlightRow","td","parentRow","parentNode","columnCount","parseInt","getElementById","value","tds","getElementsByTagName","i","length","remove","classToAdd","ttd","highlightColumn","index","rowCount","table","tr","draggable","onclick","ondragenter","e","div","dataTransfer","getData","ondragover","preventDefault","ondragleave","ondrop","element","classId","space","t_space","spaceParent","WPTB_Space","nextSibling","removeChild","setCoords","y","x","dataset","yIndex","xIndex","getCoords","coords","appendElement","node","priv","increment","key","nextIndex","WPTB_ElementOptions","elemIdClass","prop","querySelector","cloneNode","properties","infArr","className","match","optionsClass","children","childNodes","buttons","size","n_Class","type","num","affectedEl","b","optionControls","contains","jQuery","wpColorPicker","change","event","ui","parent","target","classe","ps","number","backgroundColor","color","toString","slider","oninput","onchange","val","img","src","alt","width","height","fontSize","bullets","querySelectorAll","listStyleType","toLowerCase","file_frame","wp","media","frames","title","button","multiple","on","attachment","state","get","first","toJSON","MIN_COLUMNS","MIN_ROWS","MAX_COLUMNS","MAX_ROWS","tableGenerator","body","columnsDecrementButton","columnsIncrementButton","rowsDecrementButton","rowsIncrementButton","columnsInput","rowsInput","columns","rows","WPTB_Table","WPTB_LeftPanel","wptbElementButtons","tableRows","j","tableHeader","addInnerBorderSize","tableCells","border","addCellPadding","padding","addInnerBorder","checked","styles","marginBottom","addBorderSize","_val","ondragstart","setData","wptbElement","toggleTableEditMode","addRowToTheEnd","addRowToTheStart","addRowBefore","addRowAfter","addColumnEnd","addColumnStart","mergeCells","splitCell","innerElements","el_L","item","WPTB_ListItem","divdot","divcontent","libullet","onkeyup","listItemKeyListener","onmouseenter","btnDelete","btnCopy","actions","previous","article","content","html","duplicate","append","onmouseleave","onkeydown","which","keyCode","lastP","dontAddItems","insertBefore","focus","selectedCells","multipleCellMode","activateMultipleSelectMode","deactivateMultipleSelectMode","isActivated","pushSelectedCell","cell","push","flushSelectedCells","getFirst","minXIndex","minYIndex","getLast","maxXIndex","maxYIndex","last","removeAllButFirst","code","pos","getChar","getToken","char","token","ctoken","getCurrentToken","getExpectedToken","expected","getWordFromToken","p","indexOf","word","substring","getAttributesFromToken","elems","split","pair","attr","trim","parseAllHTML","analizeElement","t","analizeElements","analizeRows","tableNode","insertRow","analizeTds","analizeTd","row","analizeHeader","header","analizeRoot","n","effectAllowed","getAttribute","messagingArea","WPTB_Stringifier","setTimeout","params","spaceBetween","stopPropagation","tagName","margin","bg1","bg2","bg3","colSpan","rowSpan","isHidden","listClass","buttonSize","buttonColor","buttonBorder","fontColor","fontFamily","additionalCSS","additionalClass","additionalID","borderSize","innerBorder","colspan","rowspan","trueNode","nodeContent","listitems","array","wptbTableSetup","maxAmountOfCells","maxAmountOfRows","mark","rs","cs","markedCells","position","column","realTimeArray","carried","cols","matriz","items","k","justAssigned","amount","carriedRowspans","colspansAcumulados","bar","recalculateIndexes","trs","maxCols","undoSelect","firstCell","addColumnBefore","addColumnAfter","addRow","_this","referenceRow","active","evt","r","aux","Array","from","drawTable","rowspans","noPending","filter","elem","arr","isSquare","a","rowStart","columnStart","rowEnd","columnEnd","itemsEstimate","string","fillTableArray","colspansSums","cells","colspanSumInRow","Math","max","apply","search","skipInCols","slice","call","shift","deleteRow","tbody","deleteColumn","dimensions","refCell","pt","newCell","elText2","elP","listItems","btnMove","act","temp","srcList","copy","setDragImage","tinyMCE","init","inline","plugins","dialog_type","theme","menubar","fixed_toolbar_container","toolbar","setup","ed","execCommand","init_instance_callback","editor","getContent","setContent","range","selection","getRng","KeyID","startOffset","currentEditor","totalWidth","offsetWidth","scrollTop","bodyElement","right","top","paste_as_text","formerActions","par"],"mappings":"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","file":"admin.js","sourcesContent":["(function () {\n\n\tfunction detectMode() {\n\t\tvar url = window.location.href,\n\t\t\tregex = new RegExp('[?&]table(=([^&#]*)|&|#|$)'),\n\t\t\tresults = regex.exec(url);\n\t\tif (!results) return false;\n\t\tif (!results[2]) return '';\n\t\treturn decodeURIComponent(results[2].replace(/\\+/g, ' '));\n\t}\n\n\tvar WPTB_Builder = function () {\n\t\tvar table_id = detectMode();\n\t\tif (table_id) {\n\t\t\tvar http = new XMLHttpRequest(),\n\t\t\t\turl = ajaxurl + \"?action=get_table\" + '&id=' + table_id;\n\t\t\thttp.open('GET', url, true);\n\t\t\thttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n\t\t\thttp.onreadystatechange = function (d) {\n\t\t\t\tif (this.readyState == 4 && this.status == 200) {\n\t\t\t\t\tdocument.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\n\t\t\t\t\tdocument.getElementsByClassName('wptb-table-setup')[0].appendChild(WPTB_Parser(http.responseText));\n\t\t\t\t}\n\t\t\t}\n\t\t\thttp.send(null);\n\t\t}\n\t\tdocument.counter = new ElementCounters();\n\t\tdocument.select = new MultipleSelect();\n\n\t\tvar initializer = WPTB_Initializer();\n\t\tsettings = WPTB_Settings();\n\t};\n\n\tdocument.addEventListener('DOMContentLoaded', WPTB_Builder);\n\n})();","var WPTB_Button = function (text) {\n\n\tvar DOMElement = document.createElement('div'),\n\t\telButton2 = document.createElement('div'),\n\t\tel_B = document.createElement('p');\n\n\tthis.kind = 'button';\n\n\tDOMElement.classList.add('wptb-button-container');\n\telButton2.classList.add('wptb-button-wrapper');\n\tel_B.classList.add('wptb-button');\n\tel_B.classList.add('editable');\n\tel_B.innerHTML = text != undefined ? text : 'Button Text';\n\telButton2.appendChild(el_B);\n\tDOMElement.appendChild(elButton2);\n\n\tthis.getDOMElement = function () {\n\t\treturn DOMElement;\n\t}\n\n\tapplyGenericItemSettings(this);\n\n\treturn this;\n\n};","var WPTB_Cell = function (callback, DOMElement) {\n\n    console.log('CB', callback);\n    function newElementProxy(el) {\n        if (el == 'list') {\n            return new WPTB_List();\n        }\n        else if (el == 'image') {\n            return new WPTB_Image();\n        }\n        else if (el == 'text') {\n            return new WPTB_Text();\n        }\n        else if (el == 'button') {\n            return new WPTB_Button();\n        }\n    }\n\n    function highlightRow(td) {\n        var parentRow = td.parentNode,\n            columnCount = parseInt(document.getElementById('wptb-columns-number').value),\n            tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\n        for (var i = 0; i < tds.length; i++) {\n            tds[i].classList.remove('highlighted-row-first', 'highlighted-row-last', 'highlighted-row-inner',\n                'highlighted-column-first', 'highlighted-column-last', 'highlighted-column-inner');\n        }\n        for (var i = 0; i < columnCount; i++) {\n\n            var classToAdd = (i == 0 ? 'highlighted-row-first' :\n                (i == columnCount - 1 ? 'highlighted-row-last'\n                    : 'highlighted-row-inner'));\n            var ttd = parentRow.getElementsByTagName('td')[i];\n            if (ttd !== td) {\n                ttd.classList.add(classToAdd);\n            }\n        }\n    }\n\n    function highlightColumn(td) {\n\n        var index,\n            parentRow = td.parentNode;\n        columnCount = parseInt(document.getElementById('wptb-columns-number').value),\n            rowCount = parseInt(document.getElementById('wptb-rows-number').value),\n            table = document.getElementsByClassName('wptb-preview-table')[0];\n        for (var i = 0; i < columnCount; i++) {\n            if (parentRow.getElementsByTagName('td')[i] === td) {\n                index = i;\n                break;\n            }\n        }\n\n        for (var i = 0; i < rowCount; i++) {\n            var classToAdd = (i == 0 ? 'highlighted-column-first' :\n                (i == rowCount - 1 ? 'highlighted-column-last'\n                    : 'highlighted-column-inner'));\n            var tr = table.getElementsByTagName('tr')[i];\n            if (tr.getElementsByTagName('td')[index] !== td) {\n                tr.getElementsByTagName('td')[index].classList.add(classToAdd);\n            }\n        }\n    }\n\n    DOMElement = document.createElement(\"td\");\n\n    DOMElement.draggable = false;\n\n    DOMElement.classList.add('wptb-droppable', 'wptb-cell');\n\n    DOMElement.onclick = callback; /*function(){\n\n        \tvar relativeActions, cells;\n\n        \tif(!document.select.isActivated()){\n        \t\treturn;\n        \t}\n        \telse{\n        \t \n\n            if(this.classList.contains('wptb-highlighted')){\n                this.classList.remove('wptb-highlighted');\n            }\n            else{\n                console.log('Not contains');\n        \t\tthis.classList.add('wptb-highlighted');    \n                //highlightRow(this);\n                //highlightColumn(this);\n            }\n\n        \t}\n        \t\n        };*/;\n\n    DOMElement.ondragenter = function (e) {\n        var div;\n        if (!e.dataTransfer.getData('wptbElement')\n            && !e.dataTransfer.getData('node')) {\n            return;\n        }\n        this.classList.add('wptb-drop-here-empty');\n    }\n\n    DOMElement.ondragover = function (e) {\n        e.preventDefault();\n    }\n\n    DOMElement.ondragleave = function () {\n        this.classList.remove('wptb-drop-here-empty');\n\n    }\n\n    DOMElement.ondrop = function (e) {\n        var element, classId, space, t_space, spaceParent;\n        e.preventDefault();\n        space = new WPTB_Space();\n\n        console.log(e.dataTransfer);\n\n        if (!e.dataTransfer.getData('wptbElement')\n            && !e.dataTransfer.getData('node')) {\n            return;\n        }\n\n        if (e.dataTransfer.getData('wptbElement')) {\n            element = newElementProxy(e.dataTransfer.getData('wptbElement'));\n            if (this.innerHTML == '') {\n                this.appendChild(new WPTB_Space());\n            }\n            this.appendChild(element.getDOMElement());\n            this.appendChild(space);\n        }\n        else {\n\n            classId = e.dataTransfer.getData('node');\n            element = document.getElementsByClassName(classId)[0];\n            if (this.innerHTML == '') {\n                t_space = element.nextSibling;\n                spaceParent = element.parentNode;\n                if (t_space != undefined) {\n                    spaceParent.removeChild(t_space);\n                }\n                this.appendChild(new WPTB_Space());\n            }\n            this.appendChild(element);\n            this.appendChild(space);\n        }\n        this.classList.remove('wptb-drop-here-empty');\n        return true;\n    }\n\n    this.getDOMElement = function () {\n        return DOMElement;\n    }\n\n    this.setCoords = function (y, x) {\n        var el = this.getDOMElement();\n        el.dataset.yIndex = y;\n        el.dataset.xIndex = x;\n    }\n\n    this.getCoords = function () {\n        var coords,\n            el = this.getDOMElement();\n        coords.x = el.dataset.xIndex;\n        coords.y = el.dataset.yIndex;\n        return coords;\n    }\n\n    this.appendElement = function (node) {\n        getDOMElement().appendChild(node);\n    }\n\n    return this;\n\n};","var ElementCounters = function () {\n\n\tvar priv = [];\n\tpriv['text'] = 0;\n\tpriv['image'] = 0;\n\tpriv['list'] = 0;\n\tpriv['button'] = 0;\n\n\tthis.increment = function (key) {\n\n\t\tif (!(key in priv)) {\n\t\t\treturn;\n\t\t}\n\n\t\tpriv[key]++;\n\t}\n\tthis.nextIndex = function (key) {\n\n\t\tif (!(key in priv)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn priv[key] + 1;\n\t}\n\n\treturn this;\n\n};","var WPTB_ElementOptions = function (element, index) {\n\n    var node = element.getDOMElement(), elemIdClass;\n\n    prop = document.querySelector(\".wptb-\" + element.kind + \"-options-prototype\").cloneNode(true);\n    prop.classList.remove(\"wptb-\" + element.kind + \"-options-prototype\"); // remove prototype from the class\n    elemIdClass = 'wptb-options-' + element.kind + \"-\" + index;\n\n    var properties = prop.getElementsByClassName('wptb-element-property');\n\n    for (var i = 0; i < properties.length; i++) {\n        properties[i].dataset.element = elemIdClass;\n    }\n\n    prop.classList.add(elemIdClass);\n    document.getElementById(\"element-options-group\").appendChild(prop);\n\n    node.onclick = function () {\n        var infArr = this.className.match(/wptb-element-((.+-)\\d+)/i),\n            optionsClass = '.wptb-' + infArr[2] + 'options' +\n                '.wptb-options-' + infArr[1];\n\n        document.getElementById('add-elements').getElementsByTagName('a')[0].classList.remove('active');\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.add('active');\n\n        document.getElementsByClassName('wptb-elements-container')[0].style.display = 'none';\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'none';\n        document.getElementById(\"element-options-group\").style.display = 'block';\n\n        var children = document.getElementById(\"element-options-group\").childNodes;\n        for (var i = 0; i < children.length; i++) {\n            if (children[i].style)\n                children[i].style.display = 'none';\n        }\n\n        document.querySelector(optionsClass).style.display = 'block';\n    };\n\n    if (element.kind == 'button') {\n        //We must add this special kind of property, since it is triggered with click event\n        var buttons = prop.getElementsByClassName('wptb-btn-size-btn');\n\n        for (var i = 0; i < buttons.length; i++) {\n            buttons[i].onclick = function () {\n                console.log('Now we should change button size');\n                var size = this.innerHTML,\n                    n_Class = this.dataset.element,\n                    infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\n                    type = infArr[1],\n                    num = infArr[2],\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0];\n                affectedEl.classList.remove('wptb-size-S');\n                affectedEl.classList.remove('wptb-size-M');\n                affectedEl.classList.remove('wptb-size-L');\n                affectedEl.classList.remove('wptb-size-XL');\n                affectedEl.classList.add('wptb-size-' + size);\n                var b = prop.getElementsByClassName('wptb-btn-size-btn');\n                for (var i = 0; i < b.length; i++) {\n                    b[i].classList.remove('selected');\n                }\n                this.classList.add('selected');\n            }\n        }\n    }\n\n    var optionControls = prop.getElementsByClassName('wptb-element-property');\n\n    for (var i = 0; i < optionControls.length; i++) {\n        if (optionControls[i].classList.contains('wptb-color-picker')) {\n            jQuery(optionControls[i]).wpColorPicker({\n                change: function (event, ui) {\n                    var parent = event.target, classe, type, ps, number;\n                    classe = parent.dataset.element.match(/wptb-options-(.+)-(\\d+)/i);\n                    type = classe[1];\n                    number = classe[2];\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + number)[0];\n                    if (type == 'button') {\n                        affectedEl.getElementsByClassName('wptb-button')[0].style.backgroundColor = ui.color.toString();\n                    }\n                    else {\n                        ps = affectedEl.getElementsByTagName(\"p\");\n                        for (var i = 0; i < ps.length; i++) {\n                            ps[i].style.color = ui.color.toString();\n                        }\n                    }\n                }\n            });\n        }\n\n        if (optionControls[i].dataset.type === 'font-size') {\n            var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-text-font-size-slider')[0];\n            slider.oninput = function () {\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].value = this.value;\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].onchange();\n            }\n        }\n\n        optionControls[i].onchange = function (event) {\n\n            var n_Class = this.dataset.element,\n                infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\n                type = infArr[1],\n                num = infArr[2],\n                affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0],\n                val = this.value;\n\n\n            switch (this.dataset.type) {\n                case 'src':\n                    var img = affectedEl.getElementsByTagName(\"img\")[0];\n                    img.src = this.value;\n                    break;\n                case 'alternative-text':\n                    var img = affectedEl.getElementsByTagName(\"img\")[0];\n                    img.alt = this.value;\n                    break;\n                case 'image-width':\n                    var img = affectedEl.getElementsByTagName(\"img\")[0];\n                    console.log(img, this.value);\n                    img.width = this.value;\n                    break;\n                case 'image-height':\n                    var img = affectedEl.getElementsByTagName(\"img\")[0];\n                    img.height = this.value;\n                    break;\n                case 'font-size':\n                    var ps = affectedEl.getElementsByTagName(\"p\");\n                    for (var i = 0; i < ps.length; i++) {\n                        ps[i].style.fontSize = val + 'px';\n                    }\n\n                    this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-slider')[0].value = this.value;\n\n                    break;\n                case 'color':\n                    var ps = affectedEl.getElementsByTagName(\"p\");\n                    for (var i = 0; i < ps.length; i++) {\n                        ps[i].style.color = val;\n                    }\n                    break;\n                case 'button-color': console.log('Event called!');\n                    break;\n                case 'list-class':\n                    if (val == 'unordered') {\n                        event.target\n                            .parentNode\n                            .parentNode\n                            .querySelector('[data-type=list-style-type]')\n                            .parentNode\n                            .style\n                            .display = 'flex';\n                        var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\n                        for (var i = 0; i < bullets.length; i++) {\n                            bullets[i].style.listStyleType = 'disc';\n                        }\n                        document.querySelector('[data-type=list-style-type]').value = 'disc';\n                    } else {\n                        event.target\n                            .parentNode\n                            .parentNode\n                            .querySelector('[data-type=list-style-type]')\n                            .parentNode\n                            .style\n                            .display = 'none';\n                        var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\n                        for (var i = 0; i < bullets.length; i++) {\n                            bullets[i].style.listStyleType = 'decimal';\n                        }\n                    }\n                    break;\n                case 'list-style-type':\n                    var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\n                    for (var i = 0; i < bullets.length; i++) {\n                        bullets[i].style.listStyleType = val.toLowerCase();\n                    }\n                    break;\n            }\n        }\n    }\n};","var WPTB_Image = function (src) {\n\n\tvar DOMElement = document.createElement('div'),\n\t\timg = document.createElement('img');\n\n\tthis.kind = 'image';\n\n\tDOMElement.appendChild(img);\n\n\tthis.getDOMElement = function () {\n\t\treturn DOMElement;\n\t}\n\tapplyGenericItemSettings(this);\n\n\tfile_frame = wp.media.frames.file_frame = wp.media({\n\t\ttitle: 'Select a image to upload',\n\t\tbutton: {\n\t\t\ttext: 'Use this image',\n\t\t},\n\t\tmultiple: false\n\t});\n\t// When an image is selected, run a callback.\n\tfile_frame.on('select', function () {\n\t\tattachment = file_frame.state().get('selection').first().toJSON();\n\t\timg.src = attachment.url;\n\t});\n\t// Finally, open the modal\n\tif (src == undefined) {\n\t\tfile_frame.open();\n\t}\n\telse {\n\t\timg.src = src;\n\t}\n\n\treturn this;\n\n};","var WPTB_Initializer = function () {\n\n\tconst MIN_COLUMNS = 1,\n\t\tMIN_ROWS = 1,\n\t\tMAX_COLUMNS = 10,\n\t\tMAX_ROWS = 10;\n\n\tvar tableGenerator = document.body;\n\tcolumnsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[0],\n\t\tcolumnsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[0],\n\t\trowsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[1],\n\t\trowsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[1],\n\t\tcolumnsInput = document.getElementById('wptb-columns-number'),\n\t\trowsInput = document.getElementById('wptb-rows-number');\n\n\n\tcolumnsDecrementButton.onclick = function () {\n\t\tif (columnsInput.value > MIN_COLUMNS) {\n\t\t\tcolumnsInput.value--;\n\t\t}\n\t};\n\n\tcolumnsIncrementButton.onclick = function () {\n\t\tif (columnsInput.value < MAX_COLUMNS) {\n\t\t\tcolumnsInput.value++;\n\t\t}\n\t};\n\n\trowsDecrementButton.onclick = function () {\n\t\tif (rowsInput.value > MIN_ROWS) {\n\t\t\trowsInput.value--;\n\t\t}\n\t};\n\n\trowsIncrementButton.onclick = function () {\n\t\tif (rowsInput.value < MAX_ROWS) {\n\t\t\trowsInput.value++;\n\t\t}\n\t};\n\n\tdocument.getElementById('wptb-generate-table').onclick = function () {\n\n\t\tvar columns = document.getElementById('wptb-columns-number').value,\n\t\t\trows = document.getElementById('wptb-rows-number').value;\n\n\t\tWPTB_Table(columns, rows);\n\n\t}\n\n};","var WPTB_LeftPanel = function () {\n\n    var table = document.getElementsByClassName('wptb-preview-table')[0],\n        wptbElementButtons = document.getElementsByClassName('wptb-element');\n\n    jQuery('#wptb-even-row-bg').wpColorPicker({\n        change: function (event, ui) {\n            var tableRows = table.getElementsByTagName('tr');\n            for (var i = 1; i < tableRows.length; i += 2) {\n                tds = tableRows[i].getElementsByTagName('td');\n                for (var j = 0; j < tds.length; j++) {\n                    tds[j].style.backgroundColor = ui.color.toString();\n                }\n            }\n        }\n    });\n    jQuery('#wptb-odd-row-bg').wpColorPicker({\n        change: function (event, ui) {\n            var tableRows = table.getElementsByTagName('tr');\n            for (var i = 2; i < tableRows.length; i += 2) {\n                tds = tableRows[i].getElementsByTagName('td');\n                for (var j = 0; j < tds.length; j++) {\n                    tds[j].style.backgroundColor = ui.color.toString();\n                }\n            }\n        }\n    });\n    jQuery('#wptb-table-header-bg').wpColorPicker({\n        change: function (event, ui) {\n            var tableHeader = table.getElementsByTagName('tr')[0],\n                tds = tableHeader.getElementsByTagName('td');\n            for (var j = 0; j < tds.length; j++) {\n                tds[j].style.backgroundColor = ui.color.toString();\n            }\n        }\n    });\n\n\n\n    function addInnerBorderSize(value) {\n        var tableCells = table.getElementsByTagName('td');\n        for (var i = 0; i < tableCells.length; i++) {\n            tableCells[i].style.border = value + 'px solid';\n        }\n    }\n\n    function addCellPadding(value) {\n        var tableCells = table.getElementsByTagName('td');\n        for (var i = 0; i < tableCells.length; i++) {\n            tableCells[i].style.padding = value + 'px';\n        }\n    }\n\n\n    function addInnerBorder(checked) {\n        var styles;\n\n        if (checked == 'checked') {\n            document.getElementById('wptb-apply-inner-border').style.marginBottom = '0px';\n            var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\n            for (var i = 0; i < tableCells.length; i++) {\n                tableCells[i].style.border = '1px solid';\n            }\n\n            document.getElementById('wptb-inner-border-settings').classList.add('visible');\n        } else {\n            document.getElementById('wptb-inner-border-settings').classList.remove('visible');\n            var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\n            for (var i = 0; i < tableCells.length; i++) {\n                tableCells[i].style.border = '';\n            }\n        }\n    }\n\n    function addBorderSize(value) {\n        table.style.border = value + 'px solid';\n    }\n\n    document.getElementById('wptb-table-cell-slider').oninput = function () {\n        document.getElementById('wptb-table-cell-number').value = this.value;\n        addCellPadding(this.value);\n    };\n\n    document.getElementById('wptb-table-cell-number').onchange = function () {\n        document.getElementById('wptb-table-cell-slider').value = this.value;\n        addCellPadding(this.value);\n    };\n\n    document.getElementById('wptb-table-border-slider').oninput = function () {\n        document.getElementById('wptb-table-border-number').value = this.value;\n        addBorderSize(this.value);\n    };\n\n    document.getElementById('wptb-table-border-number').onchange = function () {\n        document.getElementById('wptb-table-border-slider').value = this.value;\n        addBorderSize(this.value);\n    };\n\n    document.getElementById('wptb-table-inner-border-slider').oninput = function () {\n        document.getElementById('wptb-table-inner-border-number').value = this.value;\n        addInnerBorderSize(this.value);\n    };\n\n    document.getElementById('wptb-table-inner-border-number').onchange = function () {\n        document.getElementById('wptb-table-inner-border-slider').value = this.value;\n        addInnerBorderSize(this.value);\n    };\n\n    document.getElementById('wptb-inner-border-check').onchange = function () {\n        var _val = this.checked ? 'checked' : 'unchecked';\n        addInnerBorder(_val);\n    };\n\n    for (var i = 0; i < wptbElementButtons.length; i++) {\n        wptbElementButtons[i].ondragstart = function (e) {\n            e.dataTransfer.setData('wptbElement', this.dataset.wptbElement);\n        }\n    }\n\n    document.getElementById('wptb-activate-cell-management-mode').onclick = table.toggleTableEditMode;\n    document.getElementById('wptb-add-end-row').onclick = table.addRowToTheEnd;\n    document.getElementById('wptb-add-start-row').onclick = table.addRowToTheStart;\n    document.getElementById('wptb-add-row-before').onclick = table.addRowBefore;\n    document.getElementById('wptb-add-row-after').onclick = table.addRowAfter;\n    document.getElementById('wptb-add-end-column').onclick = table.addColumnEnd;\n    document.getElementById('wptb-add-start-column').onclick = table.addColumnStart;\n    //document.getElementById('wptb-add-column-before').onclick = table.addColumnBefore;\n    //document.getElementById('wptb-add-column-after').onclick = table.addColumnAfter;\n    //document.getElementById('wptb-delete-column').onclick = table.deleteColumn;\n    //document.getElementById('wptb-delete-row').onclick = table.deleteRow;\n    document.getElementById('wptb-merge-cells').onclick = table.mergeCells;\n    document.getElementById('wptb-split-cell').onclick = table.splitCell;\n    document.getElementById('add-elements').onclick = function () {\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.remove('active');\n        document.getElementById('add-elements').getElementsByTagName('a')[0].classList.add('active');\n        document.getElementsByClassName('wptb-elements-container')[0].style.display = 'table';\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'block';\n        document.getElementById(\"element-options-group\").style.display = 'none';\n    };\n\n};","var WPTB_List = function (innerElements) {\n\n    var el_L = document.createElement('ul'), item,\n        DOMElement = document.createElement('div');\n\n    this.kind = 'list';\n\n    if (!innerElements)\n        for (var i = 0; i < 3; i++) {\n            item = new WPTB_ListItem('List Item ' + (i + 1));\n            el_L.appendChild(item.getDOMElement());\n        }\n    else {\n        for (var i = 0; i < innerElements.length; i++) {\n            item = new WPTB_ListItem(innerElements[i]);\n            el_L.appendChild(item.getDOMElement());\n        }\n    }\n    DOMElement.appendChild(el_L);\n    //window.addElementOptions('list', elList);\n\n    this.getDOMElement = function () {\n        return DOMElement;\n    }\n    applyGenericItemSettings(this);\n\n    return this;\n\n};","var WPTB_ListItem = function (text) {\n\n    if (text == undefined) text = 'New List Item';\n    var DOMElement = document.createElement('article'),\n        divdot = document.createElement('div'),\n        divcontent = document.createElement('div'),\n        libullet = document.createElement('li');\n    divdot.classList.add('wptb-list-item-style-dot');\n    divcontent.classList.add('wptb-list-item-content');\n    libullet.classList.add('wptb-bullet');\n    DOMElement.appendChild(divdot);\n    DOMElement.appendChild(divcontent);\n    divdot.appendChild(libullet);\n    divcontent.innerHTML = text;\n    divcontent.onkeyup = window.listItemKeyListener;\n\n    DOMElement.onmouseenter = function (event) {\n\n        var btnDelete = document.createElement('span'),\n            btnCopy = document.createElement('span'),\n            actions = document.createElement('span'),\n            previous, i;\n        actions.classList.add('wptb-actions');\n        btnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\n        btnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\n        this.classList.add('wptb-directlyhovered');\n\n        btnDelete.onclick = function () {\n            var item = this.parentNode.parentNode,\n                parent = item.parentNode;\n            parent.removeChild(item);\n        };\n\n        btnCopy.onclick = function (event) {\n            console.log('Clicking item');\n            var article = event.target.parentNode.parentNode,\n                content = article.querySelector('.wptb-list-item-content'),\n                html = content.innerHTML;\n            var duplicate = new WPTB_ListItem(html);\n            article.parentNode.appendChild(duplicate.getDOMElement());\n        };\n\n        actions.append(btnCopy, btnDelete);\n        this.appendChild(actions);\n    };\n\n    DOMElement.onmouseleave = function (event) {\n        this.classList.remove('wptb-directlyhovered');\n        var actions = this.parentNode.querySelector('.wptb-actions');\n        if (actions != undefined) {\n            let parent = actions.parentNode;\n            parent.removeChild(actions);\n        }\n    };\n\n    divcontent.onkeydown = function (event) {\n        var key = (event.which != undefined) ? event.which :\n            event.keyCode,\n            duplicate, lastP;\n        if (key !== 13 ||\n            (window.dontAddItems !== undefined && window.dontAddItems === true)) {\n            return;\n        }\n        event.preventDefault();\n        duplicate = new WPTB_ListItem(this.innerHTML);\n        console.log('duplicate', duplicate.getDOMElement());\n        DOMElement.parentNode.insertBefore(duplicate.getDOMElement(), DOMElement);\n        console.log(divcontent);\n        divcontent.innerHTML = 'New List Item';\n        duplicate.getDOMElement().querySelector('.wptb-list-item-content').focus();\n\n        return false;\n    };\n\n    this.getDOMElement = function () {\n        return DOMElement;\n    }\n\n    return this;\n\n};","var MultipleSelect = function () {\n\n\tvar selectedCells = [],\n\t\tmultipleCellMode = false;\n\n\tthis.activateMultipleSelectMode = function () {\n\t\tselectedCells = [];\n\t\tvar tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\n\t\tfor (var i = 0; i < tds.length; i++) {\n\t\t\ttds[i].classList.remove('wptb-highlighted');\n\t\t}\n\t\tmultipleCellMode = true;\n\t}\n\n\tthis.deactivateMultipleSelectMode = function () {\n\t\tconsole.log(selectedCells);\n\t\tmultipleCellMode = false;\n\t}\n\n\tthis.isActivated = function () {\n\t\treturn multipleCellMode;\n\t}\n\n\tthis.pushSelectedCell = function (cell) {\n\t\tif (!multipleCellMode) {\n\t\t\treturn;\n\t\t}\n\t\tselectedCells.push(cell);\n\t\tcell.classList.add('wptb-highlighted');\n\t};\n\n\tthis.selectedCells = function () {\n\t\treturn selectedCells;\n\t}\n\n\tthis.flushSelectedCells = function () {\n\t\tselectedCells = [];\n\t}\n\n\tthis.getFirst = function () {\n\t\tvar minXIndex = 1000, minYIndex = 1000, first;\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\n\t\t\tif (minXIndex >= selectedCells[i].dataset.xIndex\n\t\t\t\t&& minYIndex >= selectedCells[i].dataset.yIndex) {\n\t\t\t\tfirst = selectedCells[i];\n\t\t\t\tminXIndex = selectedCells[i].dataset.xIndex;\n\t\t\t\tminYIndex = selectedCells[i].dataset.yIndex;\n\t\t\t}\n\t\t}\n\t\treturn first;\n\t}\n\n\tthis.getLast = function () {\n\t\tvar maxXIndex = -1, maxYIndex = -1, last;\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\n\t\t\tif (maxXIndex <= selectedCells[i].dataset.xIndex\n\t\t\t\t&& maxYIndex <= selectedCells[i].dataset.yIndex) {\n\t\t\t\tlast = selectedCells[i];\n\t\t\t\tmaxXIndex = selectedCells[i].dataset.xIndex;\n\t\t\t\tmaxYIndex = selectedCells[i].dataset.yIndex;\n\t\t\t}\n\t\t}\n\t\treturn last;\n\t}\n\n\tthis.removeAllButFirst = function () {\n\t\tvar td = this.getFirst();\n\t\tfor (var i = 1; i < selectedCells.length; i++) {\n\t\t\tselectedCells[i].classList.add('wptb-fused-cell-' + td.dataset.xIndex + '-' + td.dataset.yIndex);\n\t\t}\n\t}\n\n\treturn this;\n\n};","var WPTB_Parser = function (code) {\n\n\tvar node, pos = 0;\n\n\tfunction getChar() {\n\t\tif (pos >= code.length) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn code[pos++];\n\t}\n\n\tfunction getToken() {\n\t\tvar char = getChar(),\n\t\t\ttoken = char;\n\n\t\tif (char !== '[') {\n\t\t\treturn;\n\t\t}\n\n\t\tdo {\n\t\t\tchar = getChar();\n\t\t\tif (char === -1) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\ttoken += char;\n\t\t} while (char != ']');\n\n\t\tctoken = token;\n\n\t\treturn true;\n\t}\n\n\tfunction getCurrentToken() {\n\t\treturn ctoken;\n\t}\n\n\tfunction getExpectedToken(expected) {\n\t\tif (getWordFromToken(ctoken) !== expected) {\n\t\t\tthrow 'There was an error with the file and therefore the table could not be rendered';\n\t\t}\n\n\t\tgetToken();\n\t}\n\n\tfunction getWordFromToken(token) {\n\t\tvar p = token.indexOf(' '),\n\t\t\tword = token.substring(1, p);\n\t\tif (p == -1) { //This is, if token tag has no attributes\n\t\t\treturn token;\n\t\t}\n\t\treturn '[' + word + ']';\n\t}\n\n\tfunction getAttributesFromToken() {\n\t\tvar elems = ctoken.split(' '),\n\t\t\tpair,\n\t\t\tkey,\n\t\t\tvalue,\n\t\t\tattr = [];\n\n\t\tfor (var i = 1; i < elems.length; i++) {\n\t\t\tpair = elems[i].trim().split('=');\n\t\t\tkey = pair[0];\n\t\t\tvalue = pair[1].substring(1, pair[1].length - 1);\n\t\t\tattr[key] = value;\n\t\t}\n\n\n\t\treturn attr;\n\t}\n\n\tfunction parseAllHTML() {\n\t\tvar html = '';\n\t\tpos--;\n\n\t\tdo {\n\t\t\tchar = getChar();\n\t\t\tif (char === -1) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\thtml += char;\n\t\t} while (char != '[');\n\n\t\thtml = html.substring(0, html.length - 1);\n\n\t\tpos--;\n\n\t\treturn html;\n\n\t}\n\n\tfunction analizeElement() {\n\t\tvar t = getWordFromToken(getCurrentToken()), html, node;\n\n\t\tswitch (t) {\n\t\t\tcase '[text]': attr = getAttributesFromToken();\n\t\t\t\tconsole.log('Attributes', attr);\n\t\t\t\tgetExpectedToken('[text]');\n\t\t\t\thtml = parseAllHTML();\n\t\t\t\tnode = new WPTB_Text(html);\n\t\t\t\tconsole.log(html);\n\t\t\t\tgetToken();\n\t\t\t\tgetExpectedToken('[/text]');\n\t\t\t\tbreak;\n\t\t\tcase '[button]': attr = getAttributesFromToken();\n\t\t\t\tconsole.log('Attributes', attr);\n\t\t\t\tgetExpectedToken('[button]');\n\t\t\t\thtml = parseAllHTML();\n\t\t\t\tnode = new WPTB_Button(html);\n\t\t\t\tgetToken();\n\t\t\t\tgetExpectedToken('[/button]');\n\t\t\t\tbreak;\n\t\t\tcase '[img]': attr = getAttributesFromToken();\n\t\t\t\tconsole.log('Attributes', attr);\n\t\t\t\tnode = new WPTB_Image(attr['src']);\n\t\t\t\tgetExpectedToken('[img]');\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn node.getDOMElement();\n\t}\n\n\tfunction analizeElements(td) {\n\t\tdo {\n\t\t\ttd.appendChild(analizeElement());\n\t\t} while (getCurrentToken() == '[image]'\n\t\t|| getCurrentToken() == '[text]'\n\t\t|| getCurrentToken() == '[list]'\n\t\t\t|| getCurrentToken() == '[button]');\n\t}\n\n\tfunction analizeRows(tableNode) {\n\t\tconsole.log('Tr', tr);\n\t\tdo {\n\t\t\tvar tr = tableNode.insertRow();\n\t\t\ttr.classList.add('wptb-row');\n\t\t\tgetExpectedToken('[tr]');\n\t\t\tanalizeTds(tr);\n\t\t\tgetExpectedToken('[/tr]');\n\t\t} while (getWordFromToken(getCurrentToken()) === '[tr]');\n\t}\n\n\tfunction analizeTd() {\n\t\tvar td = new WPTB_Cell();\n\t\tgetExpectedToken('[td]');\n\t\tanalizeElements(td.getDOMElement());\n\t\tgetExpectedToken('[/td]');\n\t\treturn td.getDOMElement();\n\t}\n\n\tfunction analizeTds(row) {\n\t\tdo {\n\t\t\trow.appendChild(analizeTd());\n\t\t} while (getCurrentToken() == '[td]');\n\t}\n\n\tfunction analizeHeader(tableNode) {\n\t\tvar header = tableNode.insertRow();\n\t\theader.classList.add('wptb-row', 'wptb-table-head');\n\t\tconsole.log('Tr', header);\n\t\tgetExpectedToken('[tr]');\n\t\tanalizeTds(header);\n\t\tgetExpectedToken('[/tr]');\n\t}\n\n\tfunction analizeRoot() {\n\t\tgetToken();\n\t\tvar n = document.createElement('table');\n\t\tn.classList.add('wptb-preview-table');\n\t\tgetExpectedToken('[table]');\n\t\tanalizeHeader(n);\n\t\tanalizeRows(n);\n\t\tgetExpectedToken('[/table]');\n\t\treturn n;\n\t}\n\n\tnode = analizeRoot();\n\n\treturn node;\n\n};","var WPTB_Settings = function () {\n\n\tvar elems = document.getElementsByClassName('wptb-element');\n\n\tfor (var i = 0; i < elems.length; i++) {\n\t\telems[i].ondragstart = function (event) {\n\t\t\tevent.dataTransfer.effectAllowed = 'move';\n\t\t\tevent.dataTransfer.setData(\"text/plain\", event.target.getAttribute('id'));\n\t\t}\n\t};\n\n\tdocument.getElementsByClassName('wptb-save-btn')[0].onclick = function () {\n\t\tvar http = new XMLHttpRequest(),\n\t\t\turl = ajaxurl + \"?action=save_table\",\n\t\t\tt = document.getElementById('wptb-setup-name').value.trim(),\n\t\t\tmessagingArea,\n\t\t\tcode = WPTB_Stringifier(document.getElementsByClassName('wptb-preview-table')[0]);\n\n\t\tif (t === '') {\n\t\t\tmessagingArea = document.getElementsByClassName('wptb-messaging')[0];\n\t\t\tmessagingArea.innerHTML = 'Error: You must assign a name to the table before saving it.';\n\t\t\tmessagingArea.classList.add('warning');\n\t\t\tsetTimeout(function () {\n\t\t\t\tmessagingArea.classList.remove('warning');\n\t\t\t}, 5000);\n\t\t}\n\t\tconsole.log('Ajax called');\n\t\tvar params = 'title=' + t + '&content=' + code;\n\t\thttp.open('POST', url, true);\n\t\thttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n\t\thttp.onreadystatechange = function (d) {\n\t\t\tif (this.readyState == 4 && this.status == 200) {\n\t\t\t\tmessagingArea = document.getElementById('wptb-messaging-area');\n\t\t\t\tmessagingArea.innerHTML = 'Success: table \"' + t + '\" was successfully saved.';\n\t\t\t\tmessagingArea.classList.add('success');\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tmessagingArea.classList.remove('success');\n\t\t\t\t}, 5000);\n\t\t\t}\n\t\t}\n\t\thttp.send(params);\n\t}\n};\n","var WPTB_Space = function (text) {\n\n    function newElementProxy(el) {\n        if (el == 'list') {\n            return new WPTB_List();\n        }\n        else if (el == 'image') {\n            return new WPTB_Image();\n        }\n        else if (el == 'text') {\n            return new WPTB_Text();\n        }\n        else if (el == 'button') {\n            return new WPTB_Button();\n        }\n    }\n\n    spaceBetween = document.createElement('div'),\n        spaceBetween.classList.add('wptb-space-between');\n\n    spaceBetween.ondragenter = function () {\n        this.classList.add('visible');\n    };\n    spaceBetween.ondragover = function (event) {\n        event.preventDefault();\n    };\n\n    spaceBetween.ondragleave = function () {\n        this.classList.remove('visible');\n    };\n\n    spaceBetween.ondrop = function (event) {\n        event.stopPropagation();\n\n        var p = event.target.nextSibling,\n            td = event.target,\n            element, t_space, spaceParent;\n\n        while (!td.classList.contains('wptb-droppable')) {\n            td = td.parentNode;\n        }\n\n        if (event.dataTransfer.getData('wptbElement')) {\n            element = newElementProxy(event.dataTransfer.getData('wptbElement'));\n            this.classList.remove('visible');\n\n\n\n            if (p == null) {\n                td.appendChild(element.getDOMElement());\n                td.appendChild(new WPTB_Space());\n            }\n            else {\n                td.insertBefore(element.getDOMElement(), p);\n                td.insertBefore(new WPTB_Space(), p);\n            }\n\n\n        }\n\n        else {\n            element = document.getElementsByClassName(event.dataTransfer.getData('node'))[0];\n\n            t_space = element.nextSibling;\n            spaceParent = element.parentNode;\n            if (t_space != undefined) {\n                spaceParent.removeChild(t_space);\n            }\n\n            if (p == null) {\n                td.appendChild(element);\n                td.appendChild(new WPTB_Space());\n            }\n            else {\n                td.insertBefore(element, p);\n                td.insertBefore(new WPTB_Space(), p);\n            }\n\n        }\n        this.classList.remove('visible');\n    };\n\n    return spaceBetween;\n\n};","var WPTB_Stringifier = function (node) {\n\n\tif (node == undefined || node.tagName == undefined) {\n\t\treturn '';\n\t}\n\n\tvar code = '', children = node.childNodes,\n\t\tpadding, margin, bg1, bg2, bg3, border,\n\t\tcolSpan, rowSpan, isHidden, // Table Attributes\n\t\tlistClass, listStyleType, //list attributes\n\t\tbuttonSize, buttonColor, buttonBorder, //button attributes\n\t\tfontSize, fontColor, fontFamily, //text attributes\n\t\tsrc, width, height, //image attributes\n\t\tadditionalCSS, additionalClass, additionalID; // A few global attributes I wanted to add.\n\n\tswitch (node.tagName.toLowerCase()) {\n\t\tcase 'table':\n\t\t\tborder = node.style.borderSize;\n\t\t\tmargin = node.getElementsByTagName('td')[0].style.margin;\n\t\t\tpadding = node.getElementsByTagName('td')[0].style.padding;\n\t\t\tinnerBorder = node.getElementsByTagName('td')[0].style.borderSize;\n\t\t\tbg1 = node.rows[0].getElementsByTagName('td')[0].style.backgroundColor;\n\n\t\t\tif (node.rows.length > 1) {\n\t\t\t\tbg2 = node.rows[1].getElementsByTagName('td')[0].style.backgroundColor;\n\t\t\t}\n\t\t\tif (node.rows.length > 2) {\n\t\t\t\tbg3 = node.rows[2].getElementsByTagName('td')[0].style.backgroundColor;\n\t\t\t}\n\t\t\tconsole.log(innerBorder);\n\t\t\tcode += '[table'\n\t\t\t\t+ (margin != undefined && margin != '' ? ' margin=\"' + margin + '\"' : '')\n\t\t\t\t+ (padding != undefined && padding != '' ? ' padding=\"' + padding + '\"' : '')\n\t\t\t\t+ (innerBorder != undefined ? ' inner-border=\"' + innerBorder + '\"' : '')\n\t\t\t\t+ (bg1 != undefined ? ' data-bg1=\"' + bg1 + '\"' : '')\n\t\t\t\t+ (bg2 != undefined ? ' data-bg2=\"' + bg2 + '\"' : '')\n\t\t\t\t+ (bg3 != undefined ? ' data-bg3=\"' + bg3 + '\"' : '')\n\t\t\t\t+ ']';\n\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\tcode += WPTB_Stringifier(children[i]);\n\t\t\t}\n\n\t\t\tcode += '[/table]';\n\t\t\tbreak;\n\t\tcase 'tbody':\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\tcode += WPTB_Stringifier(children[i]);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'tr':\n\t\t\tcode += '[tr]';\n\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\tcode += WPTB_Stringifier(children[i]);\n\t\t\t}\n\n\t\t\tcode += '[/tr]';\n\t\t\tbreak;\n\t\tcase 'td': colspan = node.colSpan;\n\t\t\trowspan = node.rowSpan;\n\t\t\tisHidden = node.classList.contains(/^wptb-fused-cell-(\\d+)$/);\n\t\t\tcode += '[td'\n\t\t\t\t+ (colspan != undefined && colspan > 1 ? ' colspan=\"' + colspan + '\"' : '')\n\t\t\t\t+ (rowspan != undefined && rowspan > 1 ? ' rowspan=\"' + rowspan + '\"' : '')\n\t\t\t\t+ (isHidden ? ' hidden=\"true\"' : '')\n\t\t\t\t+ ']';\n\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\tcode += WPTB_Stringifier(children[i]);\n\t\t\t}\n\n\t\t\tcode += '[/td]';\n\t\t\tbreak;\n\t\tcase 'div':\n\t\t\tif (node.classList.contains('wptb-ph-element')) {\n\n\t\t\t\tvar infArr = node.className.match(/wptb-element-(.+)-(\\d+)/i),\n\t\t\t\t\toptionsClass, trueNode,\n\t\t\t\t\tnodeContent;\n\t\t\t\tif (infArr == undefined) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tswitch (infArr[1]) {\n\t\t\t\t\tcase 'list':\n\t\t\t\t\t\ttrueNode = node.getElementsByTagName('ul')[0];\n\t\t\t\t\t\tif (!trueNode) {\n\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlistStyleType = trueNode.getElementsByTagName('li')[0].style.listStyleType;\n\t\t\t\t\t\tlistClass = listStyleType == 'decimal' ? 'numbered' : 'unordered';\n\n\t\t\t\t\t\tcode += '[list'\n\t\t\t\t\t\t\t+ (listClass != undefined ? ' class=\"' + listClass + '\"' : 'class=\"unordered\"')\n\t\t\t\t\t\t\t+ (listStyleType != undefined ? ' style-type=\"' + listStyleType + '\"' : '')\n\t\t\t\t\t\t\t+ ']';\n\t\t\t\t\t\tlistitems = trueNode.getElementsByTagName('article');\n\t\t\t\t\t\tfor (var i = 0; i < listitems.length; i++) {\n\t\t\t\t\t\t\tcode += '[item]';\n\t\t\t\t\t\t\tcode += listitems[i]\n\t\t\t\t\t\t\t\t.getElementsByClassName('wptb-list-item-content')[0]\n\t\t\t\t\t\t\t\t.innerHTML;\n\t\t\t\t\t\t\tcode += '[/item]';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcode += '[/list]';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'image':\n\n\t\t\t\t\t\ttrueNode = node.getElementsByTagName('img')[0];\n\t\t\t\t\t\tif (!trueNode) {\n\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsrc = trueNode.src;\n\t\t\t\t\t\twidth = trueNode.width;\n\t\t\t\t\t\theight = trueNode.height;\n\t\t\t\t\t\talt = trueNode.alt;\n\t\t\t\t\t\tcode += '[img' +\n\t\t\t\t\t\t\t+(src != undefined ? ' src=\"' + src + '\"' : '')\n\t\t\t\t\t\t\t+ (width != undefined ? ' width=\"' + width + '\"' : '')\n\t\t\t\t\t\t\t+ (height != undefined ? ' height=\"' + height + '\"' : '')\n\t\t\t\t\t\t\t+ ']';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'text':\n\t\t\t\t\t\ttrueNode = node.getElementsByClassName('editable')[0];\n\t\t\t\t\t\tif (!trueNode) {\n\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfontSize = trueNode.getElementsByTagName('p')[0].style.fontSize;\n\t\t\t\t\t\tfontColor = trueNode.getElementsByTagName('p')[0].style.color;\n\t\t\t\t\t\tcode += '[text'\n\t\t\t\t\t\t\t+ (fontSize != undefined ? ' size=\"' + fontSize + '\"' : '')\n\t\t\t\t\t\t\t+ (fontColor != undefined ? ' color=\"' + fontColor + '\"' : '')\n\t\t\t\t\t\t\t+ ']';\n\t\t\t\t\t\tcode += trueNode.innerHTML;\n\t\t\t\t\t\tcode += '[/text]';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'button':\n\t\t\t\t\t\ttrueNode = node.getElementsByClassName('editable')[0];\n\t\t\t\t\t\tif (!trueNode) {\n\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbuttonColor = trueNode.style.backgroundColor;\n\t\t\t\t\t\tconsole.log(node);\n\t\t\t\t\t\tbuttonSize = node.className.match(/wptb-size-(.+)/i)[1];\n\n\t\t\t\t\t\tcode += '[button'\n\t\t\t\t\t\t\t+ (buttonColor != undefined ? ' color=\"' + buttonColor + '\"' : '')\n\t\t\t\t\t\t\t+ (buttonSize != undefined ? ' size=\"' + buttonSize + '\"' : '')\n\t\t\t\t\t\t\t+ ']';\n\t\t\t\t\t\tcode += trueNode.innerHTML;\n\t\t\t\t\t\tcode += '[/button]';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tcode += '';\n\t\t\tbreak;\n\t}\n\n\tif (node.nextSibling != undefined) {\n\t\tWPTB_Stringifier(node.nextSibling);\n\t}\n\n\treturn code;\n\n};","var array = [], WPTB_Table = function (columns, rows) {\n\n\tvar settings = document.getElementsByClassName('wptb-settings-items'),\n\t\twptbTableSetup = document.getElementsByClassName(\"wptb-table-setup\")[0],\n\t\ttable, row, cell,\n\t\tmaxAmountOfCells,\n\t\tmaxAmountOfRows;\n\n\tvar mark = function (event) {\n\t\tvar rs = this.rowSpan,\n\t\t\tcs = this.colSpan,\n\t\t\tmarkedCells,\n\t\t\t//   noCells = document.getElementsByClassName('no-cell-action'),\n\t\t\t//   singleCells = document.getElementsByClassName('single-action'),\n\t\t\t//   multipleCells = document.getElementsByClassName('multiple-select-action'),\n\t\t\tposition = getCoords(this),\n\t\t\trow = position[0],\n\t\t\tcolumn = position[1];\n\t\tfor (var i = 0; i < rs; i++) {\n\t\t\tfor (var j = 0; j < cs; j++) {\n\t\t\t\tarray[row + i][column + j] = 1;\n\t\t\t}\n\t\t}\n\t\tthis.classList.add('wptb-highlighted');\n\t\tmarkedCells = document.getElementsByClassName('wptb-highlighted').length;\n\t\t/*    if(markedCells === 1){\n\t\t\t\t\tfor (var i = 0; i < singleCells.length; i++) {\n\t\t\t\t\t\tsingleCells[i].classList.add('visible');\n\t\t\t\t\t\tmultipleCells[i].classList.remove('visible');\n\t\t\t\t\t\tnoCells[i].classList.remove('visible');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t\tsingleCells[i].classList.remove('visible');\n\t\t\t\t\t\tmultipleCells[i].classList.add('visible');\n\t\t\t\t\t\tnoCells[i].classList.remove('visible');\n\t\t\t\t}*/\n\t};\n\n\tfor (var i = 0; i < settings.length; i++) {\n\t\tsettings[i].classList.add('visible');\n\t}\n\n\tdocument.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\n\n\n\t//Create a HTML Table element.\n\ttable = document.createElement('table');\n\ttable.classList.add('wptb-preview-table');\n\n\n\t//Add the header row.\n\trow = table.insertRow(-1);\n\trow.classList.add('wptb-table-head', 'wptb-row');\n\n\tfor (var i = 0; i < columns; i++) {\n\t\tconsole.log(mark);\n\t\tcell = new WPTB_Cell(mark);\n\t\tcell.setCoords(0, i);\n\t\trow.appendChild(cell.getDOMElement());\n\t}\n\n\t//Add the data rows.\n\tfor (var i = 1; i < rows; i++) {\n\n\t\trow = table.insertRow(-1);\n\t\trow.classList.add('wptb-row');\n\n\t\tfor (var j = 0; j < columns; j++) {\n\t\t\tcell = new WPTB_Cell(mark);\n\t\t\tcell.setCoords(i, j);\n\t\t\trow.appendChild(cell.getDOMElement());\n\t\t}\n\t}\n\n\tvar realTimeArray = function () {\n\t\tvar carried = [], tds, cols, matriz = [];\n\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\n\t\t\tcarried[i] = 0;\n\t\t}\n\n\t\tfor (var i = 0; i < table.rows.length; i++) {\n\t\t\tcols = [];\n\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td');\n\n\t\t\tfor (items = 0; items < tds.length; items++) {\n\n\t\t\t\tfor (var k = 0; k < tds[items].colSpan; k++) {\n\t\t\t\t\tcols.push(1);\n\t\t\t\t}\n\n\t\t\t\tif (tds[items].rowSpan > 1) {\n\t\t\t\t\tfor (var k = 0; k < tds[items].colSpan; k++) {\n\t\t\t\t\t\tcarried[items + k] = {\n\t\t\t\t\t\t\tjustAssigned: true,\n\t\t\t\t\t\t\tamount: tds[items].rowSpan\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tfor (var k = 0; k < maxAmountOfCells; k++) {\n\t\t\t\tif (typeof carried[k] == 'object' && carried[k].amount > 0) {\n\n\t\t\t\t\tcarried[k].amount--;\n\n\t\t\t\t\tif (carried[k].justAssigned) {\n\t\t\t\t\t\tcarried[k].justAssigned = false;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcols.push(1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tmatriz.push(cols);\n\n\t\t}\n\t\treturn matriz;\n\t};\n\n\tvar carriedRowspans = function (row) {\n\t\tvar carried = [], tds, cols;\n\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\n\t\t\tcarried[i] = 0;\n\t\t}\n\n\t\tfor (var i = 0; i <= row; i++) {\n\t\t\t//console.log('Fila '+(i+1));\n\t\t\ttds = table.rows[i].getElementsByTagName('td');\n\t\t\tcols = 0,\n\t\t\t\titems = 0;\n\n\t\t\tfor (colspansAcumulados = 0; colspansAcumulados < maxAmountOfCells && items < tds.length;) {\n\t\t\t\tif (carried[colspansAcumulados]) {\n\t\t\t\t\t//console.log('En '+colspansAcumulados+' va la prolongacion vertical de una celda');\n\t\t\t\t\tcarried[colspansAcumulados]--;\n\t\t\t\t\tcolspansAcumulados++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tcell = tds[items++];\n\t\t\t\tif (cell.rowSpan > 1) {\n\t\t\t\t\tfor (var k = 0; k < cell.colSpan; k++) {\n\t\t\t\t\t\tcarried[colspansAcumulados + k] = cell.rowSpan;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (carried[colspansAcumulados])\n\t\t\t\t\tcarried[colspansAcumulados]--;\n\t\t\t\t//console.log('Celda del colspan numero'+colspansAcumulados);\n\t\t\t\tcolspansAcumulados += cell.colSpan;\n\t\t\t}\n\n\t\t}\n\t\tconsole.log(carried);\n\t\treturn carried;\n\t};\n\n\ttable.toggleTableEditMode = function () {\n\t\tvar bar = document.getElementById('edit-bar');\n\t\tconsole.log('Bar', bar);\n\t\tif (bar.classList.contains('visible')) {\n\t\t\tdocument.select.deactivateMultipleSelectMode();\n\t\t\tbar.classList.remove('visible');\n\t\t}\n\t\telse {\n\t\t\tdocument.select.activateMultipleSelectMode();\n\t\t\tbar.classList.add('visible');\n\n\t\t}\n\t}\n\n\ttable.recalculateIndexes = function () {\n\t\tvar trs = this.getElementsByTagName('tr'), tds, maxCols = 0;\n\n\t\tfor (var i = 0; i < trs.length; i++) {\n\t\t\ttds = trs[i].getElementsByTagName('td');\n\t\t\tfor (var j = 0; j < tds.length; j++) {\n\n\t\t\t\tif (i == 0) {\n\t\t\t\t\ttds[j].parentNode.className = '';\n\t\t\t\t\ttds[j].parentNode.classList.add('wptb-row', 'wptb-table-head');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttds[j].parentNode.className = '';\n\t\t\t\t\ttds[j].parentNode.classList.add('wptb-row');\n\t\t\t\t}\n\n\t\t\t\ttds[j].dataset.xIndex = j;\n\t\t\t\ttds[j].dataset.yIndex = i;\n\t\t\t}\n\t\t\tif (j > maxCols) {\n\t\t\t\tmaxCols = j;\n\t\t\t}\n\t\t}\n\t\tthis.columns = maxCols;\n\t\tconsole.log('Table dimensions: ' + trs.length + ' rows ,' + maxCols + ' columns');\n\t}\n\n\ttable.addColumnEnd = function () {\n\n\t\tconsole.log('add to the end');\n\t\tfor (var i = 0; i < table.rows.length; i++) {\n\t\t\ttd = new WPTB_Cell(mark);\n\t\t\ttable.rows[i].appendChild(td.getDOMElement());\n\t\t\tarray[i].push(0);\n\t\t}\n\t\tmaxAmountOfCells++;\n\t\tundoSelect();\n\t};\n\n\ttable.addColumnStart = function () {\n\t\tconsole.log('add to the start');\n\t\tfor (var i = 0; i < table.rows.length; i++) {\n\t\t\ttd = new WPTB_Cell(mark);\n\t\t\tfirstCell = table.rows[i].getElementsByTagName('td')[0];\n\t\t\tif (firstCell) {\n\t\t\t\ttable.rows[i].insertBefore(td.getDOMElement(), firstCell);\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\n\t\t\t}\n\t\t\tarray[i].push(0);\n\t\t}\n\n\t\tmaxAmountOfCells++;\n\t\tundoSelect();\n\t};\n\n\ttable.addColumnBefore = function () {\n\n\t};\n\n\ttable.addColumnAfter = function () {\n\n\t};\n\n\ttable.addRow = function (pos) {\n\t\tvar _this, row, referenceRow = undefined;\n\n\t\tif (pos == 'end' || pos == 'start') {\n\t\t\trow = this.insertRow(pos == 'end' ? -1 : 0);\n\t\t} else {\n\t\t\trow = document.createElement('tr');\n\t\t}\n\n\t\tfor (var j = 0; j < this.columns; j++) {\n\t\t\tvar cell = new WPTB_Cell(mark);\n\t\t\trow.appendChild(cell.getDOMElement());\n\t\t}\n\n\t\trow.classList.add('wptb-row');\n\n\t\tif (pos == 'before' || pos == 'after') {\n\t\t\t_this = this.getElementsByClassName('wptb-highlighted')[0];\n\t\t\treferenceRow = this.getElementsByTagName('tr')[_this.dataset.yIndex];\n\t\t\tif (pos == \"before\") {\n\t\t\t\tthis.getElementsByTagName('tbody')[0].insertBefore(row, referenceRow);\n\t\t\t\tvar buttons = document.getElementsByClassName('wptb-relative-action');\n\t\t\t\tfor (var i = 0; i < buttons.length; i++) {\n\t\t\t\t\tbuttons[i].dataset.yIndex++;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.getElementsByTagName('tbody')[0].insertBefore(row, referenceRow.nextSibling);\n\t\t\t}\n\t\t}\n\n\t\tif (pos == 'before' || pos == 'start') {\n\t\t\tvar active = document.querySelector('wptb-highlighted');\n\t\t\tif (active) {\n\t\t\t\tactive.onclick();\n\t\t\t}\n\t\t}\n\n\t\ttable.recalculateIndexes();\n\t};\n\n\ttable.addRowToTheEnd = function (evt) {\n\t\tvar r = table.insertRow(-1),\n\t\t\ttd,\n\t\t\taux;\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\n\t\t\ttd = new WPTB_Cell(mark);\n\t\t\tr.appendChild(td.getDOMElement());\n\t\t}\n\t\taux = Array.from(array[0]);\n\t\tarray.push(aux);\n\t\tdrawTable(array);\n\t\ttable.recalculateIndexes();\n\t\tundoSelect();\n\t};\n\n\ttable.addRowToTheStart = function (evt) {\n\t\tvar r = table.insertRow(0);\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\n\t\t\ttd = new WPTB_Cell(mark);\n\t\t\tr.appendChild(td.getDOMElement());\n\t\t}\n\t\taux = Array.from(array[0]);\n\t\tarray.push(aux);\n\t\tdrawTable(array);\n\t\ttable.recalculateIndexes();\n\t\tundoSelect();\n\t};\n\n\ttable.addRowBefore = function () {\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\n\t\t\trow = getCoords(cell)[0],\n\t\t\tr = table.insertRow(row),\n\t\t\taux,\n\t\t\trowspans = carriedRowspans(row - 1);\n\n\t\tnoPending = rowspans.filter(function (elem) {\n\t\t\treturn elem == 0;\n\t\t});\n\n\n\t\tfor (var i = 0; i < noPending.length; i++) {\n\t\t\tvar td = new WPTB_Cell(mark);\n\t\t\tr.appendChild(td.getDOMElement());\n\t\t}\n\n\t\tarr = realTimeArray();\n\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tconsole.log('Loop iteration');\n\n\t\t\tif (arr[i].length > maxAmountOfCells) {\n\t\t\t\t//Still not watched\n\t\t\t}\n\n\t\t\tif (arr[i].length < maxAmountOfCells) {\n\n\t\t\t\tfor (var j = arr[i].length; j < maxAmountOfCells; j++) {\n\t\t\t\t\ttd = new WPTB_Cell(mark);\n\t\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\taux = Array.from(array[0]);\n\t\tarray.push(aux);\n\t\tdrawTable(array);\n\t\ttable.recalculateIndexes();\n\t\tundoSelect();\n\t};\n\n\ttable.addRowAfter = function () {\n\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\n\t\t\trow = getCoords(cell)[0],\n\t\t\tr = table.insertRow(row + 1),\n\t\t\taux,\n\t\t\trowspans = carriedRowspans(row);\n\n\t\tnoPending = rowspans.filter(function (elem) {\n\t\t\treturn elem == 0;\n\t\t});\n\n\n\t\tfor (var i = 0; i < noPending.length; i++) {\n\t\t\ttd = new WPTB_Cell(mark);\n\t\t\tr.appendChild(td.getDOMElement());\n\t\t}\n\n\t\tarr = realTimeArray();\n\n\t\tconsole.log('Arr', arr);\n\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tconsole.log('Loop iteration');\n\n\t\t\tif (arr[i].length > maxAmountOfCells) {\n\t\t\t\t//Still not watched\n\t\t\t}\n\n\t\t\tif (arr[i].length < maxAmountOfCells) {\n\n\t\t\t\tfor (var j = arr[i].length; j < maxAmountOfCells; j++) {\n\t\t\t\t\ttd = new WPTB_Cell(mark);\n\t\t\t\t\ttable.rows[i].appendChild(td);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\taux = Array.from(array[0]);\n\t\tarray.push(aux);\n\t\tdrawTable(array);\n\t\ttable.recalculateIndexes();\n\t\tundoSelect();\n\t};\n\n\tvar isSquare = function (a) {\n\t\tvar rowStart = -1,\n\t\t\tcolumnStart = -1,\n\t\t\trowEnd = -1,\n\t\t\tcolumnEnd = -1,\n\t\t\theight,\n\t\t\twidth,\n\t\t\titemsEstimate = 0,\n\t\t\titems = 0;\n\n\t\tfor (var i = 0; i < a.length; i++) {\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\n\t\t\t\tif (a[i][j] == 1) {\n\t\t\t\t\trowStart = i;\n\t\t\t\t\tcolumnStart = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (rowStart !== -1 && columnStart !== -1) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = a.length - 1; i > -1; i--) {\n\t\t\tfor (var j = a[i].length - 1; j > -1; j--) {\n\t\t\t\tif (a[i][j] == 1) {\n\t\t\t\t\trowEnd = i;\n\t\t\t\t\tcolumnEnd = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (rowEnd !== -1 && columnEnd !== -1) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\n\t\tfor (var i = rowStart; i < rowEnd; i++) {\n\t\t\tfor (var j = columnStart; j < columnEnd; j++) {\n\t\t\t\tif (a[i][j] == 0 || a[i][j] == undefined) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < a.length; i++) {\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\n\t\t\t\tif (a[i][j] == 1) {\n\t\t\t\t\titems++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\theight = rowEnd - rowStart + 1;\n\t\twidth = columnEnd - columnStart + 1;\n\t\titemsEstimate = height * width;\n\n\t\tif (itemsEstimate !== items) {\n\t\t\treturn false;\n\t\t}\n\t\treturn [height, width];\n\t};\n\n\tvar drawTable = function (a) {\n\t\tvar string = 'DRAWING TABLE:\\n';\n\t\tfor (var i = 0; i < a.length; i++) {\n\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\n\t\t\t\tstring += ' ' + a[i][j];\n\t\t\t}\n\t\t\tstring += '\\n';\n\t\t}\n\t\tconsole.log(string);\n\t\tisSquare(a);\n\t};\n\n\tvar undoSelect = function () {\n\t\tvar tds = table.getElementsByClassName('marked');\n\t\twhile (tds.length) {\n\t\t\ttds[0].classList.remove('marked');\n\t\t}\n\t\tfor (var i = 0; i < array.length; i++) {\n\n\t\t\tfor (var j = 0; j < array[i].length; j++) {\n\t\t\t\tarray[i][j] = 0;\n\t\t\t}\n\n\t\t}\n\t};\n\n\tvar fillTableArray = function () {\n\t\tvar colspansSums = [], a = [];\n\n\t\t//calculate max amount of cells inside a row\n\t\tfor (var i = 0; i < table.rows.length; i++) {\n\t\t\tvar cells = table.rows[i].getElementsByTagName('td'),\n\t\t\t\tcolspanSumInRow = 0;\n\t\t\tfor (var j = 0; j < cells.length; j++) {\n\t\t\t\tcolspanSumInRow += cells[j].colSpan;\n\t\t\t}\n\t\t\tcolspansSums.push(colspanSumInRow);\n\t\t}\n\n\t\tconsole.log(colspanSumInRow);\n\n\t\tmaxAmountOfCells = Math.max.apply(null, colspansSums);\n\t\t//calculate max rows\n\t\tvar maxAmountOfRows = table.rows.length; /* I'm feeling like I'm gonna go crazy if I don't assume \n\t\t\t                                                  the table starts having a fixed amount of rows,\n\t\t\t                                                  therefore no matter if I vertically fuse all cells from the\n\t\t\t                                                  first row to the last row, the TR nodes won't dissapear\n\t\t\t                                                  (tough they will run empty after the merging function deletes\n\t\t\t                                                  all of its tds for increasing the first row tds rowspan),\n\t\t\t                                                  so its length remains as a confident max rows amount.\n\t\t\t                                                  */\n\t\t// fill with zeros from both values\n\t\tfor (var i = 0; i < maxAmountOfRows; i++) {\n\t\t\ta[i] = [];\n\t\t\tfor (var j = 0; j < maxAmountOfCells; j++) {\n\t\t\t\ta[i].push(0);\n\t\t\t}\n\t\t}\n\t\tdrawTable(a);\n\t\treturn a;\n\t};\n\n\n\tvar getCoords = function (search) {\n\t\tvar skipInCols = [], cell;\n\n\t\tfor (var i = 0; i < table.rows.length; i++) {\n\n\n\t\t\tvar tds = [].slice.call(table.rows[i].getElementsByTagName('td'));\n\n\t\t\tfor (var j = 0; j < maxAmountOfCells;) {\n\n\t\t\t\tif (skipInCols[j] !== undefined && skipInCols[j] > 0) {\n\t\t\t\t\tj++;\n\t\t\t\t\tskipInCols[j]--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcell = tds.shift();\n\n\t\t\t\tif (cell.rowSpan > 1) {\n\t\t\t\t\tfor (k = 0; k < cell.colSpan; k++) {\n\t\t\t\t\t\tskipInCols[j + k] = cell.rowSpan - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (cell == search) {\n\t\t\t\t\treturn [i, j];\n\t\t\t\t}\n\n\t\t\t\tj += cell.colSpan;\n\n\t\t\t}\n\n\n\n\t\t}\n\t};\n\n\n\ttable.deleteRow = function (e) {\n\t\tvar cell = document.getElementsByClassName('wptb-highlighted')[0],\n\t\t\tindex = cell.dataset.yIndex,\n\t\t\ttable = document.getElementsByClassName('wptb-preview-table')[0],\n\t\t\trow = table.getElementsByTagName('tr')[index],\n\t\t\trowCount = table.rows.length,\n\t\t\ttbody = row.parentNode;\n\t\tif ((rowCount == 1 && columnCount == 1) || tbody == undefined) {\n\t\t\treturn;\n\t\t}\n\t\ttbody.removeChild(row);\n\t\tthis.recalculateIndexes();\n\t};\n\n\ttable.deleteColumn = function (e) {\n\t\tvar cell = document.getElementsByClassName('wptb-highlighted')[0],\n\t\t\tnum = cell.dataset.xIndex,\n\t\t\ttable = document.getElementsByClassName('wptb-preview-table')[0],\n\t\t\trowCount = table.rows.length;\n\n\t\tif ((rowCount == 1 && columnCount == 1)) {\n\t\t\treturn;\n\t\t}\n\t\tfor (var i = 0; i < rowCount; i++) {\n\t\t\tvar td = table.getElementsByTagName('tr')[i].getElementsByTagName('td')[num],\n\t\t\t\ttr = td.parentNode;\n\t\t\ttr.removeChild(td);\n\t\t}\n\t\tthis.recalculateIndexes();\n\t};\n\n\ttable.mergeCells = function () {\n\t\tconsole.log('Meging');\n\t\tvar dimensions = isSquare(array),\n\t\t\trowspan = dimensions[0],\n\t\t\tcolspan = dimensions[1],\n\t\t\tfirst = document.querySelector('.wptb-highlighted'),\n\t\t\ttds = [].slice.call(document.getElementsByClassName('wptb-highlighted'), 1);\n\n\t\tconsole.log('Dimensions:', dimensions);\n\t\tconsole.log('First:', first);\n\t\tconsole.log('Cells without the first one:', tds);\n\n\n\t\tfor (var i = 0; i < tds.length; i++) {\n\t\t\tvar p = tds[i].parentNode;\n\t\t\tp.removeChild(tds[i]);\n\t\t}\n\n\t\tfirst.colSpan = colspan;\n\t\tfirst.rowSpan = rowspan;\n\t\tundoSelect();\n\t};\n\n\ttable.splitCell = function () {\n\t\tvar cell = document.getElementsByClassName('wptb-highlighted')[0],\n\t\t\trowspan = cell.rowSpan,\n\t\t\tcolspan = cell.colSpan;\n\t\tcell.rowSpan = 1;\n\t\tcell.colSpan = 1;\n\t\tconsole.log('Cell', cell.rowSpan, cell.rowspan);\n\t\tfor (var i = 0; i < rowspan; i++) {\n\t\t\tconsole.log('Let\"s split it!', cell);\n\t\t\tif (i == 0) {\n\t\t\t\tconsole.log('Iteration 1');\n\t\t\t\trefCell = cell;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconsole.log('Conter');\n\t\t\t\tfor (var k = 0, pt = 0; k < colspan; k += refCell.colSpan, pt++) {\n\t\t\t\t\tconsole.log('Increasing Conter');\n\t\t\t\t\trefCell = table.rows[i].getElementsByTagName('td')[pt];\n\t\t\t\t\tif (!refCell) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconsole.log(refCell);\n\n\t\t\tvar p = refCell ? refCell.parentNode : table.rows[i];\n\t\t\tfor (var j = 0; j < colspan; j++) {\n\t\t\t\tif (!i && !j) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tnewCell = document.createElement('td');\n\t\t\t\tnewCell.onclick = mark;\n\t\t\t\tif (refCell && refCell.nextSibling) {\n\t\t\t\t\tp.insertBefore(newCell, refCell.nextSibling)\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tp.appendChild(newCell);\n\t\t\t\t}\n\t\t\t\trefCell = newCell;\n\t\t\t}\n\t\t}\n\t\tundoSelect();\n\n\t};\n\n\tarray = fillTableArray();\n\n\twptbTableSetup.appendChild(table);\n\n\ttable.recalculateIndexes();\n\n\tWPTB_LeftPanel();\n\n};","var WPTB_Text = function (text) {\n\n\tvar DOMElement = document.createElement('div'),\n\t\telText2 = document.createElement('div'),\n\t\telP = document.createElement('p');\n\n\tthis.kind = 'text';\n\n\telText2.classList.add('editable');\n\telP.innerHTML = text != undefined ? text : 'Text';\n\telText2.appendChild(elP);\n\tDOMElement.appendChild(elText2);\n\n\tthis.getDOMElement = function () {\n\t\treturn DOMElement;\n\t}\n\tapplyGenericItemSettings(this);\n\n\treturn this;\n\n};","var applyGenericItemSettings = function (element) {\n\n\tvar node = element.getDOMElement(),\n\t\tindex = document.counter.nextIndex(element.kind),\n\t\tlistItems;\n\n\tnode.onmouseenter = function (event) {\n\t\tthis.classList.add('wptb-directlyhovered');\n\t\tvar btnDelete = document.createElement('span'),\n\t\t\tbtnCopy = document.createElement('span'),\n\t\t\tbtnMove = document.createElement('span'),\n\t\t\tactions = document.createElement('span'),\n\t\t\tprevious, i;\n\t\tactions.classList.add('wptb-actions');\n\t\tbtnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\n\t\tbtnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\n\t\tbtnMove.classList.add(\"dashicons\", \"dashicons-move\", 'move-action');\n\t\tbtnMove.draggable = true;\n\t\tbtnDelete.onclick = function (event) {\n\t\t\tvar act = this.parentNode.parentNode,\n\t\t\t\tel = act.parentNode;\n\t\t\tel.removeChild(act);\n\t\t};\n\t\tbtnCopy.onclick = function (event) {\n\t\t\tif (element.kind == 'list') {\n\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\n\t\t\t\t\ttemp = [],\n\t\t\t\t\tsrcList = event.target.parentNode.parentNode.querySelectorAll('ul article .wptb-list-item-content');\n\n\t\t\t\tfor (var i = 0; i < srcList.length; i++) {\n\t\t\t\t\ttemp.push(srcList[i].innerHTML);\n\t\t\t\t}\n\t\t\t\tvar copy = new WPTB_List(temp);\n\t\t\t\ttd.appendChild(copy.getDOMElement());\n\n\t\t\t}\n\t\t\telse if (element.kind == 'text') {\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\n\t\t\t\t\tcopy = new WPTB_Text(event.target.parentNode.parentNode.childNodes[0].innerHTML);\n\t\t\t\ttd.appendChild(copy.getDOMElement());\n\t\t\t} else if (element.kind == 'image') {\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\n\t\t\t\t\tcopy = new WPTB_Image(event.target.parentNode.parentNode.childNodes[0].src);\n\t\t\t\ttd.appendChild(copy.getDOMElement());\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\n\t\t\t\t\tcopy = new WPTB_Button(event.target.parentNode.parentNode.childNodes[0].innerHTML);\n\t\t\t\ttd.appendChild(copy.getDOMElement());\n\t\t\t}\n\t\t};\n\t\tbtnMove.ondragstart = function (event) {\n\t\t\tvar parent = this, infArr, type;\n\n\t\t\twhile (parent.className == '' ||\n\t\t\t\t!parent.classList.contains('wptb-ph-element')) {\n\t\t\t\tparent = parent.parentNode;\n\t\t\t}\n\n\n\t\t\tinfArr = parent.className.match(/wptb-element-(.+)-(\\d+)/i);\n\t\t\ttype = infArr[1];\n\n\t\t\tvar img = document.createElement(\"img\");\n\t\t\timg.src = \"http://localhost/sandbox/wp-content/plugins/wp-table-builder/inc/admin/views/builder/icons/\" + type + \".png\";\n\t\t\tconsole.log(img.src);\n\t\t\tevent.dataTransfer.setDragImage(img, 0, 0);\n\t\t\tevent.dataTransfer.setData('node', 'wptb-element-' + infArr[1] + '-' + infArr[2]);\n\t\t};\n\n\n\t\tif (element.kind === 'button') {\n\t\t\ttinyMCE.init({\n\t\t\t\ttarget: node.childNodes[0].childNodes[0],\n\t\t\t\tinline: true,\n\t\t\t\tplugins: \"link\",\n\t\t\t\tdialog_type: \"modal\",\n\t\t\t\ttheme: 'modern',\n\t\t\t\tmenubar: false,\n\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\n\t\t\t\ttoolbar: 'bold italic strikethrough',\n\t\t\t\tsetup: function (ed) {\n\t\t\t\t\ted.on(\"init\",\n\t\t\t\t\t\tfunction (ed) {\n\t\t\t\t\t\t\ttinyMCE.execCommand('mceRepaint');\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tinit_instance_callback: function (editor) {\n\t\t\t\t\teditor.on('change', function (e) {\n\t\t\t\t\t\t// check if it becomes empty because if there's no value it's hard to edit the editor in button element\n\t\t\t\t\t\tif (editor.getContent() == \"\") {\n\t\t\t\t\t\t\teditor.setContent(\"<p class='wptb-button'>Button Text</p>\");\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditor.on('KeyDown', function (e) {\n\t\t\t\t\t\tvar range = editor.selection.getRng();\n\t\t\t\t\t\tvar KeyID = e.keyCode;\n\t\t\t\t\t\tif (range.startOffset == 0 && (KeyID == 8 || KeyID == 46)) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\teditor.setContent(\"<p class='wptb-button'></p>\");\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\twindow.currentEditor = editor;\n\t\t\t\t\teditor.on('focus', function (e) {\n\n\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\n\t\t\t\t\t\tif (window.currentEditor &&\n\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\n\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (element.kind === 'text') {\n\t\t\ttinyMCE.init({\n\t\t\t\ttarget: node.childNodes[0],\n\t\t\t\tinline: true,\n\t\t\t\tplugins: \"link, paste\",\n\t\t\t\tdialog_type: \"modal\",\n\t\t\t\ttheme: 'modern',\n\t\t\t\tmenubar: false,\n\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\n\t\t\t\tpaste_as_text: true,\n\t\t\t\ttoolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\n\t\t\t\tinit_instance_callback: function (editor) {\n\t\t\t\t\twindow.currentEditor = editor;\n\t\t\t\t\teditor.on('focus', function (e) {\n\n\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\n\t\t\t\t\t\tif (window.currentEditor &&\n\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\n\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\t\telse {\n\t\t\tlistItems = node.getElementsByClassName('wptb-list-item-content');\n\t\t\tfor (var i = 0; i < listItems.length; i++) {\n\t\t\t\ttinyMCE.init({\n\t\t\t\t\ttarget: listItems[i],\n\t\t\t\t\tinline: true,\n\t\t\t\t\tplugins: \"link, paste\",\n\t\t\t\t\tdialog_type: \"modal\",\n\t\t\t\t\ttheme: 'modern',\n\t\t\t\t\tmenubar: false,\n\t\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\n\t\t\t\t\tpaste_as_text: true,\n\t\t\t\t\ttoolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\n\t\t\t\t\tinit_instance_callback: function (editor) {\n\t\t\t\t\t\twindow.currentEditor = editor;\n\t\t\t\t\t\teditor.on('focus', function (e) {\n\t\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\n\t\t\t\t\t\t\tif (window.currentEditor &&\n\t\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\n\t\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\n\t\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\n\t\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tactions.appendChild(btnMove);\n\t\tactions.appendChild(btnCopy);\n\t\tactions.appendChild(btnDelete);\n\t\tthis.appendChild(actions);\n\t};\n\n\tnode.onmouseleave = function (event) {\n\t\tvar formerActions = this.getElementsByClassName('wptb-actions');\n\t\tif (formerActions && formerActions[0]) {\n\t\t\tlet par = formerActions[0].parentNode;\n\t\t\tpar.removeChild(formerActions[0]);\n\t\t}\n\t\tthis.classList.remove('wptb-directlyhovered');\n\t};\n\n\tnode.classList.add('wptb-ph-element', 'wptb-element-' + element.kind + '-' +\n\t\tindex);\n\n\tnew WPTB_ElementOptions(element, index);\n\n\tdocument.counter.increment(element.kind);\n\n};",""]}