{"version":3,"sources":["applyGenericItemSettings.js","wptb-builder.js","WPTB_Builder.js","WPTB_Button.js","WPTB_Cell.js","WPTB_ElementCounters.js","WPTB_ElementOptions.js","WPTB_Image.js","WPTB_Initializer.js","WPTB_LeftPanel.js","WPTB_List.js","WPTB_ListItem.js","WPTB_MultipleSelect.js","WPTB_Parser.js","WPTB_Settings.js","WPTB_Space.js","WPTB_Stringifier.js","WPTB_Table.js","WPTB_Text.js"],"names":["applyGenericItemSettings","element","kindIndexProt","node","getDOMElement","index","document","counter","nextIndex","kind","listItems","copy","onmouseenter","event","classList","add","btnDelete","createElement","btnCopy","btnMove","actions","previous","i","draggable","onclick","act","parentNode","el","space","nextSibling","num","space2","removeChild","getElementsByClassName","length","td","target","temp","srcList","querySelectorAll","push","innerHTML","WPTB_List","insertBefore","WPTB_Space","WPTB_Text","childNodes","WPTB_Image","children","src","WPTB_Button","ondragstart","parent","infArr","type","className","contains","match","img","dataTransfer","setDragImage","setData","tinyMCE","init","inline","plugins","dialog_type","theme","menubar","fixed_toolbar_container","toolbar","verify_html","setup","ed","on","execCommand","init_instance_callback","editor","e","getContent","trim","setContent","range","selection","getRng","KeyID","keyCode","startOffset","preventDefault","window","currentEditor","totalWidth","offsetWidth","getElementById","scrollTop","bodyElement","style","display","position","right","top","paste_as_text","appendChild","onmouseleave","formerActions","par","remove","node_wptb_element_kind_num","WPTB_ElementOptions","increment","detectMode","url","location","href","regex","RegExp","results","exec","decodeURIComponent","replace","WPTB_Builder","table_id","http","XMLHttpRequest","ajaxurl","open","setRequestHeader","onreadystatechange","d","readyState","status","ans","JSON","parse","responseText","value","wptbTableSetupEl","WPTB_Parser","WPTB_Table","WPTB_LeftPanel","WPTB_Settings","send","ElementCounters","select","MultipleSelect","initializer","WPTB_Initializer","settings","addEventListener","text","DOMElementProt","DOMElement","elButton2","el_B","undefined","wptbElementMutch","Array","isArray","attributesContainer","attributes","setAttribute","name","wptbButtonWrapper","querySelector","wptbButtonWrapAttributes","wptbButton","wptbButtonAttributes","WPTB_Cell","callback","newElementProxy","highlightRow","parentRow","columnCount","parseInt","tds","getElementsByTagName","classToAdd","ttd","highlightColumn","rowCount","table","tr","padding","jQuery","val","innerBorderWidth","border","ondragenter","div","getData","ondragover","ondragleave","ondrop","classId","t_space","spaceParent","wptbPhElement","wptbSpaceBetween","j","wptbElementTypeClass","wptbTypeElementArr","split","wptbArticle","WPTB_ListItem","setCoords","y","x","dataset","yIndex","xIndex","getCoords","coords","appendElement","priv","key","elemIdClass","prop","cloneNode","properties","affectedEl","wptbSize","b","buttonAlignment","justifyContent","buttonAlignmentSelect","selectOption","selectOptionVal","selected","buttonTextColor","color","buttonColor","backgroundColor","buttonHref","getAttribute","buttonLinkTarget","buttonTextColorInput","buttonBackgroundColorInput","buttonHrefInput","buttonLinkTargetInput","buttonLinkTargetInputId","buttonLinkTargetInputLabel","checked","elementsA","a","aTextAlign","textAlign","imageAlignmentSelect","imageLinkHref","inputImageLink","imageLinkTarget","imageLinkTargetInput","imageLinkTargetInputId","imageLinkTargetInputLabel","imgWidth","width","imageWidthInputRange","imageWidthInputNumber","imgAlternativeText","imageAlternativeTextInput","elementFontSize","fontSize","elementTextColor","textFontSizeInputRange","textFontSizeInputNumber","textColorInput","elementListStyleType","listStyleType","elementListClassSelect","listIconSelectLabel","nodeType","listIconSelectLabelId","elementListStyleTypeSelect","elementListItemContent","listItemPTextAlignArr","p","listItemPTextAlignLeftCount","listItemPTextAlignCenterCount","listItemPTextAlignRightCount","elementListAlignmentSelect","maxListItemTAlLeftC","Math","max","optionsClass","listJustifyContent","find","wpColorPicker","defaultColor","substring","selectedIndex","buttons","size","n_Class","optionControls","change","ui","classe","ps","number","toString","slider","oninput","onchange","alt","height","jc","articles","bullets","toLowerCase","anchor","file_frame","wp","media","frames","title","button","multiple","attachment","state","get","first","toJSON","MIN_COLUMNS","MIN_ROWS","MAX_COLUMNS","MAX_ROWS","tableGenerator","body","columnsDecrementButton","columnsIncrementButton","rowsDecrementButton","rowsIncrementButton","columnsInput","rowsInput","columns","rows","wptbElementButtons","hexToRgb","hex","result","tableRows","tableHeader","tableCells","addInnerBorderSize","addCellPadding","addInnerBorder","styles","marginBottom","addBorderSize","_val","wptbElement","toggleTableEditMode","addRowToTheEnd","addRowToTheStart","addRowBefore","addRowAfter","addColumnEnd","addColumnStart","addColumnBefore","addColumnAfter","deleteColumn","deleteRow","mergeCells","splitCell","innerElements","el_L","item","wptbListItemReturn","divdot","divcontent","libullet","styleDot","onkeyup","listItemKeyListener","article","content","html","duplicate","append","onkeydown","which","lastP","dontAddItems","setTimeout","selectedCells","multipleCellMode","activateMultipleSelectMode","deactivateMultipleSelectMode","isActivated","pushSelectedCell","cell","flushSelectedCells","getFirst","minXIndex","minYIndex","getLast","maxXIndex","maxYIndex","last","removeAllButFirst","code","elementHtml","createTextNode","tagName","elems","effectAllowed","t","messagingArea","WPTB_Stringifier","firstChild","stringify","params","rs","wptbId","action","data","elSpaceBetween","includes","spaceBetween","stopPropagation","alert","start","nodeValue","int_elem_arr","attributes_list","internal_elements","inter_elem","array","wptbTableSetup","row","maxAmountOfCells","maxAmountOfRows","mark","rowSpan","cs","colSpan","markedCells","noCells","singleCells","multipleCells","column","isSquare","realTimeArray","carried","cols","matriz","items","k","justAssigned","amount","carriedRowspans","cellsBuffer","cellPointer","xPosition","stepsToMove","celda","drawTable","string","undoSelect","fillTableArray","colspansSums","cells","colspanSumInRow","apply","getActualPointsInRow","points","search","skipInCols","id","insertRow","wptb_preview_table","bar","recalculateIndexes","trs","maxCols","firstCell","c_pos","pos","pendingInsertion","bro","currentCell","l","r","aux","from","rowspans","noPending","filter","elem","arr","rowStart","columnStart","rowEnd","columnEnd","itemsEstimate","dimensions","rowspan","colspan","slice","call","addLackingCells","findRowspannedCells","difference","actualPoints","sumRows","totalColspan","reduct","pop","cell_ref","buffer","elText2","elP"],"mappings":"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","file":"admin.js","sourcesContent":["var applyGenericItemSettings = function ( element, kindIndexProt ) {\r\n\tvar node = element.getDOMElement(),\r\n\t    index = document.counter.nextIndex(element.kind),\r\n\t    listItems,\r\n            copy;\r\n\r\n\tnode.onmouseenter = function (event) {\r\n\t\tthis.classList.add('wptb-directlyhovered');\r\n\t\tvar btnDelete = document.createElement('span'),\r\n\t\t    btnCopy = document.createElement('span'),\r\n\t\t    btnMove = document.createElement('span'),\r\n\t\t    actions = document.createElement('span'),\r\n                    previous, i;\r\n\t\tactions.classList.add('wptb-actions');\r\n\t\tbtnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\r\n\t\tbtnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\r\n\t\tbtnMove.classList.add(\"dashicons\", \"dashicons-move\", 'move-action');\r\n\t\tbtnMove.draggable = true;\r\n\t\tbtnDelete.onclick = function (event) {\r\n\t\t\tvar act = this.parentNode.parentNode,\r\n\t\t\t    el = act.parentNode,\r\n\t\t\t    space = act.nextSibling,\r\n                            num, space2;\r\n\t\t\tel.removeChild(act);\r\n\t\t\tel.removeChild(space);\r\n\t\t\tnum = el.getElementsByClassName('wptb-ph-element').length;\r\n\t\t\tif (!num) {\r\n\t\t\t\tspace2 = el.getElementsByClassName('wptb-space-between')[0];\r\n\t\t\t\tif (space2) {\r\n\t\t\t\t\tel.removeChild(space2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tbtnCopy.onclick = function (event) {\r\n\t\t\tif (element.kind == 'list') {\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    temp = [],\r\n\t\t\t\t    srcList = event.target.parentNode.parentNode.querySelectorAll('ul article .wptb-list-item-content');\r\n                            \r\n\t\t\t\tfor (var i = 0; i < srcList.length; i++) {\r\n                                    temp.push(srcList[i].innerHTML);\r\n\t\t\t\t}\r\n                                \r\n\t\t\t\tvar copy = new WPTB_List( temp, node );\r\n                                \r\n                                node.parentNode.insertBefore( copy.getDOMElement(), node.nextSibling );\r\n                                node.parentNode.insertBefore( new WPTB_Space, copy.getDOMElement() );\r\n\t\t\t} else if (element.kind == 'text') {\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    copy = new WPTB_Text(event.target.parentNode.parentNode.childNodes[0].innerHTML, node);\r\n                            \r\n\t\t\t\tnode.parentNode.insertBefore( copy.getDOMElement(), node.nextSibling );\r\n                                node.parentNode.insertBefore( new WPTB_Space, copy.getDOMElement() );\r\n\t\t\t} else if ( element.kind == 'image' ) {\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    copy = new WPTB_Image( event.target.parentNode.parentNode.children[0].children[0].src, node );\r\n                            \r\n\t\t\t\tnode.parentNode.insertBefore( copy.getDOMElement(), node.nextSibling );\r\n                                node.parentNode.insertBefore( new WPTB_Space, copy.getDOMElement() );\r\n\t\t\t} else {\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    copy = new WPTB_Button( event.target.parentNode.parentNode.childNodes[0].innerHTML, node );\r\n                            \r\n                                node.parentNode.insertBefore( copy.getDOMElement(), node.nextSibling );\r\n                                node.parentNode.insertBefore( new WPTB_Space, copy.getDOMElement() );\r\n\t\t\t}\r\n\t\t};\r\n\t\tbtnMove.ondragstart = function (event) {\r\n\t\t\tvar parent = this, infArr, type;\r\n\r\n\t\t\twhile (parent.className == '' ||\r\n\t\t\t\t!parent.classList.contains('wptb-ph-element')) {\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t}\r\n\r\n\t\t\tinfArr = parent.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n\t\t\ttype = infArr[1];\r\n\r\n\t\t\tvar img = document.createElement(\"img\");\r\n\t\t\timg.src = \"http://localhost/sandbox/wp-content/plugins/wp-table-builder/inc/admin/views/builder/icons/\" + type + \".png\";\r\n\t\t\tevent.dataTransfer.setDragImage(img, 0, 0);\r\n\t\t\tevent.dataTransfer.setData('node', 'wptb-element-' + infArr[1] + '-' + infArr[2]);\r\n\t\t};\r\n\r\n\t\tif (element.kind === 'button') {\r\n\t\t\ttinyMCE.init({\r\n\t\t\t\ttarget: node.childNodes[0].childNodes[0],\r\n\t\t\t\tinline: true,\r\n\t\t\t\tplugins: \"link\",\r\n\t\t\t\tdialog_type: \"modal\",\r\n\t\t\t\ttheme: 'modern',\r\n\t\t\t\tmenubar: false,\r\n\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t\t\t\ttoolbar: 'bold italic strikethrough',\r\n\t\t\t\tverify_html: false,\r\n\t\t\t\tsetup: function (ed) {\r\n\t\t\t\t\ted.on(\"init\",\r\n\t\t\t\t\t\tfunction (ed) {\r\n\t\t\t\t\t\ttinyMCE.execCommand('mceRepaint');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tinit_instance_callback: function (editor) {\r\n\t\t\t\t\teditor.on('change', function (e) {\r\n\t\t\t\t\t\t// check if it becomes empty because if there's no value it's hard to edit the editor in button element\r\n\t\t\t\t\t\tif (editor.getContent().trim() == \"\") {\r\n\t\t\t\t\t\t\teditor.setContent(\"<a class='wptb-button'>Button Text</a>\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\teditor.on('KeyDown', function (e) {\r\n\t\t\t\t\t\tvar range = editor.selection.getRng();\r\n\t\t\t\t\t\tvar KeyID = e.keyCode;\r\n\t\t\t\t\t\tif (range.startOffset == 0 && (KeyID == 8 || KeyID == 46)) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\teditor.setContent(\"<p class='wptb-button'></p>\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\twindow.currentEditor = editor;\r\n\t\t\t\t\teditor.on('focus', function (e) {\r\n\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t\t\tif (window.currentEditor &&\r\n\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else if (element.kind === 'text') {\r\n\t\t\ttinyMCE.init({\r\n\t\t\t\ttarget: node.childNodes[0],\r\n\t\t\t\tinline: true,\r\n\t\t\t\tplugins: \"link, paste\",\r\n\t\t\t\tdialog_type: \"modal\",\r\n\t\t\t\ttheme: 'modern',\r\n\t\t\t\tmenubar: false,\r\n\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t\t\t\tpaste_as_text: true,\r\n\t\t\t\ttoolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\r\n\t\t\t\tinit_instance_callback: function (editor) {\r\n\t\t\t\t\twindow.currentEditor = editor;\r\n\t\t\t\t\teditor.on('focus', function (e) {\r\n\r\n\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t\t\tif (window.currentEditor &&\r\n\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t} else {\r\n\t\t\tlistItems = node.getElementsByClassName('wptb-list-item-content');\r\n\t\t\tfor (var i = 0; i < listItems.length; i++) {\r\n\t\t\t\ttinyMCE.init({\r\n\t\t\t\t\ttarget: listItems[i],\r\n\t\t\t\t\tinline: true,\r\n\t\t\t\t\tplugins: \"link, paste\",\r\n\t\t\t\t\tdialog_type: \"modal\",\r\n\t\t\t\t\ttheme: 'modern',\r\n\t\t\t\t\tmenubar: false,\r\n\t\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t\t\t\t\tpaste_as_text: true,\r\n\t\t\t\t\ttoolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\r\n\t\t\t\t\tinit_instance_callback: function (editor) {\r\n\t\t\t\t\t\twindow.currentEditor = editor;\r\n\t\t\t\t\t\teditor.on('focus', function (e) {\r\n\t\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t\t\t\tif (window.currentEditor &&\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tactions.appendChild(btnMove);\r\n\t\tactions.appendChild(btnCopy);\r\n\t\tactions.appendChild(btnDelete);\r\n\t\tthis.appendChild(actions);\r\n\t};\r\n\r\n\tnode.onmouseleave = function (event) {\r\n\t\tvar formerActions = this.getElementsByClassName('wptb-actions');\r\n\t\tif (formerActions && formerActions[0]) {\r\n\t\t\tlet par = formerActions[0].parentNode;\r\n\t\t\tpar.removeChild(formerActions[0]);\r\n\t\t}\r\n\t\tthis.classList.remove('wptb-directlyhovered');\r\n\t};\r\n        \r\n        let node_wptb_element_kind_num = node.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n        if ( node_wptb_element_kind_num ) {\r\n            node.classList.remove( node_wptb_element_kind_num[0] );\r\n        }\r\n        if ( ! node.classList.contains( 'wptb-ph-element' ) ) {\r\n            node.classList.add('wptb-ph-element' );\r\n            if( ! node.classList.contains( 'wptb-element-' + element.kind + '-' + index ) ) {\r\n                node.classList.add( 'wptb-element-' + element.kind + '-' + index );\r\n            }\r\n        } else {\r\n            if( ! node.classList.contains( 'wptb-element-' + element.kind + '-' + index ) ) {\r\n                node.classList.add( 'wptb-element-' + element.kind + '-' + index );\r\n            }\r\n        }\r\n\tnew WPTB_ElementOptions( element, index, kindIndexProt );\r\n\r\n\tdocument.counter.increment(element.kind);\r\n\r\n};","","(function () {\r\n\r\n\tfunction detectMode() {\r\n\t\tvar url = window.location.href,\r\n\t\t    regex = new RegExp('[?&]table(=([^&#]*)|&|#|$)'),\r\n\t\t    results = regex.exec(url);\r\n\t\tif (!results) return false;\r\n\t\tif (!results[2]) return '';\r\n\t\treturn decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n\t}\r\n\r\n\tvar WPTB_Builder = function () {\r\n            var table_id = detectMode();\r\n            if (table_id) {\r\n                var http = new XMLHttpRequest(),\r\n                    url = ajaxurl + \"?action=get_table\" + '&id=' + table_id;\r\n                http.open('GET', url, true);\r\n                http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n                http.onreadystatechange = function (d) {\r\n                    if (this.readyState == 4 && this.status == 200) {\r\n                        var ans = JSON.parse(http.responseText);\r\n                        document.getElementById('wptb-setup-name').value = ans[0];\r\n                        document.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\r\n                        let wptbTableSetupEl = document.getElementsByClassName('wptb-table-setup')[0];\r\n                        wptbTableSetupEl.appendChild( WPTB_Parser( ans[1] ) );\r\n                        WPTB_Table();\r\n                        WPTB_LeftPanel();\r\n                        WPTB_Settings();\r\n                        return;\r\n                    }\r\n                };\r\n                http.send(null);\r\n            }\r\n            document.counter = new ElementCounters();\r\n            document.select = new MultipleSelect();\r\n\r\n            var initializer = WPTB_Initializer();\r\n            settings = WPTB_Settings();\r\n\t};\r\n\r\n\tdocument.addEventListener('DOMContentLoaded', WPTB_Builder);\r\n})();","var WPTB_Button = function( text, DOMElementProt ) {\r\n    \r\n    var DOMElement = document.createElement('div'),\r\n        elButton2 = document.createElement('div'),\r\n        el_B = document.createElement('a'),\r\n        kindIndexProt = undefined;\r\n\r\n    DOMElement.classList.add('wptb-button-container', 'wptb-size-M', 'wptb-');\r\n    elButton2.classList.add('wptb-button-wrapper');\r\n    el_B.classList.add('wptb-button');\r\n    el_B.classList.add('editable');\r\n    el_B.classList.add('editable');\r\n    el_B.innerHTML = text != undefined ? text : 'Button Text';\r\n    \r\n    // Creation of a new button when copying to avoid errors when assigning new event handlers.\r\n    if ( DOMElementProt ) {\r\n        let wptbElementMutch = DOMElementProt.className.match( /wptb-element-((.+-)\\d+)/i );\r\n        if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\r\n            kindIndexProt = wptbElementMutch[1];\r\n        }; \r\n        var attributesContainer = [...DOMElementProt.attributes];\r\n        if ( attributesContainer.length > 0 ) {\r\n            for( let i = 0; i < attributesContainer.length; i++ ) {\r\n                DOMElement.setAttribute(attributesContainer[i].name, attributesContainer[i].value);\r\n            } \r\n        }\r\n        \r\n        var wptbButtonWrapper = DOMElementProt.querySelector( '.wptb-button-wrapper' );\r\n        if ( wptbButtonWrapper ) {\r\n            var wptbButtonWrapAttributes = [...wptbButtonWrapper.attributes];\r\n            if ( wptbButtonWrapAttributes.length > 0 ) {\r\n                for( let i = 0; i < wptbButtonWrapAttributes.length; i++ ) {\r\n                    if ( wptbButtonWrapAttributes[i].name == 'style') {\r\n                        elButton2.setAttribute( wptbButtonWrapAttributes[i].name, wptbButtonWrapAttributes[i].value );\r\n                    }\r\n                } \r\n            }\r\n        }\r\n        \r\n        var wptbButton = DOMElementProt.querySelector( '.wptb-button' );\r\n        if ( wptbButton ) {\r\n            var wptbButtonAttributes = [...wptbButton.attributes];\r\n            if ( wptbButtonAttributes.length > 0 ) {\r\n                for( let i = 0; i < wptbButtonAttributes.length; i++ ) {\r\n                    if ( wptbButtonAttributes[i].name == 'style' || \r\n                            wptbButtonAttributes[i].name == 'href' || \r\n                            wptbButtonAttributes[i].name == 'target' ) {\r\n                        el_B.setAttribute( wptbButtonAttributes[i].name, wptbButtonAttributes[i].value );\r\n                    }\r\n                } \r\n            }\r\n        }\r\n    }\r\n    \r\n    elButton2.appendChild(el_B);\r\n    DOMElement.appendChild(elButton2);\r\n    \r\n    this.kind = 'button';\r\n\r\n    this.getDOMElement = function () {\r\n            return DOMElement;\r\n    };\r\n\r\n    applyGenericItemSettings( this, kindIndexProt );\r\n\r\n    return this;\r\n};","var WPTB_Cell = function (callback, DOMElement) {\r\n\r\n    function newElementProxy(el) {\r\n        if (el == 'list') {\r\n            return new WPTB_List();\r\n        } else if (el == 'image') {\r\n            return new WPTB_Image();\r\n        } else if (el == 'text') {\r\n            return new WPTB_Text();\r\n        } else if (el == 'button') {\r\n            return new WPTB_Button();\r\n        }\r\n    }\r\n\r\n    function highlightRow(td) {\r\n        var parentRow = td.parentNode,\r\n            columnCount = parseInt(document.getElementById('wptb-columns-number').value),\r\n            tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n        for (var i = 0; i < tds.length; i++) {\r\n            tds[i].classList.remove('highlighted-row-first', 'highlighted-row-last', 'highlighted-row-inner', 'highlighted-column-first', 'highlighted-column-last', 'highlighted-column-inner');\r\n        }\r\n        for (var i = 0; i < columnCount; i++) {\r\n\r\n            var classToAdd = i == 0 ? 'highlighted-row-first' : i == columnCount - 1 ? 'highlighted-row-last' : 'highlighted-row-inner';\r\n            var ttd = parentRow.getElementsByTagName('td')[i];\r\n            if (ttd !== td) {\r\n                ttd.classList.add(classToAdd);\r\n            }\r\n        }\r\n    }\r\n\r\n    function highlightColumn(td) {\r\n\r\n        var index,\r\n            parentRow = td.parentNode;\r\n        columnCount = parseInt(document.getElementById('wptb-columns-number').value), rowCount = parseInt(document.getElementById('wptb-rows-number').value), table = document.getElementsByClassName('wptb-preview-table')[0];\r\n        for (var i = 0; i < columnCount; i++) {\r\n            if (parentRow.getElementsByTagName('td')[i] === td) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < rowCount; i++) {\r\n            var classToAdd = i == 0 ? 'highlighted-column-first' : i == rowCount - 1 ? 'highlighted-column-last' : 'highlighted-column-inner';\r\n            var tr = table.getElementsByTagName('tr')[i];\r\n            if (tr.getElementsByTagName('td')[index] !== td) {\r\n                tr.getElementsByTagName('td')[index].classList.add(classToAdd);\r\n            }\r\n        }\r\n    }\r\n    \r\n    if( ! DOMElement ) {\r\n        DOMElement = document.createElement(\"td\");\r\n\r\n        DOMElement.style.padding = jQuery('#wptb-table-padding-number').val() + 'px';\r\n\r\n        var innerBorderWidth = jQuery('#wptb-table-inner-border-number').val();\r\n\r\n        if (innerBorderWidth != '' && parseInt(innerBorderWidth) != 0) {\r\n            DOMElement.style.border = innerBorderWidth + 'px solid ' + jQuery('#wptb-table-border-color').val();\r\n        } else {\r\n            DOMElement.style.border = '1px dashed #969fa6';\r\n        }\r\n\r\n        DOMElement.classList.add('wptb-droppable', 'wptb-cell');\r\n    }\r\n\r\n    DOMElement.draggable = false;\r\n    if ( callback ) {\r\n        DOMElement.onclick = callback;\r\n    }\r\n\r\n    DOMElement.ondragenter = function (e) {\r\n        var div;\r\n        if (!e.dataTransfer.getData('wptbElement') && !e.dataTransfer.getData('node')) {\r\n            return;\r\n        }\r\n        this.classList.add('wptb-drop-here-empty');\r\n    };\r\n    \r\n    DOMElement.ondragover = function (e) {\r\n        e.preventDefault();\r\n    };\r\n    \r\n    DOMElement.ondragleave = function () {\r\n        this.classList.remove('wptb-drop-here-empty');\r\n    };\r\n\r\n    DOMElement.ondrop = function (e) {\r\n        var element, classId, space, t_space, spaceParent;\r\n        e.preventDefault();\r\n        space = new WPTB_Space();\r\n\r\n        if (!e.dataTransfer.getData('wptbElement') && !e.dataTransfer.getData('node')) {\r\n            return;\r\n        }\r\n\r\n        if (e.dataTransfer.getData('wptbElement')) {\r\n            element = newElementProxy(e.dataTransfer.getData('wptbElement'));\r\n            if (this.innerHTML == '') {\r\n                this.appendChild(new WPTB_Space());\r\n            }\r\n            this.appendChild(element.getDOMElement());\r\n            this.appendChild(space);\r\n        } else {\r\n            classId = e.dataTransfer.getData('node');\r\n            element = document.getElementsByClassName(classId)[0];\r\n            if (this.innerHTML == '') {\r\n                t_space = element.nextSibling;\r\n                spaceParent = element.parentNode;\r\n                if (t_space != undefined) {\r\n                    spaceParent.removeChild(t_space);\r\n                }\r\n                this.appendChild(new WPTB_Space());\r\n            }\r\n            this.appendChild(element);\r\n            this.appendChild(space);\r\n        }\r\n        this.classList.remove('wptb-drop-here-empty');\r\n        return true;\r\n    };\r\n    \r\n    let wptbPhElement = DOMElement.getElementsByClassName( 'wptb-ph-element' );\r\n                                            \r\n    if ( wptbPhElement.length > 0 ) {\r\n        for( let i = 0; i < wptbPhElement.length; i++ ) {\r\n\r\n            let wptbSpaceBetween = DOMElement.getElementsByClassName( 'wptb-space-between' );\r\n\r\n            if ( wptbSpaceBetween.length > 0 ) {\r\n                for( let j = 0; j < wptbSpaceBetween.length; j++ ) {\r\n                    WPTB_Space( wptbSpaceBetween[j] );\r\n                }\r\n            }\r\n\r\n            wptbPhElement[i].getDOMElement = function() {\r\n                return wptbPhElement[i];\r\n            }\r\n\r\n            let wptbElementTypeClass = wptbPhElement[i].className.match( /wptb-element-((.+-)\\d+)/i );\r\n            if( wptbElementTypeClass && Array.isArray( wptbElementTypeClass ) ) {\r\n                let wptbTypeElementArr = wptbElementTypeClass[1].split( '-' );\r\n                wptbPhElement[i].kind = wptbTypeElementArr[0];\r\n                applyGenericItemSettings( wptbPhElement[i], wptbElementTypeClass[1] );\r\n                if ( wptbPhElement[i].kind == 'list' ) {\r\n                    let wptbArticle = wptbPhElement[i].getElementsByTagName( 'article' );\r\n                    if( wptbArticle.length > 0 ) {\r\n                        for ( let i = 0; i < wptbArticle.length; i++ ) {\r\n                            WPTB_ListItem( undefined, wptbArticle[i] );\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    };\r\n\r\n    this.setCoords = function (y, x) {\r\n        var el = this.getDOMElement();\r\n        el.dataset.yIndex = y;\r\n        el.dataset.xIndex = x;\r\n    };\r\n\r\n    this.getCoords = function () {\r\n        var coords,\r\n            el = this.getDOMElement();\r\n        coords.x = el.dataset.xIndex;\r\n        coords.y = el.dataset.yIndex;\r\n        return coords;\r\n    };\r\n\r\n    this.appendElement = function (node) {\r\n        getDOMElement().appendChild(node);\r\n    };\r\n\r\n    return this;\r\n};","var ElementCounters = function () {\r\n\r\n\tvar priv = [];\r\n\tpriv['text'] = 0;\r\n\tpriv['image'] = 0;\r\n\tpriv['list'] = 0;\r\n\tpriv['button'] = 0;\r\n\r\n\tthis.increment = function (key) {\r\n\t\tif (!(key in priv)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tpriv[key]++;\r\n\t}\r\n\r\n\tthis.nextIndex = function (key) {\r\n\t\tif (!(key in priv)) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\treturn priv[key] + 1;\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};","var WPTB_ElementOptions = function ( element, index, kindIndexProt ) {\r\n\r\n    var node = element.getDOMElement(), elemIdClass;\r\n\r\n        prop = document.querySelector(\".wptb-\" + element.kind + \"-options-prototype\").cloneNode(true);\r\n        prop.classList.remove(\"wptb-\" + element.kind + \"-options-prototype\"); // remove prototype from the class\r\n    elemIdClass = 'wptb-options-' + element.kind + \"-\" + index;\r\n\r\n    var properties = prop.getElementsByClassName('wptb-element-property');\r\n\r\n    for (var i = 0; i < properties.length; i++) {\r\n        properties[i].dataset.element = elemIdClass;\r\n    }\r\n\r\n    prop.classList.add(elemIdClass);\r\n    document.getElementById(\"element-options-group\").appendChild(prop);\r\n    \r\n    if ( kindIndexProt ) {\r\n        if ( element.kind == 'button' ) {\r\n            let affectedEl = document.getElementsByClassName( 'wptb-element-' + kindIndexProt )[0],\r\n                wptbButtonWrapper,\r\n                wptbButton,\r\n                wptbSize;\r\n        \r\n            if ( affectedEl ) {\r\n                wptbSize = affectedEl.className.match(/wptb-size-([a-z]+)/i);\r\n            }\r\n            \r\n            if( wptbSize && Array.isArray( wptbSize ) ) {\r\n                var b = prop.getElementsByClassName('wptb-btn-size-btn');\r\n                \r\n                for ( var i = 0; i < b.length; i++ ) {\r\n                    b[i].classList.remove( 'selected' );\r\n                    \r\n                    if ( b[i].innerHTML == wptbSize[1] ) {\r\n                        b[i].classList.add( 'selected' );\r\n                    }\r\n                }\r\n            }\r\n            \r\n            if( affectedEl ) {\r\n                wptbButtonWrapper = affectedEl.getElementsByClassName( 'wptb-button-wrapper' );\r\n                \r\n                wptbButton = affectedEl.getElementsByClassName( 'wptb-button' )\r\n            }\r\n            \r\n            if ( wptbButtonWrapper ) {\r\n                let buttonAlignment = wptbButtonWrapper[0].style.justifyContent,\r\n                buttonAlignmentSelect = prop.querySelector( 'select[data-type=\"button-alignment\"]' ),\r\n                    selectOption = buttonAlignmentSelect.getElementsByTagName( 'option' ),\r\n                    selectOptionVal;\r\n                \r\n                if ( buttonAlignment == 'flex-start' ) {\r\n                    selectOptionVal = 'left';\r\n                } else if ( buttonAlignment == 'center' || ! buttonAlignment ) {\r\n                    selectOptionVal = 'center';\r\n                } else if ( buttonAlignment == 'flex-end' ) {\r\n                    selectOptionVal = 'right';\r\n                }\r\n                \r\n                for ( let i = 0; i < selectOption.length; i++ ) {\r\n                    if ( selectOption[i].value == selectOptionVal ) {\r\n                        selectOption[i].selected = true;\r\n                    }\r\n                }\r\n            }\r\n            \r\n            if( wptbButton ) {\r\n                let buttonTextColor = wptbButton[0].style.color,\r\n                    buttonColor = wptbButton[0].style.backgroundColor,\r\n                    buttonHref = wptbButton[0].getAttribute( 'href' ), \r\n                    buttonLinkTarget = wptbButton[0].getAttribute( 'target' ),\r\n                    buttonTextColorInput = prop.querySelector( 'input[data-type=\"button-text-color\"]' ),\r\n                    buttonBackgroundColorInput = prop.querySelector( 'input[data-type=\"button-color\"]' ),\r\n                    buttonHrefInput = prop.querySelector( 'input[data-type=\"button-link\"]' ),\r\n                    buttonLinkTargetInput = prop.querySelector( 'input[data-type=\"button-link-target\"]' ),\r\n                    buttonLinkTargetInputId = buttonLinkTargetInput.getAttribute( 'id' ),\r\n                    buttonLinkTargetInputLabel = buttonLinkTargetInput.parentNode.getElementsByTagName( 'label' )[0];\r\n                    \r\n                buttonLinkTargetInputId = buttonLinkTargetInputId + '-' + kindIndexProt.split( '-' )[1];\r\n\r\n                buttonLinkTargetInput.setAttribute( 'id', buttonLinkTargetInputId );\r\n                buttonLinkTargetInputLabel.setAttribute( 'for', buttonLinkTargetInputId );\r\n            \r\n                buttonTextColorInput.value = buttonTextColor;\r\n                \r\n                buttonBackgroundColorInput.value = buttonColor;\r\n                \r\n                buttonHrefInput.value = buttonHref;\r\n                \r\n                if( buttonLinkTarget && buttonLinkTarget == '_blank') {\r\n                    buttonLinkTargetInput.checked=true;\r\n                }\r\n            }\r\n        } else if ( element.kind == 'image' ) {\r\n            let affectedEl = document.getElementsByClassName( 'wptb-element-' + kindIndexProt );\r\n            if ( affectedEl.length > 0 ) {\r\n                let elementsA = affectedEl[0].getElementsByTagName( 'a' );\r\n                if ( elementsA.length > 0 ) {\r\n                    let a = elementsA[0];\r\n\r\n                    if ( a ) {\r\n                        a.onclick = function( e ) {\r\n                            e.preventDefault();\r\n                        }\r\n                        // set select according to the alignment of the image\r\n                        let aTextAlign = a.style.textAlign,\r\n                        imageAlignmentSelect = prop.querySelector( 'select[data-type=\"image-alignment\"]' ),\r\n                        selectOption = imageAlignmentSelect.getElementsByTagName( 'option' );\r\n\r\n                        for ( let i = 0; i < selectOption.length; i++ ) {\r\n                            if ( selectOption[i].value == aTextAlign ) {\r\n                                selectOption[i].selected = true;\r\n                            }\r\n                        }\r\n\r\n                        // set text link for input field of setting panel\r\n                        let imageLinkHref = a.getAttribute( 'href' ),\r\n                            inputImageLink = prop.querySelector( 'input[data-type=\"image-link\"]' );\r\n                        if ( imageLinkHref ) {\r\n                            inputImageLink.value = imageLinkHref;\r\n                        }\r\n\r\n                        // set checkbox for target of link \r\n                        let imageLinkTarget = a.getAttribute( 'target' ),\r\n                            imageLinkTargetInput = prop.querySelector( 'input[data-type=\"image-link-target\"]' ),\r\n                            imageLinkTargetInputId = imageLinkTargetInput.getAttribute( 'id' ),\r\n                            imageLinkTargetInputLabel = imageLinkTargetInput.parentNode.getElementsByTagName( 'label' )[0];\r\n\r\n                        imageLinkTargetInputId = imageLinkTargetInputId + '-' + kindIndexProt.split( '-' )[1];\r\n\r\n                        imageLinkTargetInput.setAttribute( 'id', imageLinkTargetInputId );\r\n                        imageLinkTargetInputLabel.setAttribute( 'for', imageLinkTargetInputId );\r\n\r\n                        if ( imageLinkTarget && imageLinkTarget == '_blank' ) {\r\n                            imageLinkTargetInput.checked = true;\r\n                        }\r\n\r\n                        let img = a.getElementsByTagName( 'img' );\r\n                        if ( img.length > 0 ) {\r\n                            // set value for input fields of image size\r\n                            let imgWidth = img[0].style.width;\r\n                            if ( imgWidth ) {\r\n                                let imageWidthInputRange = prop.querySelector( 'input[type=\"range\"][data-type=\"image-size\"]' ),\r\n                                    imageWidthInputNumber = prop.querySelector( 'input[type=\"number\"][data-type=\"image-size\"]' );\r\n\r\n                                imageWidthInputRange.value = parseInt( imgWidth );\r\n                                imageWidthInputNumber.value = parseInt( imgWidth );\r\n                            }\r\n\r\n                            // set value for input field of alternative text image\r\n                            let imgAlternativeText = img[0].getAttribute('alt'),\r\n                                imageAlternativeTextInput = prop.querySelector( 'input[type=\"text\"][data-type=\"alternative-text\"]' );\r\n\r\n                            imageAlternativeTextInput.value = imgAlternativeText;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        } else if ( element.kind == 'text' ) {\r\n            let affectedEl = document.getElementsByClassName( 'wptb-element-' + kindIndexProt );\r\n            if ( affectedEl.length > 0 ) {\r\n                let elementFontSize = affectedEl[0].style.fontSize,\r\n                    elementTextColor = affectedEl[0].style.color;\r\n                let textFontSizeInputRange = prop.querySelector( 'input[type=\"range\"][data-type=\"font-size\"]' ),\r\n                    textFontSizeInputNumber = prop.querySelector( 'input[type=\"number\"][data-type=\"font-size\"]' ),\r\n                    textColorInput = prop.querySelector( 'input[type=\"text\"][data-type=\"color\"]' );\r\n\r\n                textFontSizeInputRange.value = parseInt( elementFontSize );\r\n                textFontSizeInputNumber.value = parseInt( elementFontSize );\r\n                textColorInput.value = elementTextColor;\r\n            }\r\n        } else if ( element.kind == 'list' ) {\r\n            let affectedEl = document.getElementsByClassName( 'wptb-element-' + kindIndexProt );\r\n            if ( affectedEl.length > 0 ) {\r\n                let elementListStyleType = affectedEl[0].getElementsByClassName( 'wptb-bullet' );\r\n        \r\n                if ( elementListStyleType.length > 0 ) {\r\n                    elementListStyleType = elementListStyleType[0].style.listStyleType;\r\n                    \r\n                    if ( elementListStyleType && elementListStyleType != 'decimal' ) {\r\n                        let elementListClassSelect = prop.querySelector( 'select[data-type=\"list-class\"]' );\r\n                        if ( elementListClassSelect ) {\r\n                            elementListClassSelect.value = 'unordered';\r\n                            \r\n                            let listIconSelectLabel = elementListClassSelect.parentNode.nextSibling;\r\n                            for ( let i = 0; i < 10; i++ ) {\r\n                                if ( listIconSelectLabel.nodeType == '1' ) {\r\n                                    break;\r\n                                } else {\r\n                                    listIconSelectLabel = listIconSelectLabel.nextSibling;\r\n                                }\r\n                            }\r\n                            \r\n                            if ( listIconSelectLabel ) {\r\n                                let listIconSelectLabelId = listIconSelectLabel.getAttribute( 'id' );\r\n                                listIconSelectLabel.setAttribute( 'id', listIconSelectLabelId + '-' + kindIndexProt );\r\n                                listIconSelectLabel.style.display = 'flex';\r\n                            }\r\n                            \r\n                            let elementListStyleTypeSelect = prop.querySelector( 'select[data-type=\"list-style-type\"]' );\r\n                            if ( elementListStyleTypeSelect ) {\r\n                                elementListStyleTypeSelect.parentNode.style.display = 'flex';\r\n                                \r\n                                elementListStyleTypeSelect.value = elementListStyleType;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                \r\n                let elementListItemContent = affectedEl[0].getElementsByClassName( 'wptb-list-item-content' );\r\n                \r\n                if ( elementListItemContent.length > 0 ) {\r\n                    let listItemPTextAlignArr = [];\r\n                    for ( let i = 0; i < elementListItemContent.length; i++ ) {\r\n                        let p = elementListItemContent[i].querySelector( 'p' );\r\n                        if ( p ) {\r\n                            if ( p.style.textAlign ) {\r\n                                listItemPTextAlignArr.push( p.style.textAlign );\r\n                            } else {\r\n                                listItemPTextAlignArr.push( 'left' );\r\n                            }\r\n                        }\r\n                        \r\n                    }\r\n                    \r\n                    let listItemPTextAlignLeftCount = 0,\r\n                        listItemPTextAlignCenterCount = 0,\r\n                        listItemPTextAlignRightCount = 0;\r\n                    \r\n                    if ( listItemPTextAlignArr.length > 0 ) {\r\n                        for ( let i = 0; i < listItemPTextAlignArr.length; i++ ) {\r\n                            if ( listItemPTextAlignArr[i] ) {\r\n                                if ( listItemPTextAlignArr[i] == 'left' ) {\r\n                                    listItemPTextAlignLeftCount++;\r\n                                } else if ( listItemPTextAlignArr[i] == 'center' ) {\r\n                                    listItemPTextAlignCenterCount++;\r\n                                } else if ( listItemPTextAlignArr[i] == 'right' ) {\r\n                                    listItemPTextAlignRightCount++;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    \r\n                    let elementListAlignmentSelect = prop.querySelector( 'select[data-type=\"list-alignment\"]' ),\r\n                        maxListItemTAlLeftC = Math.max( listItemPTextAlignLeftCount, listItemPTextAlignCenterCount, listItemPTextAlignRightCount );\r\n                \r\n                    if ( listItemPTextAlignLeftCount == maxListItemTAlLeftC ) {\r\n                        elementListAlignmentSelect.value = 'left';\r\n                    } else if ( listItemPTextAlignCenterCount == maxListItemTAlLeftC ) {\r\n                        elementListAlignmentSelect.value = 'center';\r\n                    } else if ( listItemPTextAlignRightCount == maxListItemTAlLeftC ) {\r\n                        elementListAlignmentSelect.value = 'right';\r\n                    }\r\n                }\r\n            } \r\n        }\r\n    }\r\n\r\n    node.onclick = function () {\r\n        var infArr = this.className.match(/wptb-element-((.+-)\\d+)/i),\r\n            optionsClass = '.wptb-' + infArr[2] + 'options' +\r\n                '.wptb-options-' + infArr[1];\r\n\r\n        document.getElementById('add-elements').getElementsByTagName('a')[0].classList.remove('active');\r\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.add('active');\r\n\r\n        document.getElementsByClassName('wptb-elements-container')[0].style.display = 'none';\r\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'none';\r\n        document.getElementById(\"element-options-group\").style.display = 'block';\r\n\r\n        var children = document.getElementById(\"element-options-group\").childNodes;\r\n        for (var i = 0; i < children.length; i++) {\r\n            if (children[i].style)\r\n                children[i].style.display = 'none';\r\n        }\r\n\r\n        document.querySelector(optionsClass).style.display = 'block';\r\n\r\n        var listStyleType, listJustifyContent;\r\n\r\n        switch (element.kind) {\r\n\r\n            case 'text':\r\n                jQuery(prop).find('[data-type=color]').wpColorPicker({ defaultColor: node.style.color });\r\n                prop.querySelector('[type=number][data-type=font-size]').value\r\n                    = prop.querySelector('[type=range][data-type=font-size]').value\r\n                    = node.style.fontSize.substring(0, node.style.fontSize.length - 2);\r\n                break;\r\n            case 'list':\r\n                listJustifyContent = node.querySelector('article').style.justifyContent;\r\n                listStyleType = node.querySelector('article .wptb-list-item-style-dot li').style.listStyleType;\r\n                if ( prop.querySelector( '[type=ran][data-type=list-class]' ) ) {\r\n                    prop.querySelector('[type=ran][data-type=list-class]').selectedIndex = (listStyleType == 'decimal' ? 0 : 1);\r\n                }\r\n                if ( prop.querySelector('[type=ran][data-type=list-style-type]') ) {\r\n                    prop.querySelector('[type=ran][data-type=list-style-type]').selectedIndex = (listStyleType == 'circle' ? 0 : (listStyleType == 'square' ? 1 : 2));\r\n                }\r\n                if ( prop.querySelector('[type=ran][data-type=list-alignment]') ) {\r\n                    prop.querySelector('[type=ran][data-type=list-alignment]').selectedIndex = (listJustifyContent == 'flex-start' ? 0 : (listJustifyContent == 'center' ? 1 : 2));\r\n                }\r\n                break;\r\n            case 'image':\r\n                break;\r\n            case 'button':\r\n                jQuery(prop).find('[data-type=button-color]').wpColorPicker({ defaultColor: node.style.backgroundColor });\r\n                break;\r\n\r\n        }\r\n    };\r\n\r\n    if (element.kind == 'button') {\r\n        //We must add this special kind of property, since it is triggered with click event\r\n        var buttons = prop.getElementsByClassName('wptb-btn-size-btn');\r\n\r\n        for (var i = 0; i < buttons.length; i++) {\r\n            buttons[i].onclick = function () {\r\n                var size = this.innerHTML,\r\n                    n_Class = this.dataset.element,\r\n                    infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                    type = infArr[1],\r\n                    num = infArr[2],\r\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0];\r\n                affectedEl.classList.remove('wptb-size-S');\r\n                affectedEl.classList.remove('wptb-size-M');\r\n                affectedEl.classList.remove('wptb-size-L');\r\n                affectedEl.classList.remove('wptb-size-XL');\r\n                affectedEl.classList.add('wptb-size-' + size);\r\n                var b = this.parentNode.getElementsByClassName('wptb-btn-size-btn');\r\n                for (var i = 0; i < b.length; i++) {\r\n                    b[i].classList.remove('selected');\r\n                }\r\n                this.classList.add('selected');\r\n            }\r\n        }\r\n    }\r\n\r\n    var optionControls = prop.getElementsByClassName('wptb-element-property');\r\n\r\n    for (var i = 0; i < optionControls.length; i++) {\r\n        if (optionControls[i].classList.contains('wptb-color-picker')) {\r\n            jQuery(optionControls[i]).wpColorPicker({\r\n                change: function (event, ui) {\r\n                    var parent = event.target, classe, type, ps, number;\r\n                    classe = parent.dataset.element.match(/wptb-options-(.+)-(\\d+)/i);\r\n                    type = classe[1];\r\n                    number = classe[2];\r\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + number)[0];\r\n                    if (type == 'button') {\r\n                        if (parent.dataset.type == 'button-text-color') {\r\n                            affectedEl.getElementsByClassName('wptb-button')[0].style.color = ui.color.toString();\r\n                        } else {\r\n                            affectedEl.getElementsByClassName('wptb-button')[0].style.backgroundColor = ui.color.toString();\r\n                        }\r\n                    } else {\r\n                        affectedEl.style.color = ui.color.toString();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        if (optionControls[i].dataset.type === 'font-size') {\r\n            var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-text-font-size-slider')[0];\r\n            slider.oninput = function () {\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].value = this.value;\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].onchange();\r\n            }\r\n        }\r\n\r\n        if (optionControls[i].dataset.type === 'image-size') {\r\n            var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-image-size-slider')[0];\r\n            slider.oninput = function () {\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-image-width-number')[0].value = this.value;\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-image-width-number')[0].onchange();\r\n            }\r\n        }\r\n\r\n        optionControls[i].onchange = function (event) {\r\n\r\n            var n_Class = this.dataset.element,\r\n                infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                type = infArr[1],\r\n                num = infArr[2],\r\n                affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0],\r\n                val = this.value;\r\n\r\n            switch (this.dataset.type) {\r\n                case 'src':\r\n                    var img = affectedEl.getElementsByTagName(\"img\")[0];\r\n                    img.src = this.value;\r\n                    break;\r\n                case 'alternative-text':\r\n                    var img = affectedEl.getElementsByTagName('img')[0];\r\n                    img.alt = this.value;\r\n                    break;\r\n                case 'image-link':\r\n                    affectedEl.getElementsByTagName('a')[0].href = this.value;\r\n                    break;\r\n                case 'image-link-target':\r\n                    if (this.checked == true) {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_blank';\r\n                    } else {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_self';\r\n                    }\r\n                    break;\r\n                case 'image-size':\r\n                    affectedEl.getElementsByTagName('img')[0].style.width = this.value + '%';\r\n                    affectedEl.getElementsByTagName('img')[0].style.height = 'auto';\r\n                    this.parentNode.parentNode.getElementsByClassName('wptb-image-size-slider')[0].value = this.value;\r\n                    break;\r\n                case 'image-alignment':\r\n                    affectedEl.getElementsByTagName( 'img' )[0].parentNode.style.textAlign = this.value;\r\n                    break;\r\n                case 'font-size':\r\n                    affectedEl.style.fontSize = val + 'px';\r\n                    break;\r\n                case 'button-alignment':\r\n                    var jc = '';\r\n                    if (this.value == 'left') {\r\n                        jc = 'start';\r\n                    } else if (this.value == 'right') {\r\n                        jc = 'flex-end';\r\n                    } else {\r\n                        jc = 'center';\r\n                    }\r\n                    affectedEl.getElementsByClassName('wptb-button-wrapper')[0].style.justifyContent = jc;\r\n                    break;\r\n                case 'button-link':\r\n                    affectedEl.getElementsByTagName('a')[0].href = this.value;\r\n                    break;\r\n                case 'button-link-target':\r\n                    if (this.checked == true) {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_blank';\r\n                    } else {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_self';\r\n                    }\r\n                    break;\r\n                case 'button-color':\r\n                    break;\r\n                case 'list-alignment':\r\n                    let articles = affectedEl.querySelectorAll('article');\r\n                    for (var i = 0; i < articles.length; i++) {\r\n                        let p = articles[i].querySelector( 'p' );\r\n                        if ( p ) {\r\n                            p.style.textAlign = this.value;\r\n                        }\r\n                    }\r\n                    break;\r\n                case 'list-class':\r\n                    if (val == 'unordered') {\r\n                        event.target\r\n                            .parentNode\r\n                            .parentNode\r\n                            .querySelector('[data-type=list-style-type]')\r\n                            .parentNode\r\n                            .style\r\n                            .display = 'flex';\r\n                        document.querySelector('#wptb-list-icon-select-label').style.display = 'flex';\r\n                        var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                        for (var i = 0; i < bullets.length; i++) {\r\n                            bullets[i].style.listStyleType = 'disc';\r\n                        }\r\n                        document.querySelector('[data-type=list-style-type]').value = 'disc';\r\n                    } else {\r\n                        event.target\r\n                            .parentNode\r\n                            .parentNode\r\n                            .querySelector('[data-type=list-style-type]')\r\n                            .parentNode\r\n                            .style\r\n                            .display = 'none';\r\n                        document.querySelector('#wptb-list-icon-select-label').style.display = 'none';\r\n                        var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                        for (var i = 0; i < bullets.length; i++) {\r\n                            bullets[i].style.listStyleType = 'decimal';\r\n                        }\r\n                    }\r\n                    break;\r\n                case 'list-style-type':\r\n                    var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                    for (var i = 0; i < bullets.length; i++) {\r\n                        bullets[i].style.listStyleType = val.toLowerCase();\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n};","var WPTB_Image = function ( src, DOMElementProt ) {\r\n        let DOMElement,\r\n            kindIndexProt = undefined;\r\n        if ( DOMElementProt == undefined ) {\r\n            DOMElement = document.createElement('div');\r\n\t    let anchor = document.createElement('a'),\r\n\t    img = document.createElement('img');\r\n            anchor.style.display = 'inline-block';\r\n            anchor.appendChild(img);\r\n            DOMElement.appendChild(anchor);\r\n            \r\n            anchor.onclick = function( e ) {\r\n                e.preventDefault();\r\n            }\r\n            \r\n            file_frame = wp.media.frames.file_frame = wp.media({\r\n\t\ttitle: 'Select a image to upload',\r\n\t\tbutton: {\r\n\t\t\ttext: 'Use this image'\r\n\t\t},\r\n\t\tmultiple: false\r\n            });\r\n            // When an image is selected, run a callback.\r\n            file_frame.on('select', function () {\r\n                    attachment = file_frame.state().get('selection').first().toJSON();\r\n                    img.src = attachment.url;\r\n            });\r\n            // Finally, open the modal\r\n            if (src == undefined) {\r\n                    file_frame.open();\r\n            } else {\r\n                    img.src = src;\r\n            }\r\n        } else {\r\n            DOMElement = DOMElementProt.cloneNode( true );\r\n            \r\n            DOMElement.getElementsByTagName( 'a' )[0].onclick = function(e) {\r\n                e.preventDefault();\r\n            };\r\n            \r\n            let wptbElementMutch = DOMElementProt.className.match( /wptb-element-((.+-)\\d+)/i );\r\n            if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\r\n                kindIndexProt = wptbElementMutch[1];\r\n            };\r\n        }\r\n            \r\n        this.kind = 'image';\r\n        this.getDOMElement = function () {\r\n            return DOMElement;\r\n        };\r\n\tapplyGenericItemSettings( this, kindIndexProt );\r\n\r\n\treturn this;\r\n};","var WPTB_Initializer = function () {\r\n\r\n    const MIN_COLUMNS = 1,\r\n        MIN_ROWS = 1,\r\n        MAX_COLUMNS = 10,\r\n        MAX_ROWS = 10;\r\n\r\n    var tableGenerator = document.body;\r\n    columnsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[0],\r\n            columnsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[0],\r\n            rowsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[1],\r\n            rowsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[1],\r\n            columnsInput = document.getElementById('wptb-columns-number'),\r\n            rowsInput = document.getElementById('wptb-rows-number');\r\n\r\n    columnsDecrementButton.onclick = function () {\r\n            if (columnsInput.value > MIN_COLUMNS) {\r\n                    columnsInput.value--;\r\n            }\r\n    };\r\n\r\n    columnsIncrementButton.onclick = function () {\r\n            if (columnsInput.value < MAX_COLUMNS) {\r\n                    columnsInput.value++;\r\n            }\r\n    };\r\n\r\n    rowsDecrementButton.onclick = function () {\r\n            if (rowsInput.value > MIN_ROWS) {\r\n                    rowsInput.value--;\r\n            }\r\n    };\r\n\r\n    rowsIncrementButton.onclick = function () {\r\n            if (rowsInput.value < MAX_ROWS) {\r\n                    rowsInput.value++;\r\n            }\r\n    };\r\n\r\n    document.getElementById('wptb-generate-table').onclick = function () {\r\n            var columns = document.getElementById('wptb-columns-number').value,\r\n                rows = document.getElementById('wptb-rows-number').value;\r\n\r\n            WPTB_Table(columns, rows);\r\n    }\r\n\r\n};\r\n","var WPTB_LeftPanel = function () {\r\n\r\n    var table = document.getElementsByClassName('wptb-preview-table')[0],\r\n        wptbElementButtons = document.getElementsByClassName('wptb-element');\r\n\r\n    function hexToRgb(hex) {\r\n        var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n        return result ? 'rgb(' + parseInt(result[1], 16) + ',' + parseInt(result[2], 16) + ',' + parseInt(result[3], 16) + ')' : null;\r\n    }\r\n\r\n    jQuery('#wptb-even-row-bg').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableRows = table.getElementsByTagName('tr');\r\n            for (var i = 1; i < tableRows.length; i += 2) {\r\n                tds = tableRows[i].getElementsByTagName('td');\r\n                for (var j = 0; j < tds.length; j++) {\r\n                    tds[j].style.backgroundColor = ui.color.toString();\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    jQuery('#wptb-odd-row-bg').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableRows = table.getElementsByTagName('tr');\r\n            for (var i = 2; i < tableRows.length; i += 2) {\r\n                tds = tableRows[i].getElementsByTagName('td');\r\n                for (var j = 0; j < tds.length; j++) {\r\n                    tds[j].style.backgroundColor = ui.color.toString();\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    jQuery('#wptb-table-header-bg').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableHeader = table.getElementsByTagName('tr')[0],\r\n                tds = tableHeader.getElementsByTagName('td');\r\n            for (var j = 0; j < tds.length; j++) {\r\n                tds[j].style.backgroundColor = ui.color.toString();\r\n            }\r\n        }\r\n    });\r\n\r\n    jQuery('#wptb-table-border-color').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableCells = table.getElementsByTagName('td');\r\n            table.style.border = document.querySelector('#wptb-table-border-number').value + 'px solid ' + ui.color.toString();\r\n\r\n            for (var i = 0; i < tableCells.length; i++) {\r\n                tableCells[i].style.border = document.querySelector('#wptb-table-inner-border-number').value + 'px solid ' + ui.color.toString();\r\n            }\r\n        }\r\n    });\r\n\r\n    function addInnerBorderSize(value) {\r\n        var tableCells = table.getElementsByTagName('td');\r\n        for (var i = 0; i < tableCells.length; i++) {\r\n            tableCells[i].style.border = document.querySelector('#wptb-table-inner-border-number').value + 'px solid ' + hexToRgb(jQuery('#wptb-table-border-color').val());\r\n        }\r\n    }\r\n\r\n    function addCellPadding(value) {\r\n        var tableCells = table.getElementsByTagName('td');\r\n        for (var i = 0; i < tableCells.length; i++) {\r\n            tableCells[i].style.padding = value + 'px';\r\n        }\r\n    }\r\n\r\n    function addInnerBorder(checked) {\r\n        var styles, color = document.querySelector('#wptb-table-border-color').value != undefined ?\r\n            document.querySelector('#wptb-table-border-color').value : 'rgb(0,0,0)';\r\n\r\n        if (checked == 'checked') {\r\n            document.getElementById('wptb-apply-inner-border').style.marginBottom = '0px';\r\n            var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n            for (var i = 0; i < tableCells.length; i++) {\r\n                tableCells[i].style.border = '1px solid ' + color;\r\n            }\r\n            document.getElementById('wptb-inner-border-settings').classList.add('visible');\r\n        } else {\r\n            document.getElementById('wptb-inner-border-settings').classList.remove('visible');\r\n            var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n            for (var i = 0; i < tableCells.length; i++) {\r\n                tableCells[i].style.border = '0px solid ' + color;\r\n            }\r\n        }\r\n    }\r\n\r\n    function addBorderSize(value) {\r\n        table.style.border = value + 'px solid';\r\n    }\r\n\r\n    document.getElementById('wptb-table-cell-slider').oninput = function () {\r\n        document.getElementById('wptb-table-cell-number').value = this.value;\r\n        addCellPadding(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-cell-number').onchange = function () {\r\n        document.getElementById('wptb-table-cell-slider').value = this.value;\r\n        addCellPadding(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-border-slider').oninput = function () {\r\n        document.getElementById('wptb-table-border-number').value = this.value;\r\n        addBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-border-number').onchange = function () {\r\n        document.getElementById('wptb-table-border-slider').value = this.value;\r\n        addBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-inner-border-slider').oninput = function () {\r\n        document.getElementById('wptb-table-inner-border-number').value = this.value;\r\n        addInnerBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-inner-border-number').onchange = function () {\r\n        document.getElementById('wptb-table-inner-border-slider').value = this.value;\r\n        addInnerBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-inner-border-check').onchange = function () {\r\n        var _val = this.checked ? 'checked' : 'unchecked';\r\n        addInnerBorder(_val);\r\n    };\r\n\r\n    for (var i = 0; i < wptbElementButtons.length; i++) {\r\n        wptbElementButtons[i].ondragstart = function (e) {\r\n            e.dataTransfer.setData('wptbElement', this.dataset.wptbElement);\r\n        }\r\n    }\r\n\r\n    document.getElementById('wptb-activate-cell-management-mode').onclick = table.toggleTableEditMode;\r\n    document.getElementById('wptb-add-end-row').onclick = table.addRowToTheEnd;\r\n    document.getElementById('wptb-add-start-row').onclick = table.addRowToTheStart;\r\n    document.getElementById('wptb-add-row-before').onclick = table.addRowBefore;\r\n    document.getElementById('wptb-add-row-after').onclick = table.addRowAfter;\r\n    document.getElementById('wptb-add-end-column').onclick = table.addColumnEnd;\r\n    document.getElementById('wptb-add-start-column').onclick = table.addColumnStart;\r\n    document.getElementById('wptb-add-column-before').onclick = table.addColumnBefore;\r\n    document.getElementById('wptb-add-column-after').onclick = table.addColumnAfter;\r\n    document.getElementById('wptb-delete-column').onclick = table.deleteColumn;\r\n    document.getElementById('wptb-delete-row').onclick = table.deleteRow;\r\n    document.getElementById('wptb-merge-cells').onclick = table.mergeCells;\r\n    document.getElementById('wptb-split-cell').onclick = table.splitCell;\r\n    document.getElementById('add-elements').onclick = function () {\r\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.remove('active');\r\n        document.getElementById('add-elements').getElementsByTagName('a')[0].classList.add('active');\r\n        document.getElementsByClassName('wptb-elements-container')[0].style.display = 'table';\r\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'block';\r\n        document.getElementById(\"element-options-group\").style.display = 'none';\r\n    };\r\n\r\n};","var WPTB_List = function ( innerElements, DOMElementProt ) {\r\n\r\n    var el_L = document.createElement('ul'), item,\r\n        DOMElement = document.createElement('div'),\r\n        kindIndexProt = undefined;\r\n\r\n    this.kind = 'list';\r\n\r\n    if (innerElements === '') {\r\n        //Case for edit mode list\r\n    } else if ( !innerElements ) {\r\n        for (var i = 0; i < 3; i++) {\r\n            item = new WPTB_ListItem( 'List Item ' + (i + 1) );\r\n            el_L.appendChild(item.getDOMElement());\r\n        }\r\n    } else {\r\n        let wptbElementMutch = DOMElementProt.className.match( /wptb-element-((.+-)\\d+)/i );\r\n            if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\r\n                kindIndexProt = wptbElementMutch[1];\r\n            };\r\n        \r\n        for ( var i = 0; i < innerElements.length; i++ ) {\r\n            item = new WPTB_ListItem( innerElements[i], DOMElementProt, true );\r\n            el_L.appendChild(item.getDOMElement());\r\n        }\r\n    }\r\n    DOMElement.appendChild(el_L);\r\n    //window.addElementOptions('list', elList);\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    }\r\n    applyGenericItemSettings( this, kindIndexProt );\r\n\r\n    return this;\r\n\r\n};","var WPTB_ListItem = function ( text, DOMElementProt, copy ) {\r\n    let wptbListItemReturn;\r\n    if ( DOMElementProt == undefined || ( DOMElementProt && copy )) {\r\n        if (text == undefined) text = 'New List Item';\r\n        var DOMElement = document.createElement('article'),\r\n            divdot = document.createElement('div'),\r\n            divcontent = document.createElement('div'),\r\n            libullet = document.createElement('li');\r\n        divdot.classList.add('wptb-list-item-style-dot');\r\n        divcontent.classList.add('wptb-list-item-content');\r\n        libullet.classList.add('wptb-bullet');\r\n        if ( DOMElementProt ) {\r\n            let styleDot = DOMElementProt.querySelector( '.wptb-bullet' ).getAttribute( 'style' )\r\n            libullet.setAttribute( 'style', styleDot );\r\n        }\r\n        DOMElement.appendChild(divdot);\r\n        DOMElement.appendChild(divcontent);\r\n        divdot.appendChild(libullet);\r\n        divcontent.innerHTML = text;\r\n        divcontent.onkeyup = window.listItemKeyListener;\r\n        \r\n        wptbListItemReturn = true;\r\n    } else {\r\n        var DOMElement = DOMElementProt;\r\n        var divdot = DOMElement.getElementsByClassName( 'wptb-list-item-style-dot' )[0], \r\n            divcontent = DOMElement.getElementsByClassName( 'wptb-list-item-content' )[0], \r\n            libullet = divdot.getElementsByClassName( 'wptb-bullet' )[0];\r\n    \r\n        divcontent.onkeyup = window.listItemKeyListener;\r\n        \r\n        wptbListItemReturn = false;\r\n    }\r\n    \r\n    DOMElement.onmouseenter = function (event) {\r\n\r\n        var btnDelete = document.createElement('span'),\r\n            btnCopy = document.createElement('span'),\r\n            actions = document.createElement('span'),\r\n            previous,\r\n            i;\r\n        actions.classList.add('wptb-actions');\r\n        btnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\r\n        btnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\r\n        this.classList.add('wptb-directlyhovered');\r\n\r\n        btnDelete.onclick = function () {\r\n            var item = this.parentNode.parentNode,\r\n                parent = item.parentNode;\r\n            parent.removeChild(item);\r\n        };\r\n\r\n        btnCopy.onclick = function (event) {\r\n            var article = event.target.parentNode.parentNode,\r\n                content = article.querySelector('.wptb-list-item-content'),\r\n                html = content.innerHTML;\r\n            var duplicate = new WPTB_ListItem( html, article, true );\r\n            article.parentNode.insertBefore( duplicate.getDOMElement(), DOMElement );\r\n        };\r\n\r\n        actions.append(btnCopy, btnDelete);\r\n        this.appendChild(actions);\r\n    };\r\n\r\n    DOMElement.onmouseleave = function (event) {\r\n        this.classList.remove('wptb-directlyhovered');\r\n        var actions = this.parentNode.querySelector('.wptb-actions');\r\n        if (actions != undefined) {\r\n            var parent = actions.parentNode;\r\n            parent.removeChild(actions);\r\n        }\r\n    };\r\n\r\n    divcontent.onkeydown = function (event) {\r\n        var key = event.which != undefined ? event.which : event.keyCode,\r\n            article = event.target.parentNode,\r\n            duplicate,\r\n            lastP;\r\n        if (key !== 13 || window.dontAddItems !== undefined && window.dontAddItems === true) {\r\n            return;\r\n        }\r\n        event.preventDefault();\r\n        duplicate = new WPTB_ListItem( this.innerHTML, article, true );\r\n        DOMElement.parentNode.insertBefore(duplicate.getDOMElement(), DOMElement);\r\n        setTimeout( function(){\r\n            divcontent.innerHTML = 'New List Item';\r\n        }, 5 );\r\n\r\n        return false;\r\n    };\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    };\r\n    \r\n    if ( wptbListItemReturn ) {\r\n        return this;\r\n    }\r\n};","var MultipleSelect = function () {\r\n\r\n\tvar selectedCells = [],\r\n\t\tmultipleCellMode = false;\r\n\r\n\tthis.activateMultipleSelectMode = function () {\r\n\t\tselectedCells = [];\r\n\t\tvar tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\ttds[i].classList.remove('wptb-highlighted');\r\n\t\t}\r\n\t\tmultipleCellMode = true;\r\n\t}\r\n\r\n\tthis.deactivateMultipleSelectMode = function () {\r\n\t\tmultipleCellMode = false;\r\n\t}\r\n\r\n\tthis.isActivated = function () {\r\n\t\treturn multipleCellMode;\r\n\t}\r\n\r\n\tthis.pushSelectedCell = function (cell) {\r\n\t\tif (!multipleCellMode) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tselectedCells.push(cell);\r\n\t\tcell.classList.add('wptb-highlighted');\r\n\t};\r\n\r\n\tthis.selectedCells = function () {\r\n\t\treturn selectedCells;\r\n\t}\r\n\r\n\tthis.flushSelectedCells = function () {\r\n\t\tselectedCells = [];\r\n\t}\r\n\r\n\tthis.getFirst = function () {\r\n\t\tvar minXIndex = 1000, minYIndex = 1000, first;\r\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\r\n\t\t\tif (minXIndex >= selectedCells[i].dataset.xIndex\r\n\t\t\t\t&& minYIndex >= selectedCells[i].dataset.yIndex) {\r\n\t\t\t\tfirst = selectedCells[i];\r\n\t\t\t\tminXIndex = selectedCells[i].dataset.xIndex;\r\n\t\t\t\tminYIndex = selectedCells[i].dataset.yIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn first;\r\n\t}\r\n\r\n\tthis.getLast = function () {\r\n\t\tvar maxXIndex = -1, maxYIndex = -1, last;\r\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\r\n\t\t\tif (maxXIndex <= selectedCells[i].dataset.xIndex\r\n\t\t\t\t&& maxYIndex <= selectedCells[i].dataset.yIndex) {\r\n\t\t\t\tlast = selectedCells[i];\r\n\t\t\t\tmaxXIndex = selectedCells[i].dataset.xIndex;\r\n\t\t\t\tmaxYIndex = selectedCells[i].dataset.yIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn last;\r\n\t}\r\n\r\n\tthis.removeAllButFirst = function () {\r\n\t\tvar td = this.getFirst();\r\n\t\tfor (var i = 1; i < selectedCells.length; i++) {\r\n\t\t\tselectedCells[i].classList.add('wptb-fused-cell-' + td.dataset.xIndex + '-' + td.dataset.yIndex);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};","var WPTB_Parser = function (code) {\r\n    if( Array.isArray( code ) ) {\r\n        let elementHtml;\r\n        \r\n        if ( code.length == 1) {\r\n            return elementHtml.appendChild( document.createTextNode( code[0] ) );\r\n        }\r\n        if( 0 in code ) {\r\n            let tagName = code[0];\r\n            elementHtml =  document.createElement( tagName );\r\n            \r\n            if ( 1 in code ) {\r\n                if( Array.isArray( code[1] ) ) {\r\n                    let attributes = code[1];\r\n                    \r\n                    for( let i = 0; i < attributes.length; i++ ) {\r\n                        if( Array.isArray( attributes[i] ) ) {\r\n                            elementHtml.setAttribute(attributes[i][0], attributes[i][1]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            if ( 2 in code ) {\r\n                if ( Array.isArray( code[2] ) ) {\r\n                    for ( let i = 0; i < code[2].length; i++ ) {\r\n                        if ( typeof code[2][i] === 'string' && tagName.toLowerCase() == 'p' ) {\r\n                            elementHtml.appendChild( document.createTextNode( code[2][i] ) );\r\n                            continue;\r\n                        }\r\n                        if ( ! WPTB_Parser( code[2][i] ) ) continue;\r\n                        elementHtml.appendChild( WPTB_Parser( code[2][i] ) );\r\n                    }\r\n                } else if( typeof code[2] === 'string' ) {\r\n                    elementHtml.appendChild( document.createTextNode( code[2] ) );\r\n                }\r\n                \r\n            }\r\n        }\r\n        \r\n        return elementHtml;\r\n    } else {\r\n        return false;\r\n    }\r\n    \r\n}","var WPTB_Settings = function () {\r\n\r\n\tvar elems = document.getElementsByClassName('wptb-element');\r\n\r\n\tfunction detectMode() {\r\n\t\tvar url = window.location.href,\r\n\t\t    regex = new RegExp('[?&]table(=([^&#]*)|&|#|$)'),\r\n\t\t    results = regex.exec(url);\r\n\t\tif (!results) return false;\r\n\t\tif (!results[2]) return '';\r\n\t\treturn decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n\t}\r\n\r\n\tfor (var i = 0; i < elems.length; i++) {\r\n\t\telems[i].ondragstart = function (event) {\r\n\t\t\tevent.dataTransfer.effectAllowed = 'move';\r\n\t\t\tevent.dataTransfer.setData('wptbElement', event.target.dataset.wptbElement);\r\n\t\t}\r\n\t};\r\n\r\n\tdocument.getElementsByClassName('wptb-save-btn')[0].onclick = function () {\r\n\t\tlet http = new XMLHttpRequest(),\r\n\t\t    url = ajaxurl + \"?action=save_table\",\r\n\t\t    t = document.getElementById('wptb-setup-name').value.trim(),\r\n\t\t    messagingArea,\r\n                    code = WPTB_Stringifier(document.getElementsByClassName('wptb-preview-table')[0], true);\r\n                    \r\n\t\tif (t === '') {\r\n\t\t\tmessagingArea = document.getElementById('wptb-messaging-area');\r\n\t\t\tmessagingArea.innerHTML = '<div class=\"wptb-error wptb-message\">Error: You must assign a name to the table before saving it.</div>';\r\n\t\t\tmessagingArea.classList.add('wptb-warning');\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tmessagingArea.removeChild(messagingArea.firstChild);\r\n\t\t\t}, 4000);\r\n\t\t\treturn;\r\n\t\t}\r\n                code = JSON.stringify( code );\r\n\t\tvar params = 'title=' + t + '&content=' + code;\r\n\r\n\t\tif ((rs = detectMode()) || (rs = document.wptbId)) {\r\n\t\t\tparams += '&id=' + rs;\r\n\t\t}\r\n\r\n\t\thttp.open('POST', url, true);\r\n\t\thttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n\t\thttp.onreadystatechange = function (action) {\r\n\t\t\tif (this.readyState == 4 && this.status == 200) {\r\n\r\n\t\t\t\tvar data = JSON.parse(http.responseText);\r\n\t\t\t\tmessagingArea = document.getElementById('wptb-messaging-area');\r\n\r\n\t\t\t\tif (data[0] == 'saved') {\r\n\t\t\t\t\tdocument.wptbId = data[1];\r\n\t\t\t\t\tmessagingArea.innerHTML = '<div class=\"wptb-success wptb-message\">Table \"' + t + '\" was successfully saved.</div>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmessagingArea.innerHTML = '<div class=\"wptb-success wptb-message\">Table \"' + t + '\" was successfully updated.</div>';\r\n\t\t\t\t}\r\n\t\t\t\tmessagingArea.classList.add('wptb-success');\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tmessagingArea.removeChild(messagingArea.firstChild);\r\n\t\t\t\t}, 4000);\r\n\t\t\t}\r\n\t\t}\r\n\t\thttp.send(params);\r\n\t}\r\n};\r\n","var WPTB_Space = function ( elSpaceBetween ) {\r\n\r\n    function newElementProxy(el) {\r\n        if (el.includes('list')) {\r\n            return new WPTB_List();\r\n        } else if (el.includes('image')) {\r\n            return new WPTB_Image();\r\n        } else if (el.includes('text')) {\r\n            return new WPTB_Text();\r\n        } else if (el.includes('button')) {\r\n            return new WPTB_Button();\r\n        }\r\n    }\r\n    let spaceBetween;\r\n    if ( ! elSpaceBetween ) {\r\n        spaceBetween = document.createElement('div'), spaceBetween.classList.add('wptb-space-between');\r\n    } else {\r\n        spaceBetween = elSpaceBetween;\r\n    }\r\n\r\n    spaceBetween.ondragenter = function () {\r\n        this.classList.add('visible');\r\n    };\r\n    spaceBetween.ondragover = function (event) {\r\n        event.preventDefault();\r\n    };\r\n\r\n    spaceBetween.ondragleave = function () {\r\n        this.classList.remove('visible');\r\n    };\r\n\r\n    spaceBetween.ondrop = function (event) {\r\n        event.stopPropagation();\r\n\r\n        var p = event.target.nextSibling,\r\n            td = event.target,\r\n            element, t_space, spaceParent;\r\n\r\n        while (!td.classList.contains('wptb-droppable')) {\r\n            td = td.parentNode;\r\n        }\r\n\r\n        if (event.dataTransfer.getData('wptbElement')) {\r\n            element = newElementProxy(event.dataTransfer.getData('wptbElement'));\r\n            this.classList.remove('visible');\r\n\r\n            if (p == null) {\r\n                td.appendChild(element.getDOMElement());\r\n                td.appendChild(new WPTB_Space());\r\n            } else {\r\n                td.insertBefore(element.getDOMElement(), p);\r\n                td.insertBefore(new WPTB_Space(), p);\r\n            }\r\n\r\n        } else {\r\n            alert(event.dataTransfer.getData('node'));\r\n            element = document.getElementsByClassName(event.dataTransfer.getData('node'))[0];\r\n            t_space = element.nextSibling;\r\n            spaceParent = element.parentNode;\r\n            if (t_space != undefined) {\r\n                spaceParent.removeChild(t_space);\r\n            }\r\n\r\n            if (p == null) {\r\n                td.appendChild(element);\r\n                td.appendChild(new WPTB_Space());\r\n            } else {\r\n                td.insertBefore(element, p);\r\n                td.insertBefore(new WPTB_Space(), p);\r\n            }\r\n\r\n        }\r\n        this.classList.remove('visible');\r\n    };\r\n    \r\n    if ( ! elSpaceBetween ) {\r\n        return spaceBetween;\r\n    }\r\n};","var WPTB_Stringifier = function ( node, start = false ) {\r\n\r\n\tif ( node == undefined ) {\r\n\t\treturn '';\r\n\t} else if ( node.tagName == undefined && node.nodeType == 3 ) {\r\n            return node.nodeValue;\r\n        }\r\n        \r\n        let code = [],\r\n            children,\r\n            int_elem_arr = false,\r\n            attributes = [...node.attributes],\r\n            attributes_list = [],\r\n            internal_elements = [];\r\n            if ( ( node.parentNode.classList.contains( 'wptb-list-item-content' ) || \r\n                node.parentNode.classList.contains( 'mce-content-body' ) ) && \r\n            node.tagName.toLowerCase() == 'p' ) {\r\n                children = node.childNodes;\r\n                int_elem_arr = true;\r\n            } else if( node.children.length > 0 ) {\r\n                children = node.children;\r\n            } else {\r\n                children = node.childNodes;\r\n            }\r\n        if ( attributes.length > 0 ) {\r\n            for ( let i = 0; i < attributes.length; i++ ) {\r\n                attributes_list[i] = [attributes[i].name, attributes[i].value];\r\n            }\r\n        } else {\r\n            attributes_list = '';\r\n        }\r\n        \r\n        if ( children.length > 0 ) {\r\n            for ( let i = 0; i < children.length; i++) {\r\n                let inter_elem = WPTB_Stringifier(children[i]);\r\n                    \r\n                if ( Array.isArray( inter_elem ) || int_elem_arr ) {\r\n                    internal_elements[i] = inter_elem;\r\n                } else if ( typeof inter_elem === 'string' && inter_elem ) {\r\n                    internal_elements = inter_elem;\r\n                }\r\n            }\r\n        } else {\r\n            internal_elements = '';\r\n        }\r\n        \r\n        \r\n        code.push(node.tagName.toLowerCase(), attributes_list , internal_elements);\r\n        \r\n        return code;\r\n}","var array = [], WPTB_Table = function (columns, rows) {\r\n\r\n\t/* The members of the class */\r\n\tvar settings = document.getElementsByClassName('wptb-settings-items'),\r\n\t    wptbTableSetup = document.getElementsByClassName(\"wptb-table-setup\")[0],\r\n            table, row, cell,\r\n\t    maxAmountOfCells,\r\n\t    maxAmountOfRows;\r\n\r\n\t//HERE ARE THE PRIVATE FUNCTIONS\r\n\t/*\r\n  * This function toggles buttons visibility in cell edit mode\r\n  * (according to the amount of currently selected cells), and\r\n  * highlights visually the clicked cell if it is not highlighted, or\r\n  * removes highlight if clicked cell is already highlighted. \r\n  * It too toggles the bits of our abstract representation.\r\n  * @param Event this is the event instance of the click performed over a cell.\r\n  */\r\n\tvar mark = function (event) {\r\n\t\tvar rs = this.rowSpan,\r\n\t\t    cs = this.colSpan,\r\n\t\t    markedCells,\r\n\t\t    noCells = document.getElementsByClassName('no-cell-action'),\r\n\t\t    singleCells = document.getElementsByClassName('single-action'),\r\n\t\t    multipleCells = document.getElementsByClassName('multiple-select-action'),\r\n\t\t    position = getCoords(this),\r\n\t\t    row = position[0],\r\n\t\t    column = position[1];\r\n\t\tif (!document.select.isActivated()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.className.match(/wptb-highlighted/)) {\r\n\t\t\tthis.classList.remove('wptb-highlighted');\r\n\t\t\tfor (var i = 0; i < rs; i++) {\r\n\t\t\t\tfor (var j = 0; j < cs; j++) {\r\n\t\t\t\t\tarray[row + i][column + j] = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.classList.add('wptb-highlighted');\r\n\t\t\tfor (var i = 0; i < rs; i++) {\r\n\t\t\t\tfor (var j = 0; j < cs; j++) {\r\n\t\t\t\t\tarray[row + i][column + j] = 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tmarkedCells = document.getElementsByClassName('wptb-highlighted').length;\r\n\t\tif (markedCells === 0) {\r\n\t\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\t\tnoCells[i].classList.add('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\t\tsingleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t} else if (markedCells === 1) {\r\n\t\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\t\tnoCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\t\tsingleCells[i].classList.add('visible');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\t\tif (table.isSquare(array)) {\r\n\t\t\t\t\tmultipleCells[i].classList.add('visible');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\t\tnoCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\t\tsingleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t/* \r\n  * This function fills an array with 1's according to the actual design\r\n  * of HTML table.\r\n  * @returns an array of arrays containing an abstract representation\r\n  * of HTML table.\r\n  * @deprecated\r\n  * */\r\n\r\n\tvar realTimeArray = function () {\r\n\t\tvar carried = [], tds, cols, matriz = [];\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarried[i] = 0;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tcols = [];\r\n\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td');\r\n\r\n\t\t\tfor (items = 0; items < tds.length; items++) {\r\n\r\n\t\t\t\tfor (var k = 0; k < tds[items].colSpan; k++) {\r\n\t\t\t\t\tcols.push(1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (tds[items].rowSpan > 1) {\r\n\t\t\t\t\tfor (var k = 0; k < tds[items].colSpan; k++) {\r\n\t\t\t\t\t\tcarried[items + k] = {\r\n\t\t\t\t\t\t\tjustAssigned: true,\r\n\t\t\t\t\t\t\tamount: tds[items].rowSpan\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var k = 0; k < maxAmountOfCells; k++) {\r\n\t\t\t\tif ( typeof carried[k] == 'object' && carried[k].amount > 0 ) {\r\n\t\t\t\t\tcarried[k].amount--;\r\n\t\t\t\t\tif (carried[k].justAssigned) {\r\n\t\t\t\t\t\tcarried[k].justAssigned = false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcols.push(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tmatriz.push(cols);\r\n\r\n\t\t}\r\n\t\treturn matriz;\r\n\t};\r\n\r\n\t/*\r\n  * This function gets the number and position of cell spaces in current row that are occuped \r\n  * by upper rowspanned cells.\r\n  * @param number the number of row where we wish to calculate the carried rowspans up to.\r\n  * @return an array with the remaining rowspans in each column.\r\n  */\r\n\tvar carriedRowspans = function (row) {\r\n\t\tvar carried = [], tds, cols;\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarried[i] = 0;\r\n\t\t}\r\n\r\n\t\tif (row == -1) {\r\n\t\t\treturn carried;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i <= row; i++) {\r\n\t\t\tcellsBuffer = table.rows[i].getElementsByTagName('td');\r\n\t\t\tcellPointer = 0;\r\n\r\n\t\t\tfor (var xPosition = 0; xPosition < maxAmountOfCells; xPosition += stepsToMove) {\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (carried[xPosition]) {\r\n\t\t\t\t\tcarried[xPosition]--;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcelda = cellsBuffer[cellPointer++];\r\n\t\t\t\t\tif (celda.rowSpan > 1) {\r\n\t\t\t\t\t\tfor (k = 0; k < celda.colSpan; k++) {\r\n\t\t\t\t\t\t\tcarried[xPosition + k] = celda.rowSpan - 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstepsToMove = celda.colSpan;\r\n\t\t\t\t\t} else if (celda.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = celda.colSpan;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\treturn carried;\r\n\t};\r\n\r\n\t/*\r\n  * A helpful function for showing\r\n  * the abstract table in console.\r\n  * @param Array our abstract table.\r\n  */\r\n\tvar drawTable = function (a) {\r\n\t\tvar string = 'DRAWING TABLE:\\n';\r\n\t\tfor (var i = 0; i < a.length; i++) {\r\n\r\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\r\n\t\t\t\tstring += ' ' + a[i][j];\r\n\t\t\t}\r\n\t\t\tstring += '\\n';\r\n\t\t}\r\n\t\ttable.isSquare(a);\r\n\t};\r\n\r\n\t/*\r\n  * It resets all the bits of our abstract representation\r\n  * to 0 and removes the highlighting class of all cells.\r\n  */\r\n\r\n\tvar undoSelect = function () {\r\n\t\tvar noCells = document.getElementsByClassName('no-cell-action'),\r\n\t\t    singleCells = document.getElementsByClassName('single-action'),\r\n\t\t    multipleCells = document.getElementsByClassName('multiple-select-action'),\r\n\t\t    tds = table.getElementsByClassName('wptb-highlighted');\r\n\t\twhile (tds.length) {\r\n\t\t\ttds[0].classList.remove('wptb-highlighted');\r\n\t\t}\r\n\t\tfor (var i = 0; i < array.length; i++) {\r\n\t\t\tfor (var j = 0; j < array[i].length; j++) {\r\n\t\t\t\tarray[i][j] = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t}\r\n\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\tnoCells[i].classList.add('visible');\r\n\t\t}\r\n\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\tsingleCells[i].classList.remove('visible');\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n  * This fills the abstract representation of our table with \r\n  * zeros, at the start. the max amount of cells is the greatest sum\r\n  * of all colspans for row.\r\n  */\r\n\r\n\tvar fillTableArray = function () {\r\n\t\tvar colspansSums = [], a = [];\r\n\r\n\t\t//calculate max amount of cells inside a row\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar cells = table.rows[i].getElementsByTagName('td'),\r\n\t\t\t    colspanSumInRow = 0;\r\n\t\t\tfor (var j = 0; j < cells.length; j++) {\r\n\t\t\t\tcolspanSumInRow += cells[j].colSpan;\r\n\t\t\t}\r\n\t\t\tcolspansSums.push(colspanSumInRow);\r\n\t\t}\r\n\r\n\t\tmaxAmountOfCells = Math.max.apply(null, colspansSums);\r\n\t\t//calculate max rows\r\n\t\tvar maxAmountOfRows = table.rows.length;\r\n\r\n\t\t// fill with zeros from both values\r\n\t\tfor (var i = 0; i < maxAmountOfRows; i++) {\r\n\t\t\ta[i] = [];\r\n\t\t\tfor (var j = 0; j < maxAmountOfCells; j++) {\r\n\t\t\t\ta[i].push(0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdrawTable(a);\r\n\t\treturn a;\r\n\t};\r\n\r\n\t/*\r\n  * This function gets the sum of all colspans in a row.\r\n  * @param number the number of row to be used as reference.\r\n  */\r\n\tvar getActualPointsInRow = function (row) {\r\n\t\tvar tds = table.rows[row].getElementsByTagName('td'),\r\n\t\t    points = 0;\r\n\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\tpoints += tds[i].colSpan;\r\n\t\t}\r\n\t\treturn points;\r\n\t}\r\n\r\n\t/*\r\n  * This function gets us the exact coordinates of\r\n  * an exact cell, in a more reliable way than xIndex and yIndex,\r\n  * these last ones were meant to be used for getting the cell trough them.\r\n  * @param DOMElement the cell to get the coordinates.\r\n  */\r\n\tvar getCoords = function (search) {\r\n\t\tvar skipInCols = [], cell;\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tskipInCols[i] = 0;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar cellsBuffer = table.rows[i].getElementsByTagName('td');\r\n\t\t\tcellPointer = 0;\r\n\t\t\tfor (var xPosition = 0; xPosition < maxAmountOfCells; xPosition += stepsToMove) {\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (skipInCols[xPosition]) {\r\n\t\t\t\t\tskipInCols[xPosition]--;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar td = cellsBuffer[cellPointer++];\r\n\t\t\t\t\tif (td == search) {\r\n\t\t\t\t\t\treturn [i, xPosition];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (td.rowSpan > 1) {\r\n\t\t\t\t\t\tfor (k = 0; k < td.colSpan; k++) {\r\n\t\t\t\t\t\t\tskipInCols[xPosition + k] = td.rowSpan - 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstepsToMove = td.colSpan;\r\n\t\t\t\t\t} else if (td.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = td.colSpan;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tjQuery('#wptb-table-header-bg').val('');\r\n\tjQuery('#wptb-even-row-bg').val('');\r\n\tjQuery('#wptb-odd-row-bg').val('');\r\n\tjQuery('#wptb-table-border-color').val('');\r\n\tjQuery('#wptb-table-inner-border-number,#wptb-table-inner-border-slider').val('0');\r\n\tjQuery('#wptb-table-border-number,#wptb-table-border-slider').val('0');\r\n\tjQuery('#wptb-table-padding-number,#wptb-table-padding-slider').val('15');\r\n        \r\n        if ( columns || rows ) {\r\n            //END OF PRIVATE FUNCTIONS\r\n            for (var i = 0; i < settings.length; i++) {\r\n                    if (settings[i].id !== 'wptb-apply-inner-border') {\r\n                            settings[i].classList.add('visible');\r\n                    }\r\n            }\r\n\r\n            //Create a HTML Table element.\r\n            table = document.createElement('table');\r\n            table.classList.add('wptb-preview-table');\r\n\r\n            //Add the header row.\r\n            row = table.insertRow(-1);\r\n            row.classList.add('wptb-table-head', 'wptb-row');\r\n\r\n            for (var i = 0; i < columns; i++) {\r\n                    cell = new WPTB_Cell(mark);\r\n                    cell.setCoords(0, i);\r\n                    row.appendChild(cell.getDOMElement());\r\n            }\r\n\r\n            //Add the data rows.\r\n            for (var i = 1; i < rows; i++) {\r\n\r\n                    row = table.insertRow(-1);\r\n                    row.classList.add('wptb-row');\r\n\r\n                    for (var j = 0; j < columns; j++) {\r\n                            cell = new WPTB_Cell(mark);\r\n                            cell.setCoords(i, j);\r\n                            row.appendChild(cell.getDOMElement());\r\n                    }\r\n            }\r\n        } else {\r\n            let wptb_preview_table = document.getElementsByClassName( 'wptb-preview-table' );\r\n            \r\n            if ( wptb_preview_table.length > 0 ) {\r\n                table = wptb_preview_table[0];\r\n                \r\n                let cells = table.getElementsByTagName( 'td' );\r\n                \r\n                if ( cells.length > 0 ) {\r\n                    for ( let i = 0; i < cells.length; i++ ) {\r\n                        WPTB_Cell( mark, cells[i] );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\t\r\n\t/*\r\n  * This just toggles visibility of cell edit bar, and toggles \r\n  * cell selecting mode.\r\n  */\r\n\r\n\ttable.toggleTableEditMode = function () {\r\n\t\tvar bar = document.getElementById('edit-bar');\r\n\t\tif (bar.classList.contains('visible')) {\r\n\t\t\tdocument.select.deactivateMultipleSelectMode();\r\n\t\t\tbar.classList.remove('visible');\r\n\t\t} else {\r\n\t\t\tdocument.select.activateMultipleSelectMode();\r\n\t\t\tbar.classList.add('visible');\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n  * For assigning to each cell xIndex and y Index attributes,\r\n  * these are the column number and row number of cell in table. \r\n  */\r\n\r\n\ttable.recalculateIndexes = function () {\r\n\t\tvar trs = this.getElementsByTagName('tr'), tds, maxCols = 0;\r\n\r\n\t\tfor (var i = 0; i < trs.length; i++) {\r\n\t\t\ttds = trs[i].getElementsByTagName('td');\r\n\t\t\tfor (var j = 0; j < tds.length; j++) {\r\n\r\n\t\t\t\tif (i == 0) {\r\n\t\t\t\t\ttds[j].parentNode.className = '';\r\n\t\t\t\t\ttds[j].style.backgroundColor = jQuery('#wptb-table-header-bg').val();\r\n\t\t\t\t\ttds[j].parentNode.classList.add('wptb-row', 'wptb-table-head');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (i % 2 == 0) {\r\n\t\t\t\t\t\ttds[j].style.backgroundColor = jQuery('#wptb-odd-row-bg').val();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttds[j].style.backgroundColor = jQuery('#wptb-even-row-bg').val();\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttds[j].parentNode.className = '';\r\n\t\t\t\t\ttds[j].parentNode.classList.add('wptb-row');\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttds[j].dataset.xIndex = j;\r\n\t\t\t\ttds[j].dataset.yIndex = i;\r\n\t\t\t}\r\n\t\t\tif (j > maxCols) {\r\n\t\t\t\tmaxCols = j;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.columns = maxCols;\r\n\t}\r\n\r\n\t/*\r\n  * As simple as it is: adds a column to the end of table.\r\n  */\r\n\ttable.addColumnEnd = function () {\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\tarray[i].push(0);\r\n\t\t}\r\n\t\tmaxAmountOfCells++;\r\n\t\trecalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * As simple as it looks: adds a column to the start of table.\r\n  */\r\n\r\n\ttable.addColumnStart = function () {\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tfirstCell = table.rows[i].getElementsByTagName('td')[0];\r\n\t\t\tif (firstCell) {\r\n\t\t\t\ttable.rows[i].insertBefore(td.getDOMElement(), firstCell);\r\n\t\t\t} else {\r\n\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t}\r\n\t\t\tarray[i].push(0);\r\n\t\t}\r\n\r\n\t\tmaxAmountOfCells++;\r\n\t\trecalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Well, not so simple as previous functions.\r\n  * It adds a column after a certain column of reference.\r\n  * @param integer the column number to be used as reference.\r\n  *\tIf empty, then the first highlighted cell is used as reference.\r\n  */\r\n\r\n\ttable.addColumnAfter = function (c_pos) {\r\n\t\tvar rows = table.rows,\r\n\t\t    cellsBuffer,\r\n\t\t    cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    pos = c_pos != undefined && typeof c_pos === 'number' ? c_pos : getCoords(cell)[1],\r\n\t\t    pendingInsertion = false,\r\n\t\t    stepsToMove,\r\n                    td, bro,\r\n\t\t    carriedRowspans = [],\r\n\t\t    currentCell;\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarriedRowspans.push(0);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < rows.length; i++) {\r\n\t\t\tcellPointer = 0;\r\n\t\t\tcellsBuffer = rows[i].getElementsByTagName('td');\r\n\t\t\tpendingInsertion = false;\r\n\t\t\tfor (var xPosition = 0;\r\n\t\t\t\txPosition < maxAmountOfCells;\r\n\t\t\t\txPosition += stepsToMove) {\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (pendingInsertion) {\r\n\t\t\t\t\ttd = new WPTB_Cell(mark);\r\n\r\n\t\t\t\t\tif (currentCell && rows[i].contains(currentCell)) {\r\n\t\t\t\t\t\tbro = currentCell.nextSibling;\r\n\t\t\t\t\t\tif (bro) {\r\n\t\t\t\t\t\t\trows[i].insertBefore(td.getDOMElement(), bro);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\trows[i].appendChild(td.getDOMElement());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trows[i].insertBefore(td.getDOMElement(), cellsBuffer[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else if (carriedRowspans[xPosition] > 0) {\r\n\t\t\t\t\t// If no pending insertion, let's check if no rowspan from upper cells is pending in current position\r\n\t\t\t\t\tif (pos == xPosition) {\r\n\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurrentCell = cellsBuffer[cellPointer++];\r\n\t\t\t\t\tif (currentCell.rowSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = currentCell.colSpan;\r\n\t\t\t\t\t\tfor (var k = 0; k < currentCell.colSpan; k++) {\r\n\t\t\t\t\t\t\tcarriedRowspans[xPosition + k] = currentCell.rowSpan;\r\n\t\t\t\t\t\t\tif (xPosition + k == pos) {\r\n\t\t\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (currentCell.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = currentCell.colSpan;\r\n\t\t\t\t\t\tfor (var k = 0; k < currentCell.colSpan; k++) {\r\n\t\t\t\t\t\t\tif (xPosition + k == pos) {\r\n\t\t\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (xPosition == pos) {\r\n\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var l = 0; l < maxAmountOfCells; l++) {\r\n\t\t\t\tif (carriedRowspans[l] > 0)\r\n\t\t\t\t\tcarriedRowspans[l]--;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < array.length; i++) {\r\n\t\t\tarray[i].push(0);\r\n\t\t}\r\n\t\tmaxAmountOfCells++;\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\r\n\t};\r\n\r\n\t/*\r\n  * For preventing us to take a lot of time,\r\n  * This is just calling the function addColumnAfter, but\r\n  * using the previous column to current one as reference.\r\n  * @see addColumnAfter\r\n  */\r\n\r\n\ttable.addColumnBefore = function () {\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    pos = getCoords(cell)[1];\r\n\r\n\t\tif (pos === 0) {\r\n\t\t\ttable.addColumnStart();\r\n\t\t} else {\r\n\t\t\ttable.addColumnAfter(pos - 1);\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n  * Luckily, thisfunction is simple, \r\n  * it just add a row to the end of table.\r\n  */\r\n\r\n\ttable.addRowToTheEnd = function () {\r\n\t\tvar r = table.insertRow(-1),\r\n\t\t    td,\r\n\t\t    aux;\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Yet another simple function, \r\n  * it just add a row to the start of table.\r\n  */\r\n\r\n\ttable.addRowToTheStart = function () {\r\n\t\tvar r = table.insertRow(0);\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/* \r\n  * This function adds a row before the current one.\r\n  * Since the biggest factor of problem is a not-started but ongoing rowspan,\r\n  * the most of the troubles is not here.\r\n  */\r\n\r\n\ttable.addRowBefore = function () {\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    row = getCoords(cell)[0],\r\n\t\t    r = table.insertRow(row),\r\n\t\t    aux,\r\n\t\t    rowspans = carriedRowspans(row - 1);\r\n\r\n\t\tnoPending = rowspans.filter(function (elem) {\r\n\t\t\treturn elem == 0;\r\n\t\t});\r\n\r\n\t\tfor (var i = 0; i < noPending.length; i++) {\r\n\t\t\tvar td = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\r\n\t\tarr = realTimeArray();\r\n\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\r\n\t\t\tif (arr[i].length > maxAmountOfCells) {\r\n\t\t\t\t//Still not watched\r\n\t\t\t}\r\n\r\n\t\t\tif (arr[i].length < maxAmountOfCells) {\r\n\r\n\t\t\t\tfor (var j = arr[i].length; j < maxAmountOfCells; j++) {\r\n\t\t\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Well... by the name convention of the previous 3 functions,\r\n  * it's pretty obvious that this functions attaches a new\r\n  * row after highlighted cell row. The greatest obstacle it was\r\n  * the possibility of a TR not having the exact amount of columns\r\n  * occuped by actual node but rowspanned upper cells. For that purpose\r\n  * it was created the function realTimeArray.\r\n  * @see realTimeArray\r\n  */\r\n\r\n\ttable.addRowAfter = function () {\r\n\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    row = getCoords(cell)[0],\r\n\t\t    r = table.insertRow(row + 1),\r\n\t\t    aux,\r\n\t\t    rowspans = carriedRowspans(row);\r\n\r\n\t\tnoPending = rowspans.filter(function (elem) {\r\n\t\t\treturn elem == 0;\r\n\t\t});\r\n\r\n\t\tfor (var i = 0; i < noPending.length; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\r\n\t\tarr = realTimeArray();\r\n\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\r\n\t\t\tif (arr[i].length > maxAmountOfCells) {\r\n\t\t\t\t//Still not watched\r\n\t\t\t}\r\n\r\n\t\t\tif (arr[i].length < maxAmountOfCells) {\r\n\r\n\t\t\t\tfor (var j = arr[i].length; j < maxAmountOfCells; j++) {\r\n\t\t\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * This function checks the current selected cells\r\n  * make a rectangular shape.\r\n  * @param Array the abstract table.\r\n  * @return false, if not making a rectangle, or\r\n  *\tArray an array containing number of rows and columns, if selection makes a rectangle.\r\n  */\r\n\r\n\ttable.isSquare = function (a) {\r\n\t\tvar rowStart = -1,\r\n\t\t    columnStart = -1,\r\n\t\t    rowEnd = -1,\r\n\t\t    columnEnd = -1,\r\n\t\t    height,\r\n\t\t    width,\r\n\t\t    itemsEstimate = 0,\r\n\t\t    items = 0;\r\n\r\n\t\tfor (var i = 0; i < a.length; i++) {\r\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\r\n\t\t\t\tif (a[i][j] == 1) {\r\n\t\t\t\t\trowStart = i;\r\n\t\t\t\t\tcolumnStart = j;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (rowStart !== -1 && columnStart !== -1) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = a.length - 1; i > -1; i--) {\r\n\t\t\tfor (var j = a[i].length - 1; j > -1; j--) {\r\n\t\t\t\tif (a[i][j] == 1) {\r\n\t\t\t\t\trowEnd = i;\r\n\t\t\t\t\tcolumnEnd = j;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (rowEnd !== -1 && columnEnd !== -1) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = rowStart; i < rowEnd; i++) {\r\n\t\t\tfor (var j = columnStart; j < columnEnd; j++) {\r\n\t\t\t\tif (a[i][j] == 0 || a[i][j] == undefined) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < a.length; i++) {\r\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\r\n\t\t\t\tif (a[i][j] == 1) {\r\n\t\t\t\t\titems++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\theight = rowEnd - rowStart + 1;\r\n\t\twidth = columnEnd - columnStart + 1;\r\n\t\titemsEstimate = height * width;\r\n\r\n\t\tif (itemsEstimate !== items) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn [height, width];\r\n\t};\r\n\r\n\t/*\r\n  * This function merges all selected cells.\r\n  * Well, actually sets the colspan and rowspan of first \r\n  * upper left  cell in selection and deletes the another selected cells.\r\n  */\r\n\r\n\ttable.mergeCells = function () {\r\n\t\tvar dimensions = table.isSquare(array),\r\n\t\t    rowspan = dimensions[0],\r\n\t\t    colspan = dimensions[1],\r\n\t\t    first = document.querySelector('.wptb-highlighted'),\r\n\t\t    tds = [].slice.call(document.getElementsByClassName('wptb-highlighted'), 1);\r\n\r\n\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\tvar p = tds[i].parentNode;\r\n\t\t\tp.removeChild(tds[i]);\r\n\t\t}\r\n\r\n\t\tfirst.colSpan = colspan;\r\n\t\tfirst.rowSpan = rowspan;\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * This functions makes the exact inverse as above.\r\n  * It resets colspan and rowspan and appends \r\n  * the same amount in cells to the table.\r\n  * @bug\r\n  */\r\n\r\n\ttable.splitCell = function () {\r\n\t\tvar cell = document.getElementsByClassName('wptb-highlighted')[0],\r\n\t\t    rowspan = cell.rowSpan,\r\n\t\t    colspan = cell.colSpan;\r\n\t\tcell.rowSpan = 1;\r\n\t\tcell.colSpan = 1;\r\n\t\ttable.addLackingCells();\r\n\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Searches for rowspanned cells up to row number meeting it.\r\n  * @param number the number of row where the function\r\n  * must search up to.\r\n  */\r\n\r\n\ttable.findRowspannedCells = function (row) {\r\n\t\tvar array = [],\r\n\t\t    difference;\r\n\t\tactualPoints = getActualPointsInRow(row);\r\n\t\tif (actualPoints === maxAmountOfCells) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tdifference = maxAmountOfCells - actualPoints;\r\n\r\n\t\tfor (var i = row - 1; i >= 0 && difference; i--) {\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td');\r\n\t\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\t\tif (tds[i].rowSpan > 1) {\r\n\t\t\t\t\tarray.push(tds[i]);\r\n\t\t\t\t\tdifference -= tds[i].colSpan;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn array;\r\n\r\n\t}\r\n\r\n\t/*\r\n  * This function explores the table and adds \r\n  * a cell for each lacking one for each row\r\n  * to meet an even amount of cells.\r\n  */\r\n\r\n\ttable.addLackingCells = function () {\r\n\t\tvar sumRows = [];\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tsumRows.push(0);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td');\r\n\t\t\tfor (var j = 0; j < tds.length; j++) {\r\n\t\t\t\tif (tds[j].rowSpan > 1) {\r\n\t\t\t\t\tfor (var k = 1; k < tds[j].rowSpan; k++) {\r\n\t\t\t\t\t\tsumRows[i + k]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td'),\r\n\t\t\t    totalColspan = 0;\r\n\t\t\tfor (var j = 0; j < tds.length; j++) {\r\n\t\t\t\ttotalColspan += tds[j].colSpan;\r\n\t\t\t}\r\n\t\t\ttotalColspan += sumRows[i];\r\n\t\t\tdifference = maxAmountOfCells - totalColspan;\r\n\t\t\tfor (var j = 0; j < difference; j++) {\r\n\t\t\t\tvar td = new WPTB_Cell(mark);\r\n\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/*\r\n  * This function deletes the row of currently\r\n  * selected cell. \r\n  */\r\n\r\n\ttable.deleteRow = function () {\r\n\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    row = getCoords(cell)[0],\r\n\t\t    reduct = table.findRowspannedCells(row);\r\n\r\n\t\tfor (i = 0; i < reduct.length; i++) {\r\n\t\t\treduct[i].rowSpan--;\r\n\t\t}\r\n\r\n\t\ttable.getElementsByTagName('tbody')[0].removeChild(table.rows[row]);\r\n\t\tarray.pop();\r\n\t\tundoSelect();\r\n\t\ttable.addLackingCells();\r\n\t}\r\n\r\n\t/*\r\n  * This function deletes the column of currently\r\n  * selected cell. Again, this is way more complicated than\r\n  * delete row case.\r\n  */\r\n\r\n\ttable.deleteColumn = function () {\r\n\r\n\t\tvar cell_ref = document.querySelector('.wptb-highlighted'),\r\n\t\t    column = getCoords(cell_ref)[1],\r\n                    buffer, cell,\r\n\t\t    carriedRowspans = [];\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarriedRowspans.push(0);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tbuffer = table.rows[i].getElementsByTagName('td');\r\n\t\t\tstepsToMove = 1;\r\n\t\t\tcellPointer = 0;\r\n\t\t\tfor (var j = 0; j < maxAmountOfCells; j += stepsToMove) {\r\n\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (carriedRowspans[j] == 0) {\r\n\t\t\t\t\tcell = buffer[cellPointer++];\r\n\t\t\t\t\tif (cell.rowSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = cell.colSpan;\r\n\t\t\t\t\t\tfor (var k = 0; k < cell.colSpan; k++) {\r\n\t\t\t\t\t\t\tcarriedRowspans[j + k] = cell.rowSpan;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (column > j && column <= j + k - 1) {\r\n\t\t\t\t\t\t\t//cell.style.backgroundColor = 'pink';\r\n\t\t\t\t\t\t\tcell.colSpan--;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (cell.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = cell.colSpan;\r\n\r\n\t\t\t\t\t\tif (column > j && column <= j + cell.colSpan - 1) {\r\n\t\t\t\t\t\t\t//cell.style.backgroundColor = 'pink';\r\n\t\t\t\t\t\t\tcell.colSpan--;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (column == j) {\r\n\t\t\t\t\t\t\ttable.rows[i].removeChild(cell);\r\n\t\t\t\t\t\t\t//cell.style.backgroundColor = 'pink';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var l = 0; l < carriedRowspans.length; l++) {\r\n\t\t\t\tif (carriedRowspans[l] > 0) {\r\n\t\t\t\t\tcarriedRowspans[l]--;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\tmaxAmountOfCells--;\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tif (array[i] != undefined)\r\n\t\t\t\tarray[i].pop();\r\n\t\t}\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\tdocument.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\r\n\r\n\tarray = fillTableArray();\r\n\r\n\tundoSelect();\r\n\tdrawTable(array);\r\n\r\n\twptbTableSetup.appendChild(table);\r\n\r\n\ttable.recalculateIndexes();\r\n\r\n\tWPTB_LeftPanel();\r\n\r\n};","var WPTB_Text = function ( text , DOMElementProt ) {\r\n            let DOMElement = document.createElement('div'),\r\n                elText2 = document.createElement('div'),\r\n                elP = document.createElement('p'),\r\n                kindIndexProt = undefined;\r\n\r\n            elText2.classList.add('editable');\r\n            elP.innerHTML = text != undefined ? text : 'Text';\r\n            elText2.appendChild(elP);\r\n            DOMElement.appendChild(elText2);\r\n        if ( DOMElementProt ) {\r\n            let wptbElementMutch = DOMElementProt.className.match( /wptb-element-((.+-)\\d+)/i );\r\n            if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\r\n                kindIndexProt = wptbElementMutch[1];\r\n            };\r\n            \r\n            let attributes = [...DOMElementProt.attributes];\r\n            for( let i = 0; i < attributes.length; i++ ) {\r\n                DOMElement.setAttribute(attributes[i].name, attributes[i].value);\r\n            }\r\n        } \r\n\r\n\tthis.kind = 'text';\r\n\tthis.getDOMElement = function () {\r\n            return DOMElement;\r\n\t};\r\n\tapplyGenericItemSettings( this, kindIndexProt );\r\n\r\n\treturn this;\r\n        \r\n};"]}