{"version":3,"sources":["applyGenericItemSettings.js","wptb-builder.js","WPTB_Builder.js","WPTB_Button.js","WPTB_Cell.js","WPTB_ElementCounters.js","WPTB_ElementOptions.js","WPTB_Image.js","WPTB_Initializer.js","WPTB_LeftPanel.js","WPTB_List.js","WPTB_ListItem.js","WPTB_MultipleSelect.js","WPTB_Parser.js","WPTB_Settings.js","WPTB_Space.js","WPTB_Stringifier.js","WPTB_Table.js","WPTB_Text.js"],"names":["applyGenericItemSettings","element","node","getDOMElement","index","document","counter","nextIndex","kind","listItems","copy","onmouseenter","event","classList","add","btnDelete","createElement","btnCopy","btnMove","actions","previous","i","draggable","onclick","act","parentNode","el","space","nextSibling","num","space2","removeChild","getElementsByClassName","length","td","target","temp","srcList","querySelectorAll","DOMElement","getElementsByTagName","console","log","push","innerHTML","WPTB_List","appendChild","WPTB_Text","childNodes","insertBefore","WPTB_Space","WPTB_Image","children","src","WPTB_Button","ondragstart","parent","infArr","type","className","contains","match","img","dataTransfer","setDragImage","setData","tinyMCE","init","inline","plugins","dialog_type","theme","menubar","fixed_toolbar_container","toolbar","verify_html","setup","ed","on","execCommand","init_instance_callback","editor","e","getContent","trim","setContent","range","selection","getRng","KeyID","keyCode","startOffset","preventDefault","window","currentEditor","totalWidth","offsetWidth","getElementById","scrollTop","bodyElement","style","display","position","right","top","paste_as_text","onmouseleave","formerActions","par","remove","node_wptb_element_kind_num","WPTB_ElementOptions","increment","detectMode","url","location","href","regex","RegExp","results","exec","decodeURIComponent","replace","WPTB_Builder","table_id","http","XMLHttpRequest","ajaxurl","open","setRequestHeader","onreadystatechange","d","readyState","status","ans","JSON","parse","responseText","value","wptbTableSetupEl","WPTB_Parser","WPTB_Table","WPTB_LeftPanel","WPTB_Settings","send","ElementCounters","select","MultipleSelect","initializer","WPTB_Initializer","settings","addEventListener","text","DOMElementProt","elButton2","el_B","undefined","attributesContainer","attributes","setAttribute","name","wptbButtonWrapper","querySelector","wptbButtonWrapAttributes","wptbButton","wptbButtonAttributes","WPTB_Cell","callback","newElementProxy","highlightRow","parentRow","columnCount","parseInt","tds","classToAdd","ttd","highlightColumn","rowCount","table","tr","padding","jQuery","val","innerBorderWidth","border","ondragenter","div","getData","ondragover","ondragleave","ondrop","classId","t_space","spaceParent","wptbPhElement","wptbSpaceBetween","j","wptbElementTypeClass","Array","isArray","wptbTypeElementArr","split","wptbArticle","WPTB_ListItem","setCoords","y","x","dataset","yIndex","xIndex","getCoords","coords","appendElement","priv","key","elemIdClass","prop","cloneNode","properties","optionsClass","listStyleType","listJustifyContent","find","wpColorPicker","defaultColor","color","fontSize","substring","justifyContent","selectedIndex","backgroundColor","buttons","size","n_Class","affectedEl","b","optionControls","change","ui","classe","ps","number","toString","slider","oninput","onchange","alt","checked","width","height","textAlign","jc","articles","bullets","toLowerCase","anchor","file_frame","wp","media","frames","title","button","multiple","attachment","state","get","first","toJSON","MIN_COLUMNS","MIN_ROWS","MAX_COLUMNS","MAX_ROWS","tableGenerator","body","columnsDecrementButton","columnsIncrementButton","rowsDecrementButton","rowsIncrementButton","columnsInput","rowsInput","columns","rows","wptbElementButtons","hexToRgb","hex","result","tableRows","tableHeader","tableCells","addInnerBorderSize","addCellPadding","addInnerBorder","styles","marginBottom","addBorderSize","_val","wptbElement","toggleTableEditMode","addRowToTheEnd","addRowToTheStart","addRowBefore","addRowAfter","addColumnEnd","addColumnStart","addColumnBefore","addColumnAfter","deleteColumn","deleteRow","mergeCells","splitCell","innerElements","el_L","item","wptbListItemReturn","divdot","divcontent","libullet","styleDot","getAttribute","onkeyup","listItemKeyListener","article","content","html","duplicate","append","onkeydown","which","lastP","dontAddItems","setTimeout","selectedCells","multipleCellMode","activateMultipleSelectMode","deactivateMultipleSelectMode","isActivated","pushSelectedCell","cell","flushSelectedCells","getFirst","minXIndex","minYIndex","getLast","maxXIndex","maxYIndex","last","removeAllButFirst","code","elementHtml","createTextNode","tagName","elems","effectAllowed","t","messagingArea","WPTB_Stringifier","firstChild","stringify","params","rs","wptbId","action","data","elSpaceBetween","includes","spaceBetween","stopPropagation","p","alert","start","nodeType","nodeValue","int_elem_arr","attributes_list","internal_elements","inter_elem","array","wptbTableSetup","row","maxAmountOfCells","maxAmountOfRows","mark","rowSpan","cs","colSpan","markedCells","noCells","singleCells","multipleCells","column","isSquare","realTimeArray","carried","cols","matriz","items","k","justAssigned","amount","carriedRowspans","cellsBuffer","cellPointer","xPosition","stepsToMove","celda","drawTable","a","string","undoSelect","fillTableArray","colspansSums","cells","colspanSumInRow","Math","max","apply","getActualPointsInRow","points","search","skipInCols","id","insertRow","wptb_preview_table","bar","recalculateIndexes","trs","maxCols","firstCell","c_pos","pos","pendingInsertion","bro","currentCell","l","r","aux","from","rowspans","noPending","filter","elem","arr","rowStart","columnStart","rowEnd","columnEnd","itemsEstimate","dimensions","rowspan","colspan","slice","call","addLackingCells","findRowspannedCells","difference","actualPoints","sumRows","totalColspan","reduct","pop","cell_ref","buffer","elText2","elP"],"mappings":"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","file":"admin.js","sourcesContent":["var applyGenericItemSettings = function (element) {\r\n\tvar node = element.getDOMElement(),\r\n\t    index = document.counter.nextIndex(element.kind),\r\n\t    listItems,\r\n            copy;\r\n\r\n\tnode.onmouseenter = function (event) {\r\n\t\tthis.classList.add('wptb-directlyhovered');\r\n\t\tvar btnDelete = document.createElement('span'),\r\n\t\t    btnCopy = document.createElement('span'),\r\n\t\t    btnMove = document.createElement('span'),\r\n\t\t    actions = document.createElement('span'),\r\n                    previous, i;\r\n\t\tactions.classList.add('wptb-actions');\r\n\t\tbtnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\r\n\t\tbtnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\r\n\t\tbtnMove.classList.add(\"dashicons\", \"dashicons-move\", 'move-action');\r\n\t\tbtnMove.draggable = true;\r\n\t\tbtnDelete.onclick = function (event) {\r\n\t\t\tvar act = this.parentNode.parentNode,\r\n\t\t\t    el = act.parentNode,\r\n\t\t\t    space = act.nextSibling,\r\n                            num, space2;\r\n\t\t\tel.removeChild(act);\r\n\t\t\tel.removeChild(space);\r\n\t\t\tnum = el.getElementsByClassName('wptb-ph-element').length;\r\n\t\t\tif (!num) {\r\n\t\t\t\tspace2 = el.getElementsByClassName('wptb-space-between')[0];\r\n\t\t\t\tif (space2) {\r\n\t\t\t\t\tel.removeChild(space2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tbtnCopy.onclick = function (event) {\r\n\t\t\tif (element.kind == 'list') {\r\n\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    temp = [],\r\n\t\t\t\t    srcList = event.target.parentNode.parentNode.querySelectorAll('ul article .wptb-list-item-content'),\r\n                                    DOMElement = event.target.parentNode.parentNode.getElementsByTagName( 'article' )[0];\r\n                                    console.log(DOMElement);\r\n\r\n\t\t\t\tfor (var i = 0; i < srcList.length; i++) {\r\n\t\t\t\t\ttemp.push(srcList[i].innerHTML);\r\n\t\t\t\t}\r\n\t\t\t\tvar copy = new WPTB_List( temp, DOMElement );\r\n\t\t\t\ttd.appendChild( copy.getDOMElement() );\r\n\t\t\t} else if (element.kind == 'text') {\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    copy = new WPTB_Text(event.target.parentNode.parentNode.childNodes[0].innerHTML, node);\r\n                            \r\n\t\t\t\tnode.parentNode.insertBefore( copy.getDOMElement(), node.nextSibling );\r\n                                node.parentNode.insertBefore( new WPTB_Space, copy.getDOMElement() );\r\n\t\t\t} else if ( element.kind == 'image' ) {\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    copy = new WPTB_Image( event.target.parentNode.parentNode.children[0].children[0].src, node );\r\n                            \r\n\t\t\t\tnode.parentNode.insertBefore( copy.getDOMElement(), node.nextSibling );\r\n                                node.parentNode.insertBefore( new WPTB_Space, copy.getDOMElement() );\r\n\t\t\t} else {\r\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\r\n\t\t\t\t    copy = new WPTB_Button( event.target.parentNode.parentNode.childNodes[0].innerHTML, node );\r\n                            \r\n                                node.parentNode.insertBefore( copy.getDOMElement(), node.nextSibling );\r\n                                node.parentNode.insertBefore( new WPTB_Space, copy.getDOMElement() );\r\n\t\t\t}\r\n\t\t};\r\n\t\tbtnMove.ondragstart = function (event) {\r\n\t\t\tvar parent = this, infArr, type;\r\n\r\n\t\t\twhile (parent.className == '' ||\r\n\t\t\t\t!parent.classList.contains('wptb-ph-element')) {\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t}\r\n\r\n\t\t\tinfArr = parent.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n\t\t\ttype = infArr[1];\r\n\r\n\t\t\tvar img = document.createElement(\"img\");\r\n\t\t\timg.src = \"http://localhost/sandbox/wp-content/plugins/wp-table-builder/inc/admin/views/builder/icons/\" + type + \".png\";\r\n\t\t\tevent.dataTransfer.setDragImage(img, 0, 0);\r\n\t\t\tevent.dataTransfer.setData('node', 'wptb-element-' + infArr[1] + '-' + infArr[2]);\r\n\t\t};\r\n\r\n\t\tif (element.kind === 'button') {\r\n\t\t\ttinyMCE.init({\r\n\t\t\t\ttarget: node.childNodes[0].childNodes[0],\r\n\t\t\t\tinline: true,\r\n\t\t\t\tplugins: \"link\",\r\n\t\t\t\tdialog_type: \"modal\",\r\n\t\t\t\ttheme: 'modern',\r\n\t\t\t\tmenubar: false,\r\n\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t\t\t\ttoolbar: 'bold italic strikethrough',\r\n\t\t\t\tverify_html: false,\r\n\t\t\t\tsetup: function (ed) {\r\n\t\t\t\t\ted.on(\"init\",\r\n\t\t\t\t\t\tfunction (ed) {\r\n\t\t\t\t\t\ttinyMCE.execCommand('mceRepaint');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tinit_instance_callback: function (editor) {\r\n\t\t\t\t\teditor.on('change', function (e) {\r\n\t\t\t\t\t\t// check if it becomes empty because if there's no value it's hard to edit the editor in button element\r\n\t\t\t\t\t\tif (editor.getContent().trim() == \"\") {\r\n\t\t\t\t\t\t\teditor.setContent(\"<a class='wptb-button'>Button Text</a>\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\teditor.on('KeyDown', function (e) {\r\n\t\t\t\t\t\tvar range = editor.selection.getRng();\r\n\t\t\t\t\t\tvar KeyID = e.keyCode;\r\n\t\t\t\t\t\tif (range.startOffset == 0 && (KeyID == 8 || KeyID == 46)) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\teditor.setContent(\"<p class='wptb-button'></p>\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\twindow.currentEditor = editor;\r\n\t\t\t\t\teditor.on('focus', function (e) {\r\n\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t\t\tif (window.currentEditor &&\r\n\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else if (element.kind === 'text') {\r\n\t\t\ttinyMCE.init({\r\n\t\t\t\ttarget: node.childNodes[0],\r\n\t\t\t\tinline: true,\r\n\t\t\t\tplugins: \"link, paste\",\r\n\t\t\t\tdialog_type: \"modal\",\r\n\t\t\t\ttheme: 'modern',\r\n\t\t\t\tmenubar: false,\r\n\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t\t\t\tpaste_as_text: true,\r\n\t\t\t\ttoolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\r\n\t\t\t\tinit_instance_callback: function (editor) {\r\n\t\t\t\t\twindow.currentEditor = editor;\r\n\t\t\t\t\teditor.on('focus', function (e) {\r\n\r\n\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t\t\tif (window.currentEditor &&\r\n\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t} else {\r\n\t\t\tlistItems = node.getElementsByClassName('wptb-list-item-content');\r\n\t\t\tfor (var i = 0; i < listItems.length; i++) {\r\n\t\t\t\ttinyMCE.init({\r\n\t\t\t\t\ttarget: listItems[i],\r\n\t\t\t\t\tinline: true,\r\n\t\t\t\t\tplugins: \"link, paste\",\r\n\t\t\t\t\tdialog_type: \"modal\",\r\n\t\t\t\t\ttheme: 'modern',\r\n\t\t\t\t\tmenubar: false,\r\n\t\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n\t\t\t\t\tpaste_as_text: true,\r\n\t\t\t\t\ttoolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\r\n\t\t\t\t\tinit_instance_callback: function (editor) {\r\n\t\t\t\t\t\twindow.currentEditor = editor;\r\n\t\t\t\t\t\teditor.on('focus', function (e) {\r\n\t\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n\t\t\t\t\t\t\tif (window.currentEditor &&\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\r\n\t\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n\t\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n\t\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tactions.appendChild(btnMove);\r\n\t\tactions.appendChild(btnCopy);\r\n\t\tactions.appendChild(btnDelete);\r\n\t\tthis.appendChild(actions);\r\n\t};\r\n\r\n\tnode.onmouseleave = function (event) {\r\n\t\tvar formerActions = this.getElementsByClassName('wptb-actions');\r\n\t\tif (formerActions && formerActions[0]) {\r\n\t\t\tlet par = formerActions[0].parentNode;\r\n\t\t\tpar.removeChild(formerActions[0]);\r\n\t\t}\r\n\t\tthis.classList.remove('wptb-directlyhovered');\r\n\t};\r\n        \r\n        let node_wptb_element_kind_num = node.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n        if ( node_wptb_element_kind_num ) {\r\n            node.classList.remove( node_wptb_element_kind_num[0] );\r\n        }\r\n        if ( ! node.classList.contains( 'wptb-ph-element' ) ) {\r\n            node.classList.add('wptb-ph-element' );\r\n            if( ! node.classList.contains( 'wptb-element-' + element.kind + '-' + index ) ) {\r\n                node.classList.add( 'wptb-element-' + element.kind + '-' + index );\r\n            }\r\n        } else {\r\n            if( ! node.classList.contains( 'wptb-element-' + element.kind + '-' + index ) ) {\r\n                node.classList.add( 'wptb-element-' + element.kind + '-' + index );\r\n            }\r\n        }\r\n\tnew WPTB_ElementOptions( element, index );\r\n\r\n\tdocument.counter.increment(element.kind);\r\n\r\n};","","(function () {\r\n\r\n\tfunction detectMode() {\r\n\t\tvar url = window.location.href,\r\n\t\t    regex = new RegExp('[?&]table(=([^&#]*)|&|#|$)'),\r\n\t\t    results = regex.exec(url);\r\n\t\tif (!results) return false;\r\n\t\tif (!results[2]) return '';\r\n\t\treturn decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n\t}\r\n\r\n\tvar WPTB_Builder = function () {\r\n            var table_id = detectMode();\r\n            if (table_id) {\r\n                var http = new XMLHttpRequest(),\r\n                    url = ajaxurl + \"?action=get_table\" + '&id=' + table_id;\r\n                http.open('GET', url, true);\r\n                http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n                http.onreadystatechange = function (d) {\r\n                    if (this.readyState == 4 && this.status == 200) {\r\n                        var ans = JSON.parse(http.responseText);\r\n                        document.getElementById('wptb-setup-name').value = ans[0];\r\n                        document.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\r\n                        let wptbTableSetupEl = document.getElementsByClassName('wptb-table-setup')[0];\r\n                        wptbTableSetupEl.appendChild( WPTB_Parser( ans[1] ) );\r\n                        WPTB_Table();\r\n                        WPTB_LeftPanel();\r\n                        WPTB_Settings();\r\n                        return;\r\n                    }\r\n                };\r\n                http.send(null);\r\n            }\r\n            document.counter = new ElementCounters();\r\n            document.select = new MultipleSelect();\r\n\r\n            var initializer = WPTB_Initializer();\r\n            settings = WPTB_Settings();\r\n\t};\r\n\r\n\tdocument.addEventListener('DOMContentLoaded', WPTB_Builder);\r\n})();","var WPTB_Button = function( text, DOMElementProt ) {\r\n    \r\n    var DOMElement = document.createElement('div'),\r\n        elButton2 = document.createElement('div'),\r\n        el_B = document.createElement('a');\r\n\r\n    DOMElement.classList.add('wptb-button-container', 'wptb-size-M', 'wptb-');\r\n    elButton2.classList.add('wptb-button-wrapper');\r\n    el_B.classList.add('wptb-button');\r\n    el_B.classList.add('editable');\r\n    el_B.classList.add('editable');\r\n    el_B.innerHTML = text != undefined ? text : 'Button Text';\r\n    \r\n    if ( DOMElementProt ) {\r\n        var attributesContainer = [...DOMElementProt.attributes];\r\n        if ( attributesContainer.length > 0 ) {\r\n            for( let i = 0; i < attributesContainer.length; i++ ) {\r\n                DOMElement.setAttribute(attributesContainer[i].name, attributesContainer[i].value);\r\n            } \r\n        }\r\n        \r\n        var wptbButtonWrapper = DOMElementProt.querySelector( '.wptb-button-wrapper' );\r\n        if ( wptbButtonWrapper ) {\r\n            var wptbButtonWrapAttributes = [...wptbButtonWrapper.attributes];\r\n            if ( wptbButtonWrapAttributes.length > 0 ) {\r\n                for( let i = 0; i < wptbButtonWrapAttributes.length; i++ ) {\r\n                    if ( wptbButtonWrapAttributes[i].name == 'style') {\r\n                        elButton2.setAttribute( wptbButtonWrapAttributes[i].name, wptbButtonWrapAttributes[i].value );\r\n                    }\r\n                } \r\n            }\r\n        }\r\n        \r\n        var wptbButton = DOMElementProt.querySelector( '.wptb-button' );\r\n        if ( wptbButton ) {\r\n            var wptbButtonAttributes = [...wptbButton.attributes];\r\n            if ( wptbButtonAttributes.length > 0 ) {\r\n                for( let i = 0; i < wptbButtonAttributes.length; i++ ) {\r\n                    if ( wptbButtonAttributes[i].name == 'style') {\r\n                        el_B.setAttribute( wptbButtonAttributes[i].name, wptbButtonAttributes[i].value );\r\n                    }\r\n                } \r\n            }\r\n        }\r\n    }\r\n    \r\n    elButton2.appendChild(el_B);\r\n    DOMElement.appendChild(elButton2);\r\n    \r\n    this.kind = 'button';\r\n\r\n    this.getDOMElement = function () {\r\n            return DOMElement;\r\n    };\r\n\r\n    applyGenericItemSettings( this );\r\n\r\n    return this;\r\n};","var WPTB_Cell = function (callback, DOMElement) {\r\n\r\n    function newElementProxy(el) {\r\n        if (el == 'list') {\r\n            return new WPTB_List();\r\n        } else if (el == 'image') {\r\n            return new WPTB_Image();\r\n        } else if (el == 'text') {\r\n            return new WPTB_Text();\r\n        } else if (el == 'button') {\r\n            return new WPTB_Button();\r\n        }\r\n    }\r\n\r\n    function highlightRow(td) {\r\n        var parentRow = td.parentNode,\r\n            columnCount = parseInt(document.getElementById('wptb-columns-number').value),\r\n            tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n        for (var i = 0; i < tds.length; i++) {\r\n            tds[i].classList.remove('highlighted-row-first', 'highlighted-row-last', 'highlighted-row-inner', 'highlighted-column-first', 'highlighted-column-last', 'highlighted-column-inner');\r\n        }\r\n        for (var i = 0; i < columnCount; i++) {\r\n\r\n            var classToAdd = i == 0 ? 'highlighted-row-first' : i == columnCount - 1 ? 'highlighted-row-last' : 'highlighted-row-inner';\r\n            var ttd = parentRow.getElementsByTagName('td')[i];\r\n            if (ttd !== td) {\r\n                ttd.classList.add(classToAdd);\r\n            }\r\n        }\r\n    }\r\n\r\n    function highlightColumn(td) {\r\n\r\n        var index,\r\n            parentRow = td.parentNode;\r\n        columnCount = parseInt(document.getElementById('wptb-columns-number').value), rowCount = parseInt(document.getElementById('wptb-rows-number').value), table = document.getElementsByClassName('wptb-preview-table')[0];\r\n        for (var i = 0; i < columnCount; i++) {\r\n            if (parentRow.getElementsByTagName('td')[i] === td) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < rowCount; i++) {\r\n            var classToAdd = i == 0 ? 'highlighted-column-first' : i == rowCount - 1 ? 'highlighted-column-last' : 'highlighted-column-inner';\r\n            var tr = table.getElementsByTagName('tr')[i];\r\n            if (tr.getElementsByTagName('td')[index] !== td) {\r\n                tr.getElementsByTagName('td')[index].classList.add(classToAdd);\r\n            }\r\n        }\r\n    }\r\n    \r\n    if( ! DOMElement ) {\r\n        DOMElement = document.createElement(\"td\");\r\n\r\n        DOMElement.style.padding = jQuery('#wptb-table-padding-number').val() + 'px';\r\n\r\n        var innerBorderWidth = jQuery('#wptb-table-inner-border-number').val();\r\n\r\n        if (innerBorderWidth != '' && parseInt(innerBorderWidth) != 0) {\r\n            DOMElement.style.border = innerBorderWidth + 'px solid ' + jQuery('#wptb-table-border-color').val();\r\n        } else {\r\n            DOMElement.style.border = '1px dashed #969fa6';\r\n        }\r\n\r\n        DOMElement.classList.add('wptb-droppable', 'wptb-cell');\r\n    }\r\n\r\n    DOMElement.draggable = false;\r\n    if ( callback ) {\r\n        DOMElement.onclick = callback;\r\n    }\r\n\r\n    DOMElement.ondragenter = function (e) {\r\n        var div;\r\n        if (!e.dataTransfer.getData('wptbElement') && !e.dataTransfer.getData('node')) {\r\n            return;\r\n        }\r\n        this.classList.add('wptb-drop-here-empty');\r\n    };\r\n    \r\n    DOMElement.ondragover = function (e) {\r\n        e.preventDefault();\r\n    };\r\n    \r\n    DOMElement.ondragleave = function () {\r\n        this.classList.remove('wptb-drop-here-empty');\r\n    };\r\n\r\n    DOMElement.ondrop = function (e) {\r\n        var element, classId, space, t_space, spaceParent;\r\n        e.preventDefault();\r\n        space = new WPTB_Space();\r\n\r\n        if (!e.dataTransfer.getData('wptbElement') && !e.dataTransfer.getData('node')) {\r\n            return;\r\n        }\r\n\r\n        if (e.dataTransfer.getData('wptbElement')) {\r\n            element = newElementProxy(e.dataTransfer.getData('wptbElement'));\r\n            if (this.innerHTML == '') {\r\n                this.appendChild(new WPTB_Space());\r\n            }\r\n            this.appendChild(element.getDOMElement());\r\n            this.appendChild(space);\r\n        } else {\r\n            classId = e.dataTransfer.getData('node');\r\n            element = document.getElementsByClassName(classId)[0];\r\n            if (this.innerHTML == '') {\r\n                t_space = element.nextSibling;\r\n                spaceParent = element.parentNode;\r\n                if (t_space != undefined) {\r\n                    spaceParent.removeChild(t_space);\r\n                }\r\n                this.appendChild(new WPTB_Space());\r\n            }\r\n            this.appendChild(element);\r\n            this.appendChild(space);\r\n        }\r\n        this.classList.remove('wptb-drop-here-empty');\r\n        return true;\r\n    };\r\n    \r\n    let wptbPhElement = DOMElement.getElementsByClassName( 'wptb-ph-element' );\r\n                                            \r\n    if ( wptbPhElement.length > 0 ) {\r\n        for( let i = 0; i < wptbPhElement.length; i++ ) {\r\n\r\n            let wptbSpaceBetween = DOMElement.getElementsByClassName( 'wptb-space-between' );\r\n\r\n            if ( wptbSpaceBetween.length > 0 ) {\r\n                for( let j = 0; j < wptbSpaceBetween.length; j++ ) {\r\n                    WPTB_Space( wptbSpaceBetween[j] );\r\n                }\r\n            }\r\n\r\n            wptbPhElement[i].getDOMElement = function() {\r\n                return wptbPhElement[i];\r\n            }\r\n\r\n            let wptbElementTypeClass = wptbPhElement[i].className.match( /wptb-element-((.+-)\\d+)/i );\r\n\r\n            if( wptbElementTypeClass && Array.isArray( wptbElementTypeClass ) ) {\r\n                let wptbTypeElementArr = wptbElementTypeClass[1].split( '-' );\r\n                wptbPhElement[i].kind = wptbTypeElementArr[0];\r\n                applyGenericItemSettings( wptbPhElement[i] );\r\n                if ( wptbPhElement[i].kind == 'list' ) {\r\n                    console.log(wptbPhElement[i]);\r\n                    let wptbArticle = wptbPhElement[i].getElementsByTagName( 'article' );\r\n                    if( wptbArticle.length > 0 ) {\r\n                        for ( let i = 0; i < wptbArticle.length; i++ ) {\r\n                            console.log(wptbArticle);\r\n                            WPTB_ListItem( undefined, wptbArticle[i] );\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    };\r\n\r\n    this.setCoords = function (y, x) {\r\n        var el = this.getDOMElement();\r\n        el.dataset.yIndex = y;\r\n        el.dataset.xIndex = x;\r\n    };\r\n\r\n    this.getCoords = function () {\r\n        var coords,\r\n            el = this.getDOMElement();\r\n        coords.x = el.dataset.xIndex;\r\n        coords.y = el.dataset.yIndex;\r\n        return coords;\r\n    };\r\n\r\n    this.appendElement = function (node) {\r\n        getDOMElement().appendChild(node);\r\n    };\r\n\r\n    return this;\r\n};","var ElementCounters = function () {\r\n\r\n\tvar priv = [];\r\n\tpriv['text'] = 0;\r\n\tpriv['image'] = 0;\r\n\tpriv['list'] = 0;\r\n\tpriv['button'] = 0;\r\n\r\n\tthis.increment = function (key) {\r\n\t\tif (!(key in priv)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tpriv[key]++;\r\n\t}\r\n\r\n\tthis.nextIndex = function (key) {\r\n\t\tif (!(key in priv)) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\treturn priv[key] + 1;\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};","var WPTB_ElementOptions = function (element, index) {\r\n\r\n    var node = element.getDOMElement(), elemIdClass;\r\n\r\n        prop = document.querySelector(\".wptb-\" + element.kind + \"-options-prototype\").cloneNode(true);\r\n        prop.classList.remove(\"wptb-\" + element.kind + \"-options-prototype\"); // remove prototype from the class\r\n    elemIdClass = 'wptb-options-' + element.kind + \"-\" + index;\r\n\r\n    var properties = prop.getElementsByClassName('wptb-element-property');\r\n\r\n    for (var i = 0; i < properties.length; i++) {\r\n        properties[i].dataset.element = elemIdClass;\r\n    }\r\n\r\n    prop.classList.add(elemIdClass);\r\n    document.getElementById(\"element-options-group\").appendChild(prop);\r\n\r\n    node.onclick = function () {\r\n        var infArr = this.className.match(/wptb-element-((.+-)\\d+)/i),\r\n            optionsClass = '.wptb-' + infArr[2] + 'options' +\r\n                '.wptb-options-' + infArr[1];\r\n\r\n        document.getElementById('add-elements').getElementsByTagName('a')[0].classList.remove('active');\r\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.add('active');\r\n\r\n        document.getElementsByClassName('wptb-elements-container')[0].style.display = 'none';\r\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'none';\r\n        document.getElementById(\"element-options-group\").style.display = 'block';\r\n\r\n        var children = document.getElementById(\"element-options-group\").childNodes;\r\n        for (var i = 0; i < children.length; i++) {\r\n            if (children[i].style)\r\n                children[i].style.display = 'none';\r\n        }\r\n\r\n        document.querySelector(optionsClass).style.display = 'block';\r\n\r\n        var listStyleType, listJustifyContent;\r\n\r\n        switch (element.kind) {\r\n\r\n            case 'text':\r\n                jQuery(prop).find('[data-type=color]').wpColorPicker({ defaultColor: node.style.color });\r\n                prop.querySelector('[type=number][data-type=font-size]').value\r\n                    = prop.querySelector('[type=ran][data-type=font-size]').value\r\n                    = node.style.fontSize.substring(0, node.style.fontSize.length - 2);\r\n                break;\r\n            case 'list':\r\n                listJustifyContent = node.querySelector('article').style.justifyContent;\r\n                listStyleType = node.querySelector('article .wptb-list-item-style-dot li').style.listStyleType;\r\n                if ( prop.querySelector( '[type=ran][data-type=list-class]' ) ) {\r\n                    prop.querySelector('[type=ran][data-type=list-class]').selectedIndex = (listStyleType == 'decimal' ? 0 : 1);\r\n                }\r\n                if ( prop.querySelector('[type=ran][data-type=list-style-type]') ) {\r\n                    prop.querySelector('[type=ran][data-type=list-style-type]').selectedIndex = (listStyleType == 'circle' ? 0 : (listStyleType == 'square' ? 1 : 2));\r\n                }\r\n                if ( prop.querySelector('[type=ran][data-type=list-alignment]') ) {\r\n                    prop.querySelector('[type=ran][data-type=list-alignment]').selectedIndex = (listJustifyContent == 'flex-start' ? 0 : (listJustifyContent == 'center' ? 1 : 2));\r\n                }\r\n                break;\r\n            case 'image':\r\n                break;\r\n            case 'button':\r\n                jQuery(prop).find('[data-type=button-color]').wpColorPicker({ defaultColor: node.style.backgroundColor });\r\n                break;\r\n\r\n        }\r\n    };\r\n\r\n    if (element.kind == 'button') {\r\n        //We must add this special kind of property, since it is triggered with click event\r\n        var buttons = prop.getElementsByClassName('wptb-btn-size-btn');\r\n\r\n        for (var i = 0; i < buttons.length; i++) {\r\n            buttons[i].onclick = function () {\r\n                var size = this.innerHTML,\r\n                    n_Class = this.dataset.element,\r\n                    infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                    type = infArr[1],\r\n                    num = infArr[2],\r\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0];\r\n                affectedEl.classList.remove('wptb-size-S');\r\n                affectedEl.classList.remove('wptb-size-M');\r\n                affectedEl.classList.remove('wptb-size-L');\r\n                affectedEl.classList.remove('wptb-size-XL');\r\n                affectedEl.classList.add('wptb-size-' + size);\r\n                var b = prop.getElementsByClassName('wptb-btn-size-btn');\r\n                for (var i = 0; i < b.length; i++) {\r\n                    b[i].classList.remove('selected');\r\n                }\r\n                this.classList.add('selected');\r\n            }\r\n        }\r\n    }\r\n\r\n    var optionControls = prop.getElementsByClassName('wptb-element-property');\r\n\r\n    for (var i = 0; i < optionControls.length; i++) {\r\n        if (optionControls[i].classList.contains('wptb-color-picker')) {\r\n            jQuery(optionControls[i]).wpColorPicker({\r\n                change: function (event, ui) {\r\n                    var parent = event.target, classe, type, ps, number;\r\n                    classe = parent.dataset.element.match(/wptb-options-(.+)-(\\d+)/i);\r\n                    type = classe[1];\r\n                    number = classe[2];\r\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + number)[0];\r\n                    if (type == 'button') {\r\n                        if (parent.dataset.type == 'button-text-color') {\r\n                            affectedEl.getElementsByClassName('wptb-button')[0].style.color = ui.color.toString();\r\n                        } else {\r\n                            affectedEl.getElementsByClassName('wptb-button')[0].style.backgroundColor = ui.color.toString();\r\n                        }\r\n                    } else {\r\n                        affectedEl.style.color = ui.color.toString();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        if (optionControls[i].dataset.type === 'font-size') {\r\n            var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-text-font-size-slider')[0];\r\n            slider.oninput = function () {\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].value = this.value;\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].onchange();\r\n            }\r\n        }\r\n\r\n        if (optionControls[i].dataset.type === 'image-size') {\r\n            var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-image-size-slider')[0];\r\n            slider.oninput = function () {\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-image-width-number')[0].value = this.value;\r\n                this.parentNode.parentNode.getElementsByClassName('wptb-image-width-number')[0].onchange();\r\n            }\r\n        }\r\n\r\n        optionControls[i].onchange = function (event) {\r\n\r\n            var n_Class = this.dataset.element,\r\n                infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                type = infArr[1],\r\n                num = infArr[2],\r\n                affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0],\r\n                val = this.value;\r\n\r\n            switch (this.dataset.type) {\r\n                case 'src':\r\n                    var img = affectedEl.getElementsByTagName(\"img\")[0];\r\n                    img.src = this.value;\r\n                    break;\r\n                case 'alternative-text':\r\n                    var img = affectedEl.getElementsByTagName('img')[0];\r\n                    img.alt = this.value;\r\n                    break;\r\n                case 'image-link':\r\n                    affectedEl.getElementsByTagName('a')[0].href = this.value;\r\n                    break;\r\n                case 'button-link-target':\r\n                    if (this.checked == true) {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_blank';\r\n                    } else {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_self';\r\n                    }\r\n                    break;\r\n                case 'image-size':\r\n                    affectedEl.getElementsByTagName('img')[0].style.width = this.value + '%';\r\n                    affectedEl.getElementsByTagName('img')[0].style.height = 'auto';\r\n                    this.parentNode.parentNode.getElementsByClassName('wptb-image-size-slider')[0].value = this.value;\r\n                    break;\r\n                case 'image-alignment':\r\n                    affectedEl.getElementsByTagName( 'img' )[0].parentNode.style.textAlign = this.value;\r\n                    break;\r\n                case 'font-size':\r\n                    affectedEl.style.fontSize = val + 'px';\r\n                    break;\r\n                case 'button-alignment':\r\n                    var jc = '';\r\n                    if (this.value == 'left') {\r\n                        jc = 'start';\r\n                    } else if (this.value == 'right') {\r\n                        jc = 'flex-end';\r\n                    } else {\r\n                        jc = 'center';\r\n                    }\r\n                    affectedEl.getElementsByClassName('wptb-button-wrapper')[0].style.justifyContent = jc;\r\n                    break;\r\n                case 'button-link':\r\n                    affectedEl.getElementsByTagName('a')[0].href = this.value;\r\n                    break;\r\n                case 'button-link-target':\r\n                    if (this.checked == true) {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_blank';\r\n                    } else {\r\n                        affectedEl.getElementsByTagName('a')[0].target = '_self';\r\n                    }\r\n                    break;\r\n                case 'button-color':\r\n                    break;\r\n                case 'list-alignment':\r\n                    var jc = '';\r\n                    if (this.value == 'left') {\r\n                        jc = 'flex-start';\r\n                    } else if (this.value == 'right') {\r\n                        jc = 'flex-end';\r\n                    } else {\r\n                        jc = 'center';\r\n                    }\r\n                    var articles = affectedEl.querySelectorAll('article');\r\n                    for (var i = 0; i < articles.length; i++) {\r\n                        articles[i].style.justifyContent = jc;\r\n                    }\r\n                    break;\r\n                case 'list-class':\r\n                    if (val == 'unordered') {\r\n                        event.target\r\n                            .parentNode\r\n                            .parentNode\r\n                            .querySelector('[data-type=list-style-type]')\r\n                            .parentNode\r\n                            .style\r\n                            .display = 'flex';\r\n                        document.querySelector('#wptb-list-icon-select-label').style.display = 'flex';\r\n                        var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                        for (var i = 0; i < bullets.length; i++) {\r\n                            bullets[i].style.listStyleType = 'disc';\r\n                        }\r\n                        document.querySelector('[data-type=list-style-type]').value = 'disc';\r\n                    } else {\r\n                        event.target\r\n                            .parentNode\r\n                            .parentNode\r\n                            .querySelector('[data-type=list-style-type]')\r\n                            .parentNode\r\n                            .style\r\n                            .display = 'none';\r\n                        document.querySelector('#wptb-list-icon-select-label').style.display = 'none';\r\n                        var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                        for (var i = 0; i < bullets.length; i++) {\r\n                            bullets[i].style.listStyleType = 'decimal';\r\n                        }\r\n                    }\r\n                    break;\r\n                case 'list-style-type':\r\n                    var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\r\n                    for (var i = 0; i < bullets.length; i++) {\r\n                        bullets[i].style.listStyleType = val.toLowerCase();\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n};","var WPTB_Image = function ( src, DOMElement ) {\r\n        if ( DOMElement == undefined ) {\r\n            var DOMElement = document.createElement('div'),\r\n\t    anchor = document.createElement('a'),\r\n\t    img = document.createElement('img');\r\n            anchor.style.display = 'inline-block';\r\n            anchor.appendChild(img);\r\n            DOMElement.appendChild(anchor);\r\n            \r\n            file_frame = wp.media.frames.file_frame = wp.media({\r\n\t\ttitle: 'Select a image to upload',\r\n\t\tbutton: {\r\n\t\t\ttext: 'Use this image'\r\n\t\t},\r\n\t\tmultiple: false\r\n            });\r\n            // When an image is selected, run a callback.\r\n            file_frame.on('select', function () {\r\n                    attachment = file_frame.state().get('selection').first().toJSON();\r\n                    img.src = attachment.url;\r\n            });\r\n            // Finally, open the modal\r\n            if (src == undefined) {\r\n                    file_frame.open();\r\n            } else {\r\n                    img.src = src;\r\n            }\r\n        } else {\r\n            var DOMElement = DOMElement.cloneNode( true );\r\n        }\r\n\t\r\n            \r\n        this.kind = 'image';\r\n        this.getDOMElement = function () {\r\n            return DOMElement;\r\n        };\r\n\tapplyGenericItemSettings( this );\r\n\r\n\treturn this;\r\n};","var WPTB_Initializer = function () {\r\n\r\n    const MIN_COLUMNS = 1,\r\n        MIN_ROWS = 1,\r\n        MAX_COLUMNS = 10,\r\n        MAX_ROWS = 10;\r\n\r\n    var tableGenerator = document.body;\r\n    columnsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[0],\r\n            columnsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[0],\r\n            rowsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[1],\r\n            rowsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[1],\r\n            columnsInput = document.getElementById('wptb-columns-number'),\r\n            rowsInput = document.getElementById('wptb-rows-number');\r\n\r\n    columnsDecrementButton.onclick = function () {\r\n            if (columnsInput.value > MIN_COLUMNS) {\r\n                    columnsInput.value--;\r\n            }\r\n    };\r\n\r\n    columnsIncrementButton.onclick = function () {\r\n            if (columnsInput.value < MAX_COLUMNS) {\r\n                    columnsInput.value++;\r\n            }\r\n    };\r\n\r\n    rowsDecrementButton.onclick = function () {\r\n            if (rowsInput.value > MIN_ROWS) {\r\n                    rowsInput.value--;\r\n            }\r\n    };\r\n\r\n    rowsIncrementButton.onclick = function () {\r\n            if (rowsInput.value < MAX_ROWS) {\r\n                    rowsInput.value++;\r\n            }\r\n    };\r\n\r\n    document.getElementById('wptb-generate-table').onclick = function () {\r\n            var columns = document.getElementById('wptb-columns-number').value,\r\n                rows = document.getElementById('wptb-rows-number').value;\r\n\r\n            WPTB_Table(columns, rows);\r\n    }\r\n\r\n};\r\n","var WPTB_LeftPanel = function () {\r\n\r\n    var table = document.getElementsByClassName('wptb-preview-table')[0],\r\n        wptbElementButtons = document.getElementsByClassName('wptb-element');\r\n\r\n    function hexToRgb(hex) {\r\n        var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n        return result ? 'rgb(' + parseInt(result[1], 16) + ',' + parseInt(result[2], 16) + ',' + parseInt(result[3], 16) + ')' : null;\r\n    }\r\n\r\n    jQuery('#wptb-even-row-bg').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableRows = table.getElementsByTagName('tr');\r\n            for (var i = 1; i < tableRows.length; i += 2) {\r\n                tds = tableRows[i].getElementsByTagName('td');\r\n                for (var j = 0; j < tds.length; j++) {\r\n                    tds[j].style.backgroundColor = ui.color.toString();\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    jQuery('#wptb-odd-row-bg').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableRows = table.getElementsByTagName('tr');\r\n            for (var i = 2; i < tableRows.length; i += 2) {\r\n                tds = tableRows[i].getElementsByTagName('td');\r\n                for (var j = 0; j < tds.length; j++) {\r\n                    tds[j].style.backgroundColor = ui.color.toString();\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    jQuery('#wptb-table-header-bg').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableHeader = table.getElementsByTagName('tr')[0],\r\n                tds = tableHeader.getElementsByTagName('td');\r\n            for (var j = 0; j < tds.length; j++) {\r\n                tds[j].style.backgroundColor = ui.color.toString();\r\n            }\r\n        }\r\n    });\r\n\r\n    jQuery('#wptb-table-border-color').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableCells = table.getElementsByTagName('td');\r\n            table.style.border = document.querySelector('#wptb-table-border-number').value + 'px solid ' + ui.color.toString();\r\n\r\n            for (var i = 0; i < tableCells.length; i++) {\r\n                tableCells[i].style.border = document.querySelector('#wptb-table-inner-border-number').value + 'px solid ' + ui.color.toString();\r\n            }\r\n        }\r\n    });\r\n\r\n    function addInnerBorderSize(value) {\r\n        var tableCells = table.getElementsByTagName('td');\r\n        for (var i = 0; i < tableCells.length; i++) {\r\n            tableCells[i].style.border = document.querySelector('#wptb-table-inner-border-number').value + 'px solid ' + hexToRgb(jQuery('#wptb-table-border-color').val());\r\n        }\r\n    }\r\n\r\n    function addCellPadding(value) {\r\n        var tableCells = table.getElementsByTagName('td');\r\n        for (var i = 0; i < tableCells.length; i++) {\r\n            tableCells[i].style.padding = value + 'px';\r\n        }\r\n    }\r\n\r\n    function addInnerBorder(checked) {\r\n        var styles, color = document.querySelector('#wptb-table-border-color').value != undefined ?\r\n            document.querySelector('#wptb-table-border-color').value : 'rgb(0,0,0)';\r\n\r\n        if (checked == 'checked') {\r\n            document.getElementById('wptb-apply-inner-border').style.marginBottom = '0px';\r\n            var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n            for (var i = 0; i < tableCells.length; i++) {\r\n                tableCells[i].style.border = '1px solid ' + color;\r\n            }\r\n            document.getElementById('wptb-inner-border-settings').classList.add('visible');\r\n        } else {\r\n            document.getElementById('wptb-inner-border-settings').classList.remove('visible');\r\n            var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n            for (var i = 0; i < tableCells.length; i++) {\r\n                tableCells[i].style.border = '0px solid ' + color;\r\n            }\r\n        }\r\n    }\r\n\r\n    function addBorderSize(value) {\r\n        table.style.border = value + 'px solid';\r\n    }\r\n\r\n    document.getElementById('wptb-table-cell-slider').oninput = function () {\r\n        document.getElementById('wptb-table-cell-number').value = this.value;\r\n        addCellPadding(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-cell-number').onchange = function () {\r\n        document.getElementById('wptb-table-cell-slider').value = this.value;\r\n        addCellPadding(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-border-slider').oninput = function () {\r\n        document.getElementById('wptb-table-border-number').value = this.value;\r\n        addBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-border-number').onchange = function () {\r\n        document.getElementById('wptb-table-border-slider').value = this.value;\r\n        addBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-inner-border-slider').oninput = function () {\r\n        document.getElementById('wptb-table-inner-border-number').value = this.value;\r\n        addInnerBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-table-inner-border-number').onchange = function () {\r\n        document.getElementById('wptb-table-inner-border-slider').value = this.value;\r\n        addInnerBorderSize(this.value);\r\n    };\r\n\r\n    document.getElementById('wptb-inner-border-check').onchange = function () {\r\n        var _val = this.checked ? 'checked' : 'unchecked';\r\n        addInnerBorder(_val);\r\n    };\r\n\r\n    for (var i = 0; i < wptbElementButtons.length; i++) {\r\n        wptbElementButtons[i].ondragstart = function (e) {\r\n            e.dataTransfer.setData('wptbElement', this.dataset.wptbElement);\r\n        }\r\n    }\r\n\r\n    document.getElementById('wptb-activate-cell-management-mode').onclick = table.toggleTableEditMode;\r\n    document.getElementById('wptb-add-end-row').onclick = table.addRowToTheEnd;\r\n    document.getElementById('wptb-add-start-row').onclick = table.addRowToTheStart;\r\n    document.getElementById('wptb-add-row-before').onclick = table.addRowBefore;\r\n    document.getElementById('wptb-add-row-after').onclick = table.addRowAfter;\r\n    document.getElementById('wptb-add-end-column').onclick = table.addColumnEnd;\r\n    document.getElementById('wptb-add-start-column').onclick = table.addColumnStart;\r\n    document.getElementById('wptb-add-column-before').onclick = table.addColumnBefore;\r\n    document.getElementById('wptb-add-column-after').onclick = table.addColumnAfter;\r\n    document.getElementById('wptb-delete-column').onclick = table.deleteColumn;\r\n    document.getElementById('wptb-delete-row').onclick = table.deleteRow;\r\n    document.getElementById('wptb-merge-cells').onclick = table.mergeCells;\r\n    document.getElementById('wptb-split-cell').onclick = table.splitCell;\r\n    document.getElementById('add-elements').onclick = function () {\r\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.remove('active');\r\n        document.getElementById('add-elements').getElementsByTagName('a')[0].classList.add('active');\r\n        document.getElementsByClassName('wptb-elements-container')[0].style.display = 'table';\r\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'block';\r\n        document.getElementById(\"element-options-group\").style.display = 'none';\r\n    };\r\n\r\n};","var WPTB_List = function ( innerElements, DOMElementProt ) {\r\n\r\n    var el_L = document.createElement('ul'), item,\r\n        DOMElement = document.createElement('div');\r\n\r\n    this.kind = 'list';\r\n\r\n    if (innerElements === '') {\r\n        //Case for edit mode list\r\n    } else if (!innerElements) {\r\n        for (var i = 0; i < 3; i++) {\r\n            item = new WPTB_ListItem( 'List Item ' + (i + 1) );\r\n            el_L.appendChild(item.getDOMElement());\r\n        }\r\n    } else {\r\n        for (var i = 0; i < innerElements.length; i++) {\r\n            item = new WPTB_ListItem( innerElements[i], DOMElementProt, true );\r\n            el_L.appendChild(item.getDOMElement());\r\n        }\r\n    }\r\n    DOMElement.appendChild(el_L);\r\n    //window.addElementOptions('list', elList);\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    }\r\n    applyGenericItemSettings(this);\r\n\r\n    return this;\r\n\r\n};","var WPTB_ListItem = function ( text, DOMElementProt, copy ) {\r\n    let wptbListItemReturn;\r\n    if ( DOMElementProt == undefined || ( DOMElementProt && copy )) {\r\n        if (text == undefined) text = 'New List Item';\r\n        var DOMElement = document.createElement('article'),\r\n            divdot = document.createElement('div'),\r\n            divcontent = document.createElement('div'),\r\n            libullet = document.createElement('li');\r\n        divdot.classList.add('wptb-list-item-style-dot');\r\n        divcontent.classList.add('wptb-list-item-content');\r\n        libullet.classList.add('wptb-bullet');\r\n        if ( DOMElementProt ) {\r\n            let styleDot = DOMElementProt.querySelector( '.wptb-bullet' ).getAttribute( 'style' )\r\n            libullet.setAttribute( 'style', styleDot );\r\n        }\r\n        DOMElement.appendChild(divdot);\r\n        DOMElement.appendChild(divcontent);\r\n        divdot.appendChild(libullet);\r\n        divcontent.innerHTML = text;\r\n        divcontent.onkeyup = window.listItemKeyListener;\r\n        \r\n        wptbListItemReturn = true;\r\n    } else {\r\n        var DOMElement = DOMElementProt;\r\n        var divdot = DOMElement.getElementsByClassName( 'wptb-list-item-style-dot' )[0], \r\n            divcontent = DOMElement.getElementsByClassName( 'wptb-list-item-content' )[0], \r\n            libullet = divdot.getElementsByClassName( 'wptb-bullet' )[0];\r\n    \r\n        divcontent.onkeyup = window.listItemKeyListener;\r\n        \r\n        wptbListItemReturn = false;\r\n    }\r\n    \r\n    DOMElement.onmouseenter = function (event) {\r\n\r\n        var btnDelete = document.createElement('span'),\r\n            btnCopy = document.createElement('span'),\r\n            actions = document.createElement('span'),\r\n            previous,\r\n            i;\r\n        actions.classList.add('wptb-actions');\r\n        btnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\r\n        btnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\r\n        this.classList.add('wptb-directlyhovered');\r\n\r\n        btnDelete.onclick = function () {\r\n            var item = this.parentNode.parentNode,\r\n                parent = item.parentNode;\r\n            parent.removeChild(item);\r\n        };\r\n\r\n        btnCopy.onclick = function (event) {\r\n            var article = event.target.parentNode.parentNode,\r\n                content = article.querySelector('.wptb-list-item-content'),\r\n                html = content.innerHTML;\r\n            var duplicate = new WPTB_ListItem( html, article, true );\r\n            article.parentNode.insertBefore( duplicate.getDOMElement(), DOMElement );\r\n        };\r\n\r\n        actions.append(btnCopy, btnDelete);\r\n        this.appendChild(actions);\r\n    };\r\n\r\n    DOMElement.onmouseleave = function (event) {\r\n        this.classList.remove('wptb-directlyhovered');\r\n        var actions = this.parentNode.querySelector('.wptb-actions');\r\n        if (actions != undefined) {\r\n            var parent = actions.parentNode;\r\n            parent.removeChild(actions);\r\n        }\r\n    };\r\n\r\n    divcontent.onkeydown = function (event) {\r\n        var key = event.which != undefined ? event.which : event.keyCode,\r\n            article = event.target.parentNode,\r\n            duplicate,\r\n            lastP;\r\n        if (key !== 13 || window.dontAddItems !== undefined && window.dontAddItems === true) {\r\n            return;\r\n        }\r\n        event.preventDefault();\r\n        duplicate = new WPTB_ListItem( this.innerHTML, article, true );\r\n        DOMElement.parentNode.insertBefore(duplicate.getDOMElement(), DOMElement);\r\n        setTimeout( function(){\r\n            divcontent.innerHTML = 'New List Item';\r\n        }, 5 );\r\n\r\n        return false;\r\n    };\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    };\r\n    \r\n    if ( wptbListItemReturn ) {\r\n        return this;\r\n    }\r\n};","var MultipleSelect = function () {\r\n\r\n\tvar selectedCells = [],\r\n\t\tmultipleCellMode = false;\r\n\r\n\tthis.activateMultipleSelectMode = function () {\r\n\t\tselectedCells = [];\r\n\t\tvar tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\ttds[i].classList.remove('wptb-highlighted');\r\n\t\t}\r\n\t\tmultipleCellMode = true;\r\n\t}\r\n\r\n\tthis.deactivateMultipleSelectMode = function () {\r\n\t\tmultipleCellMode = false;\r\n\t}\r\n\r\n\tthis.isActivated = function () {\r\n\t\treturn multipleCellMode;\r\n\t}\r\n\r\n\tthis.pushSelectedCell = function (cell) {\r\n\t\tif (!multipleCellMode) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tselectedCells.push(cell);\r\n\t\tcell.classList.add('wptb-highlighted');\r\n\t};\r\n\r\n\tthis.selectedCells = function () {\r\n\t\treturn selectedCells;\r\n\t}\r\n\r\n\tthis.flushSelectedCells = function () {\r\n\t\tselectedCells = [];\r\n\t}\r\n\r\n\tthis.getFirst = function () {\r\n\t\tvar minXIndex = 1000, minYIndex = 1000, first;\r\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\r\n\t\t\tif (minXIndex >= selectedCells[i].dataset.xIndex\r\n\t\t\t\t&& minYIndex >= selectedCells[i].dataset.yIndex) {\r\n\t\t\t\tfirst = selectedCells[i];\r\n\t\t\t\tminXIndex = selectedCells[i].dataset.xIndex;\r\n\t\t\t\tminYIndex = selectedCells[i].dataset.yIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn first;\r\n\t}\r\n\r\n\tthis.getLast = function () {\r\n\t\tvar maxXIndex = -1, maxYIndex = -1, last;\r\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\r\n\t\t\tif (maxXIndex <= selectedCells[i].dataset.xIndex\r\n\t\t\t\t&& maxYIndex <= selectedCells[i].dataset.yIndex) {\r\n\t\t\t\tlast = selectedCells[i];\r\n\t\t\t\tmaxXIndex = selectedCells[i].dataset.xIndex;\r\n\t\t\t\tmaxYIndex = selectedCells[i].dataset.yIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn last;\r\n\t}\r\n\r\n\tthis.removeAllButFirst = function () {\r\n\t\tvar td = this.getFirst();\r\n\t\tfor (var i = 1; i < selectedCells.length; i++) {\r\n\t\t\tselectedCells[i].classList.add('wptb-fused-cell-' + td.dataset.xIndex + '-' + td.dataset.yIndex);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};","var WPTB_Parser = function (code) {\r\n    if( Array.isArray( code ) ) {\r\n        let elementHtml;\r\n        \r\n        if ( code.length == 1) {\r\n            return elementHtml.appendChild( document.createTextNode( code[0] ) );\r\n        }\r\n        if( 0 in code ) {\r\n            let tagName = code[0];\r\n            elementHtml =  document.createElement( tagName );\r\n            \r\n            if ( 1 in code ) {\r\n                if( Array.isArray( code[1] ) ) {\r\n                    let attributes = code[1];\r\n                    \r\n                    for( let i = 0; i < attributes.length; i++ ) {\r\n                        if( Array.isArray( attributes[i] ) ) {\r\n                            elementHtml.setAttribute(attributes[i][0], attributes[i][1]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            if ( 2 in code ) {\r\n                if ( Array.isArray( code[2] ) ) {\r\n                    for ( let i = 0; i < code[2].length; i++ ) {\r\n                        if ( typeof code[2][i] === 'string' && tagName.toLowerCase() == 'p' ) {\r\n                            elementHtml.appendChild( document.createTextNode( code[2][i] ) );\r\n                            continue;\r\n                        }\r\n                        if ( ! WPTB_Parser( code[2][i] ) ) continue;\r\n                        elementHtml.appendChild( WPTB_Parser( code[2][i] ) );\r\n                    }\r\n                } else if( typeof code[2] === 'string' ) {\r\n                    elementHtml.appendChild( document.createTextNode( code[2] ) );\r\n                }\r\n                \r\n            }\r\n        }\r\n        \r\n        return elementHtml;\r\n    } else {\r\n        return false;\r\n    }\r\n    \r\n}","var WPTB_Settings = function () {\r\n\r\n\tvar elems = document.getElementsByClassName('wptb-element');\r\n\r\n\tfunction detectMode() {\r\n\t\tvar url = window.location.href,\r\n\t\t    regex = new RegExp('[?&]table(=([^&#]*)|&|#|$)'),\r\n\t\t    results = regex.exec(url);\r\n\t\tif (!results) return false;\r\n\t\tif (!results[2]) return '';\r\n\t\treturn decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n\t}\r\n\r\n\tfor (var i = 0; i < elems.length; i++) {\r\n\t\telems[i].ondragstart = function (event) {\r\n\t\t\tevent.dataTransfer.effectAllowed = 'move';\r\n\t\t\tevent.dataTransfer.setData('wptbElement', event.target.dataset.wptbElement);\r\n\t\t}\r\n\t};\r\n\r\n\tdocument.getElementsByClassName('wptb-save-btn')[0].onclick = function () {\r\n\t\tlet http = new XMLHttpRequest(),\r\n\t\t    url = ajaxurl + \"?action=save_table\",\r\n\t\t    t = document.getElementById('wptb-setup-name').value.trim(),\r\n\t\t    messagingArea,\r\n                    code = WPTB_Stringifier(document.getElementsByClassName('wptb-preview-table')[0], true);\r\n                    \r\n\t\tif (t === '') {\r\n\t\t\tmessagingArea = document.getElementById('wptb-messaging-area');\r\n\t\t\tmessagingArea.innerHTML = '<div class=\"wptb-error wptb-message\">Error: You must assign a name to the table before saving it.</div>';\r\n\t\t\tmessagingArea.classList.add('wptb-warning');\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tmessagingArea.removeChild(messagingArea.firstChild);\r\n\t\t\t}, 4000);\r\n\t\t\treturn;\r\n\t\t}\r\n                code = JSON.stringify( code );\r\n\t\tvar params = 'title=' + t + '&content=' + code;\r\n\r\n\t\tif ((rs = detectMode()) || (rs = document.wptbId)) {\r\n\t\t\tparams += '&id=' + rs;\r\n\t\t}\r\n\r\n\t\thttp.open('POST', url, true);\r\n\t\thttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n\t\thttp.onreadystatechange = function (action) {\r\n\t\t\tif (this.readyState == 4 && this.status == 200) {\r\n\r\n\t\t\t\tvar data = JSON.parse(http.responseText);\r\n\t\t\t\tmessagingArea = document.getElementById('wptb-messaging-area');\r\n\r\n\t\t\t\tif (data[0] == 'saved') {\r\n\t\t\t\t\tdocument.wptbId = data[1];\r\n\t\t\t\t\tmessagingArea.innerHTML = '<div class=\"wptb-success wptb-message\">Table \"' + t + '\" was successfully saved.</div>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmessagingArea.innerHTML = '<div class=\"wptb-success wptb-message\">Table \"' + t + '\" was successfully updated.</div>';\r\n\t\t\t\t}\r\n\t\t\t\tmessagingArea.classList.add('wptb-success');\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tmessagingArea.removeChild(messagingArea.firstChild);\r\n\t\t\t\t}, 4000);\r\n\t\t\t}\r\n\t\t}\r\n\t\thttp.send(params);\r\n\t}\r\n};\r\n","var WPTB_Space = function ( elSpaceBetween ) {\r\n\r\n    function newElementProxy(el) {\r\n        if (el.includes('list')) {\r\n            return new WPTB_List();\r\n        } else if (el.includes('image')) {\r\n            return new WPTB_Image();\r\n        } else if (el.includes('text')) {\r\n            return new WPTB_Text();\r\n        } else if (el.includes('button')) {\r\n            return new WPTB_Button();\r\n        }\r\n    }\r\n    let spaceBetween;\r\n    if ( ! elSpaceBetween ) {\r\n        spaceBetween = document.createElement('div'), spaceBetween.classList.add('wptb-space-between');\r\n    } else {\r\n        spaceBetween = elSpaceBetween;\r\n    }\r\n\r\n    spaceBetween.ondragenter = function () {\r\n        this.classList.add('visible');\r\n    };\r\n    spaceBetween.ondragover = function (event) {\r\n        event.preventDefault();\r\n    };\r\n\r\n    spaceBetween.ondragleave = function () {\r\n        this.classList.remove('visible');\r\n    };\r\n\r\n    spaceBetween.ondrop = function (event) {\r\n        event.stopPropagation();\r\n\r\n        var p = event.target.nextSibling,\r\n            td = event.target,\r\n            element, t_space, spaceParent;\r\n\r\n        while (!td.classList.contains('wptb-droppable')) {\r\n            td = td.parentNode;\r\n        }\r\n\r\n        if (event.dataTransfer.getData('wptbElement')) {\r\n            element = newElementProxy(event.dataTransfer.getData('wptbElement'));\r\n            this.classList.remove('visible');\r\n\r\n            if (p == null) {\r\n                td.appendChild(element.getDOMElement());\r\n                td.appendChild(new WPTB_Space());\r\n            } else {\r\n                td.insertBefore(element.getDOMElement(), p);\r\n                td.insertBefore(new WPTB_Space(), p);\r\n            }\r\n\r\n        } else {\r\n            alert(event.dataTransfer.getData('node'));\r\n            element = document.getElementsByClassName(event.dataTransfer.getData('node'))[0];\r\n            t_space = element.nextSibling;\r\n            spaceParent = element.parentNode;\r\n            if (t_space != undefined) {\r\n                spaceParent.removeChild(t_space);\r\n            }\r\n\r\n            if (p == null) {\r\n                td.appendChild(element);\r\n                td.appendChild(new WPTB_Space());\r\n            } else {\r\n                td.insertBefore(element, p);\r\n                td.insertBefore(new WPTB_Space(), p);\r\n            }\r\n\r\n        }\r\n        this.classList.remove('visible');\r\n    };\r\n    \r\n    if ( ! elSpaceBetween ) {\r\n        return spaceBetween;\r\n    }\r\n};","var WPTB_Stringifier = function ( node, start = false ) {\r\n\r\n\tif ( node == undefined ) {\r\n\t\treturn '';\r\n\t} else if ( node.tagName == undefined && node.nodeType == 3 ) {\r\n            return node.nodeValue;\r\n        }\r\n        \r\n        let code = [],\r\n            children,\r\n            int_elem_arr = false,\r\n            attributes = [...node.attributes],\r\n            attributes_list = [],\r\n            internal_elements = [];\r\n            if ( ( node.parentNode.classList.contains( 'wptb-list-item-content' ) || \r\n                node.parentNode.classList.contains( 'mce-content-body' ) ) && \r\n            node.tagName.toLowerCase() == 'p' ) {\r\n                children = node.childNodes;\r\n                int_elem_arr = true;\r\n            } else if( node.children.length > 0 ) {\r\n                children = node.children;\r\n            } else {\r\n                children = node.childNodes;\r\n            }\r\n        if ( attributes.length > 0 ) {\r\n            for ( let i = 0; i < attributes.length; i++ ) {\r\n                attributes_list[i] = [attributes[i].name, attributes[i].value];\r\n            }\r\n        } else {\r\n            attributes_list = '';\r\n        }\r\n        \r\n        if ( children.length > 0 ) {\r\n            for ( let i = 0; i < children.length; i++) {\r\n                let inter_elem = WPTB_Stringifier(children[i]);\r\n                    \r\n                if ( Array.isArray( inter_elem ) || int_elem_arr ) {\r\n                    internal_elements[i] = inter_elem;\r\n                } else if ( typeof inter_elem === 'string' && inter_elem ) {\r\n                    internal_elements = inter_elem;\r\n                }\r\n            }\r\n        } else {\r\n            internal_elements = '';\r\n        }\r\n        \r\n        \r\n        code.push(node.tagName.toLowerCase(), attributes_list , internal_elements);\r\n        \r\n        return code;\r\n}","var array = [], WPTB_Table = function (columns, rows) {\r\n\r\n\t/* The members of the class */\r\n\tvar settings = document.getElementsByClassName('wptb-settings-items'),\r\n\t    wptbTableSetup = document.getElementsByClassName(\"wptb-table-setup\")[0],\r\n            table, row, cell,\r\n\t    maxAmountOfCells,\r\n\t    maxAmountOfRows;\r\n\r\n\t//HERE ARE THE PRIVATE FUNCTIONS\r\n\t/*\r\n  * This function toggles buttons visibility in cell edit mode\r\n  * (according to the amount of currently selected cells), and\r\n  * highlights visually the clicked cell if it is not highlighted, or\r\n  * removes highlight if clicked cell is already highlighted. \r\n  * It too toggles the bits of our abstract representation.\r\n  * @param Event this is the event instance of the click performed over a cell.\r\n  */\r\n\tvar mark = function (event) {\r\n\t\tvar rs = this.rowSpan,\r\n\t\t    cs = this.colSpan,\r\n\t\t    markedCells,\r\n\t\t    noCells = document.getElementsByClassName('no-cell-action'),\r\n\t\t    singleCells = document.getElementsByClassName('single-action'),\r\n\t\t    multipleCells = document.getElementsByClassName('multiple-select-action'),\r\n\t\t    position = getCoords(this),\r\n\t\t    row = position[0],\r\n\t\t    column = position[1];\r\n\t\tif (!document.select.isActivated()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.className.match(/wptb-highlighted/)) {\r\n\t\t\tthis.classList.remove('wptb-highlighted');\r\n\t\t\tfor (var i = 0; i < rs; i++) {\r\n\t\t\t\tfor (var j = 0; j < cs; j++) {\r\n\t\t\t\t\tarray[row + i][column + j] = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.classList.add('wptb-highlighted');\r\n\t\t\tfor (var i = 0; i < rs; i++) {\r\n\t\t\t\tfor (var j = 0; j < cs; j++) {\r\n\t\t\t\t\tarray[row + i][column + j] = 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tmarkedCells = document.getElementsByClassName('wptb-highlighted').length;\r\n\t\tif (markedCells === 0) {\r\n\t\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\t\tnoCells[i].classList.add('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\t\tsingleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t} else if (markedCells === 1) {\r\n\t\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\t\tnoCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\t\tsingleCells[i].classList.add('visible');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\t\tif (table.isSquare(array)) {\r\n\t\t\t\t\tmultipleCells[i].classList.add('visible');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\t\tnoCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\t\tsingleCells[i].classList.remove('visible');\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t/* \r\n  * This function fills an array with 1's according to the actual design\r\n  * of HTML table.\r\n  * @returns an array of arrays containing an abstract representation\r\n  * of HTML table.\r\n  * @deprecated\r\n  * */\r\n\r\n\tvar realTimeArray = function () {\r\n\t\tvar carried = [], tds, cols, matriz = [];\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarried[i] = 0;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tcols = [];\r\n\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td');\r\n\r\n\t\t\tfor (items = 0; items < tds.length; items++) {\r\n\r\n\t\t\t\tfor (var k = 0; k < tds[items].colSpan; k++) {\r\n\t\t\t\t\tcols.push(1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (tds[items].rowSpan > 1) {\r\n\t\t\t\t\tfor (var k = 0; k < tds[items].colSpan; k++) {\r\n\t\t\t\t\t\tcarried[items + k] = {\r\n\t\t\t\t\t\t\tjustAssigned: true,\r\n\t\t\t\t\t\t\tamount: tds[items].rowSpan\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var k = 0; k < maxAmountOfCells; k++) {\r\n\t\t\t\tif ( typeof carried[k] == 'object' && carried[k].amount > 0 ) {\r\n\t\t\t\t\tcarried[k].amount--;\r\n\t\t\t\t\tif (carried[k].justAssigned) {\r\n\t\t\t\t\t\tcarried[k].justAssigned = false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcols.push(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tmatriz.push(cols);\r\n\r\n\t\t}\r\n\t\treturn matriz;\r\n\t};\r\n\r\n\t/*\r\n  * This function gets the number and position of cell spaces in current row that are occuped \r\n  * by upper rowspanned cells.\r\n  * @param number the number of row where we wish to calculate the carried rowspans up to.\r\n  * @return an array with the remaining rowspans in each column.\r\n  */\r\n\tvar carriedRowspans = function (row) {\r\n\t\tvar carried = [], tds, cols;\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarried[i] = 0;\r\n\t\t}\r\n\r\n\t\tif (row == -1) {\r\n\t\t\treturn carried;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i <= row; i++) {\r\n\t\t\tcellsBuffer = table.rows[i].getElementsByTagName('td');\r\n\t\t\tcellPointer = 0;\r\n\r\n\t\t\tfor (var xPosition = 0; xPosition < maxAmountOfCells; xPosition += stepsToMove) {\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (carried[xPosition]) {\r\n\t\t\t\t\tcarried[xPosition]--;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcelda = cellsBuffer[cellPointer++];\r\n\t\t\t\t\tif (celda.rowSpan > 1) {\r\n\t\t\t\t\t\tfor (k = 0; k < celda.colSpan; k++) {\r\n\t\t\t\t\t\t\tcarried[xPosition + k] = celda.rowSpan - 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstepsToMove = celda.colSpan;\r\n\t\t\t\t\t} else if (celda.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = celda.colSpan;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\treturn carried;\r\n\t};\r\n\r\n\t/*\r\n  * A helpful function for showing\r\n  * the abstract table in console.\r\n  * @param Array our abstract table.\r\n  */\r\n\tvar drawTable = function (a) {\r\n\t\tvar string = 'DRAWING TABLE:\\n';\r\n\t\tfor (var i = 0; i < a.length; i++) {\r\n\r\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\r\n\t\t\t\tstring += ' ' + a[i][j];\r\n\t\t\t}\r\n\t\t\tstring += '\\n';\r\n\t\t}\r\n\t\ttable.isSquare(a);\r\n\t};\r\n\r\n\t/*\r\n  * It resets all the bits of our abstract representation\r\n  * to 0 and removes the highlighting class of all cells.\r\n  */\r\n\r\n\tvar undoSelect = function () {\r\n\t\tvar noCells = document.getElementsByClassName('no-cell-action'),\r\n\t\t    singleCells = document.getElementsByClassName('single-action'),\r\n\t\t    multipleCells = document.getElementsByClassName('multiple-select-action'),\r\n\t\t    tds = table.getElementsByClassName('wptb-highlighted');\r\n\t\twhile (tds.length) {\r\n\t\t\ttds[0].classList.remove('wptb-highlighted');\r\n\t\t}\r\n\t\tfor (var i = 0; i < array.length; i++) {\r\n\t\t\tfor (var j = 0; j < array[i].length; j++) {\r\n\t\t\t\tarray[i][j] = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var i = 0; i < multipleCells.length; i++) {\r\n\t\t\tmultipleCells[i].classList.remove('visible');\r\n\t\t}\r\n\t\tfor (var i = 0; i < noCells.length; i++) {\r\n\t\t\tnoCells[i].classList.add('visible');\r\n\t\t}\r\n\t\tfor (var i = 0; i < singleCells.length; i++) {\r\n\t\t\tsingleCells[i].classList.remove('visible');\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n  * This fills the abstract representation of our table with \r\n  * zeros, at the start. the max amount of cells is the greatest sum\r\n  * of all colspans for row.\r\n  */\r\n\r\n\tvar fillTableArray = function () {\r\n\t\tvar colspansSums = [], a = [];\r\n\r\n\t\t//calculate max amount of cells inside a row\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar cells = table.rows[i].getElementsByTagName('td'),\r\n\t\t\t    colspanSumInRow = 0;\r\n\t\t\tfor (var j = 0; j < cells.length; j++) {\r\n\t\t\t\tcolspanSumInRow += cells[j].colSpan;\r\n\t\t\t}\r\n\t\t\tcolspansSums.push(colspanSumInRow);\r\n\t\t}\r\n\r\n\t\tmaxAmountOfCells = Math.max.apply(null, colspansSums);\r\n\t\t//calculate max rows\r\n\t\tvar maxAmountOfRows = table.rows.length;\r\n\r\n\t\t// fill with zeros from both values\r\n\t\tfor (var i = 0; i < maxAmountOfRows; i++) {\r\n\t\t\ta[i] = [];\r\n\t\t\tfor (var j = 0; j < maxAmountOfCells; j++) {\r\n\t\t\t\ta[i].push(0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdrawTable(a);\r\n\t\treturn a;\r\n\t};\r\n\r\n\t/*\r\n  * This function gets the sum of all colspans in a row.\r\n  * @param number the number of row to be used as reference.\r\n  */\r\n\tvar getActualPointsInRow = function (row) {\r\n\t\tvar tds = table.rows[row].getElementsByTagName('td'),\r\n\t\t    points = 0;\r\n\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\tpoints += tds[i].colSpan;\r\n\t\t}\r\n\t\treturn points;\r\n\t}\r\n\r\n\t/*\r\n  * This function gets us the exact coordinates of\r\n  * an exact cell, in a more reliable way than xIndex and yIndex,\r\n  * these last ones were meant to be used for getting the cell trough them.\r\n  * @param DOMElement the cell to get the coordinates.\r\n  */\r\n\tvar getCoords = function (search) {\r\n\t\tvar skipInCols = [], cell;\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tskipInCols[i] = 0;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar cellsBuffer = table.rows[i].getElementsByTagName('td');\r\n\t\t\tcellPointer = 0;\r\n\t\t\tfor (var xPosition = 0; xPosition < maxAmountOfCells; xPosition += stepsToMove) {\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (skipInCols[xPosition]) {\r\n\t\t\t\t\tskipInCols[xPosition]--;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar td = cellsBuffer[cellPointer++];\r\n\t\t\t\t\tif (td == search) {\r\n\t\t\t\t\t\treturn [i, xPosition];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (td.rowSpan > 1) {\r\n\t\t\t\t\t\tfor (k = 0; k < td.colSpan; k++) {\r\n\t\t\t\t\t\t\tskipInCols[xPosition + k] = td.rowSpan - 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstepsToMove = td.colSpan;\r\n\t\t\t\t\t} else if (td.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = td.colSpan;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tjQuery('#wptb-table-header-bg').val('');\r\n\tjQuery('#wptb-even-row-bg').val('');\r\n\tjQuery('#wptb-odd-row-bg').val('');\r\n\tjQuery('#wptb-table-border-color').val('');\r\n\tjQuery('#wptb-table-inner-border-number,#wptb-table-inner-border-slider').val('0');\r\n\tjQuery('#wptb-table-border-number,#wptb-table-border-slider').val('0');\r\n\tjQuery('#wptb-table-padding-number,#wptb-table-padding-slider').val('15');\r\n        \r\n        if ( columns || rows ) {\r\n            //END OF PRIVATE FUNCTIONS\r\n            for (var i = 0; i < settings.length; i++) {\r\n                    if (settings[i].id !== 'wptb-apply-inner-border') {\r\n                            settings[i].classList.add('visible');\r\n                    }\r\n            }\r\n\r\n            //Create a HTML Table element.\r\n            table = document.createElement('table');\r\n            table.classList.add('wptb-preview-table');\r\n\r\n            //Add the header row.\r\n            row = table.insertRow(-1);\r\n            row.classList.add('wptb-table-head', 'wptb-row');\r\n\r\n            for (var i = 0; i < columns; i++) {\r\n                    cell = new WPTB_Cell(mark);\r\n                    cell.setCoords(0, i);\r\n                    row.appendChild(cell.getDOMElement());\r\n            }\r\n\r\n            //Add the data rows.\r\n            for (var i = 1; i < rows; i++) {\r\n\r\n                    row = table.insertRow(-1);\r\n                    row.classList.add('wptb-row');\r\n\r\n                    for (var j = 0; j < columns; j++) {\r\n                            cell = new WPTB_Cell(mark);\r\n                            cell.setCoords(i, j);\r\n                            row.appendChild(cell.getDOMElement());\r\n                    }\r\n            }\r\n        } else {\r\n            let wptb_preview_table = document.getElementsByClassName( 'wptb-preview-table' );\r\n            \r\n            if ( wptb_preview_table.length > 0 ) {\r\n                table = wptb_preview_table[0];\r\n                \r\n                let cells = table.getElementsByTagName( 'td' );\r\n                \r\n                if ( cells.length > 0 ) {\r\n                    for ( let i = 0; i < cells.length; i++ ) {\r\n                        WPTB_Cell( mark, cells[i] );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\t\r\n\t/*\r\n  * This just toggles visibility of cell edit bar, and toggles \r\n  * cell selecting mode.\r\n  */\r\n\r\n\ttable.toggleTableEditMode = function () {\r\n\t\tvar bar = document.getElementById('edit-bar');\r\n\t\tif (bar.classList.contains('visible')) {\r\n\t\t\tdocument.select.deactivateMultipleSelectMode();\r\n\t\t\tbar.classList.remove('visible');\r\n\t\t} else {\r\n\t\t\tdocument.select.activateMultipleSelectMode();\r\n\t\t\tbar.classList.add('visible');\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n  * For assigning to each cell xIndex and y Index attributes,\r\n  * these are the column number and row number of cell in table. \r\n  */\r\n\r\n\ttable.recalculateIndexes = function () {\r\n\t\tvar trs = this.getElementsByTagName('tr'), tds, maxCols = 0;\r\n\r\n\t\tfor (var i = 0; i < trs.length; i++) {\r\n\t\t\ttds = trs[i].getElementsByTagName('td');\r\n\t\t\tfor (var j = 0; j < tds.length; j++) {\r\n\r\n\t\t\t\tif (i == 0) {\r\n\t\t\t\t\ttds[j].parentNode.className = '';\r\n\t\t\t\t\ttds[j].style.backgroundColor = jQuery('#wptb-table-header-bg').val();\r\n\t\t\t\t\ttds[j].parentNode.classList.add('wptb-row', 'wptb-table-head');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (i % 2 == 0) {\r\n\t\t\t\t\t\ttds[j].style.backgroundColor = jQuery('#wptb-odd-row-bg').val();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttds[j].style.backgroundColor = jQuery('#wptb-even-row-bg').val();\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttds[j].parentNode.className = '';\r\n\t\t\t\t\ttds[j].parentNode.classList.add('wptb-row');\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttds[j].dataset.xIndex = j;\r\n\t\t\t\ttds[j].dataset.yIndex = i;\r\n\t\t\t}\r\n\t\t\tif (j > maxCols) {\r\n\t\t\t\tmaxCols = j;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.columns = maxCols;\r\n\t}\r\n\r\n\t/*\r\n  * As simple as it is: adds a column to the end of table.\r\n  */\r\n\ttable.addColumnEnd = function () {\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\tarray[i].push(0);\r\n\t\t}\r\n\t\tmaxAmountOfCells++;\r\n\t\trecalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * As simple as it looks: adds a column to the start of table.\r\n  */\r\n\r\n\ttable.addColumnStart = function () {\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tfirstCell = table.rows[i].getElementsByTagName('td')[0];\r\n\t\t\tif (firstCell) {\r\n\t\t\t\ttable.rows[i].insertBefore(td.getDOMElement(), firstCell);\r\n\t\t\t} else {\r\n\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t}\r\n\t\t\tarray[i].push(0);\r\n\t\t}\r\n\r\n\t\tmaxAmountOfCells++;\r\n\t\trecalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Well, not so simple as previous functions.\r\n  * It adds a column after a certain column of reference.\r\n  * @param integer the column number to be used as reference.\r\n  *\tIf empty, then the first highlighted cell is used as reference.\r\n  */\r\n\r\n\ttable.addColumnAfter = function (c_pos) {\r\n\t\tvar rows = table.rows,\r\n\t\t    cellsBuffer,\r\n\t\t    cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    pos = c_pos != undefined && typeof c_pos === 'number' ? c_pos : getCoords(cell)[1],\r\n\t\t    pendingInsertion = false,\r\n\t\t    stepsToMove,\r\n                    td, bro,\r\n\t\t    carriedRowspans = [],\r\n\t\t    currentCell;\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarriedRowspans.push(0);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < rows.length; i++) {\r\n\t\t\tcellPointer = 0;\r\n\t\t\tcellsBuffer = rows[i].getElementsByTagName('td');\r\n\t\t\tpendingInsertion = false;\r\n\t\t\tfor (var xPosition = 0;\r\n\t\t\t\txPosition < maxAmountOfCells;\r\n\t\t\t\txPosition += stepsToMove) {\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (pendingInsertion) {\r\n\t\t\t\t\ttd = new WPTB_Cell(mark);\r\n\r\n\t\t\t\t\tif (currentCell && rows[i].contains(currentCell)) {\r\n\t\t\t\t\t\tbro = currentCell.nextSibling;\r\n\t\t\t\t\t\tif (bro) {\r\n\t\t\t\t\t\t\trows[i].insertBefore(td.getDOMElement(), bro);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\trows[i].appendChild(td.getDOMElement());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trows[i].insertBefore(td.getDOMElement(), cellsBuffer[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else if (carriedRowspans[xPosition] > 0) {\r\n\t\t\t\t\t// If no pending insertion, let's check if no rowspan from upper cells is pending in current position\r\n\t\t\t\t\tif (pos == xPosition) {\r\n\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurrentCell = cellsBuffer[cellPointer++];\r\n\t\t\t\t\tif (currentCell.rowSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = currentCell.colSpan;\r\n\t\t\t\t\t\tfor (var k = 0; k < currentCell.colSpan; k++) {\r\n\t\t\t\t\t\t\tcarriedRowspans[xPosition + k] = currentCell.rowSpan;\r\n\t\t\t\t\t\t\tif (xPosition + k == pos) {\r\n\t\t\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (currentCell.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = currentCell.colSpan;\r\n\t\t\t\t\t\tfor (var k = 0; k < currentCell.colSpan; k++) {\r\n\t\t\t\t\t\t\tif (xPosition + k == pos) {\r\n\t\t\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (xPosition == pos) {\r\n\t\t\t\t\t\tpendingInsertion = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var l = 0; l < maxAmountOfCells; l++) {\r\n\t\t\t\tif (carriedRowspans[l] > 0)\r\n\t\t\t\t\tcarriedRowspans[l]--;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < array.length; i++) {\r\n\t\t\tarray[i].push(0);\r\n\t\t}\r\n\t\tmaxAmountOfCells++;\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\r\n\t};\r\n\r\n\t/*\r\n  * For preventing us to take a lot of time,\r\n  * This is just calling the function addColumnAfter, but\r\n  * using the previous column to current one as reference.\r\n  * @see addColumnAfter\r\n  */\r\n\r\n\ttable.addColumnBefore = function () {\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    pos = getCoords(cell)[1];\r\n\r\n\t\tif (pos === 0) {\r\n\t\t\ttable.addColumnStart();\r\n\t\t} else {\r\n\t\t\ttable.addColumnAfter(pos - 1);\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n  * Luckily, thisfunction is simple, \r\n  * it just add a row to the end of table.\r\n  */\r\n\r\n\ttable.addRowToTheEnd = function () {\r\n\t\tvar r = table.insertRow(-1),\r\n\t\t    td,\r\n\t\t    aux;\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Yet another simple function, \r\n  * it just add a row to the start of table.\r\n  */\r\n\r\n\ttable.addRowToTheStart = function () {\r\n\t\tvar r = table.insertRow(0);\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/* \r\n  * This function adds a row before the current one.\r\n  * Since the biggest factor of problem is a not-started but ongoing rowspan,\r\n  * the most of the troubles is not here.\r\n  */\r\n\r\n\ttable.addRowBefore = function () {\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    row = getCoords(cell)[0],\r\n\t\t    r = table.insertRow(row),\r\n\t\t    aux,\r\n\t\t    rowspans = carriedRowspans(row - 1);\r\n\r\n\t\tnoPending = rowspans.filter(function (elem) {\r\n\t\t\treturn elem == 0;\r\n\t\t});\r\n\r\n\t\tfor (var i = 0; i < noPending.length; i++) {\r\n\t\t\tvar td = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\r\n\t\tarr = realTimeArray();\r\n\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\r\n\t\t\tif (arr[i].length > maxAmountOfCells) {\r\n\t\t\t\t//Still not watched\r\n\t\t\t}\r\n\r\n\t\t\tif (arr[i].length < maxAmountOfCells) {\r\n\r\n\t\t\t\tfor (var j = arr[i].length; j < maxAmountOfCells; j++) {\r\n\t\t\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Well... by the name convention of the previous 3 functions,\r\n  * it's pretty obvious that this functions attaches a new\r\n  * row after highlighted cell row. The greatest obstacle it was\r\n  * the possibility of a TR not having the exact amount of columns\r\n  * occuped by actual node but rowspanned upper cells. For that purpose\r\n  * it was created the function realTimeArray.\r\n  * @see realTimeArray\r\n  */\r\n\r\n\ttable.addRowAfter = function () {\r\n\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    row = getCoords(cell)[0],\r\n\t\t    r = table.insertRow(row + 1),\r\n\t\t    aux,\r\n\t\t    rowspans = carriedRowspans(row);\r\n\r\n\t\tnoPending = rowspans.filter(function (elem) {\r\n\t\t\treturn elem == 0;\r\n\t\t});\r\n\r\n\t\tfor (var i = 0; i < noPending.length; i++) {\r\n\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\tr.appendChild(td.getDOMElement());\r\n\t\t}\r\n\r\n\t\tarr = realTimeArray();\r\n\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\r\n\t\t\tif (arr[i].length > maxAmountOfCells) {\r\n\t\t\t\t//Still not watched\r\n\t\t\t}\r\n\r\n\t\t\tif (arr[i].length < maxAmountOfCells) {\r\n\r\n\t\t\t\tfor (var j = arr[i].length; j < maxAmountOfCells; j++) {\r\n\t\t\t\t\ttd = new WPTB_Cell(mark);\r\n\t\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taux = Array.from(array[0]);\r\n\t\tarray.push(aux);\r\n\t\tdrawTable(array);\r\n\t\ttable.recalculateIndexes();\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * This function checks the current selected cells\r\n  * make a rectangular shape.\r\n  * @param Array the abstract table.\r\n  * @return false, if not making a rectangle, or\r\n  *\tArray an array containing number of rows and columns, if selection makes a rectangle.\r\n  */\r\n\r\n\ttable.isSquare = function (a) {\r\n\t\tvar rowStart = -1,\r\n\t\t    columnStart = -1,\r\n\t\t    rowEnd = -1,\r\n\t\t    columnEnd = -1,\r\n\t\t    height,\r\n\t\t    width,\r\n\t\t    itemsEstimate = 0,\r\n\t\t    items = 0;\r\n\r\n\t\tfor (var i = 0; i < a.length; i++) {\r\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\r\n\t\t\t\tif (a[i][j] == 1) {\r\n\t\t\t\t\trowStart = i;\r\n\t\t\t\t\tcolumnStart = j;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (rowStart !== -1 && columnStart !== -1) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = a.length - 1; i > -1; i--) {\r\n\t\t\tfor (var j = a[i].length - 1; j > -1; j--) {\r\n\t\t\t\tif (a[i][j] == 1) {\r\n\t\t\t\t\trowEnd = i;\r\n\t\t\t\t\tcolumnEnd = j;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (rowEnd !== -1 && columnEnd !== -1) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = rowStart; i < rowEnd; i++) {\r\n\t\t\tfor (var j = columnStart; j < columnEnd; j++) {\r\n\t\t\t\tif (a[i][j] == 0 || a[i][j] == undefined) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < a.length; i++) {\r\n\t\t\tfor (var j = 0; j < a[i].length; j++) {\r\n\t\t\t\tif (a[i][j] == 1) {\r\n\t\t\t\t\titems++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\theight = rowEnd - rowStart + 1;\r\n\t\twidth = columnEnd - columnStart + 1;\r\n\t\titemsEstimate = height * width;\r\n\r\n\t\tif (itemsEstimate !== items) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn [height, width];\r\n\t};\r\n\r\n\t/*\r\n  * This function merges all selected cells.\r\n  * Well, actually sets the colspan and rowspan of first \r\n  * upper left  cell in selection and deletes the another selected cells.\r\n  */\r\n\r\n\ttable.mergeCells = function () {\r\n\t\tvar dimensions = table.isSquare(array),\r\n\t\t    rowspan = dimensions[0],\r\n\t\t    colspan = dimensions[1],\r\n\t\t    first = document.querySelector('.wptb-highlighted'),\r\n\t\t    tds = [].slice.call(document.getElementsByClassName('wptb-highlighted'), 1);\r\n\r\n\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\tvar p = tds[i].parentNode;\r\n\t\t\tp.removeChild(tds[i]);\r\n\t\t}\r\n\r\n\t\tfirst.colSpan = colspan;\r\n\t\tfirst.rowSpan = rowspan;\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * This functions makes the exact inverse as above.\r\n  * It resets colspan and rowspan and appends \r\n  * the same amount in cells to the table.\r\n  * @bug\r\n  */\r\n\r\n\ttable.splitCell = function () {\r\n\t\tvar cell = document.getElementsByClassName('wptb-highlighted')[0],\r\n\t\t    rowspan = cell.rowSpan,\r\n\t\t    colspan = cell.colSpan;\r\n\t\tcell.rowSpan = 1;\r\n\t\tcell.colSpan = 1;\r\n\t\ttable.addLackingCells();\r\n\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\t/*\r\n  * Searches for rowspanned cells up to row number meeting it.\r\n  * @param number the number of row where the function\r\n  * must search up to.\r\n  */\r\n\r\n\ttable.findRowspannedCells = function (row) {\r\n\t\tvar array = [],\r\n\t\t    difference;\r\n\t\tactualPoints = getActualPointsInRow(row);\r\n\t\tif (actualPoints === maxAmountOfCells) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tdifference = maxAmountOfCells - actualPoints;\r\n\r\n\t\tfor (var i = row - 1; i >= 0 && difference; i--) {\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td');\r\n\t\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\t\tif (tds[i].rowSpan > 1) {\r\n\t\t\t\t\tarray.push(tds[i]);\r\n\t\t\t\t\tdifference -= tds[i].colSpan;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn array;\r\n\r\n\t}\r\n\r\n\t/*\r\n  * This function explores the table and adds \r\n  * a cell for each lacking one for each row\r\n  * to meet an even amount of cells.\r\n  */\r\n\r\n\ttable.addLackingCells = function () {\r\n\t\tvar sumRows = [];\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tsumRows.push(0);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td');\r\n\t\t\tfor (var j = 0; j < tds.length; j++) {\r\n\t\t\t\tif (tds[j].rowSpan > 1) {\r\n\t\t\t\t\tfor (var k = 1; k < tds[j].rowSpan; k++) {\r\n\t\t\t\t\t\tsumRows[i + k]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tvar tds = table.rows[i].getElementsByTagName('td'),\r\n\t\t\t    totalColspan = 0;\r\n\t\t\tfor (var j = 0; j < tds.length; j++) {\r\n\t\t\t\ttotalColspan += tds[j].colSpan;\r\n\t\t\t}\r\n\t\t\ttotalColspan += sumRows[i];\r\n\t\t\tdifference = maxAmountOfCells - totalColspan;\r\n\t\t\tfor (var j = 0; j < difference; j++) {\r\n\t\t\t\tvar td = new WPTB_Cell(mark);\r\n\t\t\t\ttable.rows[i].appendChild(td.getDOMElement());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/*\r\n  * This function deletes the row of currently\r\n  * selected cell. \r\n  */\r\n\r\n\ttable.deleteRow = function () {\r\n\r\n\t\tvar cell = document.querySelector('.wptb-highlighted'),\r\n\t\t    row = getCoords(cell)[0],\r\n\t\t    reduct = table.findRowspannedCells(row);\r\n\r\n\t\tfor (i = 0; i < reduct.length; i++) {\r\n\t\t\treduct[i].rowSpan--;\r\n\t\t}\r\n\r\n\t\ttable.getElementsByTagName('tbody')[0].removeChild(table.rows[row]);\r\n\t\tarray.pop();\r\n\t\tundoSelect();\r\n\t\ttable.addLackingCells();\r\n\t}\r\n\r\n\t/*\r\n  * This function deletes the column of currently\r\n  * selected cell. Again, this is way more complicated than\r\n  * delete row case.\r\n  */\r\n\r\n\ttable.deleteColumn = function () {\r\n\r\n\t\tvar cell_ref = document.querySelector('.wptb-highlighted'),\r\n\t\t    column = getCoords(cell_ref)[1],\r\n                    buffer, cell,\r\n\t\t    carriedRowspans = [];\r\n\r\n\t\tfor (var i = 0; i < maxAmountOfCells; i++) {\r\n\t\t\tcarriedRowspans.push(0);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tbuffer = table.rows[i].getElementsByTagName('td');\r\n\t\t\tstepsToMove = 1;\r\n\t\t\tcellPointer = 0;\r\n\t\t\tfor (var j = 0; j < maxAmountOfCells; j += stepsToMove) {\r\n\r\n\t\t\t\tstepsToMove = 1;\r\n\r\n\t\t\t\tif (carriedRowspans[j] == 0) {\r\n\t\t\t\t\tcell = buffer[cellPointer++];\r\n\t\t\t\t\tif (cell.rowSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = cell.colSpan;\r\n\t\t\t\t\t\tfor (var k = 0; k < cell.colSpan; k++) {\r\n\t\t\t\t\t\t\tcarriedRowspans[j + k] = cell.rowSpan;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (column > j && column <= j + k - 1) {\r\n\t\t\t\t\t\t\t//cell.style.backgroundColor = 'pink';\r\n\t\t\t\t\t\t\tcell.colSpan--;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (cell.colSpan > 1) {\r\n\t\t\t\t\t\tstepsToMove = cell.colSpan;\r\n\r\n\t\t\t\t\t\tif (column > j && column <= j + cell.colSpan - 1) {\r\n\t\t\t\t\t\t\t//cell.style.backgroundColor = 'pink';\r\n\t\t\t\t\t\t\tcell.colSpan--;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (column == j) {\r\n\t\t\t\t\t\t\ttable.rows[i].removeChild(cell);\r\n\t\t\t\t\t\t\t//cell.style.backgroundColor = 'pink';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var l = 0; l < carriedRowspans.length; l++) {\r\n\t\t\t\tif (carriedRowspans[l] > 0) {\r\n\t\t\t\t\tcarriedRowspans[l]--;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\tmaxAmountOfCells--;\r\n\r\n\t\tfor (var i = 0; i < table.rows.length; i++) {\r\n\t\t\tif (array[i] != undefined)\r\n\t\t\t\tarray[i].pop();\r\n\t\t}\r\n\t\tundoSelect();\r\n\t};\r\n\r\n\tdocument.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\r\n\r\n\tarray = fillTableArray();\r\n\r\n\tundoSelect();\r\n\tdrawTable(array);\r\n\r\n\twptbTableSetup.appendChild(table);\r\n\r\n\ttable.recalculateIndexes();\r\n\r\n\tWPTB_LeftPanel();\r\n\r\n};","var WPTB_Text = function ( text , DOMElementProt ) {\r\n            var DOMElement = document.createElement('div'),\r\n                elText2 = document.createElement('div'),\r\n                elP = document.createElement('p');\r\n\r\n            elText2.classList.add('editable');\r\n            elP.innerHTML = text != undefined ? text : 'Text';\r\n            elText2.appendChild(elP);\r\n            DOMElement.appendChild(elText2);\r\n        if ( DOMElementProt ) {\r\n            var attributes = [...DOMElementProt.attributes];\r\n            for( let i = 0; i < attributes.length; i++ ) {\r\n                DOMElement.setAttribute(attributes[i].name, attributes[i].value);\r\n            }\r\n        } \r\n\r\n\tthis.kind = 'text';\r\n\tthis.getDOMElement = function () {\r\n            return DOMElement;\r\n\t};\r\n\tapplyGenericItemSettings( this );\r\n\r\n\treturn this;\r\n        \r\n};"]}