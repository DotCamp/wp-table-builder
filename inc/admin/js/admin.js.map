{"version":3,"sources":["applyGenericItemSettings.js","wptb-builder.js","WPTB_ActionsField.js","WPTB_Builder.js","WPTB_Button.js","WPTB_Cell.js","WPTB_DropHandle.js","WPTB_ElementCounters.js","WPTB_ElementOptions.js","WPTB_Helper.js","WPTB_Image.js","WPTB_Initializer.js","WPTB_innerElementSet.js","WPTB_ItemObject.js","WPTB_LeftPanel.js","WPTB_List.js","WPTB_ListItem.js","WPTB_MultipleSelect.js","WPTB_Parser.js","WPTB_Parser2.js","WPTB_Settings.js","WPTB_Space.js","WPTB_StarRating.js","WPTB_Stringifier.js","WPTB_Stringifier2.js","WPTB_Table.js","WPTB_TableStateSaveManager.js","WPTB_Text.js"],"names":["applyGenericItemSettings","element","kindIndexProt","copy","node","getDOMElement","index","listItems","undefined","document","counter","nextIndex","kind","wptbElements","getElementsByClassName","elementIndexesArr","i","length","regex","RegExp","infArr","className","match","push","elementIndexMax","Math","max","kindIndexProtArr","split","WPTB_Helper","wptbItemStartScript","onmouseenter","event","target","classList","contains","wptbDocumentEventGenerate","wptbActionsField","WPTB_ActionsField","addActionField","setParameters","remove","a","querySelector","onclick","e","preventDefault","buttonsTinyMceInit","listItemsTinyMceInit","onmouseleave","wptbActions","type","leaveFromField","ratingStars","ratingStar","starRatingEventHandlersAdd","ritingStarZeroSet","ulStarList","findAncestor","children","node_wptb_element_kind_num","add","WPTB_ElementOptions","increment","actionType","thisNode","body","getElementsByTagName","actions","previousNode","activeElem","parentNode","removeChild","btnDelete","btnCopy","btnMove","createElement","draggable","appendChild","act","el","thisRow","table","dataTitleColumnSet","actionsRemove","wptbTableStateSaveManager","WPTB_TableStateSaveManager","tableStateSet","activeElement","activeElementClone","cloneNode","td","temp","srcList","querySelectorAll","innerHTML","WPTB_List","insertBefore","nextSibling","data","elemProt","WPTB_ItemObject","WPTB_Image","text","childNodes","WPTB_Button","WPTB_StarRating","WPTB_innerElementSet","ondragstart","dragImagesArr","dataTransfer","effectAllowed","setDragImage","setData","actionsHide","style","display","previous","append","wptbDirectlyhovered","action","item","parent","listItemsRecalculateIndex","coordinatesElement","getBoundingClientRect","coordinatesElementTopBegin","top","listItem","content","html","duplicate","WPTB_ListItem","firstChild","divcontent","setTimeout","coordinatesElementTopEnd","wptbContainer","correctTop","parseFloat","removeEventListener","left","right","clientWidth","addEventListener","relatedTarget","localName","opacity","WPTB_Builder","table_id","detectMode","http","XMLHttpRequest","urlSet","ajaxurl","open","setRequestHeader","onreadystatechange","d","readyState","status","ans","JSON","parse","responseText","getElementById","value","wptbTableSetupEl","WPTB_Parser","WPTB_Table","WPTB_LeftPanel","WPTB_Settings","send","ElementCounters","select","MultipleSelect","initializer","WPTB_Initializer","settings","DOMElementProt","DOMElement","elButton","el_B","el_BDiv","el_BDivP","wptbElementMutch","Array","isArray","attributesContainer","attributes","setAttribute","name","wptbButtonWrapper","wptbButtonWrapAttributes","wptbButtonA","wptbButtonAttributes","wptbButton","WPTB_Cell","callback","highlightRow","parentRow","columnCount","parseInt","tds","classToAdd","ttd","highlightColumn","rowCount","tr","padding","jQuery","val","innerBorderWidth","border","wptbPhElement","wptbSpaceBetween","j","WPTB_Space","wptbElementTypeClass","wptbTypeElementArr","wptbListItems","setCoords","y","x","dataset","yIndex","xIndex","getCoords","coords","appendElement","getCellDimensions","tdStyleObj","window","getComputedStyle","tdPaddingLeft","getPropertyValue","tdPaddingRight","tdBorderLeftWidth","tdBorderRightWidth","tdPaddingTop","tdPaddingBottom","tdBorderTopWidth","tdBorderBottomWidth","width","offsetWidth","height","offsetHeight","WPTB_DropHandle","thisElem","wptbDropHandle","wptbDropBorderMarker","wptbDropBorderMarkerTop","wptbDropBorderMarkerRight","wptbDropBorderMarkerBottom","wptbDropBorderMarkerLeft","ondragenter","ondragover","ondragleave","ondrop","getData","newElementProxy","wptbMovingMode","getDOMParentElement","nodeName","toLowerCase","innerElement","innerElementNext","elemType","onscroll","indics","types","notDragEnter","indexOf","elementDrag","offsetY","layerY","bottom","priv","key","elemIdClass","prop","properties","affectedEl","wptbSize","b","buttonAlignment","justifyContent","selectOptionVal","elementButtonAlignmentSelect","getAttribute","buttonHref","buttonLinkTarget","buttonId","buttonHrefInput","buttonLinkTargetInput","buttonLinkTargetInputId","buttonLinkTargetInputLabel","buttotIdInput","checked","buttonTextColor","color","buttonColor","backgroundColor","buttonTextColorInput","buttonBackgroundColorInput","rgbToHex","elementsA","imgAlign","float","imageAlignmentSelect","imageLinkHref","inputImageLink","imageLinkTarget","imageLinkTargetInput","imageLinkTargetInputId","imageLinkTargetInputLabel","imgWidth","imageWidthInputRange","imageWidthInputNumber","img","imgAlternativeText","imageAlternativeTextInput","elementList","elementListColor","listColorInput","elementListItem","listItemP","listItemPClasses","elementListClassSelect","listIconSelectLabel","nodeType","listIconSelectLabelId","elementListStyleTypeSelect","elementListItemContent","listItemPTextAlignArr","p","textAlign","listItemPTextAlignLeftCount","listItemPTextAlignCenterCount","listItemPTextAlignRightCount","elementListAlignmentSelect","maxListItemTAlLeftC","wptbListAlignmentValue","wptbRatingAlignment","ratingStarSize","starSizeInputRange","starSizeInputNumber","starColorInput","ratingStarColor","fill","starsCountInputNumber","successBox","showNumberRatingCheckbox","numeralRatingOptionContainers","wptbTextMessage","numberRatingSize","fontSize","numberRatingColor","numberSizeInputRange","numberSizeInputNumber","numberColorInput","optionsClass","wptbContrlStacksConfigId","tmplControlsConfig","wp","template","wrapper","jsonControlsConfigJson","jsonControlsConfig","wptbElementOptionsContainer","elementOptionsGroup","elementOptionsGroupChildren","elem","Object","keys","forEach","tmplControlTemplate","targetInputAddClass","selectors","selector","cssSetting","replace","trim","controlTemplate","wptbElementOptionContainer","helperJavascriptElem","helperJavascriptCode","innerText","script","buttons","size","n_Class","num","star_alignment","list_alignment","button_alignment","jc","image_alignment","image_alignment_value","optionControls","wpColorPicker","change","ui","wpColorPickerChange","wpColorPickerCheckChangeForTableStateSaving","clear","numberImputSize","slider","oninput","onchange","src","alt","href","linkHttpCheckChange","rel","removeAttribute","id","parentNodeSettingItem","span","wptbNumeralRatingOptionContainer","starRatingTextMessageChenge","wptbTextMessageSize","lineHeight","starRatings","starRatingsCount","difference","starRatingsLast","newStarRating","starRatingLength","onmouseup","hexToRgb","hex","result","exec","rgb","toString","slice","getDragImageCustom","hostName","location","protocol","hostname","image","button","list","star_rating","ulElem","par","listStyleTypeIndex","Number","tinyMCE","init","inline","plugins","dialog_type","theme","menubar","fixed_toolbar_container","paste_as_text","toolbar","setup","ed","on","article","keyCode","pText","selectedText","getSelectionText","wptbListItem","onblur","init_instance_callback","editor","currentEditor","totalWidth","scrollTop","bodyElement","position","wptbButtonContainer","link","linkArr","linkClean","rows","rowHead","computedStyleRowHead","rowHeadChildren","contentsForHeader","tdElements","textContent","thisRowChildren","wptbTitleColumn","wptbTitleColumnFontSize","wptbTitleColumnColor","wptbTitleBackgroundColor","wptbTitleAlign","cls","parentElement","txt","getSelection","selection","createRange","settingsPanelClear","wpColorPickerClear","elementOptionsPanelClear","originalEvent","wpPickerContainer","irisSquareHandle","uiSliderHandle","attribute","isId","input","newInput","url","results","decodeURIComponent","getColumnWidth","cell","xIndexes","cellWidth","getRowHeight","yIndexes","cellHeight","WPTB_Text","uiColor","classe","ps","number","starRatingSelectHoverSet","starRating","onStar","onmouseover","stopPropagation","onmouseout","wptbStarRatingContainer","wptbNumberInputs","maxCount","maxValue","onkeydown","thisValue","String","substring","onkeyup","starRatingContainer","ratingNumber","wptbTextMessageCommon","wptbTextMessageCommonVal","ucfirst","str","charAt","toUpperCase","wpTemplatesHandler","wp_enqueue_script","eventCustom","Event","bubbles","dispatchEvent","wpTemplateId","elemClass","itemScriptText","scriptNew","elImage","anchor","file_frame","media","frames","title","multiple","frame","imageSetting","attachment","imgSrc","state","props","toJSON","get","first","menuItemVisibility","MIN_COLUMNS","MIN_ROWS","MAX_COLUMNS","MAX_ROWS","tableGenerator","columnsDecrementButton","columnsIncrementButton","rowsDecrementButton","rowsIncrementButton","columnsInput","rowsInput","columns","div","classId","itemHtml","wptbElementButtons","wptbTdBgColorSavedSet","inputId","trNumber","tableRows","trBackgroundColor","wptbEvenRowBg","console","log","tableHeader","tableAdaptiveForMobile","wptbAdaptiveTableCheckbox","wptbAdaptiveTable","tableTopRowAsHeadSavedSet","wptbTopRowAsHeader","tableBorderColorWidthSavedSet","tableBorderColor","borderColor","tableBorderColorInput","tableBorderWidth","borderWidth","wptbTableBorderWidthSlider","wptbTableBorderWidthNumber","tableTd","applyInnerBorder","innerBorderCheckInput","wptbApplyInnerBorder","wptbTableInnerBorderSlider","wptbTableInnerBorderNumber","tableCells","tableInnerborderNumber","addInnerBorderSize","borderStyle","addCellPadding","addInnerBorder","styles","wptbPreviewTable","marginBottom","addBorderSize","cellPaddingSavedSet","wptbTableCellSlider","wptbTableCellNumber","wptbTableBorderNumber","wptbTextfontSizeNumber","wptbImageWidthNumber","wptbTableColumnWidthNumber","wptbTableRowHeightNumber","tdDefaultWidth","wptbInnerBorderCheck","tableBorderColorSetArea","addColumnWidth","highlighted","addRowHeight","createMobileHeadForTable","thisEvent","wptbElement","toggleTableEditMode","addRowToTheEnd","addRowToTheStart","addRowBefore","addRowAfter","addColumnEnd","addColumnStart","addColumnBefore","addColumnAfter","deleteColumn","deleteRow","mergeCells","splitCell","wptbBuilderPanel","clickOnFreeSpace","wptbHeader","wpcdFixedToolbar","hasAttribute","innerElements","el_L","wptbListItemReturn","styleDot","listItemKeyListener","selectedCells","multipleCellMode","activateMultipleSelectMode","deactivateMultipleSelectMode","isActivated","pushSelectedCell","flushSelectedCells","getFirst","minXIndex","minYIndex","getLast","maxXIndex","maxYIndex","last","removeAllButFirst","code","columnTitleMobile","WPTB_Parser2","elementHtml","createTextNode","tagName","elems","ondragend","wptbUndo","tableStateGet","wptbUndoredo","wptbUndoRedoContainer","wptbRedo","shortcodePopupWindow","onbeforeunload","wptbSaveDisabled","wptbTableStateNumberSave","wptbTableStateNumberShow","bar","wptb_admin_object","t","messagingArea","WPTB_Stringifier","outerHTML","messagingAreaText","params","security_code","rs","wptbId","stringify","wptbPreviewBtn","wptbPreviewBtnHref","previewHref","wptbSaveBtn","elSpaceBetween","includes","spaceBetween","t_space","spaceParent","alert","countStarts","ratingStarsBox","ratingStarsList","textMessage","filledRatingStarHtml","notFilledRatingStarHtml","halfFilledRatingStarHtml","ratingStarZeroSet","wptbRatingStarsBox","wptbRatingStarsBoxAttributes","wptbRatingStarsOld","wptbRatingStars","iMax","wptbRatingStarsAttributes","wptbRatingStarsOldSpan","wptbRatingStarsSpan","k","wptbRatingStarsOldSpanAttributes","l","wptbRatingStarsOldSvg","wptbRatingStarsOldSvgStyle","wptbSuccessBox","wptbSuccessBoxAttributes","wptbTextMessageAttributes","codeMain","tableColumns","minWidth","maxWidth","mceContentBodys","dataMceStyle","contentEditable","spellCheck","mceIds","wptbActionsLength","columnNameDivContainer","columnNameDiv","WPTB_Stringifier2","start","nodeValue","int_elem_arr","attributes_list","internal_elements","inter_elem","array","wptbTableSetup","row","maxAmountOfCells","maxAmountOfRows","mark","rowSpan","cs","colSpan","markedCells","noCells","singleCells","multipleCells","cellSettings","column","cellHighlighted","wptbTableColumnWidthSlider","tableColumnWidthAutoFixedCheckbox","wptbFixedWidth","wptbTableRowHeightSlider","tableRowHeightAutoFixedCheckbox","wptbFixedHeight","isSquare","realTimeArray","carried","cols","matriz","items","justAssigned","amount","carriedRowspans","cellsBuffer","cellPointer","xPosition","stepsToMove","celda","drawTable","string","undoSelect","fillTableArray","colspansSums","cells","colspanSumInRow","apply","getActualPointsInRow","points","search","skipInCols","reconstraction","insertRow","wptb_preview_table","cellModeBackground","leftScrollPanelCurtain","leftScrollPanelCellSettings","wptbPreviewTableTds","recalculateIndexes","trs","maxCols","maxColsFull","tdsArr","jMainIter","z","cleaner","dataXIndex","tableTdsFor","colspan","widthIsSet","arrayTdsFromPreviousRow","tableTdsSumMaxWidth","tableTdsSumMaxWidthFixed","tableTdsSumMaxWidthAuto","wptbTableSetupWidth","arrayCellsWidthFixedHelper","arrayCellsWidthAutoHelper","tdPaddingCommon","tableTdBorderCommonWidth","cssForTdsWidthAuto","wptbCssTdAutoWidth","tableTdBorderLeftWidth","tableTdBorderRightWidth","CellsWidthAutoCount","tableFullStyleObj","borderLeftWidth","borderRightWidth","tableBorderCommon","wptbTableTdsSumMaxWidth","wptbCellsWidthAutoCount","merging–°ellsHorizontally","wptbFixedWidthSize","styleElementCreate","tableTdWidthAuto","tableTdsWidthAutoCommon","head","cssForTdsWidthAutoOld","dataYIndex","rowspan","heightIsSet","arrayTdsPrevious","tableColumnHeightAutoFixedCheckbox","wptbAdaptiveTableChoseBlock","mergingCellsVertically","forBreak","currentTable","currentTableTd","currentTdStyle","firstCell","c_pos","cellStyle","pos","pendingInsertion","bro","currentCell","r","aux","from","cellNew","rowChildren","rowChildrenLength","cellRowSpan","rowAfter","cellsColSpan","tableRowsIChildren","tableRIChildrenLength","rowIRowSpan","rNext","rNextChildren","rNextChildrenLength","rowStart","columnStart","rowEnd","columnEnd","itemsEstimate","dimensions","call","tdsChildrenNew","tdsInternalElements","tdsIntElemLength","firstWidth","firstDataFixedWidth","firstHeight","firstDataFixedHeight","cellStyles","cellXIndex","rowChildInsertBefore","rowNext","findRowspannedCells","actualPoints","addLackingCells","sumRows","totalColspan","nextRow","nextRowChildren","nextRowChildrenLength","tdArr","nextRowChildrenK","jRowChildren","pop","onresize","wptbTableStateSaving","wptbNewPreviewTable","wptbHighlighted","cssForTdsWidthAutoValue","datawptbUndoredo","wptbLeftScrollPanelCellSetting","elText2","elP"],"mappings":"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","file":"admin.js","sourcesContent":["var applyGenericItemSettings = function ( element, kindIndexProt, copy = false ) {\r\n    var node = element.getDOMElement(),\r\n        index,\r\n        listItems,\r\n        copy;\r\n    \r\n    if ( kindIndexProt == undefined || copy == true ) {\r\n        index = document.counter.nextIndex( element.kind );\r\n        let wptbElements = document.getElementsByClassName( 'wptb-ph-element' );\r\n        let elementIndexesArr = [];\r\n        for( let i = 0; i < wptbElements.length; i++ ) {\r\n            var regex = new RegExp( 'wptb-element-' + element.kind + '-(\\\\d+)', \"i\" );\r\n            let infArr = wptbElements[i].className.match( regex );\r\n            if( infArr ) {\r\n                elementIndexesArr.push( infArr[1] );\r\n            }\r\n        }\r\n        if( elementIndexesArr.length > 0 ) {\r\n            let elementIndexMax = Math.max( ...elementIndexesArr );\r\n            index = elementIndexMax + 1;\r\n        } else { \r\n            index = 1;\r\n        }\r\n    } else if ( kindIndexProt && ! copy ) {\r\n        let kindIndexProtArr = kindIndexProt.split('-');\r\n        index = kindIndexProtArr[kindIndexProtArr.length - 1];\r\n        // start item javascript if item is new\r\n        if( element.kind == 'text' ) {\r\n            WPTB_Helper.wptbItemStartScript( element.getDOMElement() );\r\n        }\r\n    }\r\n    \r\n            \r\n    \r\n    node.onmouseenter = function ( event ) {\r\n        if( event.target.classList.contains( 'wptb-moving-mode' ) ) {\r\n            return;\r\n        }\r\n        \r\n        WPTB_Helper.wptbDocumentEventGenerate( 'item:onmouseenter' );\r\n        \r\n        let i, wptbActionsField = new WPTB_ActionsField();\r\n        \r\n        wptbActionsField.addActionField( 1, node );\r\n        \r\n        wptbActionsField.setParameters( node );\r\n        \r\n        node.classList.remove( 'wptb-ondragenter' );\r\n        \r\n        //wptbActionsField.addActionField( 1, node )\r\n        \r\n        if ( element.kind === 'button' ) {\r\n            let a = node.querySelector( 'a' ),\r\n                target = a.querySelector( 'div' );\r\n            a.onclick = function( e ) {\r\n                e.preventDefault();\r\n            }\r\n            WPTB_Helper.buttonsTinyMceInit( target );\r\n        } else if (element.kind === 'text') {\r\n//            tinyMCE.init({\r\n//                target: node.childNodes[0],\r\n//                inline: true,\r\n//                plugins: \"link, paste\",\r\n//                dialog_type: \"modal\",\r\n//                theme: 'modern',\r\n//                menubar: false,\r\n//                force_br_newlines : false,\r\n//                force_p_newlines : false,\r\n//                forced_root_block : '',\r\n//                fixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n//                paste_as_text: true,\r\n//                toolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\r\n//                setup : function( ed ) {\r\n//                    ed.on( 'change', function(e) {\r\n//                        let row = WPTB_Helper.findAncestor( node, 'wptb-row' );\r\n//                        if( row.classList.contains( 'wptb-table-head' ) ) {\r\n//                            let table = WPTB_Helper.findAncestor( row, 'wptb-preview-table' );\r\n//                            WPTB_Helper.dataTitleColumnSet( table );\r\n//                        }\r\n//                        \r\n//                        \r\n//                    });\r\n//                    \r\n//                    ed.on( 'keydown', function(e) {\r\n//                        let wptbActionsField = new WPTB_ActionsField();\r\n//                        \r\n//                        wptbActionsField.addActionField( 1, node );\r\n//        \r\n//                        wptbActionsField.setParameters( node );\r\n//                    });\r\n//                    ed.on( 'keyup', function(e) {\r\n//                        let wptbActionsField = new WPTB_ActionsField();\r\n//                        \r\n//                        wptbActionsField.addActionField( 1, node );\r\n//        \r\n//                        wptbActionsField.setParameters( node );\r\n//                        \r\n//                        e.target.onblur = function() {\r\n//                            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n//                            wptbTableStateSaveManager.tableStateSet();\r\n//                        }\r\n//                    });\r\n//                    \r\n//                },\r\n//                init_instance_callback: function (editor) {\r\n//                    window.currentEditor = editor;\r\n//                    //editor.fire('focus');\r\n//                    editor.on('focus', function (e) {\r\n//                        var totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n//                        if (window.currentEditor &&\r\n//                            document.getElementById('wptb_builder').scrollTop >= 55 &&\r\n//                            window.currentEditor.bodyElement.style.display != 'none') {\r\n//                            document.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n//                            document.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n//                            document.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n//                        } else {\r\n//                            document.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n//                            delete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n//                            delete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n//                        }\r\n//                    });\r\n//                }\r\n//            });\r\n        } else if( element.kind === 'list' ) {\r\n            listItems = node.getElementsByClassName( 'wptb-list-item-content' );\r\n            for ( let i = 0; i < listItems.length; i++ ) {\r\n                WPTB_Helper.listItemsTinyMceInit( listItems[i] );\r\n            }\r\n        } \r\n    };\r\n    \r\n    node.onmouseleave = function ( event ) {\r\n        let wptbActionsField = new WPTB_ActionsField();\r\n        \r\n        if( wptbActionsField.wptbActions && wptbActionsField.wptbActions.type != '1' ) {\r\n            return;\r\n        }\r\n        \r\n        wptbActionsField.leaveFromField( event, node, 1 );\r\n    };\r\n    \r\n    let wptbActions = document.getElementsByClassName( 'wptb-actions' );\r\n    if( wptbActions.length > 0 ) {\r\n        wptbActions = wptbActions[0];\r\n        \r\n    }\r\n    \r\n    // Change data-title-column if the title was changed\r\n    if( element.kind == 'text' ) {\r\n//        var observer = new MutationObserver( function( mutations ) {\r\n//            let row = WPTB_Helper.findAncestor( node, 'wptb-row' );\r\n//            if( row.classList.contains( 'wptb-table-head' ) ) {\r\n//                let table = WPTB_Helper.findAncestor( row, 'wptb-preview-table' );\r\n//                WPTB_Helper.dataTitleColumnSet( table );\r\n//            }\r\n//        });\r\n//        var config = { attributes: true, attributeFilter: ['style'] };\r\n//        observer.observe( element.getDOMElement(), config );\r\n    } else if( element.kind == 'star_rating' ) {\r\n        let ratingStars = node.getElementsByClassName( 'wptb-rating-star' );\r\n        for ( let i = 0; i < ratingStars.length; i++ ) {\r\n            let ratingStar = ratingStars[i];\r\n            \r\n            \r\n            WPTB_Helper.starRatingEventHandlersAdd( ratingStar );\r\n            \r\n            let ritingStarZeroSet = ratingStar.querySelector( '.wptb-rating-star-zero-set' );\r\n            if( ritingStarZeroSet ) {\r\n                ritingStarZeroSet.onclick = function( event ) {\r\n                    let ulStarList = WPTB_Helper.findAncestor( event.target, 'wptb-rating-stars-list' );\r\n                    if( ulStarList ) {\r\n                        let children = ulStarList.children;\r\n                        for( let i = 0; i < children.length; i++ ) {\r\n                            children[i].classList.remove( 'wptb-rating-star-selected-full' );\r\n                            children[i].classList.remove( 'wptb-rating-star-selected-half' );\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    let node_wptb_element_kind_num = node.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n    if ( node_wptb_element_kind_num ) {\r\n        node.classList.remove( node_wptb_element_kind_num[0] );\r\n    }\r\n    if ( ! node.classList.contains( 'wptb-ph-element' ) ) {\r\n        node.classList.add( 'wptb-ph-element' );\r\n        if( ! node.classList.contains( 'wptb-element-' + element.kind + '-' + index ) ) {\r\n            node.classList.add( 'wptb-element-' + element.kind + '-' + index );\r\n        }\r\n    } else {\r\n        if( ! node.classList.contains( 'wptb-element-' + element.kind + '-' + index ) ) {\r\n            node.classList.add( 'wptb-element-' + element.kind + '-' + index );\r\n        }\r\n    }\r\n    new WPTB_ElementOptions( element, index, kindIndexProt );\r\n\r\n    document.counter.increment(element.kind);\r\n};","","var WPTB_ActionsField = function() {\r\n    //this.wptbBorderMarker;\r\n    this.wptbActions;\r\n    if( document.getElementsByClassName( 'wptb-actions' ).length != 0 ) {\r\n        this.wptbActions = document.getElementsByClassName( 'wptb-actions' )[0];\r\n    }\r\n    \r\n    this.addActionField = ( actionType, thisNode ) => {\r\n        let body = document.getElementsByTagName( 'body' )[0];\r\n        \r\n        let actions = document.getElementsByClassName( 'wptb-actions' );\r\n        if( actions.length != 0 ) {\r\n            let previousNode = actions[0].activeElem;\r\n            if( previousNode ) {\r\n                previousNode.classList.remove( 'wptb-directlyhovered' );\r\n            }\r\n            \r\n            while( actions.length != 0 ) {\r\n                actions[0].parentNode.removeChild( actions[0] );\r\n            }\r\n        }\r\n        \r\n        if( actionType == 1 ) {\r\n        \r\n            let btnDelete, btnCopy, btnMove;\r\n\r\n            btnDelete = document.createElement( 'span' ),\r\n            btnCopy = document.createElement( 'span' ),\r\n            btnMove = document.createElement( 'span' ),\r\n            actions = document.createElement( 'div' );\r\n\r\n            actions.classList.add( 'wptb-actions' );\r\n            btnDelete.classList.add( 'dashicons', 'dashicons-trash', 'wptb-delete-action' );\r\n            btnCopy.classList.add( 'dashicons', 'dashicons-admin-page', 'wptb-duplicate-action' );\r\n            btnMove.classList.add( \"dashicons\", \"dashicons-move\", 'wptb-move-action' );\r\n            btnMove.draggable = true;\r\n\r\n            actions.appendChild( btnMove );\r\n            actions.appendChild( btnCopy );\r\n            actions.appendChild( btnDelete );\r\n            body.appendChild( actions );\r\n\r\n            actions.activeElem = thisNode;\r\n\r\n            actions.type = 1;\r\n\r\n            btnDelete.onclick = function( event ) {\r\n                let act = event.target.parentNode.activeElem,\r\n                    el = act.parentNode;\r\n                el.removeChild(act);\r\n\r\n                if( act.kind == 'text' ) {\r\n                    let thisRow = el.parentNode\r\n                    if( thisRow.classList.contains( 'wptb-table-head' ) ) {\r\n                        let table = WPTB_Helper.findAncestor( thisRow, 'wptb-preview-table' );\r\n                        WPTB_Helper.dataTitleColumnSet( table );\r\n                    }\r\n                }\r\n\r\n                let wptbActionsField = new WPTB_ActionsField();\r\n\r\n                wptbActionsField.actionsRemove();\r\n                let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                wptbTableStateSaveManager.tableStateSet();\r\n            };\r\n\r\n\r\n\r\n            btnCopy.onclick = ( event ) => {\r\n                let copy,\r\n                    infArr,\r\n                    type;\r\n                let activeElement = event.target.parentNode.activeElem;\r\n                let activeElementClone = activeElement.cloneNode( true );\r\n                activeElementClone.classList.remove( 'wptb-directlyhovered' );\r\n                infArr = activeElement.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n                type = infArr[1];\r\n                let td = activeElement.parentNode;\r\n                if ( type == 'list' ) {\r\n                    var temp = [],\r\n                        srcList = activeElement.querySelectorAll('ul li .wptb-list-item-content');\r\n\r\n                    for (var i = 0; i < srcList.length; i++) {\r\n                        temp.push(srcList[i].innerHTML);\r\n                    }\r\n\r\n                    copy = new WPTB_List( temp, activeElementClone );\r\n\r\n                    td.insertBefore( copy.getDOMElement(), activeElement.nextSibling );\r\n                } else if ( type == 'text' ) {\r\n                    let data = {};\r\n                    data.kind = type;\r\n                    data.elemProt = activeElement;\r\n                    copy = new WPTB_ItemObject( data );\r\n\r\n                    td.insertBefore( copy.getDOMElement(), activeElement.nextSibling );\r\n                } else if ( type == 'image' ) {\r\n                    copy = new WPTB_Image( '', activeElement );\r\n                    \r\n                    td.insertBefore( copy.getDOMElement(), activeElement.nextSibling );\r\n                } else if( type == 'button' ) {\r\n                    let text = activeElementClone.childNodes[0].querySelector( 'p' ).innerHTML;\r\n \r\n                    copy = new WPTB_Button( text, activeElementClone );\r\n\r\n                    td.insertBefore( copy.getDOMElement(), activeElement.nextSibling );\r\n                } else if( type = 'star_rating' ) {\r\n                    copy = new WPTB_StarRating( activeElementClone );\r\n\r\n                    td.insertBefore( copy.getDOMElement(), activeElement.nextSibling );\r\n                }\r\n\r\n                WPTB_innerElementSet( copy.getDOMElement() );\r\n\r\n                let wptbActionsField = new WPTB_ActionsField( 1, activeElement );\r\n    \r\n                wptbActionsField.setParameters( activeElement );\r\n                \r\n                let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                wptbTableStateSaveManager.tableStateSet();\r\n            };\r\n\r\n            btnMove.ondragstart = ( event ) => {\r\n                let dragImagesArr =  WPTB_Helper.dragImagesArr(),\r\n                    actions = event.target.parentNode,\r\n                    activeElem = actions.activeElem,\r\n                    infArr,\r\n                    type;\r\n                infArr = activeElem.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n                type = infArr[1];\r\n                activeElem.classList.add( 'wptb-moving-mode' );\r\n\r\n                event.dataTransfer.effectAllowed = 'move';\r\n                event.dataTransfer.setDragImage( dragImagesArr[type], 0, 0 );\r\n                event.dataTransfer.setData( 'node', 'wptb-element-' + infArr[1] + '-' + infArr[2] );\r\n                event.dataTransfer.setData( 'wptb-moving-mode', 'wptb-element-' + infArr[1] + '-' + infArr[2] );\r\n                event.dataTransfer.setData( 'wptbElIndic-' + infArr[1], 'wptbElIndic-' + infArr[1] );\r\n                let act = event.target.parentNode.activeElem;\r\n                if( act.kind == 'text' ) {\r\n                    let thisRow = act.parentNode.parentNode;\r\n                    if( thisRow.classList.contains( 'wptb-table-head' ) ) {\r\n                        let table = WPTB_Helper.findAncestor( thisRow, 'wptb-preview-table' );\r\n                        WPTB_Helper.dataTitleColumnSet( table );\r\n                    }\r\n                }\r\n                //actions.style.display = 'none';\r\n                this.actionsHide();\r\n            };\r\n\r\n            //actions.style.right = '-' + parseFloat( thisNode.offsetWidth ) + 'px';\r\n            actions.style.display = 'block';\r\n\r\n            this.wptbActions = actions;\r\n        } else if( actionType == 2 ) {\r\n            let btnDelete,\r\n                btnCopy,\r\n                previous,\r\n                i;\r\n\r\n            btnDelete = document.createElement('span'),\r\n            btnCopy = document.createElement('span'),\r\n            actions = document.createElement('span')\r\n\r\n            actions.classList.add('wptb-actions');\r\n            btnDelete.classList.add('dashicons', 'dashicons-trash', 'wptb-delete-action');\r\n            btnCopy.classList.add('dashicons', 'dashicons-admin-page', 'wptb-duplicate-action');\r\n\r\n            actions.append( btnCopy, btnDelete );\r\n            body.appendChild( actions );\r\n\r\n            actions.activeElem = thisNode;\r\n            \r\n            let wptbDirectlyhovered = WPTB_Helper.findAncestor( thisNode, 'wptb-directlyhovered' );\r\n            if( wptbDirectlyhovered ) {\r\n                wptbDirectlyhovered.classList.remove( 'wptb-directlyhovered' );\r\n            }\r\n\r\n            actions.type = 2;\r\n\r\n            btnDelete.onclick = ( event ) => {\r\n                var action = event.target.parentNode, \r\n                    item = action.activeElem,\r\n                    parent = item.parentNode;\r\n                let wptbActionsField = new WPTB_ActionsField( 4 );\r\n                wptbActionsField.actionsRemove();\r\n                parent.removeChild( item );\r\n                WPTB_Helper.listItemsRecalculateIndex( parent );\r\n                \r\n                let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                wptbTableStateSaveManager.tableStateSet();\r\n            };\r\n\r\n            btnCopy.onclick = ( event ) => {\r\n                let coordinatesElement = thisNode.getBoundingClientRect();\r\n                let coordinatesElementTopBegin = coordinatesElement.top;\r\n\r\n                var listItem = event.target.parentNode.activeElem,\r\n                    content = listItem.querySelector( '.wptb-list-item-content' ),\r\n                    html = content.innerHTML;\r\n                var duplicate = new WPTB_ListItem( html, listItem, true );\r\n                listItem.parentNode.insertBefore( duplicate.getDOMElement(), thisNode.nextSibling );\r\n                WPTB_Helper.listItemsTinyMceInit( duplicate.getDOMElement().firstChild );\r\n\r\n                let divcontent = thisNode.getElementsByClassName( 'wptb-list-item-content' );\r\n                if( divcontent.length > 0 ) {\r\n                    divcontent = divcontent[0];\r\n                }\r\n                setTimeout( function(){\r\n                    divcontent.innerHTML = html;\r\n                    WPTB_Helper.listItemsRecalculateIndex( listItem.parentNode );\r\n                }, 5 );\r\n\r\n                coordinatesElement = thisNode.getBoundingClientRect();\r\n                let coordinatesElementTopEnd = coordinatesElement.top;\r\n\r\n                if( coordinatesElementTopBegin != coordinatesElementTopEnd ) {\r\n                    let wptbActionsField = new WPTB_ActionsField( 2, thisNode );\r\n                    wptbActionsField.setParameters( thisNode );\r\n                }\r\n                \r\n                let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                wptbTableStateSaveManager.tableStateSet();\r\n            };\r\n\r\n            actions.style.display = 'block';\r\n\r\n            this.wptbActions = actions;\r\n        }\r\n    }\r\n    \r\n    this.setParameters = ( thisNode ) => {\r\n        if( ! this.wptbActions ) {\r\n            let actions = document.getElementsByClassName( 'wptb-actions' );\r\n            if( actions.length > 0 ) {\r\n                this.wptbActions = actions[0];\r\n            }\r\n        }\r\n        \r\n        if( this.wptbActions ) {\r\n            this.wptbActions.style.display = 'block';\r\n        }\r\n        \r\n        let coordinatesElement = thisNode.getBoundingClientRect();\r\n        \r\n        let wptbContainer = document.getElementsByClassName( 'wptb-container' )[0];\r\n        let correctTop = () => {\r\n            let coordinatesElement = thisNode.getBoundingClientRect();\r\n            this.wptbActions.style.top = parseFloat( coordinatesElement.top ) - 15 + 'px';\r\n        }\r\n        wptbContainer.removeEventListener( 'scroll', correctTop, false );\r\n        \r\n        this.wptbActions.style.top = parseFloat( coordinatesElement.top ) - 15 + 'px';\r\n        this.wptbActions.style.left = ( parseFloat( coordinatesElement.right ) - parseFloat( this.wptbActions.clientWidth ) ) + 1 + 'px';\r\n\r\n//        let wptbBorderMarkerTop = this.wptbBorderMarker.querySelector( '.wptb-border-marker-top' );\r\n//        wptbBorderMarkerTop.style.width = ( parseFloat( thisNode.offsetWidth )  + 3 ) + 'px';\r\n//\r\n//        let wptbBorderMarkerRight = this.wptbBorderMarker.querySelector( '.wptb-border-marker-right' );\r\n//        wptbBorderMarkerRight.style.height = ( parseFloat( coordinatesElement.bottom ) - parseFloat( coordinatesElement.top )  + 4 ) + 'px';\r\n//        wptbBorderMarkerRight.style.left = ( parseFloat( thisNode.offsetWidth )  + 3 ) + 'px';\r\n//\r\n//        let wptbBorderMarkerBottom = this.wptbBorderMarker.querySelector( '.wptb-border-marker-bottom' );\r\n//        wptbBorderMarkerBottom.style.width = wptbBorderMarkerTop.style.width;\r\n//        wptbBorderMarkerBottom.style.top = ( parseFloat( coordinatesElement.bottom ) - parseFloat( coordinatesElement.top )  + 3 ) + 'px';;\r\n//\r\n//        let wptbBorderMarkerLeft = this.wptbBorderMarker.querySelector( '.wptb-border-marker-left' );\r\n//      \r\n        \r\n        //this.wptbBorderMarker.style.display = 'block';\r\n        this.wptbActions.style.display = 'block';\r\n        thisNode.classList.add( 'wptb-directlyhovered' );\r\n        \r\n        wptbContainer.addEventListener( 'scroll', correctTop, false );\r\n    }\r\n    \r\n//        if( actionType == 1 || actionType == 2 ) {\r\n//            this.setParameters( thisNode );\r\n//        }\r\n//    } else {\r\n//        this.wptbActions.style.display = 'block';\r\n//        thisNode.classList.add( 'wptb-directlyhovered' );\r\n//    }\r\n    \r\n    this.leaveFromField = ( event, node, actionType ) => {\r\n        if( event.relatedTarget ) {\r\n            if ( event.relatedTarget.classList.contains( 'wptb-actions' ) ||\r\n                event.relatedTarget.classList.contains( 'wptb-move-action' ) ||\r\n                event.relatedTarget.classList.contains( 'wptb-duplicate-action' ) ||\r\n                event.relatedTarget.classList.contains( 'wptb-delete-action' ) ) {\r\n                if( ! this.wptbActions ) {\r\n                    this.wptbActions = document.getElementsByClassName( 'wptb-actions' )[0];\r\n                }\r\n                this.wptbActions.onmouseleave = ( event ) => {\r\n                    if( event.relatedTarget != null && event.relatedTarget != this.wptbActions.activeElem &&\r\n                        WPTB_Helper.findAncestor( event.relatedTarget, 'wptb-directlyhovered') != this.wptbActions.activeElem ) {\r\n                        event.target.activeElem.classList.remove( 'wptb-directlyhovered' );\r\n                        this.wptbActions.style.display = 'none';\r\n\r\n                        if( this.wptbActions.type == 2 ) {\r\n                            let wptbActionsField = new WPTB_ActionsField();\r\n\r\n                            wptbActionsField.addActionField( 1, event.relatedTarget.parentNode.parentNode );\r\n\r\n                            wptbActionsField.setParameters( event.relatedTarget.parentNode.parentNode );\r\n                        }\r\n                    } else {\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                return;\r\n            } \r\n//            else if( event.relatedTarget.classList.contains( 'wptb-drop-handle' ) ) {\r\n//                let wptbDropHandle = document.getElementsByClassName( 'wptb-drop-handle' );\r\n//                if( wptbDropHandle.length > 0 ) {\r\n//                    wptbDropHandle = wptbDropHandle[0];\r\n//                    wptbDropHandle.onmouseleave\r\n//                }\r\n//            }\r\n        }\r\n        \r\n        node.classList.remove( 'wptb-directlyhovered' );\r\n        this.wptbActions.style.display = 'none';\r\n        \r\n        if( this.wptbActions.type == 2 ) {\r\n            if( event.relatedTarget ) {\r\n                if( event.relatedTarget.localName == 'ul' ) {\r\n                    //let wptbActionsField = new WPTB_ActionsField();\r\n\r\n                    this.addActionField( 1, event.relatedTarget.parentNode );\r\n\r\n                    this.setParameters( event.relatedTarget.parentNode );\r\n                }\r\n            }\r\n            \r\n        }\r\n    }\r\n    \r\n    this.actionsRemove = () => {\r\n        if( ! this.wptbActions ) {\r\n            let actions = document.getElementsByClassName( 'wptb-actions' );\r\n            if( actions.length > 0 ) {\r\n                this.wptbActions = actions[0];\r\n            }\r\n        }\r\n        \r\n        if( this.wptbActions ) {\r\n            this.wptbActions.parentNode.removeChild( this.wptbActions );\r\n        }\r\n    }\r\n    \r\n    this.actionsHide = () => {\r\n        if( ! this.wptbActions ) {\r\n            let actions = document.getElementsByClassName( 'wptb-actions' );\r\n            if( actions.length > 0 ) {\r\n                this.wptbActions = actions[0];\r\n            }\r\n        }\r\n        \r\n        if( this.wptbActions ) {\r\n            this.wptbActions.style.opacity = 0;\r\n        }\r\n    }\r\n}","(function () {\r\n    var WPTB_Builder = function () {\r\n        var table_id = WPTB_Helper.detectMode();\r\n        if ( table_id ) {\r\n            var http = new XMLHttpRequest(),\r\n                urlSet = ajaxurl + \"?action=get_table\" + '&id=' + table_id;\r\n            http.open('GET', urlSet, true);\r\n            http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n            http.onreadystatechange = function (d) {\r\n                if (this.readyState == 4 && this.status == 200) {\r\n                    var ans = JSON.parse(http.responseText);\r\n                    document.getElementById('wptb-setup-name').value = ans[0];\r\n                    \r\n                    if( ans[1] ) {\r\n                        document.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\r\n                        let wptbTableSetupEl = document.getElementsByClassName('wptb-table-setup')[0];\r\n                        wptbTableSetupEl.appendChild( WPTB_Parser( ans[1] ) );\r\n                        WPTB_Table();\r\n                        WPTB_LeftPanel();\r\n                        WPTB_Settings();\r\n                        \r\n                        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                        wptbTableStateSaveManager.tableStateSet();\r\n                    } else {\r\n                        document.getElementsByClassName('wptb-table-generator')[0].style.display = 'table';\r\n                    }\r\n                    \r\n                    return;\r\n                }\r\n            };\r\n            http.send(null);\r\n        } else {\r\n            document.getElementsByClassName('wptb-table-generator')[0].style.display = 'table';\r\n        }\r\n        document.counter = new ElementCounters();\r\n        document.select = new MultipleSelect();\r\n\r\n        var initializer = WPTB_Initializer();\r\n        settings = WPTB_Settings();\r\n    };\r\n\r\n    document.addEventListener('DOMContentLoaded', WPTB_Builder);\r\n})();","var WPTB_Button = function( text, DOMElementProt ) {\r\n    \r\n    var DOMElement = document.createElement('div'),\r\n        elButton = document.createElement('div'),\r\n        el_B = document.createElement('a'),\r\n        el_BDiv = document.createElement( 'div' ),\r\n        el_BDivP = document.createElement( 'p' ),\r\n        kindIndexProt = undefined,\r\n        copy = false;\r\n\r\n    DOMElement.classList.add('wptb-button-container', 'wptb-size-M', 'wptb-');\r\n    elButton.classList.add('wptb-button-wrapper');\r\n    el_BDiv.classList.add('wptb-button');\r\n    el_BDivP.innerHTML = text != undefined ? text : 'Button Text';\r\n    \r\n    // Creation of a new button when copying to avoid errors when assigning new event handlers.\r\n    if ( DOMElementProt ) {\r\n        let wptbElementMutch = DOMElementProt.className.match( /wptb-element-((.+-)\\d+)/i );\r\n        if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\r\n            kindIndexProt = wptbElementMutch[1];\r\n            copy = true;\r\n        }; \r\n        var attributesContainer = [...DOMElementProt.attributes];\r\n        if ( attributesContainer.length > 0 ) {\r\n            for( let i = 0; i < attributesContainer.length; i++ ) {\r\n                DOMElement.setAttribute(attributesContainer[i].name, attributesContainer[i].value);\r\n            } \r\n        }\r\n        \r\n        var wptbButtonWrapper = DOMElementProt.querySelector( '.wptb-button-wrapper' );\r\n        if ( wptbButtonWrapper ) {\r\n            var wptbButtonWrapAttributes = [...wptbButtonWrapper.attributes];\r\n            if ( wptbButtonWrapAttributes.length > 0 ) {\r\n                for( let i = 0; i < wptbButtonWrapAttributes.length; i++ ) {\r\n                    if ( wptbButtonWrapAttributes[i].name == 'style') {\r\n                        elButton.setAttribute( wptbButtonWrapAttributes[i].name, wptbButtonWrapAttributes[i].value );\r\n                    }\r\n                } \r\n            }\r\n        }\r\n        \r\n        var wptbButtonA = DOMElementProt.querySelector( 'a' );\r\n        if ( wptbButtonA ) {\r\n            var wptbButtonAttributes = [...wptbButtonA.attributes];\r\n            if ( wptbButtonAttributes.length > 0 ) {\r\n                for( let i = 0; i < wptbButtonAttributes.length; i++ ) {\r\n                    if ( wptbButtonAttributes[i].name == 'style' || \r\n                            wptbButtonAttributes[i].name == 'href' || \r\n                            wptbButtonAttributes[i].name == 'target' ) {\r\n                        el_B.setAttribute( wptbButtonAttributes[i].name, wptbButtonAttributes[i].value );\r\n                    }\r\n                } \r\n            }\r\n        }\r\n        \r\n        var wptbButton = DOMElementProt.querySelector( '.wptb-button' );\r\n        if ( wptbButton ) {\r\n            var wptbButtonAttributes = [...wptbButton.attributes];\r\n            if ( wptbButtonAttributes.length > 0 ) {\r\n                for( let i = 0; i < wptbButtonAttributes.length; i++ ) {\r\n                    if ( wptbButtonAttributes[i].name == 'style') {\r\n                        el_BDiv.setAttribute( wptbButtonAttributes[i].name, wptbButtonAttributes[i].value );\r\n                    }\r\n                } \r\n            }\r\n        }\r\n    }\r\n    \r\n    elButton.appendChild(el_B);\r\n    el_B.appendChild( el_BDiv );\r\n    el_BDiv.appendChild( el_BDivP );\r\n    DOMElement.appendChild(elButton);\r\n    \r\n    \r\n    \r\n    this.kind = 'button';\r\n\r\n    this.getDOMElement = function () {\r\n            return DOMElement;\r\n    };\r\n\r\n    applyGenericItemSettings( this, kindIndexProt, copy );\r\n    \r\n    return this;\r\n};","var WPTB_Cell = function (callback, DOMElement) {\r\n\r\n    function highlightRow(td) {\r\n        var parentRow = td.parentNode,\r\n            columnCount = parseInt(document.getElementById('wptb-columns-number').value),\r\n            tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n        for (var i = 0; i < tds.length; i++) {\r\n            tds[i].classList.remove('wptb-highlighted-row-first', 'wptb-highlighted-row-last', 'wptb-highlighted-row-inner', 'wptb-highlighted-column-first', 'wptb-highlighted-column-last', 'wptb-highlighted-column-inner');\r\n        }\r\n        for (var i = 0; i < columnCount; i++) {\r\n\r\n            var classToAdd = i == 0 ? 'wptb-highlighted-row-first' : i == columnCount - 1 ? 'wptb-highlighted-row-last' : 'wptb-highlighted-row-inner';\r\n            var ttd = parentRow.getElementsByTagName('td')[i];\r\n            if (ttd !== td) {\r\n                ttd.classList.add(classToAdd);\r\n            }\r\n        }\r\n    }\r\n\r\n    function highlightColumn(td) {\r\n\r\n        var index,\r\n            parentRow = td.parentNode;\r\n        columnCount = parseInt(document.getElementById('wptb-columns-number').value), rowCount = parseInt(document.getElementById('wptb-rows-number').value), table = document.getElementsByClassName('wptb-preview-table')[0];\r\n        for (var i = 0; i < columnCount; i++) {\r\n            if (parentRow.getElementsByTagName('td')[i] === td) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < rowCount; i++) {\r\n            var classToAdd = i == 0 ? 'wptb-highlighted-column-first' : i == rowCount - 1 ? 'wptb-highlighted-column-last' : 'wptb-highlighted-column-inner';\r\n            var tr = table.getElementsByTagName('tr')[i];\r\n            if (tr.getElementsByTagName('td')[index] !== td) {\r\n                tr.getElementsByTagName('td')[index].classList.add(classToAdd);\r\n            }\r\n        }\r\n    }\r\n    \r\n    if( ! DOMElement ) {\r\n        DOMElement = document.createElement(\"td\");\r\n\r\n        DOMElement.style.padding = jQuery('#wptb-table-padding-number').val() + 'px';\r\n\r\n        var innerBorderWidth = jQuery('#wptb-table-inner-border-number').val();\r\n\r\n        if (innerBorderWidth != '' && parseInt(innerBorderWidth) != 0) {\r\n            DOMElement.style.border = innerBorderWidth + 'px solid ' + jQuery('#wptb-table-border-color').val();\r\n        } \r\n\r\n        DOMElement.classList.add('wptb-droppable', 'wptb-cell');\r\n    }\r\n\r\n    DOMElement.draggable = false;\r\n    if ( callback ) {\r\n        DOMElement.onclick = callback;\r\n    }\r\n    \r\n    WPTB_innerElementSet( DOMElement );\r\n    \r\n    let wptbPhElement = DOMElement.getElementsByClassName( 'wptb-ph-element' );\r\n                                            \r\n    if ( wptbPhElement.length > 0 ) {\r\n        for( let i = 0; i < wptbPhElement.length; i++ ) {\r\n\r\n            let wptbSpaceBetween = DOMElement.getElementsByClassName( 'wptb-space-between' );\r\n\r\n            if ( wptbSpaceBetween.length > 0 ) {\r\n                for( let j = 0; j < wptbSpaceBetween.length; j++ ) {\r\n                    WPTB_Space( wptbSpaceBetween[j] );\r\n                }\r\n            }\r\n            \r\n            wptbPhElement[i].getDOMElement = function() {\r\n                return wptbPhElement[i];\r\n            }\r\n            \r\n            WPTB_innerElementSet( wptbPhElement[i] );\r\n            \r\n            let wptbElementTypeClass = wptbPhElement[i].className.match( /wptb-element-((.+-)\\d+)/i );\r\n            if( wptbElementTypeClass && Array.isArray( wptbElementTypeClass ) ) {\r\n                let wptbTypeElementArr = wptbElementTypeClass[1].split( '-' );\r\n                wptbPhElement[i].kind = wptbTypeElementArr[0];\r\n                applyGenericItemSettings( wptbPhElement[i], wptbElementTypeClass[1] );\r\n                if ( wptbPhElement[i].kind == 'list' ) {\r\n                    let wptbListItems = wptbPhElement[i].getElementsByTagName( 'li' );\r\n                    if( wptbListItems.length > 0 ) {\r\n                        for ( let i = 0; i < wptbListItems.length; i++ ) {\r\n                            WPTB_ListItem( undefined, wptbListItems[i] );\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    };\r\n\r\n    this.setCoords = function (y, x) {\r\n        var el = this.getDOMElement();\r\n        el.dataset.yIndex = y;\r\n        el.dataset.xIndex = x;\r\n    };\r\n\r\n    this.getCoords = function () {\r\n        var coords,\r\n            el = this.getDOMElement();\r\n        coords.x = el.dataset.xIndex;\r\n        coords.y = el.dataset.yIndex;\r\n        return coords;\r\n    };\r\n\r\n    this.appendElement = function (node) {\r\n        getDOMElement().appendChild(node);\r\n    };\r\n    \r\n    DOMElement.getCellDimensions = function() {\r\n        let tdStyleObj = window.getComputedStyle( this, null );\r\n        \r\n        let tdPaddingLeft = tdStyleObj.getPropertyValue( 'padding-left' );\r\n        let tdPaddingRight = tdStyleObj.getPropertyValue( 'padding-right' );\r\n        \r\n        let tdBorderLeftWidth = tdStyleObj.getPropertyValue( 'border-left-width' );\r\n        let tdBorderRightWidth = tdStyleObj.getPropertyValue( 'border-right-width' );\r\n        \r\n        let tdPaddingTop = tdStyleObj.getPropertyValue( 'padding-top' );\r\n        let tdPaddingBottom = tdStyleObj.getPropertyValue( 'padding-bottom' );\r\n        \r\n        let tdBorderTopWidth = tdStyleObj.getPropertyValue( 'border-top-width' );\r\n        let tdBorderBottomWidth = tdStyleObj.getPropertyValue( 'border-bottom-width' );\r\n        \r\n        let width = parseFloat( this.offsetWidth, 10 ) - \r\n                    parseFloat( tdPaddingLeft, 10 ) - \r\n                    parseFloat( tdPaddingRight, 10 ) -\r\n                    parseFloat( tdBorderLeftWidth, 10 ) -\r\n                    parseFloat( tdBorderRightWidth, 10 );\r\n            \r\n        let height = parseFloat( this.offsetHeight, 10 ) - \r\n                    parseFloat( tdPaddingTop, 10 ) - \r\n                    parseFloat( tdPaddingBottom, 10 ) -\r\n                    parseFloat( tdBorderTopWidth, 10 ) -\r\n                    parseFloat( tdBorderBottomWidth, 10 );\r\n        \r\n        return {\r\n            width: width, \r\n            height: height\r\n        };\r\n    }\r\n\r\n    return this;\r\n};","var WPTB_DropHandle = function (thisElem, e) {\r\n    \r\n    let wptbDropHandle,\r\n        wptbDropBorderMarker;\r\n    if ( document.getElementsByClassName( 'wptb-drop-handle' ).length == 0 ) {\r\n        wptbDropHandle = document.createElement( 'div' );\r\n        wptbDropHandle.classList.add( 'wptb-drop-handle' );\r\n        \r\n        wptbDropBorderMarker = document.createElement( 'div' );\r\n        wptbDropBorderMarker.classList.add( 'wptb-drop-border-marker' );\r\n        \r\n        let wptbDropBorderMarkerTop = document.createElement( 'div' ),\r\n            wptbDropBorderMarkerRight = document.createElement( 'div' ),\r\n            wptbDropBorderMarkerBottom = document.createElement( 'div' ),\r\n            wptbDropBorderMarkerLeft = document.createElement( 'div' );\r\n        \r\n        wptbDropBorderMarkerTop.classList.add( 'wptb-drop-border-marker-top' );\r\n        wptbDropBorderMarkerRight.classList.add( 'wptb-drop-border-marker-right' );\r\n        wptbDropBorderMarkerBottom.classList.add( 'wptb-drop-border-marker-bottom' );\r\n        wptbDropBorderMarkerLeft.classList.add( 'wptb-drop-border-marker-left' );\r\n        \r\n        wptbDropBorderMarker.appendChild( wptbDropBorderMarkerTop );\r\n        wptbDropBorderMarker.appendChild( wptbDropBorderMarkerRight );\r\n        wptbDropBorderMarker.appendChild( wptbDropBorderMarkerBottom );\r\n        wptbDropBorderMarker.appendChild( wptbDropBorderMarkerLeft );\r\n        \r\n        let body = document.getElementsByTagName( 'body' );\r\n        if ( body.length > 0 ) {\r\n            body[0].appendChild( wptbDropHandle );\r\n            body[0].appendChild( wptbDropBorderMarker );\r\n        }\r\n        \r\n        wptbDropHandle.ondragenter = function () {\r\n\r\n        }\r\n\r\n        wptbDropHandle.ondragover = function (e) {\r\n            e.preventDefault();\r\n        }\r\n\r\n        wptbDropHandle.ondragleave = function () {\r\n\r\n        }\r\n        wptbDropHandle.ondrop = function (e) {\r\n            e.preventDefault();\r\n            let element;\r\n            \r\n            if ( e.dataTransfer.getData('wptbElement') ) {\r\n                element = WPTB_Helper.newElementProxy( e.dataTransfer.getData('wptbElement') );\r\n                element = element.getDOMElement();\r\n            } else {\r\n                element = document.getElementsByClassName( e.dataTransfer.getData('node') )[0];\r\n                element.classList.remove( 'wptb-moving-mode' );\r\n                element.classList.remove( 'wptb-moving-into-same-elem' );\r\n                element.wptbMovingMode = 1;\r\n            }\r\n            \r\n            let td;\r\n            if( wptbDropHandle.dataset.text == 'Drop Here' ) {\r\n                thisElem = wptbDropHandle.getDOMParentElement();\r\n                if ( thisElem.nodeName.toLowerCase() == 'td' ) {\r\n                    td = wptbDropHandle.getDOMParentElement();\r\n                    td.appendChild( element );\r\n                }\r\n            } else {\r\n                let innerElement = wptbDropHandle.getDOMParentElement();\r\n                td = innerElement.parentNode;\r\n                \r\n                if( wptbDropHandle.dataset.text == 'Above Element' ) {\r\n                    td.insertBefore( element, innerElement );\r\n                } else if( wptbDropHandle.dataset.text == 'Below Element' ) {\r\n                    let innerElementNext = innerElement.nextSibling;\r\n                    td.insertBefore( element, innerElementNext );\r\n                }\r\n            }\r\n            \r\n            let thisRow = td.parentNode\r\n            if( thisRow.classList.contains( 'wptb-table-head' ) ) {\r\n                let table = WPTB_Helper.findAncestor( thisRow, 'wptb-preview-table' );\r\n                WPTB_Helper.dataTitleColumnSet( table );\r\n            }\r\n            \r\n            // start item javascript if item is new\r\n            let infArr = element.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n            let elemType = infArr[1];\r\n            if ( e.dataTransfer.getData( 'wptbElement' ) && elemType == 'text' ) {\r\n                WPTB_Helper.wptbItemStartScript( element );\r\n            }\r\n            \r\n            wptbDropHandle.style.display = 'none';\r\n            wptbDropBorderMarker.style.display = 'none';\r\n            \r\n            WPTB_innerElementSet(element);\r\n            if( ! element.classList.contains( 'wptb-image-container' ) || element.wptbMovingMode == 1 ) {\r\n                let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                wptbTableStateSaveManager.tableStateSet();\r\n                element.wptbMovingMode == undefined;\r\n            }\r\n        }\r\n        let wptbContainer = document.querySelector( '.wptb-container' );\r\n        wptbContainer.onscroll = function() {\r\n            wptbDropHandle.style.display = 'none';\r\n            wptbDropBorderMarker.style.display = 'none';\r\n        }\r\n    } else {\r\n        wptbDropHandle = document.getElementsByClassName( 'wptb-drop-handle' )[0];\r\n        wptbDropBorderMarker = document.getElementsByClassName( 'wptb-drop-border-marker' )[0];\r\n    }\r\n    if( thisElem && thisElem.nodeName.toLowerCase() == 'td' && \r\n            thisElem.getElementsByClassName( 'wptb-ph-element' ).length != 0 ) {\r\n        return;\r\n    }\r\n    \r\n    let thisRow;\r\n    if ( thisElem.localName == 'td' ) {\r\n        thisRow = thisElem.parentNode;\r\n    } else if ( thisElem.localName == 'div' && thisElem.classList.contains( 'wptb-ph-element' ) ) {\r\n        thisRow = thisElem.parentNode.parentNode;\r\n    }\r\n    if( thisRow.classList.contains( 'wptb-table-head' ) ) {\r\n        let indics = e.dataTransfer.types;\r\n        let notDragEnter = false;\r\n        for ( let i = 0; i < indics.length; i++ ) {\r\n            let infArr = indics[i].match( /wptbelindic-([a-z]+)/i );\r\n            if ( infArr && infArr[1] != 'text' ) {\r\n                notDragEnter = true;\r\n                break;\r\n            }\r\n        }\r\n        if( notDragEnter ) {\r\n            return;\r\n        }\r\n    }\r\n    \r\n    wptbDropHandle.style.width = thisElem.offsetWidth + 'px';\r\n    let height = thisElem.offsetHeight,\r\n        coordinatesElement = thisElem.getBoundingClientRect(),\r\n        left = parseFloat( coordinatesElement.left ),\r\n        top;\r\n    wptbDropHandle.style.left = left + 'px';\r\n    \r\n    if( e.dataTransfer.types.indexOf( 'wptb-moving-mode' ) != -1 ) {\r\n        let elementDrag = document.getElementsByClassName( 'wptb-moving-mode' )[0];\r\n        if( thisElem == elementDrag ) {\r\n            wptbDropHandle.classList.add('wptb-moving-into-same-elem');\r\n            wptbDropBorderMarker.classList.add('wptb-moving-into-same-elem');\r\n        } else {\r\n            wptbDropHandle.classList.remove('wptb-moving-into-same-elem');\r\n            wptbDropBorderMarker.classList.remove('wptb-moving-into-same-elem');\r\n        }\r\n    }\r\n    \r\n    wptbDropHandle.getDOMParentElement = function() {\r\n        return thisElem;\r\n    }\r\n    \r\n    wptbDropHandle.style.display = 'block';\r\n    wptbDropBorderMarker.style.display = 'block';\r\n    if( thisElem.nodeName.toLowerCase() != 'td' ) {\r\n        let y = e.offsetY==undefined?e.layerY:e.offsetY;\r\n        top = parseFloat( coordinatesElement.top ) - parseFloat( 11 );\r\n        wptbDropHandle.dataset.text = 'Above Element';\r\n        if ( y > height/2 ) {\r\n            top = parseFloat( coordinatesElement.top ) + height - 1;\r\n            wptbDropHandle.dataset.text = 'Below Element';\r\n        }\r\n    } else {\r\n        wptbDropHandle.dataset.text = 'Drop Here';\r\n        top = parseFloat( coordinatesElement.top ) + height/2 - 5;\r\n    }\r\n    wptbDropHandle.style.top = top + 'px';\r\n\r\n    wptbDropBorderMarker.style.top = coordinatesElement.top + 'px';\r\n    wptbDropBorderMarker.style.left = coordinatesElement.left + 'px';\r\n\r\n    wptbDropBorderMarkerTop = wptbDropBorderMarker.querySelector( '.wptb-drop-border-marker-top' );\r\n    wptbDropBorderMarkerTop.style.width = ( parseFloat( thisElem.offsetWidth ) - parseFloat( 1 ) ) + 'px';\r\n\r\n    wptbDropBorderMarkerRight = wptbDropBorderMarker.querySelector( '.wptb-drop-border-marker-right' );\r\n    wptbDropBorderMarkerRight.style.height = ( parseFloat( coordinatesElement.bottom ) - parseFloat( coordinatesElement.top ) - 1 ) + 'px';\r\n    wptbDropBorderMarkerRight.style.left = wptbDropBorderMarkerTop.style.width;\r\n\r\n    wptbDropBorderMarkerBottom = wptbDropBorderMarker.querySelector( '.wptb-drop-border-marker-bottom' );\r\n    wptbDropBorderMarkerBottom.style.width = wptbDropBorderMarkerTop.style.width;\r\n    wptbDropBorderMarkerBottom.style.top = wptbDropBorderMarkerRight.style.height;\r\n\r\n    wptbDropBorderMarkerLeft = wptbDropBorderMarker.querySelector( '.wptb-drop-border-marker-left' );\r\n    wptbDropBorderMarkerLeft.style.height = wptbDropBorderMarkerRight.style.height;\r\n}","var ElementCounters = function () {\r\n\r\n\tvar priv = [];\r\n\tpriv['text'] = 0;\r\n\tpriv['image'] = 0;\r\n\tpriv['list'] = 0;\r\n\tpriv['button'] = 0;\r\n\r\n\tthis.increment = function (key) {\r\n\t\tif (!(key in priv)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tpriv[key]++;\r\n\t}\r\n\r\n\tthis.nextIndex = function (key) {\r\n\t\tif (!(key in priv)) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\treturn priv[key] + 1;\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};","var WPTB_ElementOptions = function ( element, index, kindIndexProt ) {\r\n\r\n    var node = element.getDOMElement(), elemIdClass;\r\n    if( element.kind != 'text' ) {\r\n        prop = document.querySelector(\".wptb-\" + element.kind + \"-options-prototype\").cloneNode(true);\r\n        prop.classList.remove(\"wptb-\" + element.kind + \"-options-prototype\"); // remove prototype from the class\r\n        elemIdClass = 'wptb-options-' + element.kind + \"-\" + index;\r\n\r\n        var properties = prop.getElementsByClassName('wptb-element-property');\r\n\r\n        for (var i = 0; i < properties.length; i++) {\r\n            properties[i].dataset.element = elemIdClass;\r\n        }\r\n\r\n        prop.classList.add(elemIdClass);\r\n        document.getElementById(\"element-options-group\").appendChild(prop);\r\n    }\r\n    \r\n    \r\n    if ( kindIndexProt ) {\r\n        if ( element.kind == 'button' ) {\r\n            let affectedEl = document.getElementsByClassName( 'wptb-element-' + kindIndexProt )[0],\r\n                wptbButtonWrapper,\r\n                wptbButtonA,\r\n                wptbButton,\r\n                wptbSize;\r\n        \r\n            if ( affectedEl ) {\r\n                wptbSize = affectedEl.className.match(/wptb-size-([a-z]+)/i);\r\n            }\r\n            \r\n            if( wptbSize && Array.isArray( wptbSize ) ) {\r\n                var b = prop.getElementsByClassName('wptb-btn-size-btn');\r\n                \r\n                for ( var i = 0; i < b.length; i++ ) {\r\n                    b[i].classList.remove( 'selected' );\r\n                    \r\n                    if ( b[i].innerHTML == wptbSize[1] ) {\r\n                        b[i].classList.add( 'selected' );\r\n                    }\r\n                }\r\n            }\r\n            \r\n            if( affectedEl ) {\r\n                wptbButtonWrapper = affectedEl.getElementsByClassName( 'wptb-button-wrapper' );\r\n                \r\n                wptbButtonA = affectedEl.getElementsByTagName( 'a' );\r\n                \r\n                wptbButton = affectedEl.getElementsByClassName( 'wptb-button' );\r\n            }\r\n            \r\n            if ( wptbButtonWrapper ) {\r\n                let buttonAlignment = wptbButtonWrapper[0].style.justifyContent;\r\n\r\n                var selectOptionVal='';\r\n                if ( buttonAlignment == 'start' ) {\r\n                    selectOptionVal = 'left';\r\n                } else if ( buttonAlignment == 'center' || ! buttonAlignment ) {\r\n                    selectOptionVal = 'center';\r\n                } else if ( buttonAlignment == 'flex-end' ) {\r\n                    selectOptionVal = 'right';\r\n                }\r\n\r\n                let elementButtonAlignmentSelect = prop.getElementsByClassName('wptb-button-alignment-btn');\r\n\r\n\r\n\r\n\r\n                for ( var i = 0; i < elementButtonAlignmentSelect.length; i++ ) {\r\n                        elementButtonAlignmentSelect[i].classList.remove( 'selected' );\r\n                        \r\n                        if ( elementButtonAlignmentSelect[i].getAttribute('data-button_alignment') == selectOptionVal ) {\r\n                            elementButtonAlignmentSelect[i].classList.add( 'selected' );\r\n                        }\r\n                    }\r\n            }\r\n            \r\n            if ( wptbButtonA.length > 0 ) {\r\n                let buttonHref = wptbButtonA[0].getAttribute( 'href' ), \r\n                    buttonLinkTarget = wptbButtonA[0].getAttribute( 'target' ),\r\n                    buttonId = wptbButtonA[0].getAttribute( 'id' ),\r\n                    \r\n                    \r\n                    buttonHrefInput = prop.querySelector( 'input[data-type=\"button-link\"]' ),\r\n                    buttonLinkTargetInput = prop.querySelector( 'input[data-type=\"button-link-target\"]' ),\r\n                    buttonLinkTargetInputId = buttonLinkTargetInput.getAttribute( 'id' ),\r\n                    buttonLinkTargetInputLabel = buttonLinkTargetInput.parentNode.getElementsByTagName( 'label' )[0],\r\n            \r\n                    buttotIdInput = prop.querySelector( 'input[data-type=\"button-id\"]' );\r\n\r\n                buttonLinkTargetInputId = buttonLinkTargetInputId + '-' + kindIndexProt.split( '-' )[1];\r\n                buttonLinkTargetInput.setAttribute( 'id', buttonLinkTargetInputId );\r\n                buttonLinkTargetInputLabel.setAttribute( 'for', buttonLinkTargetInputId );\r\n\r\n                buttonHrefInput.value = buttonHref;\r\n\r\n                if( buttonLinkTarget && buttonLinkTarget == '_blank') {\r\n                    buttonLinkTargetInput.checked = true;\r\n                }\r\n                \r\n                buttotIdInput.value = buttonId;\r\n            }\r\n            \r\n            if( wptbButton ) {\r\n                let buttonTextColor = wptbButton[0].style.color,\r\n                    buttonColor = wptbButton[0].style.backgroundColor,\r\n                    buttonTextColorInput = prop.querySelector( 'input[data-type=\"button-text-color\"]' ),\r\n                    buttonBackgroundColorInput = prop.querySelector( 'input[data-type=\"button-color\"]' );\r\n                \r\n            \r\n                buttonTextColorInput.value = WPTB_Helper.rgbToHex( buttonTextColor );\r\n                \r\n                buttonBackgroundColorInput.value = WPTB_Helper.rgbToHex( buttonColor );\r\n                \r\n            }\r\n        } else if ( element.kind == 'image' ) {\r\n            let affectedEl = document.getElementsByClassName( 'wptb-element-' + kindIndexProt );\r\n            if ( affectedEl.length > 0 ) {\r\n                let elementsA = affectedEl[0].getElementsByTagName( 'a' );\r\n                if ( elementsA.length > 0 ) {\r\n                    let a = elementsA[0];\r\n\r\n                    if ( a ) {\r\n                        // set select according to the alignment of the image\r\n                        let imgAlign;\r\n                        if( a.style.float == 'none' || ! a.style.float) {\r\n                            imgAlign = 'center';\r\n                        } else {\r\n                            imgAlign = a.style.float;\r\n                        }\r\n                        let imageAlignmentSelect = prop.getElementsByClassName('wptb-image-alignment-btn');\r\n\r\n                        for ( var i = 0; i < imageAlignmentSelect.length; i++ ) {\r\n                            imageAlignmentSelect[i].classList.remove( 'selected' );\r\n                            \r\n                            if ( imageAlignmentSelect[i].getAttribute('data-image_alignment') == imgAlign ) {\r\n                                imageAlignmentSelect[i].classList.add( 'selected' );\r\n                            }\r\n                        }\r\n\r\n\r\n                        a.onclick = function( e ) {\r\n                            e.preventDefault();\r\n                        }\r\n\r\n                        // set text link for input field of setting panel\r\n                        let imageLinkHref = a.getAttribute( 'href' ),\r\n                            inputImageLink = prop.querySelector( 'input[data-type=\"image-link\"]' );\r\n                        if ( imageLinkHref ) {\r\n                            inputImageLink.value = imageLinkHref;\r\n                        }\r\n\r\n                        // set checkbox for target of link \r\n                        let imageLinkTarget = a.getAttribute( 'target' ),\r\n                            imageLinkTargetInput = prop.querySelector( 'input[data-type=\"image-link-target\"]' ),\r\n                            imageLinkTargetInputId = imageLinkTargetInput.getAttribute( 'id' ),\r\n                            imageLinkTargetInputLabel = imageLinkTargetInput.parentNode.getElementsByTagName( 'label' )[0];\r\n\r\n                        imageLinkTargetInputId = imageLinkTargetInputId + '-' + kindIndexProt.split( '-' )[1];\r\n\r\n                        imageLinkTargetInput.setAttribute( 'id', imageLinkTargetInputId );\r\n                        imageLinkTargetInputLabel.setAttribute( 'for', imageLinkTargetInputId );\r\n\r\n                        if ( imageLinkTarget && imageLinkTarget == '_blank' ) {\r\n                            imageLinkTargetInput.checked = true;\r\n                        }\r\n\r\n                        // set value for input fields of image size\r\n                        let imgWidth = a.style.width;\r\n                        if ( imgWidth ) {\r\n                            let imageWidthInputRange = prop.querySelector( 'input[type=\"range\"][data-type=\"image-size\"]' ),\r\n                                imageWidthInputNumber = prop.querySelector( 'input[type=\"number\"][data-type=\"image-size\"]' );\r\n\r\n                            imageWidthInputRange.value = parseInt( imgWidth );\r\n                            imageWidthInputNumber.value = parseInt( imgWidth );\r\n                        }\r\n\r\n                        let img = a.getElementsByTagName( 'img' );\r\n                        if ( img.length > 0 ) {\r\n                            // set value for input field of alternative text image\r\n                            let imgAlternativeText = img[0].getAttribute('alt'),\r\n                                imageAlternativeTextInput = prop.querySelector( 'input[type=\"text\"][data-type=\"alternative-text\"]' );\r\n\r\n                            imageAlternativeTextInput.value = imgAlternativeText;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        } else if ( element.kind == 'text' ) {\r\n//            let affectedEl = document.getElementsByClassName( 'wptb-element-' + kindIndexProt );\r\n//            if ( affectedEl.length > 0 ) {\r\n//                let elementFontSize = affectedEl[0].style.fontSize,\r\n//                    elementTextColor = affectedEl[0].style.color;\r\n//                let textFontSizeInputRange = prop.querySelector( 'input[type=\"range\"][data-type=\"font-size\"]' ),\r\n//                    textFontSizeInputNumber = prop.querySelector( 'input[type=\"number\"][data-type=\"font-size\"]' ),\r\n//                    textColorInput = prop.querySelector( 'input[type=\"text\"][data-type=\"color\"]' );\r\n//\r\n//                textFontSizeInputRange.value = parseInt( elementFontSize ) ? parseInt( elementFontSize ) : 10;\r\n//                textFontSizeInputNumber.value = parseInt( elementFontSize ) ? parseInt( elementFontSize ) : 10;\r\n//                textColorInput.value = WPTB_Helper.rgbToHex( elementTextColor );\r\n//            }\r\n        } else if ( element.kind == 'list' ) {\r\n            let elementList = document.getElementsByClassName( 'wptb-element-' + kindIndexProt );\r\n            if ( elementList.length > 0 ) {\r\n                let elementListColor = elementList[0].querySelector( 'p' ).style.color;\r\n                let listColorInput = prop.querySelector( 'input[type=\"text\"][data-type=\"list-text-color\"]' );\r\n                listColorInput.value = WPTB_Helper.rgbToHex( elementListColor );\r\n                \r\n                let elementListItem = elementList[0].querySelectorAll( 'li' );\r\n                if ( elementListItem.length > 0 ) {\r\n                    let listItemP = elementListItem[0].querySelector( 'p' );\r\n                    let listItemPClasses = listItemP.classList;\r\n                    //listItemPClasses = [...listItemPClasses];\r\n                    if ( listItemPClasses.length > 0 ) {\r\n                        let elementListClassSelect = prop.querySelector( 'select[data-type=\"list-class\"]' );\r\n                        if ( elementListClassSelect ) {\r\n                            elementListClassSelect.value = 'unordered';\r\n                            \r\n                            let listIconSelectLabel = elementListClassSelect.parentNode.nextSibling;\r\n                            for ( let i = 0; i < 10; i++ ) {\r\n                                if ( listIconSelectLabel.nodeType == '1' ) {\r\n                                    break;\r\n                                } else {\r\n                                    listIconSelectLabel = listIconSelectLabel.nextSibling;\r\n                                }\r\n                            }\r\n                            if ( listIconSelectLabel ) {\r\n                                let listIconSelectLabelId = listIconSelectLabel.getAttribute( 'id' );\r\n                                listIconSelectLabel.setAttribute( 'id', listIconSelectLabelId + '-' + kindIndexProt );\r\n                                listIconSelectLabel.style.display = 'flex';\r\n                            }\r\n                            \r\n                            let elementListStyleTypeSelect = prop.querySelector( 'select[data-type=\"list-style-type\"]' );\r\n                            if ( elementListStyleTypeSelect ) {\r\n                                elementListStyleTypeSelect.parentNode.style.display = 'flex';\r\n                                \r\n                                if( listItemPClasses.contains( 'wptb-list-style-type-disc' ) ) {\r\n                                    elementListStyleTypeSelect.value = 'disc';\r\n                                } else if( listItemPClasses.contains( 'wptb-list-style-type-circle' ) ) {\r\n                                    elementListStyleTypeSelect.value = 'circle';\r\n                                } else if( listItemPClasses.contains( 'wptb-list-style-type-square' ) ) {\r\n                                    elementListStyleTypeSelect.value = 'square';\r\n                                } else if ( listItemPClasses.contains( 'wptb-list-style-type-none' ) ) {\r\n                                    elementListStyleTypeSelect.value = 'none';\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                \r\n                let elementListItemContent = elementList[0].getElementsByClassName( 'wptb-list-item-content' );\r\n                if ( elementListItemContent.length > 0 ) {\r\n                    let listItemPTextAlignArr = [];\r\n                    for ( let i = 0; i < elementListItemContent.length; i++ ) {\r\n                        let p = elementListItemContent[i].querySelector( 'p' );\r\n                        if ( p ) {\r\n                            if ( p.style.textAlign ) {\r\n                                listItemPTextAlignArr.push( p.style.textAlign );\r\n                            } else {\r\n                                listItemPTextAlignArr.push( 'left' );\r\n                            }\r\n                        }\r\n                        \r\n                    }\r\n                    \r\n                    let listItemPTextAlignLeftCount = 0,\r\n                        listItemPTextAlignCenterCount = 0,\r\n                        listItemPTextAlignRightCount = 0;\r\n                    \r\n                    if ( listItemPTextAlignArr.length > 0 ) {\r\n                        for ( let i = 0; i < listItemPTextAlignArr.length; i++ ) {\r\n                            if ( listItemPTextAlignArr[i] ) {\r\n                                if ( listItemPTextAlignArr[i] == 'left' ) {\r\n                                    listItemPTextAlignLeftCount++;\r\n                                } else if ( listItemPTextAlignArr[i] == 'center' ) {\r\n                                    listItemPTextAlignCenterCount++;\r\n                                } else if ( listItemPTextAlignArr[i] == 'right' ) {\r\n                                    listItemPTextAlignRightCount++;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    \r\n                    let elementListAlignmentSelect = prop.getElementsByClassName('wptb-list-alignment-btn'),\r\n                        maxListItemTAlLeftC = Math.max( listItemPTextAlignLeftCount, listItemPTextAlignCenterCount, listItemPTextAlignRightCount );\r\n                    let wptbListAlignmentValue;\r\n                    if ( listItemPTextAlignLeftCount == maxListItemTAlLeftC ) {\r\n                        wptbListAlignmentValue = 'left';\r\n                    } else if ( listItemPTextAlignCenterCount == maxListItemTAlLeftC ) {\r\n                        wptbListAlignmentValue = 'center';\r\n                    } else if ( listItemPTextAlignRightCount == maxListItemTAlLeftC ) {\r\n                        wptbListAlignmentValue = 'right';\r\n                    }\r\n\r\n                    for ( var i = 0; i < elementListAlignmentSelect.length; i++ ) {\r\n                        elementListAlignmentSelect[i].classList.remove( 'selected' );\r\n                        \r\n                        if ( elementListAlignmentSelect[i].getAttribute('data-list_alignment') == wptbListAlignmentValue ) {\r\n                            elementListAlignmentSelect[i].classList.add( 'selected' );\r\n                        }\r\n                    }\r\n                }\r\n            } \r\n        } else if( element.kind == 'star_rating' ) {\r\n            let affectedEl = document.getElementsByClassName( 'wptb-element-' + kindIndexProt ),wptbRatingAlignment;\r\n            if( affectedEl.length > 0 ) {\r\n                affectedEl = affectedEl[0];\r\n                let ratingStar = affectedEl.querySelector( 'li' );\r\n                if( ratingStar ) {\r\n                    let ratingStarSize = ratingStar.style.width;\r\n                    let starSizeInputRange = prop.querySelector( 'input[type=\"range\"][data-type=\"star-size\"]' ),\r\n                        starSizeInputNumber = prop.querySelector( 'input[type=\"number\"][data-type=\"star-size\"]' );\r\n\r\n                    starSizeInputRange.value = parseInt( ratingStarSize ) ? parseInt( ratingStarSize ) : 10;\r\n                    starSizeInputNumber.value = parseInt( ratingStarSize ) ? parseInt( ratingStarSize ) : 10;\r\n\r\n                    if( ratingStar.querySelector( 'span' ) ) {\r\n                        let starColorInput = prop.querySelector( 'input[type=\"text\"][data-type=\"star-color\"]' ),\r\n                            ratingStarColor = ratingStar.querySelector( 'span' ).style.fill;\r\n                        starColorInput.value = WPTB_Helper.rgbToHex( ratingStarColor );\r\n                    }\r\n                }\r\n                \r\n                let ratingStars = affectedEl.querySelectorAll( 'li' );\r\n                let starsCountInputNumber = prop.querySelector( 'input[type=\"number\"][data-type=\"stars-count\"]' );\r\n                if( ratingStars.length == 1 && ratingStars[0].style.display == 'none' ) {\r\n                    starsCountInputNumber.value = 0;\r\n                } else {\r\n                    starsCountInputNumber.value = ratingStars.length;\r\n                }\r\n\r\n                // Rating default/saved alignment from icons in left panel\r\n                if ( affectedEl ) {\r\n                    wptbRatingAlignment = affectedEl.style.textAlign;\r\n                }\r\n                \r\n                if( wptbRatingAlignment ) {\r\n                    var b = prop.getElementsByClassName('wptb-rating-alignment-btn');\r\n                    \r\n                    for ( var i = 0; i < b.length; i++ ) {\r\n                        b[i].classList.remove( 'selected' );\r\n                        \r\n                        if ( b[i].getAttribute('data-star_alignment') == wptbRatingAlignment ) {\r\n                            b[i].classList.add( 'selected' );\r\n                        }\r\n                    }\r\n                }\r\n\r\n                let successBox = affectedEl.querySelector( '.wptb-success-box' );\r\n                if( successBox ) {\r\n                    let showNumberRatingCheckbox = prop.querySelector( 'input[type=\"checkbox\"][data-type=\"show-number-rating\"]' );\r\n                    if( successBox.style.display == 'block' ) {\r\n                        showNumberRatingCheckbox.checked = true;\r\n                        let numeralRatingOptionContainers = prop.getElementsByClassName( 'wptb-numeral-rating-option-container' );\r\n                        for( let i = 0; i < numeralRatingOptionContainers.length; i++ ) {\r\n                            numeralRatingOptionContainers[i].style.display = 'block';\r\n                        }\r\n                    } else {\r\n                        showNumberRatingCheckbox.checked = false;\r\n                    }\r\n\r\n                    let wptbTextMessage = successBox.querySelector( '.wptb-text-message' );\r\n                    if( wptbTextMessage ) {\r\n                        let numberRatingSize = wptbTextMessage.style.fontSize;\r\n                        let numberRatingColor = wptbTextMessage.style.color;\r\n\r\n                        let numberSizeInputRange = prop.querySelector( 'input[type=\"range\"][data-type=\"numeral-rating-size\"]' ),\r\n                        numberSizeInputNumber = prop.querySelector( 'input[type=\"number\"][data-type=\"numeral-rating-size\"]' ),\r\n                        numberColorInput = prop.querySelector( 'input[type=\"text\"][data-type=\"numeral-rating-color\"]' );\r\n\r\n                        numberSizeInputRange.value = parseInt( numberRatingSize ) ? parseInt( numberRatingSize ) : 10;\r\n                        numberSizeInputNumber.value = parseInt( numberRatingSize ) ? parseInt( numberRatingSize ) : 10;\r\n                        numberColorInput.value = WPTB_Helper.rgbToHex( numberRatingColor );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    node.onclick = function () {\r\n        var children = document.getElementById(\"element-options-group\").childNodes;\r\n        for (var i = 0; i < children.length; i++) {\r\n            if (children[i].style)\r\n                children[i].style.display = 'none';\r\n        }\r\n        if( element.kind != 'text' ) {\r\n            var infArr = this.className.match(/wptb-element-((.+-)\\d+)/i),\r\n                optionsClass = '.wptb-' + infArr[2] + 'options' +\r\n                    '.wptb-options-' + infArr[1];\r\n\r\n            document.getElementsByClassName('wptb-elements-container')[0].style.display = 'none';\r\n            document.getElementsByClassName('wptb-settings-section')[0].style.display = 'none';\r\n            document.getElementById(\"element-options-group\").style.display = 'block';\r\n\r\n\r\n            document.querySelector(optionsClass).style.display = 'block';\r\n        } else {\r\n            var infArr = this.className.match(/wptb-element-((.+-)\\d+)/i);\r\n            // get controls config for this item\r\n            let wptbContrlStacksConfigId = 'wptb-' + element.kind + '-control-stack';\r\n            let tmplControlsConfig = wp.template( wptbContrlStacksConfigId );\r\n            let data = {\r\n                wrapper: '.' + infArr[0]\r\n            };\r\n            let jsonControlsConfigJson = tmplControlsConfig( data );\r\n            let jsonControlsConfig = JSON.parse( jsonControlsConfigJson );\r\n            \r\n            // create a container for inserting controls of this item\r\n            let wptbElementOptionsContainer = document.createElement( 'div' );\r\n            wptbElementOptionsContainer.classList.add( 'wptb-element-options', 'wptb-options-' + infArr[1] );\r\n            \r\n            // clear elements from options group\r\n            //document.getElementById( 'element-options-group' ).innerHTML = '';\r\n            let elementOptionsGroup = document.getElementById( 'element-options-group' );\r\n            let elementOptionsGroupChildren = elementOptionsGroup.children;\r\n            for( let i = 0; i < elementOptionsGroupChildren.length; i++ ) {\r\n                let elem = elementOptionsGroupChildren[i].className.match(/wptb-options-text-(\\d+)/i);\r\n                if( elem ) {\r\n                    elementOptionsGroup.removeChild( elementOptionsGroupChildren[i] );\r\n                }\r\n            }\r\n            \r\n            \r\n            // hide wptb-elements-container and wptb-settings-section\r\n            document.getElementsByClassName('wptb-elements-container')[0].style.display = 'none';\r\n            document.getElementsByClassName('wptb-settings-section')[0].style.display = 'none';\r\n            \r\n            // show element-options-group \r\n            document.getElementById(\"element-options-group\").style.display = 'block';\r\n            \r\n            // insert created container into element-option-group tag\r\n            document.getElementById( 'element-options-group' ).appendChild( wptbElementOptionsContainer );\r\n            \r\n            // show created container\r\n            wptbElementOptionsContainer.style.display = 'block';\r\n            \r\n            // create controls \r\n            Object.keys( jsonControlsConfig ).forEach( function( key ) {\r\n                // get necessary wp js template\r\n                let tmplControlTemplate = wp.template( 'wptb-' + key + '-control' );\r\n                \r\n                \r\n                let data = jsonControlsConfig[key];\r\n                \r\n                // create class which needs for searching \r\n                let targetInputAddClass;\r\n                if( jsonControlsConfig[key].selectors !== undefined ) {\r\n                    let selector,\r\n                    cssSetting;\r\n                    for ( let prop in jsonControlsConfig[key].selectors ) {\r\n                        selector = prop;\r\n                        cssSetting = jsonControlsConfig[key].selectors[prop];\r\n                    }\r\n\r\n                    targetInputAddClass = selector.replace( '.', '' ).replace( ' ', '-' ).trim() + '-' + cssSetting;\r\n                    targetInputAddClass = targetInputAddClass.toLowerCase();\r\n                    \r\n                    data.targetInputAddClass = targetInputAddClass;\r\n                }\r\n                \r\n                \r\n                let controlTemplate = tmplControlTemplate( data );\r\n                \r\n                let wptbElementOptionContainer = document.createElement( 'div' );\r\n                wptbElementOptionContainer.classList.add( 'wptb-element-option', 'wptb-settings-items' );\r\n                \r\n                wptbElementOptionContainer.innerHTML = controlTemplate;\r\n                \r\n                wptbElementOptionsContainer.appendChild( wptbElementOptionContainer );\r\n                \r\n                let helperJavascriptElem = wptbElementOptionContainer.getElementsByTagName( 'script' );\r\n                if( helperJavascriptElem.length > 0 ) {\r\n                    helperJavascriptElem = helperJavascriptElem[0];\r\n                    let helperJavascriptCode = helperJavascriptElem.innerText;\r\n                    wptbElementOptionContainer.removeChild( helperJavascriptElem );\r\n                    let script = document.createElement( 'script' );\r\n                    script.setAttribute( 'type', 'text/javascript' );\r\n                    script.innerHTML = helperJavascriptCode.replace(/\\r|\\n|\\t/g, '').trim();\r\n                    wptbElementOptionContainer.appendChild( script );\r\n                }\r\n            });\r\n            \r\n            \r\n            WPTB_Helper.wptbDocumentEventGenerate( 'controlPanel:added:leftPanel' );\r\n        }\r\n        \r\n\r\n                //var listStyleType, textAlign;\r\n\r\n//        switch (element.kind) {\r\n\r\n//            case 'text':\r\n//                jQuery(prop).find('[data-type=color]').wpColorPicker({ defaultColor: node.style.color });\r\n//                prop.querySelector('[type=number][data-type=font-size]').value\r\n//                    = prop.querySelector('[type=range][data-type=font-size]').value\r\n//                    = node.style.fontSize.substring(0, node.style.fontSize.length - 2);\r\n//                break;\r\n//            case 'list':\r\n//                textAlign = node.querySelector('li p').style.textAlign;\r\n//                listStyleType = node.querySelector('li').style.listStyleType;\r\n//                if ( prop.querySelector( 'select[data-type=list-class]' ) ) {\r\n//                console.log(textAlign);\r\n//                console.log(listStyleType);\r\n//                console.log(listStyleType);\r\n//                console.log(prop);\r\n//                    prop.querySelector('select[data-type=list-class]').selectedIndex = ( listStyleType == 'decimal' ? 0 : 1 );\r\n//                }\r\n//                if ( prop.querySelector('select[data-type=list-style-type]') ) {\r\n//                    prop.querySelector('select[data-type=list-style-type]').selectedIndex = (listStyleType == 'circle' ? 0 : (listStyleType == 'square' ? 1 : 2));\r\n//                }\r\n//                if ( prop.querySelector('select[data-type=list-alignment]') ) {\r\n//                    prop.querySelector('select[data-type=list-alignment]').selectedIndex = (textAlign == 'left' ? 0 : (textAlign == 'center' ? 1 : 2));\r\n//                }\r\n//                break;\r\n//            case 'image':\r\n//                break;\r\n//            case 'button':\r\n//                jQuery(prop).find('[data-type=button-color]').wpColorPicker({ defaultColor: node.style.backgroundColor });\r\n//                break;\r\n//\r\n//        }\r\n    };\r\n\r\n    if (element.kind == 'button') {\r\n        //We must add this special kind of property, since it is triggered with click event\r\n        var buttons = prop.getElementsByClassName('wptb-btn-size-btn');\r\n\r\n        for (var i = 0; i < buttons.length; i++) {\r\n            buttons[i].onclick = function () {\r\n                var size = this.innerHTML,\r\n                    n_Class = this.dataset.element,\r\n                    infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                    type = infArr[1],\r\n                    num = infArr[2],\r\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0];\r\n                affectedEl.classList.remove('wptb-size-S');\r\n                affectedEl.classList.remove('wptb-size-M');\r\n                affectedEl.classList.remove('wptb-size-L');\r\n                affectedEl.classList.remove('wptb-size-XL');\r\n                affectedEl.classList.add('wptb-size-' + size);\r\n                var b = this.parentNode.getElementsByClassName('wptb-btn-size-btn');\r\n                for (var i = 0; i < b.length; i++) {\r\n                    b[i].classList.remove('selected');\r\n                }\r\n                this.classList.add('selected');\r\n                \r\n                let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                wptbTableStateSaveManager.tableStateSet();\r\n            }\r\n        }\r\n    }\r\n\r\n    /*\r\n    * alignment option in left panel using icons for star-rating\r\n    */\r\n    if (element.kind == 'star_rating') {\r\n            //We must add this special kind of property, since it is triggered with click event\r\n            var buttons = prop.getElementsByClassName('wptb-rating-alignment-btn');\r\n\r\n            for (var i = 0; i < buttons.length; i++) {\r\n                buttons[i].onclick = function () {\r\n                    var star_alignment = this.getAttribute('data-star_alignment'),\r\n                        n_Class = this.dataset.element,\r\n                        infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                        type = infArr[1],\r\n                        num = infArr[2],\r\n                        affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0];\r\n                        affectedEl.style.textAlign = star_alignment;\r\n\r\n                    var b = this.parentNode.getElementsByClassName('wptb-rating-alignment-btn');\r\n                    for (var i = 0; i < b.length; i++) {\r\n                        b[i].classList.remove('selected');\r\n                    }\r\n                    this.classList.add('selected');\r\n                    \r\n                    let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                    wptbTableStateSaveManager.tableStateSet();\r\n                }\r\n            }\r\n        }\r\n    /*\r\n    * alignment option in left panel using icons for list\r\n    */\r\n    if (element.kind == 'list') {\r\n            //We must add this special kind of property, since it is triggered with click event\r\n            var buttons = prop.getElementsByClassName('wptb-list-alignment-btn');\r\n\r\n            for (var i = 0; i < buttons.length; i++) {\r\n                buttons[i].onclick = function () {\r\n                    var list_alignment = this.getAttribute('data-list_alignment'),\r\n                        n_Class = this.dataset.element,\r\n                        infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                        type = infArr[1],\r\n                        num = infArr[2],\r\n                        affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0];\r\n\r\n                        let listItems = affectedEl.querySelectorAll('li');\r\n                        for (var i = 0; i < listItems.length; i++) {\r\n                            let p = listItems[i].querySelector( 'p' );\r\n                            if ( p ) {\r\n                                p.style.textAlign = list_alignment;\r\n                            }\r\n                        }\r\n\r\n                    var b = this.parentNode.getElementsByClassName('wptb-list-alignment-btn');\r\n                    for (var i = 0; i < b.length; i++) {\r\n                        b[i].classList.remove('selected');\r\n                    }\r\n                    this.classList.add('selected');\r\n                    \r\n                    let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                    wptbTableStateSaveManager.tableStateSet();\r\n                }\r\n            }\r\n        }\r\n    /*\r\n    * alignment option in left panel using icons for button\r\n    */\r\n    if (element.kind == 'button') {\r\n            //We must add this special kind of property, since it is triggered with click event\r\n            var buttons = prop.getElementsByClassName('wptb-button-alignment-btn');\r\n\r\n            for (var i = 0; i < buttons.length; i++) {\r\n                buttons[i].onclick = function () {\r\n                    var button_alignment = this.getAttribute('data-button_alignment'),\r\n                        n_Class = this.dataset.element,\r\n                        infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                        type = infArr[1],\r\n                        num = infArr[2],\r\n                        affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0];\r\n\r\n                        var jc = '';\r\n                        if (button_alignment == 'left') {\r\n                            jc = 'start';\r\n                        } else if (button_alignment == 'right') {\r\n                            jc = 'flex-end';\r\n                        } else {\r\n                            jc = 'center';\r\n                        }\r\n                        affectedEl.getElementsByClassName('wptb-button-wrapper')[0].style.justifyContent = jc;\r\n\r\n                    var b = this.parentNode.getElementsByClassName('wptb-button-alignment-btn');\r\n                    for (var i = 0; i < b.length; i++) {\r\n                        b[i].classList.remove('selected');\r\n                    }\r\n                    this.classList.add('selected');\r\n                    \r\n                    let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                    wptbTableStateSaveManager.tableStateSet();\r\n                }\r\n            }\r\n        }\r\n\r\n    /*\r\n    * alignment option in left panel using icons for image\r\n    */\r\n    if (element.kind == 'image') {\r\n        //We must add this special kind of property, since it is triggered with click event\r\n        var buttons = prop.getElementsByClassName('wptb-image-alignment-btn');\r\n\r\n        for (var i = 0; i < buttons.length; i++) {\r\n            buttons[i].onclick = function () {\r\n                var image_alignment = this.getAttribute('data-image_alignment'),\r\n                    n_Class = this.dataset.element,\r\n                    infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                    type = infArr[1],\r\n                    num = infArr[2],\r\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0];\r\n\r\n                    var image_alignment_value = '';\r\n                    if (image_alignment == 'left') {\r\n                        image_alignment_value = 'left';\r\n                    } else if (image_alignment == 'right') {\r\n                        image_alignment_value = 'right';\r\n                    } else {\r\n                        image_alignment_value = 'none';\r\n                    }\r\n\r\n                    affectedEl.querySelector( '.wptb-image-wrapper a' ).style.float = image_alignment_value;\r\n\r\n                var b = this.parentNode.getElementsByClassName('wptb-image-alignment-btn');\r\n                for (var i = 0; i < b.length; i++) {\r\n                    b[i].classList.remove('selected');\r\n                }\r\n                this.classList.add('selected');\r\n\r\n                let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                wptbTableStateSaveManager.tableStateSet();\r\n            }\r\n        }\r\n    }\r\n    \r\n    if( element.kind != 'text' ) {\r\n        var optionControls = prop.getElementsByClassName('wptb-element-property');\r\n\r\n        for (var i = 0; i < optionControls.length; i++) {\r\n            if ( optionControls[i].classList.contains( 'wptb-color-picker' ) ) {\r\n                jQuery(optionControls[i]).wpColorPicker({\r\n                    change: function ( event, ui ) {\r\n                        WPTB_Helper.wpColorPickerChange( event, ui );\r\n\r\n                        //console.log(event);\r\n                        WPTB_Helper.wpColorPickerCheckChangeForTableStateSaving( event );\r\n                    },\r\n                    clear: function( event ) {\r\n                        WPTB_Helper.wpColorPickerChange( event );\r\n                    }\r\n                });\r\n            }\r\n\r\n            if( optionControls[i].classList.contains( 'wptb-stars-count-field' ) ) {\r\n                WPTB_Helper.numberImputSize( optionControls[i], 1, 10 );\r\n            }\r\n\r\n            if ( optionControls[i].dataset.type === 'font-size' || optionControls[i].dataset.type === 'image-size' ||\r\n                   optionControls[i].dataset.type === 'star-size' || optionControls[i].dataset.type === 'numeral-rating-size' ) {\r\n                var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-size-slider')[0];\r\n                slider.oninput = function () {\r\n                    this.parentNode.parentNode.getElementsByClassName('wptb-size-number')[0].value = this.value;\r\n                    this.parentNode.parentNode.getElementsByClassName('wptb-size-number')[0].onchange( event );\r\n                }\r\n            }\r\n\r\n    //        if (optionControls[i].dataset.type === 'image-size') {\r\n    //            var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-size-slider')[0];\r\n    //            slider.oninput = function () {\r\n    //                this.parentNode.parentNode.getElementsByClassName('wptb-size-number')[0].value = this.value;\r\n    //                this.parentNode.parentNode.getElementsByClassName('wptb-size-number')[0].onchange( event );\r\n    //            }\r\n    //        }\r\n    //        \r\n    //        if ( optionControls[i].dataset.type === 'star-size' ) {\r\n    //            var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-size-slider')[0];\r\n    //            slider.oninput = function () {\r\n    //                this.parentNode.parentNode.getElementsByClassName('wptb-size-number')[0].value = this.value;\r\n    //                this.parentNode.parentNode.getElementsByClassName('wptb-size-number')[0].onchange( event );\r\n    //            }\r\n    //        }\r\n\r\n            optionControls[i].onchange = function ( event ) {\r\n                var n_Class = this.dataset.element,\r\n                    infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\r\n                    type = infArr[1],\r\n                    num = infArr[2],\r\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0],\r\n                    val = this.value;\r\n\r\n                switch ( this.dataset.type ) {\r\n                    case 'src':\r\n                        var img = affectedEl.getElementsByTagName(\"img\")[0];\r\n                        img.src = this.value;\r\n                        break;\r\n                    case 'alternative-text':\r\n                        var img = affectedEl.getElementsByTagName('img')[0];\r\n                        img.alt = this.value;\r\n                        break;\r\n                    case 'image-link':\r\n                        affectedEl.getElementsByTagName('a')[0].href = WPTB_Helper.linkHttpCheckChange( this.value );\r\n                        break;\r\n                    case 'image-link-target':\r\n                        if (this.checked == true) {\r\n                            affectedEl.getElementsByTagName('a')[0].target = '_blank';\r\n                        } else {\r\n                            affectedEl.getElementsByTagName('a')[0].target = '_self';\r\n                        }\r\n                        break;\r\n                    case 'image-link-nofollow':\r\n                        if (this.checked == true) {\r\n                            affectedEl.getElementsByTagName('a')[0].rel = 'nofollow';\r\n                        } else {\r\n                            affectedEl.getElementsByTagName('a')[0].removeAttribute('rel');\r\n                        }\r\n                        break;\r\n                    case 'image-size':\r\n                        affectedEl.getElementsByTagName('a')[0].style.width = this.value + '%';\r\n                        affectedEl.getElementsByTagName('a')[0].style.height = 'auto';\r\n                        this.parentNode.parentNode.getElementsByClassName('wptb-size-slider')[0].value = this.value;\r\n                        break;\r\n                    case 'font-size':\r\n                        affectedEl.style.fontSize = val + 'px';\r\n                        this.parentNode.parentNode.getElementsByClassName('wptb-size-slider')[0].value = this.value;\r\n                        break;\r\n                    case 'rating-alignment':\r\n                        var jc = '';\r\n                        if (this.value == 'left') {\r\n                            jc = 'start';\r\n                        } else if (this.value == 'right') {\r\n                            jc = 'right';\r\n                        } else {\r\n                            jc = 'center';\r\n                        }\r\n                        affectedEl.style.textAlign = jc;\r\n                        break;\r\n                    case 'button-link':\r\n                        if ( this.value ) {\r\n                            affectedEl.getElementsByTagName( 'a' )[0].href = WPTB_Helper.linkHttpCheckChange( this.value );\r\n                        } else {\r\n                            affectedEl.getElementsByTagName( 'a' )[0].removeAttribute( 'href' );\r\n                        }\r\n                        break;\r\n                    case 'button-link-target':\r\n                        if (this.checked == true) {\r\n                            affectedEl.getElementsByTagName('a')[0].target = '_blank';\r\n                        } else {\r\n                            affectedEl.getElementsByTagName('a')[0].target = '_self';\r\n                        }\r\n                        break;\r\n                    case 'button-link-nofollow':\r\n                        if (this.checked == true) {\r\n                            affectedEl.getElementsByTagName('a')[0].rel = 'nofollow';\r\n                        } else {\r\n                            affectedEl.getElementsByTagName('a')[0].removeAttribute( 'rel' );\r\n                        }\r\n                        break;\r\n                    case 'button-id':\r\n                        if( this.value ) {\r\n                            affectedEl.getElementsByTagName( 'a' )[0].id = this.value;\r\n                        } else {\r\n                            affectedEl.getElementsByTagName( 'a' )[0].removeAttribute( 'id' );\r\n                        }\r\n                    case 'button-color':\r\n                        break;\r\n                    case 'list-class':\r\n                        let parentNode = event.target\r\n                                .parentNode\r\n                                .parentNode\r\n                                .querySelector('[data-type=list-style-type]')\r\n                                .parentNode,\r\n                            parentNodeSettingItem = parentNode.parentNode;\r\n                        if (val == 'unordered') {\r\n                            parentNode.style.display = 'flex';\r\n\r\n                            parentNodeSettingItem.querySelector( '.wptb-list-icon-select-label' ).style.display = 'flex';\r\n                            let listItem = affectedEl.querySelectorAll('li');\r\n                            for (var i = 0; i < listItem.length; i++) {\r\n                                let p = listItem[i].querySelector( 'p' );\r\n                                p.removeAttribute ( 'class' );\r\n                                p.classList.add( 'wptb-list-style-type-disc' );\r\n                            }\r\n                            parentNodeSettingItem.querySelector('[data-type=list-style-type]').value = 'disc';\r\n                        } else {\r\n                            parentNode.style.display = 'none';\r\n                            parentNodeSettingItem.querySelector( '.wptb-list-icon-select-label' ).style.display = 'none';\r\n                            var listItem = affectedEl.querySelectorAll('li');\r\n                            for (var i = 0; i < listItem.length; i++) {\r\n                                let p = listItem[i].querySelector( 'p' );\r\n                                p.removeAttribute ( 'class' );\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 'list-style-type':\r\n                        var listItem = affectedEl.querySelectorAll('li');\r\n                        for (var i = 0; i < listItem.length; i++) {\r\n                            let p = listItem[i].querySelector( 'p' );\r\n                            p.removeAttribute ( 'class' );\r\n                            p.classList.add( 'wptb-list-style-type-' + val.toLowerCase() );\r\n                        }\r\n                        break;\r\n                    case 'star-size':\r\n                        let ratingStar = affectedEl.querySelectorAll('li');\r\n                        for( let i = 0; i < ratingStar.length; i++ ) {\r\n                            ratingStar[i].style.width = val + 'px';\r\n                            ratingStar[i].style.height = val + 'px';\r\n                            let span = ratingStar[i].querySelectorAll( 'span' );\r\n                            for( let j = 0; j < span.length; j++ ) {\r\n                                if( span[j].querySelector( 'svg' ) ) {\r\n                                    span[j].style.width = val + 'px';\r\n                                    span[j].style.height = val + 'px';\r\n                                    span[j].querySelector( 'svg' ).style.width = val + 'px';\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 'show-number-rating':\r\n                        let wptbNumeralRatingOptionContainer = WPTB_Helper.findAncestor( this, 'wptb-star_rating-options' )\r\n                        .getElementsByClassName( 'wptb-numeral-rating-option-container' );\r\n\r\n                        WPTB_Helper.starRatingTextMessageChenge( affectedEl );\r\n\r\n                        if( wptbNumeralRatingOptionContainer.length > 0 ) {\r\n                            let wptbTextMessage = affectedEl.querySelector( '.wptb-text-message' );\r\n\r\n                            let val = this.checked ? 'checked' : 'unchecked';\r\n                            if( val== 'checked' ) {\r\n                                for ( let i = 0; i < wptbNumeralRatingOptionContainer.length; i++ ) {\r\n                                    wptbNumeralRatingOptionContainer[i].style.display = 'block';\r\n                                }\r\n                                wptbTextMessage.parentNode.style.display = 'block';\r\n                            } else if ( val == 'unchecked' ) {\r\n                                for ( let i = 0; i < wptbNumeralRatingOptionContainer.length; i++ ) {\r\n                                    wptbNumeralRatingOptionContainer[i].style.display = 'none';\r\n                                }\r\n                                wptbTextMessage.parentNode.style.display = 'none';\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 'numeral-rating-size':\r\n                        let wptbTextMessageSize = affectedEl.querySelector('.wptb-text-message');\r\n                        wptbTextMessageSize.style.fontSize = val + 'px';\r\n                        wptbTextMessageSize.style.height = val + 'px';\r\n                        wptbTextMessageSize.style.lineHeight = val + 'px';\r\n                        break;\r\n                    case 'stars-count':\r\n                        let starRatings = affectedEl.querySelectorAll( 'li' );\r\n\r\n                        let starRatingsCount = starRatings.length;\r\n\r\n                        if( val > starRatingsCount ) {\r\n                            let difference = val - starRatingsCount;\r\n                            let starRatingsLast = starRatings[starRatings.length - 1];\r\n\r\n                            let parent = starRatingsLast.parentNode;\r\n                            for( let i = 0; i < difference; i++ ){\r\n                                let newStarRating = starRatingsLast.cloneNode( true );\r\n                                newStarRating.removeAttribute( 'class' );\r\n                                newStarRating.setAttribute( 'class', 'wptb-rating-star' );\r\n                                newStarRating.dataset.value = parseInt(starRatingsLast.dataset.value) + i + 1;\r\n                                WPTB_Helper.starRatingEventHandlersAdd( newStarRating );\r\n                                parent.appendChild( newStarRating );\r\n                            }\r\n                        } else if( val < starRatingsCount ) {\r\n                                let difference = parseInt( starRatingsCount ) - parseInt( val );\r\n\r\n                                if( val == 0 ) {\r\n                                    difference--;\r\n                                    starRatings[0].removeAttribute( 'class' );\r\n                                    starRatings[0].setAttribute( 'class', 'wptb-rating-star' );\r\n                                    starRatings[0].style.display = 'none';\r\n                                }\r\n\r\n                                let starRatingLength = starRatings.length;\r\n                                for( i = 0; i < difference; i++ ) {\r\n                                    starRatings[0].parentNode.removeChild( starRatings[starRatingLength - i - 1] );\r\n                                }\r\n                        } else if( val == starRatingsCount && starRatingsCount == 1 ) {\r\n                            starRatings[0].style.display = 'inline-block';\r\n                        }\r\n\r\n                        WPTB_Helper.starRatingTextMessageChenge( affectedEl );\r\n\r\n                        break;\r\n                }\r\n\r\n\r\n                if( event.target.classList.contains( 'wptb-size-slider' ) || event.target.classList.contains( 'wptb-size-slider' ) ) {\r\n                    event.target.onmouseup = function() {\r\n                        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                        wptbTableStateSaveManager.tableStateSet();\r\n                    }\r\n                } else {\r\n                    let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                    wptbTableStateSaveManager.tableStateSet();\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n};","var WPTB_Helper = {\r\n    hexToRgb: function( hex ) {\r\n        var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec( hex );\r\n        return result ? 'rgb(' + parseInt( result[1], 16 ) + ',' + parseInt( result[2], 16 ) + ',' + parseInt( result[3], 16 ) + ')' : null;\r\n    },\r\n    rgbToHex: function ( rgb ) {\r\n        var rgb = rgb.match( /^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i );\r\n\r\n        return ( rgb && rgb.length === 4 ) ? \"#\" +\r\n            ( \"0\" + parseInt( rgb[1],10 ).toString( 16 )).slice( -2 ) +\r\n            ( \"0\" + parseInt( rgb[2],10 ).toString( 16 )).slice( -2 ) +\r\n            ( \"0\" + parseInt( rgb[3],10 ).toString( 16 )).slice( -2 ) : '';\r\n    },\r\n    getDragImageCustom: function ( type ) {\r\n        let hostName = location.protocol + '//' + location.hostname;\r\n        let img = document.createElement( 'img' );\r\n        img.src = hostName + '/wp-content/plugins/wp-table-builder/inc/admin/views/builder/icons/' + type + '.png';\r\n        return img;\r\n    },\r\n    dragImagesArr: function() {\r\n        return {\r\n            text: WPTB_Helper.getDragImageCustom( 'text' ),\r\n            image: WPTB_Helper.getDragImageCustom( 'image' ),\r\n            button: WPTB_Helper.getDragImageCustom( 'button' ),\r\n            list: WPTB_Helper.getDragImageCustom( 'list' ),\r\n            star_rating: WPTB_Helper.getDragImageCustom( 'half-filled-rating-star' )\r\n        };\r\n    },\r\n    listItemsRecalculateIndex: function( ulElem ) {\r\n        let par = ulElem.querySelectorAll( 'p' );\r\n        if ( par.length > 0 ) {\r\n            for ( let i = 0; i < par.length; i++ ) {\r\n                par[i].dataset.listStyleTypeIndex = Number( i ) + 1 + '.';\r\n            }\r\n        }\r\n    },\r\n    listItemsTinyMceInit: function( listItem ) {\r\n        tinyMCE.init({\r\n            target: listItem,\r\n            inline: true,\r\n            plugins: \"link, paste\",\r\n            dialog_type: \"modal\",\r\n            theme: 'modern',\r\n            menubar: false,\r\n            fixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n            paste_as_text: true,\r\n            toolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\r\n            setup: function(ed) {\r\n                ed.on('keydown', function(e) {\r\n                    let article = e.target.parentNode;\r\n                    if ( e.keyCode == 13 ) {\r\n                        e.preventDefault();\r\n                        let text = e.target.innerHTML;\r\n                        let duplicate = new WPTB_ListItem( text, article, true );\r\n                        \r\n                        article.parentNode.insertBefore( duplicate.getDOMElement(), article );\r\n                        WPTB_Helper.listItemsTinyMceInit( duplicate.getDOMElement().firstChild );\r\n                        e.target.querySelector( 'p' ).innerText = 'New List Item';\r\n                        //tinyMCE.execCommand('mceInsertContent', false, 'New List Item');\r\n                        WPTB_Helper.listItemsRecalculateIndex( article.parentNode );\r\n                        \r\n                        return;\r\n                        \r\n                    } else if ( e.keyCode == '8' || e.keyCode == '46' ) {\r\n                        let p = e.target.querySelector( 'p' );\r\n                        let pText = p.innerHTML.replace(/<[^>]+>/g, '');\r\n                        pText = pText.replace( /\\s+/g, ' ' ).trim();\r\n                        pText = pText.replace( /&nbsp;/g, '').trim();\r\n                        \r\n                        if( pText == '' ) {\r\n                            e.preventDefault();\r\n                            e.target.querySelector( 'p' ).innerText = '\\n';\r\n                        } else {\r\n                            let selectedText = WPTB_Helper.getSelectionText();\r\n                            selectedText = selectedText.replace( /\\s+/g, ' ' ).trim();\r\n                            selectedText = selectedText.replace( /&nbsp;/g, '' ).trim();\r\n                            if( selectedText == pText ) {\r\n                                e.preventDefault();\r\n                                e.target.querySelector( 'p' ).innerText = '\\n';\r\n                            }\r\n                        }\r\n                    }\r\n                    \r\n                    let wptbListItem = e.target.parentNode;\r\n                    let wptbActionsField = new WPTB_ActionsField();\r\n\r\n                    wptbActionsField.addActionField( 2, wptbListItem );\r\n\r\n                    wptbActionsField.setParameters( wptbListItem );\r\n                });\r\n                \r\n                ed.on( 'keyup', function( e ) {\r\n                    let wptbListItem = e.target.parentNode;\r\n                    let wptbActionsField = new WPTB_ActionsField();\r\n\r\n                    wptbActionsField.addActionField( 2, wptbListItem );\r\n\r\n                    wptbActionsField.setParameters( wptbListItem );\r\n                    \r\n                    e.target.onblur = function() {\r\n                        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                        wptbTableStateSaveManager.tableStateSet();\r\n                    }\r\n                });\r\n            },\r\n            init_instance_callback: function (editor) {\r\n                window.currentEditor = editor;\r\n                editor.on('focus', function (e) {\r\n                    var totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n                    if (window.currentEditor &&\r\n                        document.getElementById('wptb_builder').scrollTop >= 55 &&\r\n                        window.currentEditor.bodyElement.style.display != 'none') {\r\n                        document.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n                        document.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n                        document.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n                    } else {\r\n                        document.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n                        delete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n                        delete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    buttonsTinyMceInit: function( target ) {\r\n        tinyMCE.init({\r\n            target: target,\r\n            inline: true,\r\n            plugins: \"link\",\r\n            dialog_type: \"modal\",\r\n            theme: 'modern',\r\n            menubar: false,\r\n            fixed_toolbar_container: '#wpcd_fixed_toolbar',\r\n            toolbar: 'bold italic strikethrough',\r\n            setup : function(ed) {\r\n                ed.on( 'keydown', function(e) {\r\n                    if (e.keyCode == 13) {\r\n                        e.preventDefault();\r\n                    }\r\n                    let wptbButtonContainer = WPTB_Helper.findAncestor( target, 'wptb-button-container' );\r\n                    \r\n                    let wptbActionsField = new WPTB_ActionsField();\r\n\r\n                    wptbActionsField.addActionField( 1, wptbButtonContainer );\r\n\r\n                    wptbActionsField.setParameters( wptbButtonContainer );\r\n                });\r\n                \r\n                ed.on( 'keyup', function(e) {\r\n                    let wptbButtonContainer = WPTB_Helper.findAncestor( target, 'wptb-button-container' );\r\n                    \r\n                    let wptbActionsField = new WPTB_ActionsField();\r\n\r\n                    wptbActionsField.addActionField( 1, wptbButtonContainer );\r\n\r\n                    wptbActionsField.setParameters( wptbButtonContainer );\r\n                    \r\n                    e.target.onblur = function() {\r\n                        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                        wptbTableStateSaveManager.tableStateSet();\r\n                    }\r\n                });\r\n            },\r\n            init_instance_callback: function (editor) {\r\n                window.currentEditor = editor;\r\n                editor.on('focus', function (e) {\r\n                    var totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\r\n                    if (window.currentEditor &&\r\n                        document.getElementById('wptb_builder').scrollTop >= 55 &&\r\n                        window.currentEditor.bodyElement.style.display != 'none') {\r\n                        document.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\r\n                        document.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\r\n                        document.getElementById('wpcd_fixed_toolbar').style.top = '100px';\r\n                    } else {\r\n                        document.getElementById('wpcd_fixed_toolbar').style.position = 'static';\r\n                        delete document.getElementById('wpcd_fixed_toolbar').style.right;\r\n                        delete document.getElementById('wpcd_fixed_toolbar').style.top;\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    linkHttpCheckChange: function( link ) {\r\n        if ( link ) {\r\n            if ( link.indexOf( 'http://' ) == -1 && link.indexOf( 'https://' ) == -1 ) {\r\n                let linkArr = link.split( '/' ),\r\n                    linkClean;\r\n                if ( Array.isArray( linkArr ) && linkArr.length > 0 ) {\r\n                    linkClean = linkArr[linkArr.length - 1];\r\n                }\r\n                return document.location.protocol + '//' + linkClean;\r\n            } else { \r\n                return link;\r\n            }\r\n        } else {\r\n            return '';\r\n        }\r\n    },\r\n    dataTitleColumnSet: function( table ) {\r\n        let rows = table.rows,\r\n            rowHead = rows[0];\r\n        let computedStyleRowHead = getComputedStyle(rowHead);\r\n        \r\n        let rowHeadChildren = rowHead.children;\r\n        let contentsForHeader = {};\r\n        for( let i = 0; i < rowHeadChildren.length; i++ ) {\r\n            let tdElements = rowHeadChildren[i].children;\r\n            for( let j = 0; j < tdElements.length; j++ ) {\r\n                let element = tdElements[j];\r\n                if( element.classList.contains( 'wptb-ph-element' ) ) {\r\n                    let infArr = element.className.match( /wptb-element-(.+)-(\\d+)/i );\r\n                    if( infArr[1] == 'text' ) {\r\n                        let p = element.querySelector( 'p' ),\r\n                            textContent = p.textContent,\r\n                            textAlign = p.style.textAlign;\r\n                            contentsForHeader[rowHeadChildren[i].dataset.xIndex] = [textContent, element.style.fontSize, \r\n                                element.style.color, computedStyleRowHead.backgroundColor, textAlign];\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if( ! contentsForHeader[rowHeadChildren[i].dataset.xIndex] ) {\r\n                contentsForHeader[rowHeadChildren[i].dataset.xIndex] = ['', '', \r\n                            '', computedStyleRowHead.backgroundColor, ''];\r\n            }\r\n        }\r\n        for ( let i = 1; i < rows.length; i++ ) {\r\n            let thisRow = rows[i],\r\n                thisRowChildren = thisRow.children;\r\n            for( let j = 0; j < thisRowChildren.length; j++ ) {\r\n                if ( contentsForHeader[thisRowChildren[j].dataset.xIndex] ) {\r\n                    thisRowChildren[j].dataset.wptbTitleColumn = contentsForHeader[thisRowChildren[j].dataset.xIndex][0];\r\n                    thisRowChildren[j].dataset.wptbTitleColumnFontSize = contentsForHeader[thisRowChildren[j].dataset.xIndex][1];\r\n                    thisRowChildren[j].dataset.wptbTitleColumnColor = contentsForHeader[thisRowChildren[j].dataset.xIndex][2];\r\n                    thisRowChildren[j].dataset.wptbTitleBackgroundColor = contentsForHeader[thisRowChildren[j].dataset.xIndex][3];\r\n                    thisRowChildren[j].dataset.wptbTitleAlign = contentsForHeader[thisRowChildren[j].dataset.xIndex][4];\r\n                } else {\r\n                    thisRowChildren[j].dataset.wptbTitleColumn = '';\r\n                    thisRowChildren[j].dataset.wptbTitleColumnFontSize = '';\r\n                    thisRowChildren[j].dataset.wptbTitleColumnColor = '';\r\n                    thisRowChildren[j].dataset.wptbTitleBackgroundColor = '';\r\n                    thisRowChildren[j].dataset.wptbTitleAlign = '';\r\n                }\r\n            }\r\n        }\r\n    },\r\n    findAncestor: function(el, cls) {\r\n        while ((el = el.parentElement) && !el.classList.contains(cls));\r\n        return el;\r\n    },\r\n    getSelectionText: function() {\r\n        var txt = '';\r\n        if (txt = window.getSelection) {\r\n            txt = window.getSelection().toString();\r\n        } else {\r\n            txt = document.selection.createRange().text;\r\n        }\r\n        return txt;\r\n    },\r\n    settingsPanelClear: function() {\r\n        document.getElementById( 'wptb-adaptive-table-checkbox' ).checked = false;\r\n        document.getElementById( 'wptb-top-row-as-header' ).checked = false;\r\n        document.getElementById( 'wptb-table-border-slider' ).value = 0;\r\n        document.getElementById( 'wptb-table-border-number' ).value = 0;\r\n        document.getElementById( 'wptb-inner-border-check' ).checked = false;\r\n        document.getElementById( 'wptb-apply-inner-border' ).classList.remove( 'visible' );\r\n        document.getElementById( 'wptb-table-inner-border-slider' ).value = 1;\r\n        document.getElementById( 'wptb-table-inner-border-number' ).value = 1;\r\n        \r\n        WPTB_Helper.wpColorPickerClear( 'wptb-table-border-color', true );\r\n        \r\n        WPTB_Helper.wpColorPickerClear( 'wptb-table-header-bg', true );\r\n        \r\n        WPTB_Helper.wpColorPickerClear( 'wptb-even-row-bg', true );\r\n        \r\n        WPTB_Helper.wpColorPickerClear( 'wptb-odd-row-bg', true );\r\n        \r\n        document.getElementById( 'wptb-table-cell-slider' ).value = 15;\r\n        document.getElementById( 'wptb-table-cell-number' ).value = 15;\r\n    },\r\n    elementOptionsPanelClear: function() {\r\n        let elementOptionsGroup = document.getElementById( 'element-options-group' );\r\n        if( elementOptionsGroup ) {\r\n            elementOptionsGroup.innerHTML = '';\r\n        }\r\n    },\r\n    wpColorPickerCheckChangeForTableStateSaving: function( event ) {\r\n        if( event.originalEvent.type == 'external' ) {\r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n        } else {\r\n            let wpPickerContainer = WPTB_Helper.findAncestor( event.target, 'wp-picker-container' );\r\n            if( wpPickerContainer ) {\r\n                if( event.originalEvent.type == 'square' ) {\r\n                    let irisSquareHandle = wpPickerContainer.getElementsByClassName( 'iris-square-handle' );\r\n                    if( irisSquareHandle.length > 0 ) {\r\n                        irisSquareHandle = irisSquareHandle[0];\r\n                        irisSquareHandle.onmouseup = function() {\r\n                            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                            wptbTableStateSaveManager.tableStateSet();\r\n                        }\r\n                    }\r\n                } else if( event.originalEvent.type == 'strip' ) {\r\n                    let uiSliderHandle = wpPickerContainer.getElementsByClassName( 'iris-slider-offset' );\r\n                    if( uiSliderHandle.length > 0 ) {\r\n                        uiSliderHandle = uiSliderHandle[0];\r\n                        uiSliderHandle.onmouseup = function() {\r\n                            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                            wptbTableStateSaveManager.tableStateSet();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    wpColorPickerClear: function( attribute, isId ) {\r\n        let input;\r\n        if( isId ) {\r\n            input = [document.getElementById( attribute )];\r\n            input.length = 1;\r\n        } else {\r\n            input = document.getElementsByClassName( attribute );\r\n        }\r\n        for( let i = 0; i < input.length; i++ ) {\r\n            let wpPickerContainer = WPTB_Helper.findAncestor( input[i], 'wp-picker-container' );\r\n            if( wpPickerContainer ) {\r\n                let parent = wpPickerContainer.parentNode;\r\n                parent.removeChild( wpPickerContainer );\r\n                let newInput = document.createElement( 'input' );\r\n                if( isId ) {\r\n                    newInput.setAttribute( 'id', attribute );\r\n                } else {\r\n                    newInput.classList.add( 'wptb-element-property', attribute );\r\n                }\r\n                newInput.value = \"\";\r\n                parent.appendChild( newInput );\r\n            }\r\n        }\r\n    },\r\n    detectMode: function() {\r\n        var url = window.location.href,\r\n            regex = new RegExp('[?&]table(=([^&#]*)|&|#|$)'),\r\n            results = regex.exec(url);\r\n        if (!results) return false;\r\n        if (!results[2]) return '';\r\n        return decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n    },\r\n    getColumnWidth: function( table, cell ) {\r\n        let xIndex = cell.dataset.xIndex;\r\n        let xIndexes = table.querySelectorAll( '[data-x-index=\"' + xIndex + '\"]' );\r\n        let cellWidth = cell.getCellDimensions().width;\r\n        for( let i = 0; i < xIndexes.length; i++ ) {\r\n            if( cellWidth > xIndexes[i].getCellDimensions().width ) {\r\n                cellWidth = xIndexes[i].getCellDimensions().width;\r\n            }\r\n        }\r\n        return cellWidth;\r\n    },\r\n    getRowHeight: function( table, cell ) {\r\n        let yIndex = cell.dataset.yIndex;\r\n        let yIndexes = table.querySelectorAll( '[data-y-index=\"' + yIndex + '\"]' );\r\n        let cellHeight = cell.getCellDimensions().height;\r\n        for( let i = 0; i < yIndexes.length; i++ ) {\r\n            if( cellHeight > yIndexes[i].getCellDimensions().height ) {\r\n                cellHeight = yIndexes[i].getCellDimensions().height;\r\n            }\r\n        }\r\n        return cellHeight;\r\n    },\r\n    newElementProxy: function( el ) {\r\n        if( el == 'text' ) {\r\n            let data = {kind: 'text'};\r\n            return new WPTB_ItemObject( data );\r\n        }\r\n        \r\n        if ( el == 'list' ) {\r\n            return new WPTB_List();\r\n        } else if ( el == 'image' ) {\r\n            return new WPTB_Image();\r\n        } else if ( el == 'text' ) {\r\n            return new WPTB_Text();\r\n        } else if ( el == 'button' ) {\r\n            return new WPTB_Button();\r\n        } else if( el == 'star_rating' ) {\r\n            return new WPTB_StarRating();\r\n        }\r\n    },\r\n    wpColorPickerChange: function( event, ui ) {\r\n        let uiColor;\r\n        if( ui ) {\r\n            uiColor = ui.color.toString();\r\n        } else {\r\n            uiColor = '';\r\n        }\r\n        \r\n        let parent = WPTB_Helper.findAncestor( event.target, 'wp-picker-input-wrap' ).getElementsByClassName( 'wptb-color-picker' )[0], classe, type, ps, number;\r\n        classe = parent.dataset.element.match(/wptb-options-(.+)-(\\d+)/i);\r\n        type = classe[1];\r\n        number = classe[2];\r\n        let affectedEl = document.getElementsByClassName( 'wptb-element-' + type + '-' + number )[0];\r\n        if ( type == 'button' ) {\r\n            if ( parent.dataset.type == 'button-text-color' ) {\r\n                affectedEl.getElementsByClassName( 'wptb-button' )[0].style.color = uiColor;\r\n            } else {\r\n                affectedEl.getElementsByClassName( 'wptb-button' )[0].style.backgroundColor = uiColor;\r\n            }\r\n        } else if( type == 'list' ) {\r\n            let ps = affectedEl.querySelectorAll( 'p' );\r\n            if( ps.length > 0 ) {\r\n                for ( let i = 0; i < ps.length; i++ ) {\r\n                    ps[i].style.color = uiColor;\r\n                }\r\n            }\r\n        } else if( type == 'star_rating' ) {\r\n            if ( parent.dataset.type == 'star-color' ) {\r\n                let ratingStar = affectedEl.querySelectorAll('li');\r\n                for( let i = 0; i < ratingStar.length; i++ ) {\r\n                    let span = ratingStar[i].getElementsByTagName( 'span' );\r\n                    for( let j = 0; j < span.length; j++ ) {\r\n                        span[j].style.fill = uiColor;\r\n                    }\r\n                }\r\n            } else if( parent.dataset.type == 'numeral-rating-color' ) {\r\n                let wptbTextMessageSize = affectedEl.querySelector('.wptb-text-message');\r\n                wptbTextMessageSize.style.color = uiColor;\r\n            }\r\n\r\n        } else {\r\n            affectedEl.style.color = uiColor;\r\n        }\r\n    },\r\n    starRatingSelectHoverSet : function( event ) {\r\n        let starRating;\r\n        if( ! event.target.classList.contains( 'wptb-rating-star' ) ) {\r\n            starRating = WPTB_Helper.findAncestor( event.target, 'wptb-rating-star' );\r\n        } else {\r\n            starRating = event.target;\r\n        }\r\n        \r\n        let onStar = parseInt( starRating.dataset.value, 10 ); // The star currently mouse on\r\n\r\n        // Now highlight all the stars that's not after the current hovered star\r\n        let children = starRating.parentNode.children;\r\n        if( event.type == \"mouseover\" ) {\r\n            for( let j = 0; j < children.length; j++ ) {\r\n                if( j < onStar ) {\r\n                    if( j == onStar - 1 ) {\r\n                        if ( event.target.classList.contains( 'wptb-rating-star-left-signal-part' ) ) {\r\n                            children[j].classList.add( 'wptb-rating-star-hover-half' );\r\n                            children[j].classList.remove( 'wptb-rating-star-hover-full' );\r\n                        } else if( event.target.classList.contains( 'wptb-rating-star-right-signal-part' ) ) {\r\n                            children[j].classList.add( 'wptb-rating-star-hover-full' );\r\n                            children[j].classList.remove( 'wptb-rating-star-hover-half' );\r\n                        }\r\n                    } else {\r\n                        children[j].classList.add( 'wptb-rating-star-hover-full' );\r\n                        children[j].classList.remove( 'wptb-rating-star-hover-half' );\r\n                    }\r\n                } else {\r\n                    children[j].classList.remove( 'wptb-rating-star-hover-full' );\r\n                    children[j].classList.remove( 'wptb-rating-star-hover-half' );\r\n                }\r\n            }\r\n        } else if ( event.type == \"click\" ) {\r\n            for( let j = 0; j < children.length; j++ ) {\r\n                if( j < onStar ) {\r\n                    if( j == onStar - 1 ) {\r\n                        if ( event.target.classList.contains( 'wptb-rating-star-left-signal-part' ) ) {\r\n                            children[j].classList.add( 'wptb-rating-star-selected-half' );\r\n                            children[j].classList.remove( 'wptb-rating-star-selected-full' );\r\n                        } else if( event.target.classList.contains( 'wptb-rating-star-right-signal-part' ) ) {\r\n                            children[j].classList.add( 'wptb-rating-star-selected-full' );\r\n                            children[j].classList.remove( 'wptb-rating-star-selected-half' );\r\n                        }\r\n                    } else {\r\n                        children[j].classList.add( 'wptb-rating-star-selected-full' );\r\n                        children[j].classList.remove( 'wptb-rating-star-selected-half' );\r\n                    }\r\n                } else {\r\n                    children[j].classList.remove( 'wptb-rating-star-selected-full' );\r\n                    children[j].classList.remove( 'wptb-rating-star-selected-half' );\r\n                }\r\n            }\r\n        }\r\n        \r\n    },\r\n    starRatingEventHandlersAdd: function( ratingStar ) {\r\n        ratingStar.onmouseover = function( event ) {\r\n            event.stopPropagation();\r\n            WPTB_Helper.starRatingSelectHoverSet( event );\r\n        }\r\n        ratingStar.onmouseout = function() {\r\n            let children = this.parentNode.children;\r\n            for( let j = 0; j < children.length; j++ ) {\r\n                children[j].classList.remove( 'wptb-rating-star-hover-half' );\r\n                children[j].classList.remove( 'wptb-rating-star-hover-full' );\r\n            }\r\n        }\r\n\r\n        /* 2. Action to perform on click */\r\n        ratingStar.onclick = function( event ) {\r\n            WPTB_Helper.starRatingSelectHoverSet( event );\r\n            \r\n            /* Rating number message */\r\n            let wptbStarRatingContainer = WPTB_Helper.findAncestor( event.target, 'wptb-star_rating-container' );\r\n\r\n            WPTB_Helper.starRatingTextMessageChenge( wptbStarRatingContainer );\r\n\r\n            let wptbActionsField = new WPTB_ActionsField( 1, wptbStarRatingContainer );\r\n\r\n            wptbActionsField.setParameters( wptbStarRatingContainer );\r\n\r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n        }\r\n    },\r\n    numberImputSize: function ( wptbNumberInputs, maxCount, maxValue ) {\r\n        wptbNumberInputs.onkeydown = function() {\r\n            let thisValue = this.value;\r\n            thisValue = String( thisValue );\r\n            if ( thisValue[0] == 0 ) {\r\n                this.value = \"\";\r\n            } else {\r\n                thisValue = thisValue.substring( 0, maxCount );\r\n                this.value = thisValue;\r\n            }\r\n        }\r\n        wptbNumberInputs.onkeyup = function() {\r\n            let thisValue = this.value;\r\n            thisValue = String( thisValue );\r\n            if ( thisValue > maxValue ) {\r\n                this.value = maxValue;\r\n            }\r\n        }\r\n    },\r\n    starRatingTextMessageChenge: function( starRatingContainer ) {\r\n        let ratingNumber = starRatingContainer.getElementsByClassName( 'wptb-rating-star-selected-full' ).length;\r\n        if( starRatingContainer.getElementsByClassName( 'wptb-rating-star-selected-half' ).length > 0 ) {\r\n            ratingNumber = parseInt( ratingNumber ) + 0.5;\r\n        }\r\n        \r\n        let wptbTextMessageCommon = starRatingContainer.querySelectorAll( 'li' ),\r\n            wptbTextMessageCommonVal = wptbTextMessageCommon.length,\r\n            wptbTextMessage = starRatingContainer.querySelector( '.wptb-text-message' );\r\n        if( wptbTextMessageCommonVal == 1 && wptbTextMessageCommon[0].style.display == 'none' ) {\r\n            wptbTextMessage.innerHTML = '';\r\n            return;\r\n        }\r\n        \r\n        wptbTextMessage.innerHTML = ratingNumber + '/' + wptbTextMessageCommonVal;\r\n    },\r\n    ucfirst: function( str ) {\r\n        return str.charAt(0).toUpperCase() + str.slice(1);\r\n    },\r\n    wpTemplatesHandler: function( kind ) {\r\n        wp_enqueue_script( kind + '_item_script_handler',  );\r\n    },\r\n    wptbDocumentEventGenerate: function( eventCustom ) {\r\n        let event = new Event( eventCustom, {bubbles: true} );\r\n        document.dispatchEvent( event );\r\n    },\r\n    wptbItemStartScript: function( item ) {\r\n        //let script = item.getElementsByTagName( 'script' );\r\n        let infArr = item.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n        if( infArr && Array.isArray( infArr ) ) {\r\n            let kind = infArr[1];\r\n            if( kind ) {\r\n                let wpTemplateId = 'wptb-' + kind + '-script';\r\n                let template = wp.template( wpTemplateId );\r\n                let data  = {elemClass: infArr[0]};\r\n                let itemScriptText = template( data );\r\n                itemScriptText = itemScriptText.replace(/\\r|\\n|\\t/g, '').trim();\r\n                \r\n                let scriptNew = document.createElement( 'script' );\r\n                scriptNew.setAttribute( 'type', 'text/javascript' );\r\n                scriptNew.innerHTML = itemScriptText;\r\n                item.parentNode.appendChild( scriptNew );\r\n                item.parentNode.removeChild( scriptNew );\r\n            }\r\n        }\r\n    }\r\n}\r\n","var WPTB_Image = function ( src, DOMElementProt ) {\r\n        let DOMElement,\r\n                elImage,\r\n            kindIndexProt = undefined,\r\n            copy = false;\r\n        if ( DOMElementProt == undefined ) {\r\n            DOMElement = document.createElement( 'div' );\r\n            elImage = document.createElement( 'div' );\r\n\t    let anchor = document.createElement( 'a' ),\r\n\t    img = document.createElement( 'img' );\r\n            anchor.style.display = 'block';\r\n            anchor.appendChild( img );\r\n            DOMElement.classList.add( 'wptb-image-container' );\r\n            elImage.classList.add( 'wptb-image-wrapper' );\r\n            elImage.appendChild( anchor );\r\n            DOMElement.appendChild( elImage );\r\n            \r\n            anchor.onclick = function( e ) {\r\n                e.preventDefault();\r\n            }\r\n            \r\n            file_frame = wp.media.frames.file_frame = wp.media({\r\n\t\ttitle: 'Select a image to upload',\r\n\t\tbutton: {\r\n                    text: 'Use this image'\r\n\t\t},\r\n\t\tmultiple: false,\r\n                frame: 'post'\r\n            });\r\n            \r\n            let imageSetting = function( img, attachment ) {\r\n                let imgSrc = attachment.url;\r\n                let linkArr = imgSrc.split( ':' ),\r\n                    linkClean;\r\n                if ( Array.isArray( linkArr ) && linkArr.length > 0 ) {\r\n                    linkClean = linkArr[linkArr.length - 1];\r\n                }\r\n                img.src = linkClean;\r\n                img.height = attachment.height;\r\n                img.width = attachment.width;\r\n                img.style.width = '100%';\r\n\r\n                let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n                wptbTableStateSaveManager.tableStateSet();\r\n            }\r\n            \r\n            // When an image is select, run a callback.\r\n            file_frame.on( 'select', function() {\r\n                attachment = file_frame.state().props.toJSON();\r\n                imageSetting( img, attachment );\r\n            });\r\n            \r\n            // When an image is insert, run a callback.\r\n            file_frame.on( 'insert', function () {\r\n                attachment = file_frame.state().get( 'selection' ).first().toJSON();\r\n                imageSetting( img, attachment );\r\n            });\r\n            \r\n            // Finally, open the modal\r\n            if (src == undefined) {\r\n                file_frame.open();\r\n                file_frame.menuItemVisibility( 'gallery', 'hide' );\r\n                file_frame.menuItemVisibility( 'playlist', 'hide' ), \r\n                file_frame.menuItemVisibility( 'video-playlist', 'hide' ), \r\n                file_frame.menuItemVisibility( 'audio-playlist', 'hide' )\r\n            } else {\r\n                img.src = src;\r\n            }\r\n        } else {\r\n            DOMElement = DOMElementProt.cloneNode( true );\r\n            \r\n            DOMElement.getElementsByTagName( 'a' )[0].onclick = function(e) {\r\n                e.preventDefault();\r\n            };\r\n            \r\n            let wptbElementMutch = DOMElementProt.className.match( /wptb-element-((.+-)\\d+)/i );\r\n            if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\r\n                kindIndexProt = wptbElementMutch[1];\r\n                copy = true;\r\n            };\r\n        }\r\n            \r\n        this.kind = 'image';\r\n        this.getDOMElement = function () {\r\n            return DOMElement;\r\n        };\r\n\tapplyGenericItemSettings( this, kindIndexProt, copy );\r\n\r\n\treturn this;\r\n};","var WPTB_Initializer = function () {\r\n\r\n    const MIN_COLUMNS = 1,\r\n        MIN_ROWS = 1,\r\n        MAX_COLUMNS = 30,\r\n        MAX_ROWS = 30;\r\n\r\n    var tableGenerator = document.body;\r\n    columnsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[0],\r\n            columnsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[0],\r\n            rowsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[1],\r\n            rowsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[1],\r\n            columnsInput = document.getElementById('wptb-columns-number'),\r\n            rowsInput = document.getElementById('wptb-rows-number');\r\n    \r\n    columnsDecrementButton.onclick = function () {\r\n            if (columnsInput.value > MIN_COLUMNS) {\r\n                    columnsInput.value--;\r\n            }\r\n    };\r\n\r\n    columnsIncrementButton.onclick = function () {\r\n            if (columnsInput.value < MAX_COLUMNS) {\r\n                    columnsInput.value++;\r\n            }\r\n    };\r\n\r\n    rowsDecrementButton.onclick = function () {\r\n            if (rowsInput.value > MIN_ROWS) {\r\n                    rowsInput.value--;\r\n            }\r\n    };\r\n\r\n    rowsIncrementButton.onclick = function () {\r\n            if (rowsInput.value < MAX_ROWS) {\r\n                    rowsInput.value++;\r\n            }\r\n    };\r\n\r\n    document.getElementById('wptb-generate-table').onclick = function () {\r\n            var columns = document.getElementById('wptb-columns-number').value,\r\n                rows = document.getElementById('wptb-rows-number').value;\r\n\r\n            WPTB_Table(columns, rows);\r\n            \r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n    }\r\n\r\n};\r\n","var WPTB_innerElementSet = function  ( element ) {\r\n    \r\n    element.ondragenter = function (e) {\r\n        var div;\r\n        if ( e.dataTransfer.types.indexOf( 'wptbelement' ) == -1 && e.dataTransfer.types.indexOf( 'wptb-moving-mode' ) == -1 ) {\r\n            return;\r\n        }\r\n        WPTB_DropHandle(this, e);\r\n        \r\n        element.classList.add( 'wptb-ondragenter' );\r\n    }\r\n    element.ondragover = function (e) {\r\n        e.preventDefault();\r\n        WPTB_DropHandle(this, e);\r\n    }\r\n    element.ondragleave = function () {\r\n        \r\n    }\r\n    element.ondrop = function(e) {\r\n        this.classList.remove( 'wptb-ondragenter' );\r\n        let element, classId;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        if (!e.dataTransfer.getData('wptbElement') && !e.dataTransfer.getData('node')) {\r\n            return;\r\n        }\r\n        let wptbDropHandle,\r\n            wptbDropBorderMarker;\r\n        if ( document.getElementsByClassName( 'wptb-drop-handle' ).length > 0 ) {\r\n            wptbDropHandle = document.getElementsByClassName( 'wptb-drop-handle' )[0];\r\n        }\r\n        if( document.getElementsByClassName( 'wptb-drop-border-marker' ).length > 0 ) {\r\n            wptbDropBorderMarker = document.getElementsByClassName( 'wptb-drop-border-marker' )[0];\r\n        }\r\n\r\n        if ( e.dataTransfer.getData( 'wptbElement' ) ) {\r\n            element = WPTB_Helper.newElementProxy( e.dataTransfer.getData( 'wptbElement' ) );\r\n            element = element.getDOMElement();\r\n        } else {\r\n            classId = e.dataTransfer.getData( 'node' );\r\n            element = document.getElementsByClassName( classId )[0];\r\n            //element.classList.remove( 'wptb-moving-mode' );\r\n        }\r\n        \r\n        if( wptbDropHandle.style.display == 'block' ) {\r\n            let td;\r\n            if( wptbDropHandle.dataset.text == 'Drop Here' ) {\r\n                td = wptbDropHandle.getDOMParentElement();\r\n                td.appendChild( element );\r\n            } else {\r\n                let innerElement = wptbDropHandle.getDOMParentElement();\r\n                td = innerElement.parentNode;\r\n\r\n                if( wptbDropHandle.dataset.text == 'Above Element' ) {\r\n                    td.insertBefore( element, innerElement );\r\n                } else if( wptbDropHandle.dataset.text == 'Below Element' ) {\r\n                    let innerElementNext = innerElement.nextSibling;\r\n                    td.insertBefore( element, innerElementNext );\r\n                }\r\n            }\r\n            let thisRow = td.parentNode\r\n            if( thisRow.classList.contains( 'wptb-table-head' ) ) {\r\n                let table = WPTB_Helper.findAncestor( thisRow, 'wptb-preview-table' );\r\n                WPTB_Helper.dataTitleColumnSet( table );\r\n            }\r\n            \r\n            // start item javascript if item is new\r\n            let infArr = element.className.match(/wptb-element-(.+)-(\\d+)/i);\r\n            let elemType = infArr[1];\r\n            if ( e.dataTransfer.getData( 'wptbElement' ) && elemType == 'text' ) {\r\n                WPTB_Helper.wptbItemStartScript( element );\r\n            }\r\n        } else {\r\n            return;\r\n        }\r\n        \r\n        wptbDropHandle.style.display = 'none';\r\n        wptbDropBorderMarker.style.display = 'none';\r\n\r\n        WPTB_innerElementSet( element );\r\n        \r\n        if( ! element.classList.contains( 'wptb-image-container' ) || element.classList.contains( 'wptb-moving-mode' ) ) {\r\n            element.classList.remove( 'wptb-moving-mode' );\r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n        } \r\n        return true;\r\n    }\r\n    element.onmouseover = function(e) {\r\n        element.classList.remove( 'wptb-ondragenter' );\r\n    }\r\n}","var WPTB_ItemObject = function ( data ) {\n    let DOMElement, kindIndexProt, copy;\n    if( ! data.elemProt ) {\n        DOMElement = document.createElement('div'),\n        kindIndexProt = undefined,\n        copy = false;\n        DOMElement.classList.add( 'wptb-' + data.kind + '-container', 'wptb-ph-element', 'wptb-item-javascript-indic' );\n    \n        let wpTemplateId = 'wptb-' + data.kind + '-content';\n        let template = wp.template( wpTemplateId );\n        data.node = DOMElement;\n        let itemHtml = template( data );\n\n        itemHtml = itemHtml.replace(/\\r|\\n|\\t/g, '').trim();\n        DOMElement.innerHTML = itemHtml;\n    } else {\n        DOMElement = data.elemProt.cloneNode( true );\n        DOMElement.classList.remove( 'wptb-directlyhovered' );\n        let wptbElementMutch = data.elemProt.className.match( /wptb-element-((.+-)\\d+)/i );\n        if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\n            kindIndexProt = wptbElementMutch[1];\n        };\n        copy = true;\n    }\n     \n    window.addEventListener( 'item:onmouseenter', function( event ) {\n        //console.log( event );\n    }, false);\n    \n    \n    this.kind = data.kind;\n    this.getDOMElement = function () {\n        return DOMElement;\n    };\n    \n    applyGenericItemSettings( this, kindIndexProt, copy );\n    return this;\n}\n\n\n","var WPTB_LeftPanel = function () {\r\n\r\n    var table = document.getElementsByClassName('wptb-preview-table')[0],\r\n        wptbElementButtons = document.getElementsByClassName('wptb-element');\r\n    \r\n    function wptbTdBgColorSavedSet( inputId, trNumber ) {\r\n        if ( trNumber > 3 ) return;\r\n        if( table ) {\r\n            let tableRows = table.getElementsByTagName('tr');\r\n            if ( tableRows.length > trNumber ) {\r\n                let trBackgroundColor = tableRows[trNumber].style.backgroundColor;\r\n                var wptbEvenRowBg = document.getElementById(inputId);\r\n                if ( wptbEvenRowBg && trBackgroundColor ) {\r\n                    wptbEvenRowBg.value = WPTB_Helper.rgbToHex( trBackgroundColor );\r\n                }\r\n            }\r\n        }\r\n        \r\n    }\r\n    \r\n    wptbTdBgColorSavedSet( 'wptb-even-row-bg', 1 );\r\n    jQuery('#wptb-even-row-bg').wpColorPicker({\r\n        change: function ( event, ui ) {\r\n            var tableRows = table.getElementsByTagName('tr');\r\n            for ( let i = 1; i < tableRows.length; i += 2 ) {\r\n                tableRows[i].style.backgroundColor = ui.color.toString();\r\n            }\r\n            console.log(event);\r\n            console.log(this);\r\n            WPTB_Helper.wpColorPickerCheckChangeForTableStateSaving( event );\r\n        },\r\n        clear: function(){\r\n            var tableRows = table.getElementsByTagName('tr');\r\n            for ( let i = 1; i < tableRows.length; i += 2 ) {\r\n                tableRows[i].style.backgroundColor = '';\r\n                let tds = tableRows[i].getElementsByTagName('td');\r\n                for ( let j = 0; j < tds.length; j++ ) {\r\n                    tds[j].style.backgroundColor = '';\r\n                }\r\n            }\r\n            \r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n        },\r\n\r\n    });\r\n    \r\n    wptbTdBgColorSavedSet( 'wptb-odd-row-bg', 2 );\r\n    jQuery('#wptb-odd-row-bg').wpColorPicker({\r\n        change: function ( event, ui ) {\r\n            var tableRows = table.getElementsByTagName('tr');\r\n            for ( let i = 2; i < tableRows.length; i += 2 ) {\r\n                tableRows[i].style.backgroundColor = ui.color.toString();\r\n            }\r\n            \r\n            WPTB_Helper.wpColorPickerCheckChangeForTableStateSaving( event );\r\n        },\r\n        clear: function(){\r\n            var tableRows = table.getElementsByTagName('tr');\r\n            for ( let i = 2; i < tableRows.length; i += 2 ) {\r\n                tableRows[i].style.backgroundColor = '';\r\n                let tds = tableRows[i].getElementsByTagName( 'td' );\r\n                for ( var j = 0; j < tds.length; j++ ) {\r\n                    tds[j].style.backgroundColor = '';\r\n                }\r\n            }\r\n            \r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n        },\r\n    });\r\n    \r\n    wptbTdBgColorSavedSet( 'wptb-table-header-bg', 0 );\r\n    jQuery('#wptb-table-header-bg').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableHeader = table.getElementsByTagName('tr')[0];\r\n            tableHeader.style.backgroundColor = ui.color.toString();\r\n            \r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n        },\r\n        clear: function(){\r\n            var tableHeader = table.getElementsByTagName('tr')[0];\r\n            tableHeader.style.backgroundColor = '';\r\n            let tds = tableHeader.getElementsByTagName('td');\r\n            for (var j = 0; j < tds.length; j++) {\r\n                tds[j].style.backgroundColor = '';\r\n            }\r\n            \r\n            WPTB_Helper.wpColorPickerCheckChangeForTableStateSaving( event );\r\n        },\r\n    });\r\n    \r\n    function tableAdaptiveForMobile( table ) {\r\n        let wptbAdaptiveTableCheckbox = document.getElementById( 'wptb-adaptive-table-checkbox' );\r\n        if( table && table.dataset.wptbAdaptiveTable && table.dataset.wptbAdaptiveTable == \"1\" ) {\r\n            wptbAdaptiveTableCheckbox.checked = true;\r\n        } else {\r\n            wptbAdaptiveTableCheckbox.checked = false;\r\n        }\r\n    }\r\n    tableAdaptiveForMobile( table );\r\n    \r\n    function tableTopRowAsHeadSavedSet( table ) {\r\n        let wptbTopRowAsHeader = document.getElementById( 'wptb-top-row-as-header' );\r\n        \r\n        if( table && table.classList.contains( 'wptb-table-preview-head' ) ) {\r\n            wptbTopRowAsHeader.checked = true;\r\n        } else {\r\n            wptbTopRowAsHeader.checked = false;\r\n        }\r\n    }\r\n    tableTopRowAsHeadSavedSet( table );\r\n    \r\n    function tableBorderColorWidthSavedSet() {\r\n        let table = document.getElementsByClassName('wptb-preview-table');\r\n        if ( table.length > 0 ) {\r\n            let tableBorderColor = table[0].style.borderColor;\r\n            if ( tableBorderColor ) {\r\n                let tableBorderColorInput = document.getElementById( 'wptb-table-border-color' );\r\n                if ( tableBorderColorInput ) {\r\n                    tableBorderColorInput.value = WPTB_Helper.rgbToHex( tableBorderColor );\r\n                }\r\n            }\r\n            \r\n            let tableBorderWidth = table[0].style.borderWidth;\r\n            if ( tableBorderWidth ) {\r\n                let wptbTableBorderWidthSlider = document.getElementById('wptb-table-border-slider'),\r\n                    wptbTableBorderWidthNumber = document.getElementById('wptb-table-border-number');\r\n                \r\n                if ( wptbTableBorderWidthSlider ) {\r\n                    wptbTableBorderWidthSlider.value = parseInt( tableBorderWidth );\r\n                }\r\n                if ( wptbTableBorderWidthNumber ) {\r\n                    wptbTableBorderWidthNumber.value = parseInt( tableBorderWidth );\r\n                }\r\n            }\r\n            \r\n            \r\n            let tableTd = table[0].querySelector( 'td' );\r\n            let applyInnerBorder = tableTd.style.borderWidth;\r\n            if ( applyInnerBorder ) {\r\n                let innerBorderCheckInput = document.getElementById( 'wptb-inner-border-check' );\r\n                let wptbApplyInnerBorder = document.getElementById( 'wptb-apply-inner-border' );\r\n                if ( applyInnerBorder && parseInt( applyInnerBorder ) > 0 ) {\r\n                    if ( innerBorderCheckInput ) {\r\n                        innerBorderCheckInput.checked = true;\r\n                        \r\n                        if ( wptbApplyInnerBorder ) {\r\n                            wptbApplyInnerBorder.classList.add( 'visible' );\r\n                            let wptbTableInnerBorderSlider = document.getElementById( 'wptb-table-inner-border-slider' );\r\n                            let wptbTableInnerBorderNumber = document.getElementById( 'wptb-table-inner-border-number' );\r\n                            wptbTableInnerBorderSlider.value = parseInt( applyInnerBorder );\r\n                            wptbTableInnerBorderNumber.value = parseInt( applyInnerBorder );\r\n                        }\r\n                    }\r\n                } else {\r\n                    innerBorderCheckInput.checked = false;\r\n                }\r\n            }\r\n            \r\n            if ( ( tableBorderWidth && parseInt( tableBorderWidth ) > 0 ) || ( applyInnerBorder && parseInt( applyInnerBorder ) > 0 ) ) {\r\n                document.getElementById( 'wptb-table-border-color-set-area' ).style.display = '';\r\n            }\r\n        }\r\n    }\r\n    \r\n    tableBorderColorWidthSavedSet();\r\n\r\n    jQuery('#wptb-table-border-color').wpColorPicker({\r\n        change: function (event, ui) {\r\n            var tableCells = table.getElementsByTagName('td');\r\n            table.style.border = document.querySelector('#wptb-table-border-number').value + 'px solid ' + ui.color.toString();\r\n\r\n            for (var i = 0; i < tableCells.length; i++) {\r\n                let tableInnerborderNumber = document.querySelector('#wptb-table-inner-border-number').value;\r\n                if ( document.getElementById('wptb-inner-border-check').checked ) {\r\n                    tableCells[i].style.border = ( tableInnerborderNumber != 0 ? tableInnerborderNumber : 1 ) + 'px solid ' + ui.color.toString();\r\n                }\r\n            }\r\n            WPTB_Helper.wpColorPickerCheckChangeForTableStateSaving( event );\r\n        },\r\n        clear: function() {\r\n            var tableCells = table.getElementsByTagName('td');\r\n            table.style.borderColor = '';\r\n\r\n            for (var i = 0; i < tableCells.length; i++) {\r\n                tableCells[i].style.borderColor = '';\r\n            }\r\n            \r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n        }\r\n    });\r\n\r\n    function addInnerBorderSize(value) {\r\n        var tableCells = table.getElementsByTagName('td');\r\n        for (var i = 0; i < tableCells.length; i++) {\r\n            tableCells[i].style.borderWidth = document.querySelector('#wptb-table-inner-border-number').value + 'px';\r\n            tableCells[i].style.borderStyle = 'solid';\r\n        }\r\n    }\r\n\r\n    function addCellPadding(value) {\r\n        var tableCells = table.getElementsByTagName('td');\r\n        for (var i = 0; i < tableCells.length; i++) {\r\n            tableCells[i].style.padding = value + 'px';\r\n        }\r\n    }\r\n\r\n    function addInnerBorder( checked ) {\r\n        var styles, color = document.querySelector('#wptb-table-border-color').value != undefined ?\r\n            document.querySelector('#wptb-table-border-color').value : 'rgb(0,0,0)';\r\n            if ( document.querySelector( '#wptb-table-inner-border-slider' ).value == 0 || document.querySelector( '#wptb-table-inner-border-number' ).value == 0 ) {\r\n                document.querySelector( '#wptb-table-inner-border-slider' ).value = 1;\r\n                document.querySelector( '#wptb-table-inner-border-number' ).value = 1;\r\n            }\r\n            let width = document.querySelector( '#wptb-table-inner-border-slider' ).value + 'px';\r\n        let wptbPreviewTable = document.getElementsByClassName('wptb-preview-table');\r\n        if( wptbPreviewTable.length > 0 ) {\r\n            if (checked == 'checked') {\r\n                document.getElementById('wptb-apply-inner-border').style.marginBottom = '0px';\r\n                var tableCells = wptbPreviewTable[0].getElementsByTagName( 'td' );\r\n                for (var i = 0; i < tableCells.length; i++) {\r\n                    tableCells[i].style.border = width + ' solid ' + color;\r\n                }\r\n                document.getElementById( 'wptb-apply-inner-border' ).classList.add( 'visible' );\r\n            } else {\r\n                document.getElementById( 'wptb-apply-inner-border' ).classList.remove( 'visible' );\r\n                var tableCells = wptbPreviewTable[0].getElementsByTagName( 'td' );\r\n                for (var i = 0; i < tableCells.length; i++) {\r\n                    tableCells[i].style.border = '0px solid ' + color;\r\n                    tableCells[i].style.border = null;\r\n                }\r\n            }\r\n        }\r\n        \r\n    }\r\n\r\n    function addBorderSize( value ) {\r\n        table.style.borderWidth = value + 'px';\r\n        table.style.borderStyle = 'solid';\r\n    }\r\n    \r\n    function cellPaddingSavedSet() {\r\n        let table = document.getElementsByClassName('wptb-preview-table');\r\n        \r\n        if ( table.length > 0 ) {\r\n            let td = table[0].querySelector( 'td' );\r\n            \r\n            if ( td ) {\r\n                let padding = td.style.padding;\r\n                \r\n                if ( padding ) {\r\n                    let wptbTableCellSlider = document.getElementById('wptb-table-cell-slider'),\r\n                        wptbTableCellNumber = document.getElementById('wptb-table-cell-number');\r\n                \r\n                    if ( wptbTableCellSlider ) {\r\n                        wptbTableCellSlider.value = parseInt( padding );\r\n                    }\r\n                    if ( wptbTableCellNumber ) {\r\n                        wptbTableCellNumber.value = parseInt( padding );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    cellPaddingSavedSet();\r\n    \r\n    let wptbTableBorderNumber = document.getElementById( 'wptb-table-border-number' );\r\n    WPTB_Helper.numberImputSize( wptbTableBorderNumber, 1, 50 );\r\n    \r\n    let wptbTableInnerBorderNumber = document.getElementById( 'wptb-table-inner-border-number' );\r\n    WPTB_Helper.numberImputSize( wptbTableInnerBorderNumber, 1, 50 );\r\n    \r\n    let wptbTableCellNumber = document.getElementById( 'wptb-table-cell-number' );\r\n    WPTB_Helper.numberImputSize( wptbTableCellNumber, 1, 50 );\r\n    \r\n    let wptbTextfontSizeNumber = document.getElementById( 'wptb-size-number' );\r\n    WPTB_Helper.numberImputSize( wptbTextfontSizeNumber, 1, 50 );\r\n    \r\n    let wptbImageWidthNumber = document.getElementById( 'wptb-size-number' );\r\n    WPTB_Helper.numberImputSize( wptbImageWidthNumber, 2, 100 );\r\n    \r\n    let wptbTableColumnWidthNumber = document.getElementById( 'wptb-table-column-width-number' );\r\n    WPTB_Helper.numberImputSize( wptbTableColumnWidthNumber, 2, 500 );\r\n    \r\n    let wptbTableRowHeightNumber = document.getElementById( 'wptb-table-row-height-number' );\r\n    WPTB_Helper.numberImputSize( wptbTableRowHeightNumber, 2, 200 );\r\n    \r\n    \r\n    \r\n    document.getElementById('wptb-table-cell-slider').oninput = function () {\r\n        document.getElementById('wptb-table-cell-number').value = this.value;\r\n        addCellPadding(this.value);\r\n        table.tdDefaultWidth();\r\n    };\r\n    \r\n    document.getElementById('wptb-table-cell-slider').onchange = function() {\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    }\r\n\r\n    document.getElementById('wptb-table-cell-number').onchange = function () {\r\n        document.getElementById('wptb-table-cell-slider').value = this.value;\r\n        addCellPadding(this.value);\r\n        table.tdDefaultWidth();\r\n        \r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n\r\n    document.getElementById('wptb-table-border-slider').oninput = function () {\r\n        document.getElementById('wptb-table-border-number').value = this.value;\r\n        addBorderSize(this.value);\r\n        table.tdDefaultWidth();\r\n        \r\n        let wptbInnerBorderCheck = document.getElementById('wptb-inner-border-check').checked,\r\n            tableBorderColorSetArea = document.getElementById( 'wptb-table-border-color-set-area' );\r\n        if ( this.value == 0 && wptbInnerBorderCheck == false ) {\r\n            tableBorderColorSetArea.style.display = 'none';\r\n        } else {\r\n            tableBorderColorSetArea.style.display = '';\r\n        }\r\n    };\r\n    \r\n    document.getElementById('wptb-table-border-slider').onchange = function() {\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    }\r\n\r\n    document.getElementById('wptb-table-border-number').onchange = function () {\r\n        document.getElementById('wptb-table-border-slider').value = this.value;\r\n        addBorderSize(this.value);\r\n        table.tdDefaultWidth();\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n\r\n    document.getElementById('wptb-table-inner-border-slider').oninput = function () {\r\n        document.getElementById('wptb-table-inner-border-number').value = this.value;\r\n        addInnerBorderSize(this.value);\r\n        table.tdDefaultWidth();\r\n    };\r\n    \r\n    document.getElementById('wptb-table-inner-border-slider').onchange = function () {\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    }\r\n\r\n    document.getElementById('wptb-table-inner-border-number').onchange = function () {\r\n        document.getElementById('wptb-table-inner-border-slider').value = this.value;\r\n        addInnerBorderSize(this.value);\r\n        table.tdDefaultWidth();\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n\r\n    document.getElementById('wptb-inner-border-check').onchange = function () {\r\n        if( table ) {\r\n            let val = this.checked ? 'checked' : 'unchecked';\r\n            addInnerBorder( val );\r\n            let borderWidth = document.getElementById('wptb-table-border-slider').value,\r\n                tableBorderColorSetArea = document.getElementById( 'wptb-table-border-color-set-area' );\r\n            if( val == 'unchecked' && borderWidth == 0 ) {\r\n                tableBorderColorSetArea.style.display = 'none';\r\n            } else {\r\n                tableBorderColorSetArea.style.display = '';\r\n            }\r\n            \r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n        }\r\n    };\r\n    \r\n    document.getElementById( 'wptb-table-column-width-slider' ).oninput = function () {\r\n        document.getElementById( 'wptb-table-column-width-number' ).value = this.value;\r\n        table.addColumnWidth( this.value );\r\n    };\r\n    \r\n    document.getElementById( 'wptb-table-column-width-slider' ).onchange = function () {\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n    \r\n    document.getElementById( 'wptb-table-column-width-number' ).onchange = function () {\r\n        document.getElementById( 'wptb-table-column-width-slider' ).value = this.value;\r\n        table.addColumnWidth( this.value );\r\n        \r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n    \r\n    document.getElementById( 'wptb-table-column-width-auto-fixed' ).onchange = function () {\r\n        if( this.checked ) {\r\n            let highlighted = table.querySelector( '.wptb-highlighted' );\r\n            let width = WPTB_Helper.getColumnWidth( table, highlighted );\r\n            table.addColumnWidth( width );\r\n        } else {\r\n            table.addColumnWidth( false, true );\r\n            let highlighted = table.querySelector( '.wptb-highlighted' );\r\n            let width = WPTB_Helper.getColumnWidth( table, highlighted );\r\n            document.getElementById( 'wptb-table-column-width-number' ).value = width;\r\n            document.getElementById( 'wptb-table-column-width-slider' ).value = width;\r\n        }\r\n        \r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n\r\n    document.getElementById( 'wptb-table-row-height-slider' ).oninput = function () {\r\n        document.getElementById( 'wptb-table-row-height-number' ).value = this.value;\r\n        table.addRowHeight( this.value );\r\n    };\r\n    \r\n    document.getElementById( 'wptb-table-row-height-slider' ).onchange = function () {\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n\r\n    document.getElementById( 'wptb-table-row-height-number' ).onchange = function () {\r\n        document.getElementById( 'wptb-table-row-height-slider' ).value = this.value;\r\n        table.addRowHeight( this.value );\r\n        \r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n    \r\n    document.getElementById( 'wptb-table-row-height-auto-fixed' ).onchange = function () {\r\n        if( this.checked ) {\r\n            let highlighted = table.querySelector( '.wptb-highlighted' );\r\n            let height = WPTB_Helper.getRowHeight( table, highlighted );\r\n            table.addRowHeight( height );\r\n        } else {\r\n            table.addRowHeight( false, true );\r\n            let highlighted = table.querySelector( '.wptb-highlighted' );\r\n            let height = WPTB_Helper.getRowHeight( table, highlighted );\r\n            document.getElementById( 'wptb-table-row-height-number' ).value = height;\r\n            document.getElementById( 'wptb-table-row-height-slider' ).value = height;\r\n        }\r\n        \r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n    \r\n    document.getElementById( 'wptb-adaptive-table-checkbox' ).onchange = function() {\r\n        if( this.checked ) {\r\n            table.dataset.wptbAdaptiveTable = 1;\r\n        } else {\r\n            table.dataset.wptbAdaptiveTable = 0;\r\n        }\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n    \r\n    function createMobileHeadForTable( table, thisEvent ) {\r\n        \r\n        if( thisEvent.checked ) {\r\n            WPTB_Helper.dataTitleColumnSet( table );\r\n            \r\n            table.classList.add( 'wptb-table-preview-head' );\r\n            table.rows[0].classList.add( 'wptb-table-head' );\r\n        } else {\r\n            let rows = table.rows;\r\n            table.classList.remove( 'wptb-table-preview-head' );\r\n            rows[0].classList.remove( 'wptb-table-head' );\r\n            \r\n            for ( let i = 1; i < rows.length; i++ ) {\r\n                let thisRow = rows[i],\r\n                    thisRowChildren = thisRow.children;\r\n                for( let j = 0; j < thisRowChildren.length; j++ ) {\r\n                    thisRowChildren[j].removeAttribute( 'data-wptb-title-column' );\r\n                    thisRowChildren[j].removeAttribute( 'data-wptb-title-column-font-size' );\r\n                    thisRowChildren[j].removeAttribute( 'data-wptb-title-column-color' );\r\n                    thisRowChildren[j].removeAttribute( 'data-wptb-title-background-color' );\r\n                    thisRowChildren[j].removeAttribute( 'data-wptb-title-align' );\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    document.getElementById( 'wptb-top-row-as-header' ).onchange = function () {\r\n        createMobileHeadForTable( table, this );\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    }\r\n\r\n    for (var i = 0; i < wptbElementButtons.length; i++) {\r\n        wptbElementButtons[i].ondragstart = function (e) {\r\n            e.dataTransfer.setData('wptbElement', this.dataset.wptbElement);\r\n            e.dataTransfer.setData( 'wptbElIndic-' + this.dataset.wptbElement, 'wptbElIndic-' + this.dataset.wptbElement );\r\n        }\r\n    }\r\n    \r\n    if( table ) {\r\n        document.getElementById('wptb-activate-cell-management-mode').onclick = table.toggleTableEditMode;\r\n        document.getElementById( 'wptb-table-edit-mode-close' ).onclick = table.toggleTableEditMode;\r\n        document.getElementById( 'wptb-left-scroll-panel-curtain-close' ).onclick = table.toggleTableEditMode;\r\n        document.getElementById('wptb-add-end-row').onclick = table.addRowToTheEnd;\r\n        document.getElementById('wptb-add-start-row').onclick = table.addRowToTheStart;\r\n        document.getElementById('wptb-add-row-before').onclick = table.addRowBefore;\r\n        document.getElementById('wptb-add-row-after').onclick = table.addRowAfter;\r\n        document.getElementById('wptb-add-end-column').onclick = table.addColumnEnd;\r\n        document.getElementById('wptb-add-start-column').onclick = table.addColumnStart;\r\n        document.getElementById('wptb-add-column-before').onclick = table.addColumnBefore;\r\n        document.getElementById('wptb-add-column-after').onclick = table.addColumnAfter;\r\n        document.getElementById('wptb-delete-column').onclick = table.deleteColumn;\r\n        document.getElementById('wptb-delete-row').onclick = table.deleteRow;\r\n        document.getElementById('wptb-merge-cells').onclick = table.mergeCells;\r\n        document.getElementById('wptb-split-cell').onclick = table.splitCell;\r\n    }\r\n    \r\n    document.querySelector( '.wptb-left-panel-extend' ).onclick = function() {\r\n        let wptbContainer = document.querySelector( '.wptb-container' );\r\n        if( wptbContainer ) {\r\n            if ( wptbContainer.classList.contains( 'collapsed' ) ) {\r\n                wptbContainer.classList.remove( 'collapsed' );\r\n            } else {\r\n                wptbContainer.classList.add( 'collapsed' );\r\n            }\r\n        }\r\n    };\r\n    \r\n    // this code hides the \"element parameters\" area \r\n    // when clicked outside this element and its \"tinymce\" toolbar \r\n    let wptbBuilderPanel = document.getElementsByClassName( 'wptb-builder-panel' )[0];\r\n    wptbBuilderPanel.onclick = function( e ) {\r\n        if( ! e.target.classList.contains( 'wptb-ph-element' ) && ! WPTB_Helper.findAncestor( e.target, 'wptb-ph-element' ) && \r\n               ! e.target.classList.contains( 'wptb-fixed-toolbar' ) && ! WPTB_Helper.findAncestor( e.target, 'wptb-fixed-toolbar' ) ) {\r\n            clickOnFreeSpace();\r\n        } \r\n   };\r\n   \r\n   let wptbHeader = document.getElementsByClassName( 'wptb-header' );\r\n   if( wptbHeader.length > 0 ) wptbHeader = wptbHeader[0];\r\n   wptbHeader.onclick = function() {\r\n       clickOnFreeSpace();\r\n   }\r\n   \r\n   function clickOnFreeSpace() {\r\n       document.getElementsByClassName( 'wptb-elements-container' )[0].style.display = 'table';\r\n        document.getElementsByClassName( 'wptb-settings-section' )[0].style.display = 'block';\r\n        document.getElementById( 'element-options-group' ).style.display = 'none';\r\n        let wpcdFixedToolbar = document.getElementById( 'wpcd_fixed_toolbar' );\r\n        if( wpcdFixedToolbar.hasAttribute( 'data-toolbar-active-id' ) ) {\r\n            document.getElementById( wpcdFixedToolbar.getAttribute( 'data-toolbar-active-id' ) ).classList.remove( 'toolbar-active' );\r\n        }\r\n   }\r\n   document.querySelector('.wptb-panel-left').addEventListener('click', function (event) {\r\n      if (event.target.classList.contains('wptb-exit-options')) {\r\n        clickOnFreeSpace();\r\n      }\r\n    });\r\n   \r\n};","var WPTB_List = function ( innerElements, DOMElementProt ) {\r\n\r\n    var el_L = document.createElement('ul'), item,\r\n        DOMElement = document.createElement('div'),\r\n        kindIndexProt = undefined,\r\n        copy = false;\r\n    DOMElement.classList.add( 'wptb-list-item-container' );\r\n\r\n    this.kind = 'list';\r\n\r\n    if (innerElements === '') {\r\n        //Case for edit mode list\r\n    } else if ( !innerElements ) {\r\n        for (var i = 0; i < 3; i++) {\r\n            item = new WPTB_ListItem( '<p>List Item ' + (i + 1) + '</p>');\r\n            el_L.appendChild(item.getDOMElement());\r\n        }\r\n    } else {\r\n        let wptbElementMutch = DOMElementProt.className.match( /wptb-element-((.+-)\\d+)/i );\r\n            if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\r\n                kindIndexProt = wptbElementMutch[1];\r\n                copy = true;\r\n            };\r\n        \r\n        for ( var i = 0; i < innerElements.length; i++ ) {\r\n            let listItem = DOMElementProt.querySelector( 'li' );\r\n            item = new WPTB_ListItem( innerElements[i], listItem, true );\r\n            el_L.appendChild(item.getDOMElement());\r\n        }\r\n    }\r\n    DOMElement.appendChild(el_L);\r\n    //window.addElementOptions('list', elList);\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    }\r\n    applyGenericItemSettings( this, kindIndexProt, copy );\r\n    WPTB_Helper.listItemsRecalculateIndex( el_L );\r\n\r\n    return this;\r\n};","var WPTB_ListItem = function ( text, DOMElementProt, copy ) {\r\n    let wptbListItemReturn;\r\n    if ( DOMElementProt == undefined || ( DOMElementProt && copy )) {\r\n        if (text == undefined) text = 'New List Item';\r\n        var DOMElement = document.createElement('li'),\r\n            //divdot = document.createElement('div'),\r\n            divcontent = document.createElement('div');\r\n            //libullet = document.createElement('li');\r\n        //divdot.classList.add('wptb-list-item-style-dot');\r\n        divcontent.classList.add('wptb-list-item-content');\r\n        //libullet.classList.add('wptb-bullet');\r\n        if ( DOMElementProt ) {\r\n            let styleDot = DOMElementProt.getAttribute( 'style' );\r\n            if ( styleDot ) {\r\n                DOMElement.setAttribute( 'style', styleDot );\r\n            }\r\n        }\r\n        //DOMElement.appendChild(divdot);\r\n        DOMElement.appendChild(divcontent);\r\n        //divdot.appendChild(libullet);\r\n        divcontent.innerHTML = text;\r\n        divcontent.onkeyup = window.listItemKeyListener;\r\n        \r\n        wptbListItemReturn = true;\r\n    } else {\r\n        var DOMElement = DOMElementProt;\r\n        var divcontent = DOMElement.getElementsByClassName( 'wptb-list-item-content' )[0];\r\n    \r\n        divcontent.onkeyup = window.listItemKeyListener;\r\n        \r\n        wptbListItemReturn = false;\r\n    }\r\n    \r\n    DOMElement.onmouseenter = function ( event ) {\r\n        let wptbActionsField = new WPTB_ActionsField();\r\n        \r\n        wptbActionsField.addActionField( 2, DOMElement );\r\n        \r\n        wptbActionsField.setParameters( DOMElement );\r\n        console.log(DOMElement);\r\n    };\r\n\r\n    DOMElement.onmouseleave = function ( event ) {\r\n        let wptbActionsField = new WPTB_ActionsField();\r\n        \r\n        wptbActionsField.leaveFromField( event, DOMElement, 2 );\r\n        \r\n        return false;\r\n    };\r\n\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    };\r\n    \r\n    if ( wptbListItemReturn ) {\r\n        return this;\r\n    }\r\n};","var MultipleSelect = function () {\r\n\r\n\tvar selectedCells = [],\r\n\t\tmultipleCellMode = false;\r\n\r\n\tthis.activateMultipleSelectMode = function () {\r\n\t\tselectedCells = [];\r\n\t\tvar tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\r\n\t\tfor (var i = 0; i < tds.length; i++) {\r\n\t\t\ttds[i].classList.remove('wptb-highlighted');\r\n\t\t}\r\n\t\tmultipleCellMode = true;\r\n\t}\r\n\r\n\tthis.deactivateMultipleSelectMode = function () {\r\n\t\tmultipleCellMode = false;\r\n\t}\r\n\r\n\tthis.isActivated = function () {\r\n\t\treturn multipleCellMode;\r\n\t}\r\n\r\n\tthis.pushSelectedCell = function (cell) {\r\n\t\tif (!multipleCellMode) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tselectedCells.push(cell);\r\n\t\tcell.classList.add('wptb-highlighted');\r\n\t};\r\n\r\n\tthis.selectedCells = function () {\r\n\t\treturn selectedCells;\r\n\t}\r\n\r\n\tthis.flushSelectedCells = function () {\r\n\t\tselectedCells = [];\r\n\t}\r\n\r\n\tthis.getFirst = function () {\r\n\t\tvar minXIndex = 1000, minYIndex = 1000, first;\r\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\r\n\t\t\tif (minXIndex >= selectedCells[i].dataset.xIndex\r\n\t\t\t\t&& minYIndex >= selectedCells[i].dataset.yIndex) {\r\n\t\t\t\tfirst = selectedCells[i];\r\n\t\t\t\tminXIndex = selectedCells[i].dataset.xIndex;\r\n\t\t\t\tminYIndex = selectedCells[i].dataset.yIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn first;\r\n\t}\r\n\r\n\tthis.getLast = function () {\r\n\t\tvar maxXIndex = -1, maxYIndex = -1, last;\r\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\r\n\t\t\tif (maxXIndex <= selectedCells[i].dataset.xIndex\r\n\t\t\t\t&& maxYIndex <= selectedCells[i].dataset.yIndex) {\r\n\t\t\t\tlast = selectedCells[i];\r\n\t\t\t\tmaxXIndex = selectedCells[i].dataset.xIndex;\r\n\t\t\t\tmaxYIndex = selectedCells[i].dataset.yIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn last;\r\n\t}\r\n\r\n\tthis.removeAllButFirst = function () {\r\n\t\tvar td = this.getFirst();\r\n\t\tfor (var i = 1; i < selectedCells.length; i++) {\r\n\t\t\tselectedCells[i].classList.add('wptb-fused-cell-' + td.dataset.xIndex + '-' + td.dataset.yIndex);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};","var WPTB_Parser = function (code) {\n    let div = document.createElement( 'div' );\n    div.innerHTML = code;\n    \n    let table = div.children[0];\n    let columnTitleMobile = [...table.querySelectorAll( '.wptb-column-title-mobile-container' )];\n    \n    for( let i = 0; i < columnTitleMobile.length; i++ ) {\n        let parent = columnTitleMobile[i].parentNode;\n        parent.removeChild( columnTitleMobile[i] );\n    }\n    \n    let tds = table.querySelectorAll( 'td' );\n    for ( let i = 0; i < tds.length; i++ ) {\n        tds[i].classList.add( 'wptb-droppable' );\n        tds[i].classList.remove( 'wptb-column-title-mobile-not-elements' );\n    }\n    \n    return table;\n}","var WPTB_Parser2 = function (code) {\r\n    if( Array.isArray( code ) ) {\r\n        let elementHtml;\r\n        \r\n        if ( code.length == 1) {\r\n            return elementHtml.appendChild( document.createTextNode( code[0] ) );\r\n        }\r\n        if( 0 in code ) {\r\n            let tagName = code[0];\r\n            elementHtml =  document.createElement( tagName );\r\n            \r\n            if ( 1 in code ) {\r\n                if( Array.isArray( code[1] ) ) {\r\n                    let attributes = code[1];\r\n                    \r\n                    for( let i = 0; i < attributes.length; i++ ) {\r\n                        if( Array.isArray( attributes[i] ) ) {\r\n                            elementHtml.setAttribute(attributes[i][0], attributes[i][1]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            if ( 2 in code ) {\r\n                if ( Array.isArray( code[2] ) ) {\r\n                    for ( let i = 0; i < code[2].length; i++ ) {\r\n                        if ( typeof code[2][i] === 'string' && tagName.toLowerCase() == 'p' ) {\r\n                            elementHtml.appendChild( document.createTextNode( code[2][i] ) );\r\n                            continue;\r\n                        }\r\n                        if ( ! WPTB_Parser( code[2][i] ) ) continue;\r\n                        elementHtml.appendChild( WPTB_Parser( code[2][i] ) );\r\n                    }\r\n                } else if( typeof code[2] === 'string' ) {\r\n                    elementHtml.appendChild( document.createTextNode( code[2] ) );\r\n                }\r\n                \r\n            }\r\n        }\r\n        \r\n        return elementHtml;\r\n    } else {\r\n        return false;\r\n    }\r\n    \r\n}","var WPTB_Settings = function () {\r\n    var elems = document.getElementsByClassName('wptb-element');\r\n\r\n    for ( var i = 0; i < elems.length; i++ ) {\r\n        elems[i].ondragstart = function ( event ) {\r\n            event.dataTransfer.effectAllowed = 'move';\r\n            event.dataTransfer.setData( 'wptbElement', event.target.dataset.wptbElement );\r\n            event.dataTransfer.setData( 'wptbElIndic-' + event.target.dataset.wptbElement, 'wptbElIndic-' + event.target.dataset.wptbElement );\r\n        }\r\n        elems[i].ondragend = function () {\r\n            let wptbDropHandle = document.querySelector( '.wptb-drop-handle' ),\r\n                wptbDropBorderMarker = document.querySelector( '.wptb-drop-border-marker' );\r\n            if ( wptbDropHandle || wptbDropBorderMarker ) {\r\n                wptbDropHandle.style.display = 'none';\r\n                wptbDropBorderMarker.style.display = 'none';\r\n            }\r\n        }\r\n    };\r\n    \r\n    let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n    let wptbUndo = document.getElementsByClassName( 'wptb-undo' );\r\n    if( wptbUndo.length > 0 ) {\r\n        wptbUndo = wptbUndo[0];\r\n        \r\n        wptbUndo.onclick = function( event ) {\r\n            if( ! this.classList.contains( 'wptb-undoredo-disabled' ) ) {\r\n                wptbTableStateSaveManager.tableStateGet( this.dataset.wptbUndoredo );\r\n                let wptbUndoRedoContainer = document.getElementsByClassName( 'wptb-undo-redo-container' );\r\n                if( wptbUndoRedoContainer.length > 0 ) {\r\n                    wptbUndoRedoContainer = wptbUndoRedoContainer[0];\r\n                    wptbUndoRedoContainer.onmouseleave = function( event ) {\r\n                        event.target.onmouseleave = '';\r\n                        WPTB_Table();\r\n                    }\r\n                }\r\n            }\r\n            \r\n        }\r\n    }\r\n    \r\n    let wptbRedo = document.getElementsByClassName( 'wptb-redo' );\r\n    if( wptbRedo.length > 0 ) {\r\n        wptbRedo = wptbRedo[0];\r\n        \r\n        wptbRedo.onclick = function( event ) {\r\n            if( ! this.classList.contains( 'wptb-undoredo-disabled' ) ) {\r\n                wptbTableStateSaveManager.tableStateGet( this.dataset.wptbUndoredo );\r\n                let wptbUndoRedoContainer = document.getElementsByClassName( 'wptb-undo-redo-container' );\r\n                if( wptbUndoRedoContainer.length > 0 ) {\r\n                    wptbUndoRedoContainer = wptbUndoRedoContainer[0];\r\n                    wptbUndoRedoContainer.onmouseleave = function( event ) {\r\n                        event.target.onmouseleave = '';\r\n                        WPTB_Table();\r\n                    }\r\n                }\r\n            }\r\n            \r\n        }\r\n    }\r\n    \r\n    let shortcodePopupWindow = document.getElementsByClassName( 'wptb-popup-window-modal' )[0];\r\n    document.getElementsByClassName( 'wptb-embed-btn' )[0].onclick = function () {\r\n        if( ! this.classList.contains( 'wptb-button-disable' ) ) {\r\n            shortcodePopupWindow.classList.add( 'wptb-popup-show' );\r\n        }\r\n    }\r\n    \r\n    window.onbeforeunload = function(e) {\r\n        let wptbSaveDisabled = document.getElementsByClassName( 'wptb-save-disabled' );\r\n        if( wptbSaveDisabled.length == 0 ) {\r\n            return true;\r\n        } else {\r\n            return null;\r\n        }\r\n    };\r\n    \r\n    \r\n    document.getElementsByClassName( 'wptb-popup-dark-area' )[0].onclick = function () {\r\n        shortcodePopupWindow.classList.remove( 'wptb-popup-show' );\r\n    }\r\n    \r\n    document.getElementsByClassName( 'wptb-popup-window-close-icon' )[0].onclick = function () {\r\n        shortcodePopupWindow.classList.remove( 'wptb-popup-show' );\r\n    }\r\n    \r\n    document.getElementsByClassName( 'wptb-preview-btn' )[0].onclick = function ( e ) {\r\n        if( this.classList.contains( 'wptb-button-disable' ) ) {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    document.getElementsByClassName( 'wptb-save-btn' )[0].onclick = function ( event ) {\r\n        if( ( ! event.target.dataset.wptbTableStateNumberSave && window.wptbTableStateNumberShow == 0 ) || \r\n                window.wptbTableStateNumberShow == event.target.dataset.wptbTableStateNumberSave ) {\r\n            return;\r\n        }\r\n        let bar = document.querySelector( '.wptb-edit-bar' );\r\n        if ( bar && bar.classList.contains( 'visible' ) ) {\r\n            let table = document.getElementsByClassName( 'wptb-preview-table' )[0];\r\n            table.toggleTableEditMode();\r\n        }\r\n\r\n        let http = new XMLHttpRequest(),\r\n            url = ( wptb_admin_object ? wptb_admin_object.ajaxurl : ajaxurl ) + \"?action=save_table\",\r\n            t = document.getElementById( 'wptb-setup-name' ).value.trim(),\r\n            messagingArea,\r\n            code = document.getElementsByClassName( 'wptb-preview-table' );\r\n        if( code.length > 0 ) {\r\n            code = WPTB_Stringifier( code[0] );\r\n            code = code.outerHTML;\r\n        } else { \r\n            code = '';\r\n        }\r\n            \r\n        if ( t === '' || code === '' ) {\r\n            let messagingAreaText = '';\r\n            if( t === '' ) messagingAreaText += 'You must assign a name to the table before saving it.</br>';\r\n            if( code === '' ) messagingAreaText += 'Table wasn\\'t created';\r\n            messagingArea = document.getElementById( 'wptb-messaging-area' );\r\n            messagingArea.innerHTML = '<div class=\"wptb-error wptb-message\">Error: ' + messagingAreaText + '</div>';\r\n            messagingArea.classList.add( 'wptb-warning' );\r\n            setTimeout(function () {\r\n                    messagingArea.removeChild( messagingArea.firstChild );\r\n            }, 4000 );\r\n            return;\r\n        }\r\n\r\n        let params = {\r\n            title: t,\r\n            content: code,\r\n            security_code: wptb_admin_object.security_code\r\n        };\r\n        if (( rs = WPTB_Helper.detectMode() ) || ( rs = document.wptbId )) {\r\n            params.id = rs;\r\n        }\r\n        params = JSON.stringify( params );\r\n\r\n        http.open('POST', url, true);\r\n        http.setRequestHeader( 'Content-type', 'application/json; charset=utf-8' );\r\n\r\n        http.onreadystatechange = function (action) {\r\n            if ( this.readyState == 4 && this.status == 200 ) {\r\n                var data = JSON.parse( http.responseText );\r\n                messagingArea = document.getElementById( 'wptb-messaging-area' );\r\n\r\n                if ( data[0] == 'saved' ) {\r\n                    document.wptbId = data[1];\r\n                    messagingArea.innerHTML = '<div class=\"wptb-success wptb-message\">Table \"' + t + '\" was successfully saved.</div>';\r\n                    document.getElementsByClassName( 'wptb-embed-btn' )[0].classList.remove( 'wptb-button-disable' );\r\n                    document.getElementById( 'wptb-embed-shortcode' ).value = '[wptb id=' + data[1] + ']';\r\n                    let wptbPreviewBtn = document.getElementsByClassName( 'wptb-preview-btn' );\r\n                    if( wptbPreviewBtn.length > 0 ) {\r\n                        wptbPreviewBtn = wptbPreviewBtn[0];\r\n                        wptbPreviewBtn.classList.remove( 'wptb-button-disable' );\r\n                        let wptbPreviewBtnHref = wptbPreviewBtn.dataset.previewHref;\r\n                        wptbPreviewBtnHref = wptbPreviewBtnHref.replace( 'empty', data[1] );\r\n                        wptbPreviewBtn.setAttribute( 'href', wptbPreviewBtnHref );\r\n                    }\r\n                    \r\n                } else if( data[0] == 'edited' ) {\r\n                    messagingArea.innerHTML = '<div class=\"wptb-success wptb-message\">Table \"' + t + '\" was successfully updated.</div>';\r\n                    event.target.dataset.wptbTableStateNumberSave = window.wptbTableStateNumberShow;\r\n                    \r\n                    let wptbSaveBtn = document.getElementsByClassName( 'wptb-save-btn' );\r\n                    if( wptbSaveBtn.length > 0 ) {\r\n                        wptbSaveBtn = wptbSaveBtn[0];\r\n                        wptbSaveBtn.classList.add( 'wptb-save-disabled' );\r\n                    }\r\n                } else {\r\n                    messagingArea.innerHTML = '<div class=\"wptb-error wptb-message\">Safety problems</div>';\r\n                }\r\n                messagingArea.classList.add( 'wptb-success' );\r\n                setTimeout( function () {\r\n                    messagingArea.removeChild( messagingArea.firstChild );\r\n                }, 4000 );\r\n            }\r\n        }\r\n        http.send( params );\r\n    }\r\n};\r\n","var WPTB_Space = function ( elSpaceBetween ) {\r\n\r\n    function newElementProxy(el) {\r\n        if (el.includes('list')) {\r\n            return new WPTB_List();\r\n        } else if (el.includes('image')) {\r\n            return new WPTB_Image();\r\n        } else if (el.includes('text')) {\r\n            return new WPTB_Text();\r\n        } else if (el.includes('button')) {\r\n            return new WPTB_Button();\r\n        }\r\n    }\r\n    let spaceBetween;\r\n    if ( ! elSpaceBetween ) {\r\n        spaceBetween = document.createElement('div'), spaceBetween.classList.add('wptb-space-between');\r\n    } else {\r\n        spaceBetween = elSpaceBetween;\r\n    }\r\n\r\n    spaceBetween.ondragenter = function () {\r\n        this.classList.add('visible');\r\n    };\r\n    spaceBetween.ondragover = function (event) {\r\n        event.preventDefault();\r\n    };\r\n\r\n    spaceBetween.ondragleave = function () {\r\n        this.classList.remove('visible');\r\n    };\r\n\r\n    spaceBetween.ondrop = function (event) {\r\n        event.stopPropagation();\r\n\r\n        var p = event.target.nextSibling,\r\n            td = event.target,\r\n            element, t_space, spaceParent;\r\n\r\n        while ( !td.classList.contains('wptb-droppable') ) {\r\n            td = td.parentNode;\r\n        }\r\n\r\n        if (event.dataTransfer.getData('wptbElement')) {\r\n            element = newElementProxy(event.dataTransfer.getData('wptbElement'));\r\n            this.classList.remove('visible');\r\n\r\n            if (p == null) {\r\n                td.appendChild(element.getDOMElement());\r\n                td.appendChild(new WPTB_Space());\r\n            } else {\r\n                td.insertBefore(element.getDOMElement(), p);\r\n                td.insertBefore(new WPTB_Space(), p);\r\n            }\r\n\r\n        } else {\r\n            alert(event.dataTransfer.getData('node'));\r\n            element = document.getElementsByClassName(event.dataTransfer.getData('node'))[0];\r\n            t_space = element.nextSibling;\r\n            spaceParent = element.parentNode;\r\n            if (t_space != undefined) {\r\n                spaceParent.removeChild(t_space);\r\n            }\r\n\r\n            if (p == null) {\r\n                td.appendChild(element);\r\n                td.appendChild(new WPTB_Space());\r\n            } else {\r\n                td.insertBefore(element, p);\r\n                td.insertBefore(new WPTB_Space(), p);\r\n            }\r\n\r\n        }\r\n        this.classList.remove('visible');\r\n    };\r\n    \r\n    if ( ! elSpaceBetween ) {\r\n        return spaceBetween;\r\n    }\r\n};","var WPTB_StarRating = function ( DOMElementProt, countStarts ) {\r\n    if( ! countStarts ) {\r\n        if( ! DOMElementProt ) {\r\n            countStarts = 5;\r\n        } else {\r\n            countStarts = DOMElementProt.querySelectorAll( 'li' ).length;\r\n        }\r\n    }\r\n        \r\n    let DOMElement = document.createElement('div'),\r\n        ratingStarsBox = document.createElement( 'div' ),\r\n        ratingStarsList = document.createElement( 'ul' ),\r\n        successBox = document.createElement( 'div' ),\r\n        textMessage = document.createElement( 'div' ),\r\n        kindIndexProt = undefined,\r\n        copy = false;\r\n    \r\n    DOMElement.classList.add( 'wptb-star_rating-container' );\r\n    ratingStarsBox.classList.add( 'wptb-rating-stars-box' );\r\n    ratingStarsList.classList.add( 'wptb-rating-stars-list' );\r\n    successBox.classList.add( 'wptb-success-box' );\r\n    successBox.style.display = 'none';\r\n    textMessage.classList.add( 'wptb-text-message' );\r\n    textMessage.style.fontSize = '25px';\r\n    \r\n    let filledRatingStarHtml = '<svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" \\n\\\r\n        xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"20px\" style=\"width: 20px;\" viewBox=\"0 0 426.667 426.667\" \\n\\\r\n        style=\"enable-background:new 0 0 426.667 426.667;\" xml:space=\"preserve\">\\n\\\r\n        <polygon points=\"426.667,165.12 273.28,152.107 213.333,10.667 153.387,152.107 0,165.12 \\n\\\r\n        116.48,266.027 81.493,416 213.333,336.427 345.173,416 310.187,266.027\"/></svg>';\r\n    \r\n    let notFilledRatingStarHtml = '<svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" \\n\\\r\n        xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"20px\" style=\"width: 20px;\" viewBox=\"0 0 426.667 426.667\" \\n\\\r\n        style=\"enable-background:new 0 0 426.667 426.667;\" xml:space=\"preserve\">\\n\\\r\n        <path d=\"M426.667,165.12L273.28,151.893L213.333,10.667l-59.947,141.44L0,165.12l116.48,100.907L81.493,416l131.84-79.573\\n\\\r\n        L345.173,416L310.4,266.027L426.667,165.12z M213.333,296.533L133.12,344.96l21.333-91.307l-70.827-61.44l93.44-8.107 \\n\\\r\n        l36.267-85.973l36.48,86.187l93.44,8.107l-70.827,61.44l21.333,91.307L213.333,296.533z\"/></svg>';\r\n    \r\n    let halfFilledRatingStarHtml = '<svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" \\n\\\r\n        xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"20px\" style=\"width: 20px;\" viewBox=\"0 0 426.667 426.667\" \\n\\\r\n        style=\"enable-background:new 0 0 426.667 426.667;\" xml:space=\"preserve\">\\n\\\r\n        <path d=\"M426.667,165.12L273.28,151.893L213.333,10.667l-59.947,141.44L0,165.12l116.48,100.907L81.493,416l131.84-79.573 \\n\\\r\n        L345.173,416L310.4,266.027L426.667,165.12z M213.333,296.533v-198.4l36.48,86.187l93.44,8.107l-70.827,61.44l21.333,91.307 \\n\\\r\n        L213.333,296.533z\"/></svg>';\r\n    \r\n    \r\n    for( let i = 0; i < countStarts; i++ ) {\r\n        let ratingStar = document.createElement( 'li' );\r\n        ratingStar.classList.add( 'wptb-rating-star' );\r\n        ratingStar.style.width = '20px';\r\n        let ratingStarZeroSet = '';\r\n        if( i == 0 ) {\r\n            ratingStarZeroSet = '<span class=\"wptb-rating-star-zero-set\"></span>';\r\n        }\r\n        \r\n        ratingStar.innerHTML = '<span class=\"wptb-rating-star-left-signal-part\">' + ratingStarZeroSet + '</span><span class=\"wptb-filled-rating-star\">' + filledRatingStarHtml + '</span>'\r\n                                + '<span class=\"wptb-not-filled-rating-star\">' + notFilledRatingStarHtml + '</span>'\r\n                                + '<span class=\"wptb-half-filled-rating-star\">' + halfFilledRatingStarHtml + '</span><span  class=\"wptb-rating-star-right-signal-part\"></span>';\r\n        ratingStar.dataset.value = i + 1;\r\n        ratingStarsList.appendChild( ratingStar );\r\n    }\r\n\r\n    successBox.appendChild( textMessage );\r\n    ratingStarsBox.appendChild( ratingStarsList );\r\n    ratingStarsBox.appendChild( successBox );\r\n    DOMElement.appendChild( ratingStarsBox );\r\n    \r\n    \r\n\r\n    \r\n    // Creation of a new star rating when copying to avoid errors when assigning new event handlers.\r\n    if ( DOMElementProt ) {\r\n        let wptbElementMutch = DOMElementProt.className.match( /wptb-element-((.+-)\\d+)/i );\r\n        if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\r\n            kindIndexProt = wptbElementMutch[1];\r\n            copy = true;\r\n        };\r\n        \r\n        var wptbRatingStarsBox = DOMElementProt.querySelector( '.wptb-rating-stars-box' );\r\n        if ( wptbRatingStarsBox ) {\r\n            var wptbRatingStarsBoxAttributes = [...wptbRatingStarsBox.attributes];\r\n            if ( wptbRatingStarsBoxAttributes.length > 0 ) {\r\n                for( let i = 0; i < wptbRatingStarsBoxAttributes.length; i++ ) {\r\n                    if ( wptbRatingStarsBoxAttributes[i].name == 'style') {\r\n                        ratingStarsBox.setAttribute( wptbRatingStarsBoxAttributes[i].name, wptbRatingStarsBoxAttributes[i].value );\r\n                    }\r\n                } \r\n            }\r\n        }\r\n        \r\n        let wptbRatingStarsOld = wptbRatingStarsBox.querySelectorAll( 'li' );\r\n        let wptbRatingStars = ratingStarsList.querySelectorAll( 'li' );\r\n        if ( wptbRatingStarsOld.length > 0 && wptbRatingStars.length > 0 ) {\r\n            let iMax = wptbRatingStarsOld.length < countStarts ? wptbRatingStarsOld.length : countStarts;\r\n            for( let i = 0; i < wptbRatingStarsOld.length; i++ ) {\r\n                let  wptbRatingStarsAttributes = [...wptbRatingStarsOld[i].attributes];\r\n                if ( wptbRatingStarsAttributes.length > 0 ) {\r\n                    for( let j = 0; j < wptbRatingStarsAttributes.length; j++ ) {\r\n                        wptbRatingStars[i].setAttribute( wptbRatingStarsAttributes[j].name, wptbRatingStarsAttributes[j].value );\r\n                    } \r\n                }\r\n                \r\n                let wptbRatingStarsOldSpan = wptbRatingStarsOld[i].children;\r\n                let wptbRatingStarsSpan = wptbRatingStars[i].children;\r\n                for( let k = 0; k < wptbRatingStarsOldSpan.length; k++ ){\r\n                    let wptbRatingStarsOldSpanAttributes = [...wptbRatingStarsOldSpan[k].attributes];\r\n                    if( wptbRatingStarsOldSpanAttributes.length > 0 ) {\r\n                        for ( let l = 0; l < wptbRatingStarsOldSpanAttributes.length; l++ ) {\r\n                            wptbRatingStarsSpan[k].setAttribute( wptbRatingStarsOldSpanAttributes[l].name, wptbRatingStarsOldSpanAttributes[l].value );\r\n                            let wptbRatingStarsOldSvg = wptbRatingStarsOldSpan[k].querySelector( 'svg' );\r\n                            if( wptbRatingStarsOldSvg ) {\r\n                                let wptbRatingStarsOldSvgStyle = wptbRatingStarsOldSvg.getAttribute( 'style' );\r\n                                wptbRatingStarsSpan[k].querySelector( 'svg' ).setAttribute( 'style', wptbRatingStarsOldSvgStyle );\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        \r\n        var wptbSuccessBox = wptbRatingStarsBox.querySelector( '.wptb-success-box' );\r\n        if ( wptbSuccessBox ) {\r\n            var wptbSuccessBoxAttributes = [...wptbSuccessBox.attributes];\r\n            for( let i = 0; i < wptbSuccessBoxAttributes.length; i++ ) {\r\n                if ( wptbSuccessBoxAttributes[i].name == 'style') {\r\n                    successBox.setAttribute( wptbSuccessBoxAttributes[i].name, wptbSuccessBoxAttributes[i].value );\r\n                }\r\n            } \r\n        }\r\n        \r\n        var wptbTextMessage = wptbSuccessBox.querySelector( '.wptb-text-message' );\r\n        if ( wptbTextMessage ) {\r\n            textMessage.innerHTML = wptbTextMessage.innerHTML;\r\n            var wptbTextMessageAttributes = [...wptbTextMessage.attributes];\r\n            for( let i = 0; i < wptbTextMessageAttributes.length; i++ ) {\r\n                if ( wptbTextMessageAttributes[i].name == 'style') {\r\n                    textMessage.setAttribute( wptbTextMessageAttributes[i].name, wptbTextMessageAttributes[i].value );\r\n                }\r\n            } \r\n        }\r\n    }\r\n    \r\n    this.kind = 'star_rating';\r\n\r\n    this.getDOMElement = function () {\r\n            return DOMElement;\r\n    };\r\n\r\n    applyGenericItemSettings( this, kindIndexProt, copy );\r\n    \r\n    return this;\r\n}","var WPTB_Stringifier = function ( codeMain ) {\r\n    if ( codeMain ) {\r\n        let code = codeMain.cloneNode( true );\r\n        code.classList.add( 'wptb-table-preview-static-indic' );\r\n        code.dataset.tableColumns = codeMain.columns;\r\n        code.style.width = null;\r\n        code.style.minWidth = null;\r\n        code.style.maxWidth = null;\r\n        \r\n        let tds = code.getElementsByTagName( 'td' );\r\n        if ( tds.length > 0 ) {\r\n            for ( let i = 0; i < tds.length; i++ ) {\r\n                \r\n                if ( codeMain.querySelector( 'wptb-table-preview-head' ) ) {\r\n                    tds[i].removeAttribute( 'data-x-index' );\r\n                }\r\n                tds[i].removeAttribute( 'data-y-index' );\r\n                tds[i].removeAttribute( 'draggable' );\r\n                tds[i].classList.remove( 'wptb-droppable' );\r\n                let innerElements = tds[i].getElementsByClassName( 'wptb-ph-element' );\r\n                \r\n                if ( innerElements.length > 0 ) {\r\n                    for ( let j = 0; j < innerElements.length; j++ ) {\r\n                        \r\n                        let mceContentBodys = innerElements[j].querySelectorAll( '.mce-content-body' );\r\n                        if( mceContentBodys.length > 0 ) {\r\n                            for ( let k = 0; k < mceContentBodys.length; k++ ) {\r\n                                mceContentBodys[k].classList.remove( 'mce-content-body' );\r\n                            }\r\n                        }\r\n                        \r\n                        let dataMceStyle = innerElements[j].querySelectorAll( '[data-mce-style]' );\r\n                        if ( dataMceStyle.length > 0 ) {\r\n                            for ( let k = 0; k < dataMceStyle.length; k++ ) {\r\n                                dataMceStyle[k].removeAttribute( 'data-mce-style' );\r\n                            }\r\n                        }\r\n                        \r\n                        let contentEditable = innerElements[j].querySelectorAll( '[contenteditable]' );\r\n                        if ( contentEditable.length > 0 ) {\r\n                            for ( let k = 0; k < contentEditable.length; k++ ) {\r\n                                contentEditable[k].removeAttribute( 'contenteditable' );\r\n                            }\r\n                        }\r\n                        \r\n                        let spellCheck = innerElements[j].querySelectorAll( '[spellcheck]' );\r\n                        if ( spellCheck.length > 0 ) {\r\n                            for ( let k = 0; k < spellCheck.length; k++ ) {\r\n                                spellCheck[k].removeAttribute( 'spellcheck' );\r\n                            }\r\n                        }\r\n                        \r\n                        let mceIds = innerElements[j].querySelectorAll( '[id^=mce_]' );\r\n                        if ( mceIds.length > 0 ) {\r\n                            for ( let k = 0; k < mceIds.length; k++ ) {\r\n                                mceIds[k].removeAttribute( 'id' );\r\n                            }\r\n                        }\r\n                        \r\n                        let wptbActions = innerElements[j].querySelectorAll( '.wptb-actions' );\r\n                        let wptbActionsLength = wptbActions.length;\r\n                        while ( wptbActionsLength > 0 ) {\r\n                            if( wptbActions[0] && wptbActions[0].parentNode ) {\r\n                                wptbActions[0].parentNode.removeChild( wptbActions[0] );\r\n                                wptbActionsLength--;\r\n                            } else {\r\n                                break;\r\n                            }\r\n                            \r\n                        }  \r\n                    }\r\n                }\r\n                \r\n                if( tds[i].hasAttribute( 'data-wptb-title-column' ) ) {\r\n                    let columnNameDivContainer = document.createElement( 'div' ),\r\n                        columnNameDiv = document.createElement( 'div' );\r\n                    columnNameDivContainer.classList.add( 'wptb-column-title-mobile-container' );\r\n                    columnNameDiv.classList.add( 'wptb-column-title-mobile' );\r\n                    columnNameDiv.dataset.wptbTitleColumn = tds[i].dataset.wptbTitleColumn;\r\n                    columnNameDiv.setAttribute( 'style', 'font-size:' + tds[i].dataset.wptbTitleColumnFontSize + '; \\n\\\r\n                        color:' + tds[i].dataset.wptbTitleColumnColor + '; background-color:' + tds[i].dataset.wptbTitleBackgroundColor + '; text-align:' + tds[i].dataset.wptbTitleAlign + ';' );\r\n                    columnNameDiv.style.padding = tds[i].style.padding;\r\n                    if( tds[i].children.length == 0 ) {\r\n                        tds[i].classList.add( 'wptb-column-title-mobile-not-elements' );\r\n                    }\r\n                    columnNameDivContainer.appendChild( columnNameDiv );\r\n                    tds[i].insertBefore( columnNameDivContainer, tds[i].firstChild );\r\n                }\r\n            }\r\n        }\r\n        \r\n        return code;\r\n    }\r\n}","var WPTB_Stringifier2 = function ( node, start = false ) {\r\n\r\n\tif ( node == undefined ) {\r\n\t\treturn '';\r\n\t} else if ( node.tagName == undefined && node.nodeType == 3 ) {\r\n            return node.nodeValue;\r\n        }\r\n        \r\n        let code = [],\r\n            children,\r\n            int_elem_arr = false,\r\n            attributes = [...node.attributes],\r\n            attributes_list = [],\r\n            internal_elements = [];\r\n            if ( ( node.parentNode.classList.contains( 'wptb-list-item-content' ) || \r\n                node.parentNode.classList.contains( 'mce-content-body' ) ) && \r\n            node.tagName.toLowerCase() == 'p' ) {\r\n                children = node.childNodes;\r\n                int_elem_arr = true;\r\n            } else if( node.children.length > 0 ) {\r\n                children = node.children;\r\n            } else {\r\n                children = node.childNodes;\r\n            }\r\n        if ( attributes.length > 0 ) {\r\n            for ( let i = 0; i < attributes.length; i++ ) {\r\n                attributes_list[i] = [attributes[i].name, attributes[i].value];\r\n            }\r\n        } else {\r\n            attributes_list = '';\r\n        }\r\n        \r\n        if ( children.length > 0 ) {\r\n            for ( let i = 0; i < children.length; i++) {\r\n                let inter_elem = WPTB_Stringifier(children[i]);\r\n                    \r\n                if ( Array.isArray( inter_elem ) || int_elem_arr ) {\r\n                    internal_elements[i] = inter_elem;\r\n                } else if ( typeof inter_elem === 'string' && inter_elem ) {\r\n                    internal_elements = inter_elem;\r\n                }\r\n            }\r\n        } else {\r\n            internal_elements = '';\r\n        }\r\n        \r\n        \r\n        code.push(node.tagName.toLowerCase(), attributes_list , internal_elements);\r\n        \r\n        return code;\r\n}","var array = [], WPTB_Table = function (columns, rows) {\r\n\r\n    /* The members of the class */\r\n    var settings = document.getElementsByClassName('wptb-settings-items'),\r\n            wptbTableSetup = document.getElementsByClassName(\"wptb-table-setup\")[0],\r\n            table, row, cell,\r\n            maxAmountOfCells,\r\n            maxAmountOfRows;\r\n\r\n    //HERE ARE THE PRIVATE FUNCTIONS\r\n    /*\r\n     * This function toggles buttons visibility in cell edit mode\r\n     * (according to the amount of currently selected cells), and\r\n     * highlights visually the clicked cell if it is not highlighted, or\r\n     * removes highlight if clicked cell is already highlighted. \r\n     * It too toggles the bits of our abstract representation.\r\n     * @param Event this is the event instance of the click performed over a cell.\r\n     */\r\n    var mark = function ( event ) {\r\n        var rs = this.rowSpan,\r\n            cs = this.colSpan,\r\n            markedCells,\r\n            noCells = document.getElementsByClassName('wptb-no-cell-action'),\r\n            singleCells = document.getElementsByClassName('wptb-single-action'),\r\n            multipleCells = document.getElementsByClassName('wptb-multiple-select-action'),\r\n            cellSettings = document.getElementById( 'wptb-left-scroll-panel-cell-settings' ),\r\n            position = getCoords(this),\r\n            row = position[0],\r\n            column = position[1];\r\n        if ( ! document.select.isActivated() ) {\r\n            return;\r\n        }\r\n        if (this.className.match(/wptb-highlighted/)) {\r\n            this.classList.remove('wptb-highlighted');\r\n            for (var i = 0; i < rs; i++) {\r\n                for (var j = 0; j < cs; j++) {\r\n                    array[row + i][column + j] = 0;\r\n                }\r\n            }\r\n        } else {\r\n            this.classList.add('wptb-highlighted');\r\n            for (var i = 0; i < rs; i++) {\r\n                for (var j = 0; j < cs; j++) {\r\n                    array[row + i][column + j] = 1;\r\n                }\r\n            }\r\n        }\r\n\r\n        markedCells = document.getElementsByClassName('wptb-highlighted').length;\r\n        if (markedCells === 0) {\r\n            for (var i = 0; i < multipleCells.length; i++) {\r\n                multipleCells[i].classList.remove('visible');\r\n                multipleCells[i].setAttribute('disabled', 'disabled');\r\n            }\r\n            for (var i = 0; i < noCells.length; i++) {\r\n                noCells[i].classList.add('visible');\r\n                noCells[i].removeAttribute('disabled');\r\n            }\r\n            for (var i = 0; i < singleCells.length; i++) {\r\n                singleCells[i].classList.remove('visible');\r\n                singleCells[i].setAttribute('disabled', 'disabled');\r\n            }\r\n            cellSettings.classList.remove( 'visible' );\r\n        } else if (markedCells === 1) {\r\n            for (var i = 0; i < multipleCells.length; i++) {\r\n                multipleCells[i].classList.remove('visible');\r\n                multipleCells[i].setAttribute('disabled', 'disabled');\r\n            }\r\n            for (var i = 0; i < noCells.length; i++) {\r\n                noCells[i].classList.remove('visible');\r\n                noCells[i].setAttribute('disabled', 'disabled');\r\n            }\r\n            for (var i = 0; i < singleCells.length; i++) {\r\n                singleCells[i].classList.add('visible');\r\n                singleCells[i].removeAttribute('disabled');\r\n            }\r\n            let cellHighlighted = document.querySelector( '.wptb-highlighted' );\r\n            if( cellHighlighted ) {\r\n                let wptbTableColumnWidthSlider = document.getElementById( 'wptb-table-column-width-slider' );\r\n                let wptbTableColumnWidthNumber = document.getElementById( 'wptb-table-column-width-number' );\r\n                let tableColumnWidthAutoFixedCheckbox = document.getElementById( 'wptb-table-column-width-auto-fixed' );\r\n                let width = cellHighlighted.style.width;\r\n                if( width ) {\r\n                    wptbTableColumnWidthSlider.value = parseFloat( width, 10 );\r\n                    wptbTableColumnWidthNumber.value = parseFloat( width, 10 );\r\n                    tableColumnWidthAutoFixedCheckbox.checked = true;\r\n                } else if( cellHighlighted.dataset.wptbFixedWidth ) {\r\n                    wptbTableColumnWidthSlider.value = cellHighlighted.dataset.wptbFixedWidth;\r\n                    wptbTableColumnWidthNumber.value = cellHighlighted.dataset.wptbFixedWidth;\r\n                    tableColumnWidthAutoFixedCheckbox.checked = true;\r\n                } else {\r\n                    let cellWidth = WPTB_Helper.getColumnWidth( table, cellHighlighted );\r\n                    wptbTableColumnWidthSlider.value = cellWidth;\r\n                    wptbTableColumnWidthNumber.value = cellWidth;\r\n                    tableColumnWidthAutoFixedCheckbox.checked = false;\r\n                }\r\n                \r\n                \r\n                let wptbTableRowHeightSlider = document.getElementById( 'wptb-table-row-height-slider' );\r\n                let wptbTableRowHeightNumber = document.getElementById( 'wptb-table-row-height-number' );\r\n                let tableRowHeightAutoFixedCheckbox = document.getElementById( 'wptb-table-row-height-auto-fixed' );\r\n                let height = cellHighlighted.style.height;\r\n                if( height ) {\r\n                    wptbTableRowHeightSlider.value = parseFloat( height, 10 );\r\n                    wptbTableRowHeightNumber.value = parseFloat( height, 10 );\r\n                    tableRowHeightAutoFixedCheckbox.checked = true;\r\n                } else if( cellHighlighted.dataset.wptbFixedHeight ) {\r\n                    wptbTableRowHeightSlider.value = cellHighlighted.dataset.wptbFixedHeight;\r\n                    wptbTableRowHeightNumber.value = cellHighlighted.dataset.wptbFixedHeight;\r\n                    tableRowHeightAutoFixedCheckbox.checked = true;\r\n                } else {\r\n                    let cellHeight = WPTB_Helper.getRowHeight( table, cellHighlighted );\r\n                    wptbTableRowHeightSlider.value = cellHeight;\r\n                    wptbTableRowHeightNumber.value = cellHeight;\r\n                    tableRowHeightAutoFixedCheckbox.checked = false;\r\n                }\r\n            }\r\n            cellSettings.classList.add( 'visible' );\r\n        } else {\r\n            for (var i = 0; i < multipleCells.length; i++) {\r\n                if (table.isSquare(array)) {\r\n                    multipleCells[i].classList.add('visible');\r\n                    multipleCells[i].removeAttribute('disabled');\r\n                } else {\r\n                    multipleCells[i].classList.remove('visible');\r\n                    multipleCells[i].setAttribute('disabled', 'disabled');\r\n                }\r\n            }\r\n            for (var i = 0; i < noCells.length; i++) {\r\n                noCells[i].classList.remove('visible');\r\n                noCells[i].setAttribute('disabled', 'disabled');\r\n            }\r\n            for (var i = 0; i < singleCells.length; i++) {\r\n                singleCells[i].classList.remove('visible');\r\n                singleCells[i].setAttribute('disabled', 'disabled');\r\n            }\r\n            cellSettings.classList.remove( 'visible' );\r\n        }\r\n    };\r\n\r\n    /* \r\n     * This function fills an array with 1's according to the actual design\r\n     * of HTML table.\r\n     * @returns an array of arrays containing an abstract representation\r\n     * of HTML table.\r\n     * @deprecated\r\n     * */\r\n\r\n    var realTimeArray = function () {\r\n        var carried = [], tds, cols, matriz = [];\r\n\r\n        for (var i = 0; i < maxAmountOfCells; i++) {\r\n            carried[i] = 0;\r\n        }\r\n\r\n        for (var i = 0; i < table.rows.length; i++) {\r\n            cols = [];\r\n\r\n            var tds = table.rows[i].getElementsByTagName('td');\r\n\r\n            for (items = 0; items < tds.length; items++) {\r\n\r\n                for (var k = 0; k < tds[items].colSpan; k++) {\r\n                    cols.push(1);\r\n                }\r\n\r\n                if (tds[items].rowSpan > 1) {\r\n                    for (var k = 0; k < tds[items].colSpan; k++) {\r\n                        carried[items + k] = {\r\n                            justAssigned: true,\r\n                            amount: tds[items].rowSpan\r\n                        };\r\n                    }\r\n                }\r\n            }\r\n\r\n            for (var k = 0; k < maxAmountOfCells; k++) {\r\n                if (typeof carried[k] == 'object' && carried[k].amount > 0) {\r\n                    carried[k].amount--;\r\n                    if (carried[k].justAssigned) {\r\n                        carried[k].justAssigned = false;\r\n                    } else {\r\n                        cols.push(1);\r\n                    }\r\n                }\r\n            }\r\n\r\n            matriz.push(cols);\r\n\r\n        }\r\n        return matriz;\r\n    };\r\n\r\n    /*\r\n     * This function gets the number and position of cell spaces in current row that are occuped \r\n     * by upper rowspanned cells.\r\n     * @param number the number of row where we wish to calculate the carried rowspans up to.\r\n     * @return an array with the remaining rowspans in each column.\r\n     */\r\n    var carriedRowspans = function (row) {\r\n        var carried = [], tds, cols;\r\n\r\n        for (var i = 0; i < maxAmountOfCells; i++) {\r\n            carried[i] = 0;\r\n        }\r\n\r\n        if (row == -1) {\r\n            return carried;\r\n        }\r\n\r\n        for (var i = 0; i <= row; i++) {\r\n            cellsBuffer = table.rows[i].getElementsByTagName('td');\r\n            cellPointer = 0;\r\n\r\n            for (var xPosition = 0; xPosition < maxAmountOfCells; xPosition += stepsToMove) {\r\n                stepsToMove = 1;\r\n\r\n                if (carried[xPosition]) {\r\n                    carried[xPosition]--;\r\n                } else {\r\n                    celda = cellsBuffer[cellPointer++];\r\n                    if (celda.rowSpan > 1) {\r\n                        for (k = 0; k < celda.colSpan; k++) {\r\n                            carried[xPosition + k] = celda.rowSpan - 1;\r\n                        }\r\n                        stepsToMove = celda.colSpan;\r\n                    } else if (celda.colSpan > 1) {\r\n                        stepsToMove = celda.colSpan;\r\n                    }\r\n                }\r\n            }\r\n\r\n        }\r\n        return carried;\r\n    };\r\n\r\n    /*\r\n     * A helpful function for showing\r\n     * the abstract table in console.\r\n     * @param Array our abstract table.\r\n     */\r\n    var drawTable = function (a) {\r\n        var string = 'DRAWING TABLE:\\n';\r\n        for (var i = 0; i < a.length; i++) {\r\n\r\n            for (var j = 0; j < a[i].length; j++) {\r\n                string += ' ' + a[i][j];\r\n            }\r\n            string += '\\n';\r\n        }\r\n        table.isSquare(a);\r\n    };\r\n\r\n    /*\r\n     * It resets all the bits of our abstract representation\r\n     * to 0 and removes the highlighting class of all cells.\r\n     */\r\n\r\n    var undoSelect = function () {\r\n        var noCells = document.getElementsByClassName('wptb-no-cell-action'),\r\n                singleCells = document.getElementsByClassName('wptb-single-action'),\r\n                multipleCells = document.getElementsByClassName('wptb-multiple-select-action'),\r\n                cellSettings = document.getElementById( 'wptb-left-scroll-panel-cell-settings' ),\r\n                tds = table.getElementsByClassName('wptb-highlighted');\r\n        while (tds.length) {\r\n            tds[0].classList.remove('wptb-highlighted');\r\n        }\r\n        cellSettings.classList.remove( 'visible' );\r\n        for (var i = 0; i < array.length; i++) {\r\n            for (var j = 0; j < array[i].length; j++) {\r\n                array[i][j] = 0;\r\n            }\r\n        }\r\n        for (var i = 0; i < multipleCells.length; i++) {\r\n            multipleCells[i].classList.remove('visible');\r\n            multipleCells[i].setAttribute('disabled', 'disabled');\r\n        }\r\n        for (var i = 0; i < noCells.length; i++) {\r\n            noCells[i].classList.add('visible');\r\n            noCells[i].removeAttribute('disabled');\r\n        }\r\n        for (var i = 0; i < singleCells.length; i++) {\r\n            singleCells[i].classList.remove('visible');\r\n            singleCells[i].setAttribute('disabled', 'disabled');\r\n        }\r\n    };\r\n\r\n    /*\r\n     * This fills the abstract representation of our table with \r\n     * zeros, at the start. the max amount of cells is the greatest sum\r\n     * of all colspans for row.\r\n     */\r\n\r\n    var fillTableArray = function () {\r\n        var colspansSums = [], a = [];\r\n\r\n        //calculate max amount of cells inside a row\r\n        for (var i = 0; i < table.rows.length; i++) {\r\n            var cells = table.rows[i].getElementsByTagName('td'),\r\n                    colspanSumInRow = 0;\r\n            for (var j = 0; j < cells.length; j++) {\r\n                colspanSumInRow += cells[j].colSpan;\r\n            }\r\n            colspansSums.push(colspanSumInRow);\r\n        }\r\n\r\n        maxAmountOfCells = Math.max.apply(null, colspansSums);\r\n        //calculate max rows\r\n        var maxAmountOfRows = table.rows.length;\r\n\r\n        // fill with zeros from both values\r\n        for (var i = 0; i < maxAmountOfRows; i++) {\r\n            a[i] = [];\r\n            for (var j = 0; j < maxAmountOfCells; j++) {\r\n                a[i].push(0);\r\n            }\r\n        }\r\n        drawTable(a);\r\n        return a;\r\n    };\r\n\r\n    /*\r\n     * This function gets the sum of all colspans in a row.\r\n     * @param number the number of row to be used as reference.\r\n     */\r\n    var getActualPointsInRow = function (row) {\r\n        var tds = table.rows[row].getElementsByTagName('td'),\r\n                points = 0;\r\n        for (var i = 0; i < tds.length; i++) {\r\n            points += tds[i].colSpan;\r\n        }\r\n        return points;\r\n    }\r\n\r\n    /*\r\n     * This function gets us the exact coordinates of\r\n     * an exact cell, in a more reliable way than xIndex and yIndex,\r\n     * these last ones were meant to be used for getting the cell trough them.\r\n     * @param DOMElement the cell to get the coordinates.\r\n     */\r\n    var getCoords = function (search) {\r\n        var skipInCols = [], cell;\r\n\r\n        for (var i = 0; i < maxAmountOfCells; i++) {\r\n            skipInCols[i] = 0;\r\n        }\r\n\r\n        for (var i = 0; i < table.rows.length; i++) {\r\n            var cellsBuffer = table.rows[i].getElementsByTagName('td');\r\n            cellPointer = 0;\r\n            for (var xPosition = 0; xPosition < maxAmountOfCells; xPosition += stepsToMove) {\r\n                stepsToMove = 1;\r\n\r\n                if (skipInCols[xPosition]) {\r\n                    skipInCols[xPosition]--;\r\n                } else {\r\n                    var td = cellsBuffer[cellPointer++];\r\n                    if (td == search) {\r\n                        return [i, xPosition];\r\n                    }\r\n                    if (td.rowSpan > 1) {\r\n                        for ( let k = 0; k < td.colSpan; k++ ) {\r\n                            skipInCols[xPosition + k] = td.rowSpan - 1;\r\n                        }\r\n                        stepsToMove = td.colSpan;\r\n                    } else if (td.colSpan > 1) {\r\n                        stepsToMove = td.colSpan;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    jQuery('#wptb-table-header-bg').val('');\r\n    jQuery('#wptb-even-row-bg').val('');\r\n    jQuery('#wptb-odd-row-bg').val('');\r\n    jQuery('#wptb-table-border-color').val('');\r\n    jQuery('#wptb-table-inner-border-number,#wptb-table-inner-border-slider').val('0');\r\n    jQuery('#wptb-table-border-number,#wptb-table-border-slider').val('0');\r\n    jQuery('#wptb-table-padding-number,#wptb-table-padding-slider').val('15');\r\n\r\n    if (columns || rows) {\r\n        //END OF PRIVATE FUNCTIONS\r\n        for (var i = 0; i < settings.length; i++) {\r\n            if (settings[i].id !== 'wptb-apply-inner-border') {\r\n                settings[i].classList.add('visible');\r\n            }\r\n        }\r\n\r\n        //Create a HTML Table element.\r\n        table = document.createElement( 'table' );\r\n        table.classList.add( 'wptb-preview-table' );\r\n        table.dataset.reconstraction = 1;\r\n        table.dataset.wptbAdaptiveTable = 1;\r\n        //Add the data rows.\r\n        for (var i = 0; i < rows; i++) {\r\n\r\n            row = table.insertRow(-1);\r\n            row.classList.add( 'wptb-row' );\r\n\r\n            for (var j = 0; j < columns; j++) {\r\n                cell = new WPTB_Cell(mark);\r\n                cell.setCoords(i, j);\r\n                row.appendChild(cell.getDOMElement());\r\n            }\r\n        }\r\n    } else {\r\n        let wptb_preview_table = document.getElementsByClassName( 'wptb-preview-table' );\r\n\r\n        if (wptb_preview_table.length > 0) {\r\n            table = wptb_preview_table[0];\r\n\r\n            let cells = table.getElementsByTagName('td');\r\n\r\n            if (cells.length > 0) {\r\n                for (let i = 0; i < cells.length; i++) {\r\n                    WPTB_Cell(mark, cells[i]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /*\r\n     * This just toggles visibility of cell edit bar, and toggles \r\n     * cell selecting mode.\r\n     */\r\n\r\n    table.toggleTableEditMode = function () {\r\n        let bar = document.getElementsByClassName('wptb-edit-bar'),\r\n                cellModeBackground = document.getElementById('wptb-cell_mode_background'),\r\n                leftScrollPanelCurtain = document.getElementById('wptb-left-scroll-panel-curtain'),\r\n                leftScrollPanelCellSettings = document.getElementById( 'wptb-left-scroll-panel-cell-settings' ),\r\n                wptbPreviewTable = document.getElementsByClassName('wptb-preview-table');\r\n        if (wptbPreviewTable.length > 0) {\r\n            wptbPreviewTable = wptbPreviewTable[0];\r\n        }\r\n\r\n        if ( bar.length > 0 ) {\r\n            for ( let i = 0; i < bar.length; i++ ) {\r\n                if ( bar[i].classList.contains( 'visible' ) ) {\r\n                    document.select.deactivateMultipleSelectMode();\r\n                    bar[i].classList.remove( 'visible' );\r\n                    cellModeBackground.classList.remove( 'visible' );\r\n                    leftScrollPanelCurtain.classList.remove( 'visible' );\r\n                    leftScrollPanelCellSettings.classList.remove( 'visible' );\r\n                    wptbPreviewTable.parentNode.classList.remove( 'wptb-preview-table-manage-cells' );\r\n                    let wptbPreviewTableTds = wptbPreviewTable.getElementsByTagName( 'td' );\r\n                    if ( wptbPreviewTableTds.length > 0 ) {\r\n                        for ( let i = 0; i < wptbPreviewTableTds.length; i++ ) {\r\n                            wptbPreviewTableTds[i].classList.remove( 'wptb-highlighted' );\r\n                        }\r\n                    }\r\n                } else {\r\n                    document.select.activateMultipleSelectMode();\r\n                    bar[i].classList.add( 'visible' );\r\n                    cellModeBackground.classList.add( 'visible' );\r\n                    leftScrollPanelCurtain.classList.add( 'visible' );\r\n                    wptbPreviewTable.parentNode.classList.add( 'wptb-preview-table-manage-cells' );\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    /*\r\n     * For assigning to each cell xIndex and y Index attributes,\r\n     * these are the column number and row number of cell in table. \r\n     */\r\n\r\n    table.recalculateIndexes = function ( start ) {\r\n        let trs = this.getElementsByTagName('tr'), tds, maxCols = 0, maxColsFull = 0,\r\n                tdsArr = [];\r\n        let wptbTopRowAsHeader = document.getElementById( 'wptb-top-row-as-header' );\r\n        \r\n        for (var i = 0; i < trs.length; i++) {\r\n            if ( i == 0 ) {\r\n                if ( start == undefined ) {\r\n                    trs[i].style.backgroundColor = jQuery('#wptb-table-header-bg').val();\r\n                }\r\n                if( wptbTopRowAsHeader.checked ) {\r\n                    if( start == undefined ) {\r\n                        this.classList.add( 'wptb-table-preview-head' );               \r\n                        trs[i].classList.add( 'wptb-table-head' )\r\n                    }  ;\r\n                } else {\r\n                    if( start == undefined ) {\r\n                        this.classList.remove( 'wptb-table-preview-head' );\r\n                        trs[i].classList.remove( 'wptb-table-head' );\r\n                    }\r\n                }\r\n            } else {\r\n                if (i % 2 == 0) {\r\n                    if ( start == undefined ) {\r\n                        trs[i].style.backgroundColor = jQuery('#wptb-odd-row-bg').val();\r\n                    }\r\n                    trs[i].classList.remove( 'wptb-table-head' );\r\n                } else {\r\n                    if ( start == undefined ) {\r\n                        trs[i].style.backgroundColor = jQuery('#wptb-even-row-bg').val();\r\n                    }\r\n                    trs[i].classList.remove( 'wptb-table-head' );\r\n                }\r\n            }\r\n\r\n            tdsArr[i];\r\n            tds = trs[i].getElementsByTagName('td');\r\n\r\n            if (tdsArr[i] == undefined) {\r\n                tdsArr[i] = [];\r\n            }\r\n\r\n            let jMainIter = 0;\r\n            for (var j = 0; j < tds.length; j++) {\r\n                if (tdsArr[i][j] != undefined) {\r\n                    for (let y = 0; y < 100; y++) {\r\n                        if (tdsArr[i][jMainIter] != undefined) {\r\n                            jMainIter++;\r\n                            continue;\r\n                        }\r\n                        tdsArr[i][jMainIter] = tds[j];\r\n                        tds[j].dataset.xIndex = jMainIter;\r\n                        break;\r\n                    }\r\n                } else {\r\n                    tdsArr[i][j] = tds[j];\r\n                    tds[j].dataset.xIndex = jMainIter;\r\n                }\r\n                tds[j].dataset.yIndex = i;\r\n\r\n                if (tds[j].colSpan > 1) {\r\n                    for (let k = 1; k < tds[j].colSpan; k++) {\r\n                        jMainIter++;\r\n                        tdsArr[i][jMainIter] = 'tdDummy';\r\n                    }\r\n                }\r\n\r\n                if (tds[j].rowSpan > 1) {\r\n                    for (let x = 1; x < tds[j].rowSpan; x++) {\r\n                        if (tdsArr[i + x] == undefined) {\r\n                            tdsArr[i + x] = [];\r\n                        }\r\n                        for (let z = 0; z < tds[j].colSpan; z++) {\r\n                            tdsArr[i + x][jMainIter - tds[j].colSpan + 1 + z ] = 'tdDummy';\r\n                        }\r\n                    }\r\n                }\r\n                jMainIter++;\r\n                if( i == 0 ) {\r\n                    maxColsFull = jMainIter;\r\n                }\r\n            }\r\n            if (j > maxCols) {\r\n                maxCols = j;\r\n            }\r\n        }\r\n        this.columns = maxCols;\r\n        this.maxCols = maxColsFull;\r\n    }\r\n    \r\n     table.addColumnWidth = function( value, cleaner ) {\r\n        let highlighted  = table.getElementsByClassName( 'wptb-highlighted' );\r\n        if( highlighted.length > 0 ) {\r\n            for( let k = 0; k < highlighted.length; k++ ) {\r\n                let dataXIndex = highlighted[k].dataset.xIndex;\r\n                if( dataXIndex ) {\r\n                    function tableTdsFor( dataXIndex, colspan ) {\r\n                        let tableRows = table.rows;\r\n                        let widthIsSet = false;\r\n                        let arrayTdsFromPreviousRow = [];\r\n                        for( let i = 0; i < tableRows.length; i++ ) {\r\n                            let row = tableRows[i];\r\n                            let tds = row.children;\r\n                            for( let j = 0; j < tds.length; j++ ) {\r\n                                let td = tds[j];\r\n                                if( td.dataset.xIndex == dataXIndex ) {\r\n                                    if( value ) {\r\n                                        if( td.colSpan == colspan ) {\r\n                                            td.style.width = value + 'px';\r\n                                            td.removeAttribute( 'data-wptb-fixed-width' );\r\n                                            widthIsSet = true;\r\n                                            let tableColumnWidthAutoFixedCheckbox = document.getElementById( 'wptb-table-column-width-auto-fixed' );\r\n                                            if( ! tableColumnWidthAutoFixedCheckbox.checked ) {\r\n                                                tableColumnWidthAutoFixedCheckbox.checked = true;\r\n                                            }\r\n                                        } else {\r\n                                            td.style.width = null;\r\n                                            td.dataset.wptbFixedWidth = value;\r\n                                            if( i == tableRows.length - 1 && ! widthIsSet ) {\r\n                                                tableTdsFor( dataXIndex, colspan + 1 );\r\n                                            }\r\n                                        }\r\n                                    } else if( cleaner ) {\r\n                                        td.style.width = null;\r\n                                        td.removeAttribute( 'data-wptb-fixed-width' );\r\n                                    } else {\r\n                                        if( td.dataset.wptbFixedWidth ) {\r\n                                            if( td.colSpan == colspan ) {\r\n                                                td.style.width = td.dataset.wptbFixedWidth + 'px';\r\n                                                td.removeAttribute( 'data-wptb-fixed-width' );\r\n                                            } \r\n                                        } else if( td.style.width ) {\r\n                                            for( let z = 0; z < arrayTdsFromPreviousRow.length; z++ ) {\r\n                                                arrayTdsFromPreviousRow[z].style.width = td.style.width;\r\n                                            }\r\n                                            arrayTdsFromPreviousRow = [];\r\n                                        } else {\r\n                                            arrayTdsFromPreviousRow.push( td );\r\n                                        }\r\n                                    }\r\n                                    break;\r\n                                } \r\n                            }\r\n                        }\r\n                    }\r\n                    \r\n                    tableTdsFor( dataXIndex, 1 );\r\n                }\r\n            }\r\n            \r\n            table.tdDefaultWidth();\r\n        }\r\n    }\r\n    \r\n    table.tdDefaultWidth = function() {\r\n        let rows = table.rows;\r\n        \r\n        let tableTdsSumMaxWidth = 0;\r\n        let tableTdsSumMaxWidthFixed = 0;\r\n        let tableTdsSumMaxWidthAuto = 0;\r\n        \r\n        let wptbTableSetup = document.getElementsByClassName( 'wptb-table-setup' )[0];\r\n        let wptbTableSetupWidth = wptbTableSetup.offsetWidth;\r\n        \r\n        let arrayCellsWidthFixedHelper = [];\r\n        let arrayCellsWidthAutoHelper = [];\r\n        let tdPaddingCommon = 0;\r\n        let tableTdBorderCommonWidth = 0;\r\n        let cssForTdsWidthAuto = '';\r\n        \r\n        for( let i = 0; i < rows.length; i++ ) {\r\n            let tds = rows[i].children;\r\n            for( let j = 0; j < tds.length; j++ ) {\r\n                let td = tds[j];\r\n                \r\n                if( ! arrayCellsWidthFixedHelper[parseInt( td.dataset.xIndex )] && ! arrayCellsWidthAutoHelper[parseInt( td.dataset.xIndex )] ) {\r\n                    if( td.style.width ) {\r\n                        arrayCellsWidthFixedHelper[parseInt( td.dataset.xIndex )] = parseFloat( td.style.width );\r\n                        td.removeAttribute( 'data-wptb-css-td-auto-width' );\r\n                    } else {\r\n                        if( ! td.dataset.wptbFixedWidth ) {\r\n                            arrayCellsWidthAutoHelper[parseInt( td.dataset.xIndex )] = 100;\r\n                            td.dataset.wptbCssTdAutoWidth = true;\r\n                        }\r\n                    }\r\n                    \r\n                    if( window.getComputedStyle( td, null ) ) {\r\n                        let tdStyleObj = window.getComputedStyle( td, null );\r\n                        let tdPaddingLeft = tdStyleObj.getPropertyValue( 'padding-left' );\r\n                        let tdPaddingRight = tdStyleObj.getPropertyValue( 'padding-right' );\r\n                        tdPaddingCommon = parseFloat( tdPaddingLeft, 10 ) + parseFloat( tdPaddingRight, 10 );\r\n\r\n                        let tableTdBorderLeftWidth = tdStyleObj.getPropertyValue( 'border-left-width' );\r\n                        let tableTdBorderRightWidth = tdStyleObj.getPropertyValue( 'border-right-width' );\r\n                        tableTdBorderCommonWidth = parseFloat( tableTdBorderLeftWidth, 10 ) + parseFloat( tableTdBorderRightWidth, 10 );\r\n                        if( arrayCellsWidthFixedHelper[parseInt( td.dataset.xIndex )] ) {\r\n                            arrayCellsWidthFixedHelper[parseInt( td.dataset.xIndex )] += tdPaddingCommon;\r\n                            arrayCellsWidthFixedHelper[parseInt( td.dataset.xIndex )] += tableTdBorderCommonWidth;\r\n                        } else {\r\n                            arrayCellsWidthAutoHelper[parseInt( td.dataset.xIndex )] += tdPaddingCommon;\r\n                            arrayCellsWidthAutoHelper[parseInt( td.dataset.xIndex )] += tableTdBorderCommonWidth;\r\n                        }\r\n                    }\r\n                } else if( arrayCellsWidthAutoHelper[parseInt( td.dataset.xIndex )] ) {\r\n                    if( ! td.dataset.wptbFixedWidth ) {\r\n                        td.dataset.wptbCssTdAutoWidth = true;\r\n                    }\r\n                } else if( arrayCellsWidthFixedHelper[parseInt( td.dataset.xIndex )] ) {\r\n                    td.removeAttribute( 'data-wptb-css-td-auto-width' );\r\n                }\r\n            }\r\n        }\r\n        \r\n        for( let i = 0; i < arrayCellsWidthFixedHelper.length; i++ ) {\r\n            if( arrayCellsWidthFixedHelper[i] ) {\r\n                tableTdsSumMaxWidthFixed += arrayCellsWidthFixedHelper[i];\r\n            }\r\n        }\r\n        \r\n        let CellsWidthAutoCount = 0;\r\n        for( let i = 0; i < arrayCellsWidthAutoHelper.length; i++ ) {\r\n            if( arrayCellsWidthAutoHelper[i] ) {\r\n                tableTdsSumMaxWidthAuto += arrayCellsWidthAutoHelper[i];\r\n                CellsWidthAutoCount++;\r\n            }\r\n        }\r\n        \r\n        let tableFullStyleObj = window.getComputedStyle( table, null );\r\n        let borderLeftWidth = tableFullStyleObj.getPropertyValue( 'border-left-width' );\r\n        let borderRightWidth = tableFullStyleObj.getPropertyValue( 'border-right-width' );\r\n        let tableBorderCommon = parseFloat( borderLeftWidth, 10 ) + parseFloat( borderRightWidth, 10 );\r\n        tableTdsSumMaxWidth = tableTdsSumMaxWidthFixed + tableTdsSumMaxWidthAuto + tableBorderCommon;\r\n        \r\n        table.dataset.wptbTableTdsSumMaxWidth = tableTdsSumMaxWidth;\r\n        if( CellsWidthAutoCount ) {\r\n            table.dataset.wptbCellsWidthAutoCount = CellsWidthAutoCount;\r\n            if( table.merging–°ellsHorizontally ) {\r\n                table.dataset.wptbFixedWidthSize = tableTdsSumMaxWidthFixed - tableBorderCommon;\r\n            } else {\r\n                table.removeAttribute( 'data-wptb-fixed-width-size' );\r\n            }\r\n        } else {\r\n            table.removeAttribute( 'data-wptb-fixed-width-size' );\r\n            table.removeAttribute( 'data-wptb-cells-width-auto-count' );\r\n        }\r\n        \r\n        let styleElementCreate = false;\r\n        let tableTdWidthAuto;\r\n        if( tableTdsSumMaxWidth < wptbTableSetupWidth ) {\r\n            if( CellsWidthAutoCount ) {\r\n                table.style.minWidth = '100%';\r\n                if( table.merging–°ellsHorizontally ) {\r\n                    table.style.width = null;\r\n                    let tableTdsWidthAutoCommon = wptbTableSetupWidth - tableTdsSumMaxWidthFixed - tableBorderCommon;\r\n                    tableTdWidthAuto = tableTdsWidthAutoCommon / CellsWidthAutoCount;\r\n                    tableTdWidthAuto = tableTdWidthAuto - tdPaddingCommon - tableTdBorderCommonWidth;\r\n                    styleElementCreate = true;\r\n                } else {\r\n                    table.style.width = '100%';\r\n                }\r\n            } else {\r\n                table.style.width = null;\r\n                table.style.minWidth = null;\r\n                table.style.maxWidth = tableTdsSumMaxWidth + 'px';\r\n            }\r\n        } else {\r\n            table.style.maxWidth = null;\r\n            table.style.minWidth = tableTdsSumMaxWidth + 'px';\r\n            table.style.width = null;\r\n            tableTdWidthAuto = '100'\r\n            styleElementCreate = true;\r\n        }\r\n        \r\n        let head = document.head;\r\n        if( head ) {\r\n            let cssForTdsWidthAutoOld = head.querySelector( 'style[data-wptb-td-auto-width=\"true\"]' );\r\n            if( cssForTdsWidthAutoOld ) {\r\n                head.removeChild( cssForTdsWidthAutoOld );\r\n            }\r\n        }\r\n        \r\n        if( styleElementCreate ) {\r\n            cssForTdsWidthAuto = document.createElement( 'style' );\r\n            cssForTdsWidthAuto.setAttribute( 'data-wptb-td-auto-width', true );\r\n            cssForTdsWidthAuto.innerHTML = '[data-wptb-css-td-auto-width=true]{width:' + tableTdWidthAuto + 'px}';\r\n            if( head ) {\r\n                head.appendChild( cssForTdsWidthAuto );\r\n            }\r\n        }\r\n    }\r\n    \r\n    table.addRowHeight = function( value, cleaner ) {\r\n        let highlighted  = table.getElementsByClassName( 'wptb-highlighted' );\r\n        if( highlighted.length > 0 ) {\r\n            for( let k = 0; k < highlighted.length; k++ ) {\r\n                let dataYIndex = highlighted[k].dataset.yIndex;\r\n                if( dataYIndex ) {\r\n                    function tableTdsFor( dataYIndex, rowspan ) {\r\n                        let tableRows = table.rows;\r\n                        let heightIsSet = false;\r\n                        let arrayTdsPrevious = [];\r\n                        for( let i = 0; i < tableRows.length; i++ ) {\r\n                            let row = tableRows[i];\r\n                            let tds = row.children;\r\n                            for( let j = 0; j < tds.length; j++ ) {\r\n                                let td = tds[j];\r\n                                if( td.dataset.yIndex == dataYIndex ) {\r\n                                    if( value ) {\r\n                                        if( td.rowSpan == rowspan ) {\r\n                                            td.style.height = value + 'px';\r\n                                            td.removeAttribute( 'data-wptb-fixed-heidht' );\r\n                                            heightIsSet = true;\r\n                                            let tableColumnHeightAutoFixedCheckbox = document.getElementById( 'wptb-table-row-height-auto-fixed' );\r\n                                            if( ! tableColumnHeightAutoFixedCheckbox.checked ) {\r\n                                                tableColumnHeightAutoFixedCheckbox.checked = true;\r\n                                            }\r\n                                            continue;\r\n                                        } else {\r\n                                            td.style.height = null;\r\n                                            td.dataset.wptbFixedHeight = value;\r\n                                            if( j == tds.length - 1 && ! heightIsSet ) {\r\n                                                tableTdsFor( dataYIndex , rowspan + 1 );\r\n                                            }\r\n                                        }\r\n                                    } else if( cleaner ) {\r\n                                        td.style.height = null;\r\n                                        td.removeAttribute( 'data-wptb-fixed-heidht' );\r\n                                    } else {\r\n                                        if( td.dataset.wptbFixedHeight ) {\r\n                                            if( td.rowSpan = rowspan ) {\r\n                                                td.style.height = td.dataset.wptbFixedHeight + 'px';\r\n                                                td.removeAttribute( 'data-wptb-fixed-width' );\r\n                                            }\r\n                                        } else if( td.style.height ) {\r\n                                            for( let z = 0; z < arrayTdsPrevious.length; z++ ) {\r\n                                                arrayTdsPrevious[z].style.height = td.style.height;\r\n                                            }\r\n                                            arrayTdsPrevious = [];\r\n                                        } else {\r\n                                            arrayTdsPrevious.push( td );\r\n                                        }\r\n                                    }\r\n                                } \r\n                            }\r\n                        }\r\n                    }\r\n                    \r\n                    tableTdsFor( dataYIndex, 1 );\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    table.reconstraction = function() {\r\n        let tds = table.getElementsByTagName( 'td' );\r\n        let wptbAdaptiveTableChoseBlock = document.getElementsByClassName( 'wptb-adaptive-table-chose-block' );\r\n        if( wptbAdaptiveTableChoseBlock.length > 0 ) {\r\n            wptbAdaptiveTableChoseBlock = wptbAdaptiveTableChoseBlock[0];\r\n        }\r\n        table.merging–°ellsHorizontally = false;\r\n        table.mergingCellsVertically = false;\r\n        table.dataset.reconstraction = 1;\r\n        wptbAdaptiveTableChoseBlock.style.display = 'block';\r\n        let forBreak = 0;\r\n        for( let i = 0; i < tds.length; i++ ) {\r\n            if( tds[i].colSpan > 1 ) {\r\n                table.dataset.reconstraction = 0;\r\n                wptbAdaptiveTableChoseBlock.style.display = 'none';\r\n                table.merging–°ellsHorizontally = true;\r\n                forBreak++;\r\n            }\r\n            \r\n            if( tds[i].rowSpan > 1 ) {\r\n                table.dataset.reconstraction = 0;\r\n                wptbAdaptiveTableChoseBlock.style.display = 'none';\r\n                table.mergingCellsVertically = true;\r\n                forBreak++;\r\n            }\r\n            \r\n            if( forBreak == 2 ) {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /*\r\n     * As simple as it is: adds a column to the end of table.\r\n     */\r\n    table.addColumnEnd = function () {\r\n        let td,\r\n            currentTable = document.getElementsByClassName('wptb-preview-table'),\r\n            currentTableTd,\r\n            currentTdStyle;\r\n        if (currentTable.length > 0) {\r\n            currentTableTd = currentTable[0].querySelector('td');\r\n        }\r\n\r\n        if (currentTableTd) {\r\n            currentTdStyle = currentTableTd.getAttribute('style');\r\n        }\r\n        \r\n        for (var i = 0; i < table.rows.length; i++) {\r\n            td = new WPTB_Cell(mark);\r\n            \r\n            if (currentTdStyle) {\r\n                td.getDOMElement().setAttribute('style', currentTdStyle);\r\n                td.getDOMElement().style.width = null;\r\n                td.getDOMElement().style.height = null;\r\n            }\r\n            \r\n            table.rows[i].appendChild(td.getDOMElement());\r\n            array[i].push(0);\r\n        }\r\n        \r\n        maxAmountOfCells++;\r\n        table.recalculateIndexes();\r\n        table.tdDefaultWidth();\r\n        table.addRowHeight();\r\n        WPTB_Helper.dataTitleColumnSet( table );\r\n        undoSelect();\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n\r\n    /*\r\n     * As simple as it looks: adds a column to the start of table.\r\n     */\r\n\r\n    table.addColumnStart = function () {\r\n        let td,\r\n            firstCell,\r\n            currentTable = document.getElementsByClassName('wptb-preview-table'),\r\n            currentTableTd,\r\n            currentTdStyle;\r\n        if ( currentTable.length > 0 ) {\r\n            currentTableTd = currentTable[0].querySelector('td');\r\n        }\r\n\r\n        if ( currentTableTd ) {\r\n            currentTdStyle = currentTableTd.getAttribute('style');\r\n        }\r\n        \r\n        for (var i = 0; i < table.rows.length; i++) {\r\n            td = new WPTB_Cell(mark);\r\n            if (currentTdStyle) {\r\n                td.getDOMElement().setAttribute('style', currentTdStyle);\r\n                td.getDOMElement().style.width = null;\r\n                td.getDOMElement().style.height = null;\r\n            }\r\n            firstCell = table.rows[i].getElementsByTagName('td')[0];\r\n            if (firstCell) {\r\n                table.rows[i].insertBefore(td.getDOMElement(), firstCell);\r\n            } else {\r\n                table.rows[i].appendChild(td.getDOMElement());\r\n            }\r\n            array[i].push(0);\r\n        }\r\n\r\n        maxAmountOfCells++;\r\n        table.recalculateIndexes();\r\n        table.tdDefaultWidth();\r\n        table.addRowHeight();\r\n        WPTB_Helper.dataTitleColumnSet( table );\r\n        undoSelect();\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n\r\n    /*\r\n     * Well, not so simple as previous functions.\r\n     * It adds a column after a certain column of reference.\r\n     * @param integer the column number to be used as reference.\r\n     *\tIf empty, then the first highlighted cell is used as reference.\r\n     */\r\n\r\n    table.addColumnAfter = function (c_pos) {\r\n        let rows = table.rows,\r\n            cellPointer,\r\n            cellsBuffer,\r\n            cell = document.querySelector('.wptb-highlighted'),\r\n            cellStyle = cell.getAttribute('style'),\r\n            pos = c_pos != undefined && typeof c_pos === 'number' ? c_pos : getCoords(cell)[1];\r\n    \r\n        \r\n    \r\n        if( maxAmountOfCells - pos - cell.colSpan + 1 == 1 ) {\r\n            table.addColumnEnd();\r\n        } else {\r\n            let pendingInsertion = false,\r\n                stepsToMove,\r\n                td, bro,\r\n                carriedRowspans = [],\r\n                currentCell;\r\n\r\n            for (var i = 0; i < maxAmountOfCells; i++) {\r\n                carriedRowspans.push(0);\r\n            }\r\n\r\n            for (var i = 0; i < rows.length; i++) {\r\n                cellPointer = 0;\r\n                cellsBuffer = rows[i].getElementsByTagName('td');\r\n                pendingInsertion = false;\r\n                for (var xPosition = 0;\r\n                        xPosition < maxAmountOfCells;\r\n                        xPosition += stepsToMove) {\r\n                    stepsToMove = 1;\r\n\r\n                    if (pendingInsertion) {\r\n                        td = new WPTB_Cell(mark);\r\n                        if (cellStyle) {\r\n                            td.getDOMElement().setAttribute('style', cellStyle);\r\n                            td.getDOMElement().style.width = null;\r\n                            td.getDOMElement().style.height = null;\r\n                        }\r\n                        if (currentCell && rows[i].contains(currentCell)) {\r\n                            bro = currentCell.nextSibling;\r\n                            if (bro) {\r\n                                rows[i].insertBefore(td.getDOMElement(), bro);\r\n                            } else {\r\n                                rows[i].appendChild(td.getDOMElement());\r\n                            }\r\n                        } else {\r\n                            rows[i].insertBefore(td.getDOMElement(), cellsBuffer[0]);\r\n                        }\r\n                        break;\r\n                    } else if (carriedRowspans[xPosition] > 0) {\r\n                        // If no pending insertion, let's check if no rowspan from upper cells is pending in current position\r\n                        if (pos == xPosition) {\r\n                            pendingInsertion = true;\r\n                        }\r\n                    } else {\r\n                        currentCell = cellsBuffer[cellPointer++];\r\n                        if (currentCell.rowSpan > 1) {\r\n                            stepsToMove = currentCell.colSpan;\r\n                            for (var k = 0; k < currentCell.colSpan; k++) {\r\n                                carriedRowspans[xPosition + k] = currentCell.rowSpan;\r\n                                if (xPosition + k == pos) {\r\n                                    pendingInsertion = true;\r\n                                }\r\n                            }\r\n                        } else if (currentCell.colSpan > 1) {\r\n                            stepsToMove = currentCell.colSpan;\r\n                            for (var k = 0; k < currentCell.colSpan; k++) {\r\n                                if (xPosition + k == pos) {\r\n                                    pendingInsertion = true;\r\n                                }\r\n                            }\r\n                        } else if (xPosition == pos) {\r\n                            pendingInsertion = true;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                for (var l = 0; l < maxAmountOfCells; l++) {\r\n                    if (carriedRowspans[l] > 0)\r\n                        carriedRowspans[l]--;\r\n                }\r\n\r\n            }\r\n\r\n            for (var i = 0; i < array.length; i++) {\r\n                array[i].push(0);\r\n            }\r\n            maxAmountOfCells++;\r\n            drawTable(array);\r\n            table.recalculateIndexes();\r\n            table.addColumnWidth();\r\n            table.addRowHeight();\r\n            WPTB_Helper.dataTitleColumnSet( table );\r\n            undoSelect();\r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n        }\r\n    };\r\n\r\n    /*\r\n     * For preventing us to take a lot of time,\r\n     * This is just calling the function addColumnAfter, but\r\n     * using the previous column to current one as reference.\r\n     * @see addColumnAfter\r\n     */\r\n\r\n    table.addColumnBefore = function () {\r\n        var cell = document.querySelector('.wptb-highlighted'),\r\n                pos = getCoords(cell)[1];\r\n\r\n        if (pos === 0) {\r\n            table.addColumnStart();\r\n        } else {\r\n            table.addColumnAfter(pos - 1);\r\n        }\r\n    };\r\n\r\n    /*\r\n     * Luckily, thisfunction is simple, \r\n     * it just add a row to the end of table.\r\n     */\r\n\r\n    table.addRowToTheEnd = function () {\r\n        let r = table.insertRow(-1),\r\n        td,\r\n        aux,\r\n        currentTable = document.getElementsByClassName('wptb-preview-table');\r\n        r.classList.add( 'wptb-row' );\r\n        if (currentTable.length > 0) {\r\n            currentTable = currentTable[0];\r\n            \r\n            for (var i = 0; i < maxAmountOfCells; i++) {\r\n                td = new WPTB_Cell(mark);\r\n                let currentTableTd = currentTable.querySelector('[data-x-index=\"' + i + '\"]');\r\n                if( currentTableTd ) {\r\n                    let currentTdStyle = currentTableTd.getAttribute( 'style' );\r\n                    \r\n                    td.getDOMElement().setAttribute( 'style', currentTdStyle );\r\n                    td.getDOMElement().style.height = null;\r\n                }\r\n                r.appendChild(td.getDOMElement());\r\n            }\r\n            \r\n            aux = Array.from(array[0]);\r\n            array.push(aux);\r\n            drawTable(array);\r\n            table.recalculateIndexes();\r\n            table.addColumnWidth();\r\n            WPTB_Helper.dataTitleColumnSet( table );\r\n            undoSelect();\r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n        }\r\n    };\r\n\r\n    /*\r\n     * Yet another simple function, \r\n     * it just add a row to the start of table.\r\n     */\r\n\r\n    table.addRowToTheStart = function () {\r\n        let r = table.insertRow(0),\r\n        td,\r\n        aux,\r\n        currentTable = document.getElementsByClassName('wptb-preview-table'),\r\n        currentTableTd,\r\n        currentTdStyle;\r\n        r.classList.add( 'wptb-row' );\r\n        if (currentTable.length > 0) {\r\n            currentTable = currentTable[0];\r\n            \r\n            for (var i = 0; i < maxAmountOfCells; i++) {\r\n                td = new WPTB_Cell(mark);\r\n                let currentTableTd = currentTable.querySelector('[data-x-index=\"' + i + '\"]');\r\n                if( currentTableTd ) {\r\n                    let currentTdStyle = currentTableTd.getAttribute( 'style' );\r\n                    \r\n                    td.getDOMElement().setAttribute( 'style', currentTdStyle );\r\n                    td.getDOMElement().style.height = null;\r\n                }\r\n                r.appendChild(td.getDOMElement());\r\n            }\r\n            \r\n            aux = Array.from(array[0]);\r\n            array.push(aux);\r\n            drawTable(array);\r\n            table.recalculateIndexes();\r\n            table.addColumnWidth();\r\n            WPTB_Helper.dataTitleColumnSet( table );\r\n            undoSelect();\r\n            let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n            wptbTableStateSaveManager.tableStateSet();\r\n        }\r\n    };\r\n\r\n    /* \r\n     * This function adds a row before the current one.\r\n     * Since the biggest factor of problem is a not-started but ongoing rowspan,\r\n     * the most of the troubles is not here.\r\n     */\r\n\r\n    table.addRowBefore = function () {\r\n        let cell = document.querySelector('.wptb-highlighted'),\r\n            cellStyle = cell.getAttribute('style'),\r\n            row = getCoords(cell)[0],\r\n            cellNew;\r\n        for( let i = row - 1; i >= 0; i-- ) {\r\n            let rowChildren = table.rows[i].children;\r\n            let rowChildrenLength = rowChildren.length;\r\n            if( rowChildrenLength > 0 ) {\r\n                for( let j = 0; j < rowChildrenLength; j++ ) {\r\n                    if( rowChildren[j].rowSpan == 1 ) {\r\n                        row = i;\r\n                        cellNew = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if ( cellNew ) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (row === 0) {\r\n            table.addRowToTheStart();\r\n        } else {\r\n            table.addRowAfter( row, cellStyle );\r\n        }\r\n    };\r\n\r\n    /*\r\n     * Well... by the name convention of the previous 3 functions,\r\n     * it's pretty obvious that this functions attaches a new\r\n     * row after highlighted cell row. The greatest obstacle it was\r\n     * the possibility of a TR not having the exact amount of columns\r\n     * occuped by actual node but rowspanned upper cells. For that purpose\r\n     * it was created the function realTimeArray.\r\n     * @see realTimeArray\r\n     */\r\n\r\n    table.addRowAfter = function ( row, cellStyle ) {\r\n        let cellRowSpan,\r\n            rowAfter,\r\n            aux;\r\n            \r\n        if ( ( row == undefined || typeof row !== 'number' ) && cellStyle == undefined ) {\r\n            let cell = document.querySelector('.wptb-highlighted');\r\n            cellStyle = cell.getAttribute('style'),\r\n            row = getCoords(cell)[0],\r\n            cellRowSpan = cell.rowSpan,\r\n            rowAfter = row + cellRowSpan - 1;\r\n        } else {\r\n            rowAfter = row;\r\n        }\r\n        \r\n        \r\n        let cellsColSpan = 0;\r\n        if ( rowAfter < table.rows.length -1 ) {\r\n            for( let i = 0; i <= rowAfter ; i++ ) {\r\n                let tableRowsIChildren = table.rows[i].children,\r\n                    tableRIChildrenLength = tableRowsIChildren.length;\r\n                if( tableRIChildrenLength > 0 ) {\r\n                    for( let j = 0; j < tableRIChildrenLength; j++ ) {\r\n                        let rowIRowSpan = tableRowsIChildren[j].rowSpan;\r\n\r\n                        if ( rowIRowSpan - 1  + i > rowAfter ) {\r\n                            tableRowsIChildren[j].rowSpan++;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            let rNext = table.rows[rowAfter + 1],\r\n                rNextChildren = rNext.children,\r\n                rNextChildrenLength = rNextChildren.length;\r\n                \r\n            if( rNextChildrenLength > 0 ) {\r\n                for ( let i = 0; i < rNextChildrenLength; i++ ) {\r\n                    cellsColSpan += rNextChildren[i].colSpan;\r\n                }\r\n            }\r\n        } else {\r\n            cellsColSpan = array[0].length;\r\n        }\r\n        \r\n        let r = table.insertRow( rowAfter + 1 );\r\n        r.classList.add( 'wptb-row' );\r\n        \r\n        for ( j = 0; j < cellsColSpan; j++ ) {\r\n            let td = new WPTB_Cell( mark );\r\n            td.getDOMElement().setAttribute( 'style', cellStyle );\r\n            td.getDOMElement().style.width = null;\r\n            td.getDOMElement().style.height = null;\r\n            r.appendChild( td.getDOMElement() );\r\n        }\r\n\r\n        aux = Array.from(array[0]);\r\n        array.push(aux);\r\n        drawTable(array);\r\n        table.recalculateIndexes();\r\n        table.addColumnWidth();\r\n        WPTB_Helper.dataTitleColumnSet( table );\r\n        undoSelect();\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n\r\n    /*\r\n     * This function checks the current selected cells\r\n     * make a rectangular shape.\r\n     * @param Array the abstract table.\r\n     * @return false, if not making a rectangle, or\r\n     *\tArray an array containing number of rows and columns, if selection makes a rectangle.\r\n     */\r\n\r\n    table.isSquare = function (a) {\r\n        var rowStart = -1,\r\n            columnStart = -1,\r\n            rowEnd = -1,\r\n            columnEnd = -1,\r\n            height,\r\n            width,\r\n            itemsEstimate = 0,\r\n            items = 0;\r\n\r\n        for (var i = 0; i < a.length; i++) {\r\n            for (var j = 0; j < a[i].length; j++) {\r\n                if (a[i][j] == 1) {\r\n                    if ( j < columnStart || columnStart == -1 ) {\r\n                        columnStart = j;\r\n                    }\r\n                    if ( i < rowStart || rowStart == -1 ) {\r\n                        rowStart = i;\r\n                    }\r\n                }\r\n            }\r\n            \r\n        }\r\n\r\n        for (var i = a.length - 1; i > -1; i--) {\r\n            for (var j = a[i].length - 1; j > -1; j--) {\r\n                if (a[i][j] == 1) {\r\n                    if ( j > columnEnd ) {\r\n                        columnEnd = j;\r\n                    }\r\n                    if ( i > rowEnd ) {\r\n                        rowEnd = i;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        for (var i = rowStart; i < rowEnd; i++) {\r\n            for (var j = columnStart; j < columnEnd; j++) {\r\n                if (a[i][j] == 0 || a[i][j] == undefined) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < a.length; i++) {\r\n            for (var j = 0; j < a[i].length; j++) {\r\n                if (a[i][j] == 1) {\r\n                    items++;\r\n                }\r\n            }\r\n        }\r\n\r\n        height = rowEnd - rowStart + 1;\r\n        width = columnEnd - columnStart + 1;\r\n        itemsEstimate = height * width;\r\n\r\n        if (itemsEstimate !== items) {\r\n            return false;\r\n        }\r\n        return [height, width];\r\n    };\r\n\r\n    /*\r\n     * This function merges all selected cells.\r\n     * Well, actually sets the colspan and rowspan of first \r\n     * upper left  cell in selection and deletes the another selected cells.\r\n     */\r\n\r\n    table.mergeCells = function () {\r\n        var dimensions = table.isSquare(array),\r\n            rowspan = dimensions[0],\r\n            colspan = dimensions[1],\r\n            first = document.querySelector('.wptb-highlighted'),\r\n            tds = [].slice.call(document.getElementsByClassName('wptb-highlighted'), 1),\r\n            tdsChildrenNew = [];\r\n\r\n        for (let i = 0; i < tds.length; i++) {\r\n            let tdsInternalElements = tds[i].getElementsByClassName('wptb-ph-element');\r\n            if (tdsInternalElements.length > 0) {\r\n                let tdsIntElemLength = tdsInternalElements.length;\r\n                for (let j = 0; j < tdsIntElemLength; j++) {\r\n                    tdsChildrenNew.push(tdsInternalElements[j]);\r\n                }\r\n            }\r\n            let p = tds[i].parentNode;\r\n            p.removeChild(tds[i]);\r\n        }\r\n        if (tdsChildrenNew.length > 0) {\r\n            for (let i = 0; i < tdsChildrenNew.length; i++) {\r\n                first.appendChild(tdsChildrenNew[i]);\r\n            }\r\n        }\r\n\r\n        first.colSpan = colspan;\r\n        first.rowSpan = rowspan;\r\n        table.recalculateIndexes();\r\n        table.reconstraction();\r\n        let firstWidth = first.style.width;\r\n        let firstDataFixedWidth = first.dataset.wptbFixedWidth;\r\n        if( firstWidth ) {\r\n            table.addColumnWidth( parseFloat( firstWidth, 10 ) );\r\n        } else if( firstDataFixedWidth ) {\r\n            table.addColumnWidth();\r\n        } else {\r\n            table.addColumnWidth( false, true );\r\n        }\r\n        \r\n        let firstHeight = first.style.height;\r\n        let firstDataFixedHeight = first.dataset.wptbFixedHeight;\r\n        if( firstHeight ) {\r\n            table.addRowHeight( parseFloat( firstHeight, 10 ) );\r\n        } else if( firstDataFixedHeight ) {\r\n            table.addRowHeight();\r\n        } else {\r\n            table.addRowHeight( false, true );\r\n        }\r\n        WPTB_Helper.dataTitleColumnSet( table );\r\n        undoSelect();\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n\r\n    /*\r\n     * This functions makes the exact inverse as above.\r\n     * It resets colspan and rowspan and appends \r\n     * the same amount in cells to the table.\r\n     * @bug\r\n     */\r\n\r\n    table.splitCell = function () {\r\n        var cell = document.getElementsByClassName('wptb-highlighted')[0],\r\n            rowspan = cell.rowSpan,\r\n            colspan = cell.colSpan,\r\n            cellStyles = cell.getAttribute('style'),\r\n            row = getCoords(cell)[0],\r\n            thisRow = table.rows[row],\r\n            cellXIndex =cell.dataset.xIndex;\r\n    \r\n        cell.rowSpan = 1;\r\n        cell.colSpan = 1;\r\n        \r\n        for (let i = 1; i < colspan; i++) {\r\n            let td = new WPTB_Cell(mark);\r\n            td.getDOMElement().setAttribute('style', cellStyles);\r\n            td.getDOMElement().classList.add( 'wptb-highlighted' );\r\n            if ( cell.nextSibling ) {\r\n                thisRow.insertBefore( td.getDOMElement(), cell.nextSibling );\r\n            } else {\r\n                thisRow.appendChild( td.getDOMElement() );\r\n            }\r\n            \r\n        }\r\n\r\n        if (rowspan > 1) {\r\n            for (let i = 1; i < rowspan; i++) {\r\n                let rowChildInsertBefore = undefined,\r\n                    rowNext = table.rows[row + i],\r\n                    rowChildren = rowNext.children,\r\n                    rowChildrenLength = rowChildren.length;\r\n            \r\n                if ( rowChildrenLength > 0 ) {\r\n                    for ( let k = 0; k < rowChildrenLength; k++ ) {\r\n                        if ( Number( rowChildren[k].dataset.xIndex ) > Number( cellXIndex ) ) {\r\n                            rowChildInsertBefore = rowChildren[k];\r\n                            break;\r\n                        } \r\n                    }\r\n                }\r\n                for ( let j = 0; j < colspan; j++ ) {\r\n                    let td = new WPTB_Cell( mark );\r\n                    td.getDOMElement().setAttribute( 'style', cellStyles );\r\n                    if ( rowChildInsertBefore != undefined ) {\r\n                        rowNext.insertBefore( td.getDOMElement(), rowChildInsertBefore );\r\n                    } else {\r\n                        rowNext.appendChild( td.getDOMElement() );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        table.recalculateIndexes();\r\n        table.reconstraction();\r\n        table.addColumnWidth();\r\n        table.addRowHeight();\r\n        WPTB_Helper.dataTitleColumnSet( table );\r\n        undoSelect();\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n\r\n    /*\r\n     * Searches for rowspanned cells up to row number meeting it.\r\n     * @param number the number of row where the function\r\n     * must search up to.\r\n     */\r\n\r\n    table.findRowspannedCells = function (row) {\r\n        var array = [],\r\n                difference;\r\n        actualPoints = getActualPointsInRow(row);\r\n        if (actualPoints === maxAmountOfCells) {\r\n            return [];\r\n        }\r\n        difference = maxAmountOfCells - actualPoints;\r\n\r\n        for (var i = row - 1; i >= 0 && difference; i--) {\r\n            var tds = table.rows[i].getElementsByTagName('td');\r\n            for (var i = 0; i < tds.length; i++) {\r\n                if (tds[i].rowSpan > 1) {\r\n                    array.push(tds[i]);\r\n                    difference -= tds[i].colSpan;\r\n                }\r\n            }\r\n        }\r\n        return array;\r\n\r\n    }\r\n\r\n    /*\r\n     * This function explores the table and adds \r\n     * a cell for each lacking one for each row\r\n     * to meet an even amount of cells.\r\n     */\r\n\r\n    table.addLackingCells = function () {\r\n        var sumRows = [];\r\n        for (var i = 0; i < table.rows.length; i++) {\r\n            sumRows.push(0);\r\n        }\r\n\r\n        for (var i = 0; i < table.rows.length; i++) {\r\n            var tds = table.rows[i].getElementsByTagName('td');\r\n            for (var j = 0; j < tds.length; j++) {\r\n                if (tds[j].rowSpan > 1) {\r\n                    for (var k = 1; k < tds[j].rowSpan; k++) {\r\n                        sumRows[i + k]++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < table.rows.length; i++) {\r\n            var tds = table.rows[i].getElementsByTagName('td'),\r\n                    totalColspan = 0;\r\n            for (var j = 0; j < tds.length; j++) {\r\n                totalColspan += tds[j].colSpan;\r\n            }\r\n            totalColspan += sumRows[i];\r\n            difference = maxAmountOfCells - totalColspan;\r\n            for (var j = 0; j < difference; j++) {\r\n                var td = new WPTB_Cell(mark);\r\n                table.rows[i].appendChild(td.getDOMElement());\r\n                //table.rows[i].insertBefore( td.getDOMElement(), rows[i].nextSibling );\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\r\n     * This function deletes the row of currently\r\n     * selected cell. \r\n     */\r\n\r\n    table.deleteRow = function () {\r\n        let cell = document.querySelector('.wptb-highlighted'),\r\n            cellStyles = cell.getAttribute('style'),\r\n            rowspan = cell.rowSpan,\r\n            row = getCoords(cell)[0],\r\n            thisRow,\r\n            aux;\r\n    \r\n        if ( rowspan == undefined ) rowspan = 1;\r\n        \r\n        for ( let i = 0; i < rowspan; i++ ) {\r\n            thisRow = table.rows[row];\r\n            let thisRowChildren = thisRow.children,\r\n                nextRow = table.rows[row + 1],\r\n                nextRowChildren,\r\n                nextRowChildrenLength,\r\n                tdArr = [];\r\n\r\n            if( nextRow != undefined ) {\r\n                nextRowChildren = nextRow.children;\r\n                nextRowChildrenLength = nextRowChildren.length;\r\n                for (let j = 0; j < thisRowChildren.length; j++) {\r\n                    if ( thisRowChildren[j].rowSpan > 1 ) {\r\n                        let td = new WPTB_Cell(mark);\r\n                            td.getDOMElement().setAttribute('style', cellStyles);\r\n                            td.getDOMElement().colSpan = thisRowChildren[j].colSpan;\r\n                            td.getDOMElement().rowSpan = thisRowChildren[j].rowSpan - 1;\r\n\r\n                        let nextRowChildrenK = undefined;\r\n                        for ( let k = 0; k < nextRowChildrenLength; k++ ) {\r\n                            if ( Number( nextRowChildren[k].dataset.xIndex ) > Number( thisRowChildren[j].dataset.xIndex ) ) {\r\n                                nextRowChildrenK = nextRowChildren[k];\r\n                                break;\r\n                            } \r\n                        }\r\n\r\n                        if ( nextRowChildrenK ) {\r\n                            tdArr.push( [td, nextRowChildrenK] );\r\n                        } else {\r\n                            tdArr.push( [td] );\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if ( tdArr.length > 0 ) {\r\n                    for ( let k = 0; k < tdArr.length; k++ ) {\r\n                        if ( tdArr[k][1] != undefined ) {\r\n                            nextRow.insertBefore( tdArr[k][0].getDOMElement(), tdArr[k][1] );\r\n                        } else {\r\n                            nextRow.appendChild( tdArr[k][0].getDOMElement() );\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            let tableRows = table.rows;\r\n            if ( tableRows.length > 0 ) {\r\n                for ( let j = 0; j < row; j++ ) {\r\n                    let jRowChildren = tableRows[j].children;\r\n                    if ( jRowChildren.length > 0 ) {\r\n                        for ( let x = 0; x < jRowChildren.length; x++ ) {\r\n                            if ( jRowChildren[x].rowSpan - 1 >= row - j ) {\r\n                                jRowChildren[x].rowSpan--;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            aux = Array.from(array[0]);\r\n            array.pop(aux);\r\n            drawTable(array);\r\n            table.getElementsByTagName('tbody')[0].removeChild(table.rows[row]);\r\n            \r\n            if( table.rows.length == 0 ) {\r\n                table.toggleTableEditMode();\r\n                wptbTableSetup.innerHTML = '';\r\n                WPTB_Helper.settingsPanelClear();\r\n                document.getElementsByClassName('wptb-table-generator')[0].style.display = 'table';\r\n            }\r\n            \r\n            table.recalculateIndexes();\r\n            WPTB_Helper.dataTitleColumnSet( table );\r\n        }\r\n        \r\n        undoSelect();\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    }\r\n\r\n    /*\r\n     * This function deletes the column of currently\r\n     * selected cell. Again, this is way more complicated than\r\n     * delete row case.\r\n     */\r\n\r\n    table.deleteColumn = function () {\r\n        let cell = document.querySelector('.wptb-highlighted'),\r\n            cellXIndex = cell.dataset.xIndex,\r\n            colspan = cell.colSpan;\r\n        \r\n        for ( let i = 0; i < colspan; i++ ) {\r\n            for ( let j = 0; j < table.rows.length; j++ ) {\r\n                let rowChildren = table.rows[j].children;\r\n                let rowChildrenLength = rowChildren.length;\r\n                if( rowChildrenLength > 0 ) {\r\n                    for ( let k = rowChildrenLength - 1; k >= 0; k-- ) {\r\n                        if ( Number( rowChildren[k].dataset.xIndex ) == Number( cellXIndex ) ) {\r\n                            if ( rowChildren[k].colSpan > 1 ) {\r\n                                rowChildren[k].colSpan--;\r\n                            } else {\r\n                                table.rows[j].removeChild( rowChildren[k] );\r\n                            }\r\n                            break;\r\n                        } else if( Number( rowChildren[k].dataset.xIndex ) < Number( cellXIndex ) && \r\n                                Number( rowChildren[k].dataset.xIndex ) + \r\n                                Number( rowChildren[k].colSpan -1 ) >= cellXIndex ) {\r\n                            if ( rowChildren[k].colSpan > 1 ) {\r\n                                rowChildren[k].colSpan--;\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            for ( let j = 0; j < table.rows.length; j++ ) {\r\n                if (array[j] != undefined)\r\n                    array[j].pop();\r\n            }\r\n            \r\n            maxAmountOfCells--;\r\n            \r\n            if( table.querySelectorAll( 'td' ).length == 0 ) {\r\n                table.toggleTableEditMode();\r\n                wptbTableSetup.innerHTML = '';\r\n                WPTB_Helper.settingsPanelClear();\r\n                document.getElementsByClassName('wptb-table-generator')[0].style.display = 'table';\r\n            }\r\n            \r\n            table.recalculateIndexes();\r\n            table.tdDefaultWidth();\r\n            WPTB_Helper.dataTitleColumnSet( table );\r\n        }\r\n        \r\n        undoSelect();\r\n        let wptbTableStateSaveManager = new WPTB_TableStateSaveManager();\r\n        wptbTableStateSaveManager.tableStateSet();\r\n    };\r\n\r\n    document.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\r\n\r\n    array = fillTableArray();\r\n\r\n    undoSelect();\r\n    drawTable(array);\r\n\r\n    wptbTableSetup.appendChild(table);\r\n    //if (columns || rows) {\r\n        table.recalculateIndexes( true );\r\n    //}\r\n    table.reconstraction();\r\n    table.tdDefaultWidth();\r\n    \r\n    wptbTableSetup.onresize = function() {\r\n        table.tdDefaultWidth();\r\n    };\r\n\r\n    WPTB_LeftPanel();\r\n    \r\n    // this code gets the ID of the active element in the toolbar \r\n    // and stores it in the data attribute of the common container element \"wpcd_fixed_toolbar\"\r\n//    let wptbPhElement = document.getElementsByClassName( 'wptb-ph-element' );\r\n//    let wpcdFixedToolbar = document.getElementById( 'wpcd_fixed_toolbar' );\r\n//    for ( let i = 0; i < wptbPhElement.length; i++ ) {\r\n//        wptbPhElement[i].addEventListener( 'click', function( e ) {\r\n//            let wptbToolbar = document.getElementById( 'wpcd_fixed_toolbar' ).children;\r\n//            for ( let j = 0; j < wptbToolbar.length; j++ ) {\r\n//                let elementStyles = window.getComputedStyle( wptbToolbar[j], 'null' );\r\n//                if( elementStyles.getPropertyValue( 'display' ) == 'block' ) {\r\n//                    wpcdFixedToolbar.dataset.toolbarActiveId = wptbToolbar[j].getAttribute( 'id' );\r\n//                }\r\n//            }\r\n//        }, false );\r\n//    }\r\n    \r\n//    let wptbPanelLeft = document.getElementsByClassName( 'wptb-panel-left' );\r\n//    if( wptbPanelLeft.length > 0 ) {\r\n//        wptbPanelLeft[0].addEventListener( 'click', function( e ) {\r\n//            let toolbarActiveElementId = wpcdFixedToolbar.dataset.toolbarActiveId;\r\n//            document.getElementById( toolbarActiveElementId ).style.display = '';\r\n//        }, false );\r\n//    }\r\n    \r\n//    let body = document.getElementsByTagName( 'body' );\r\n//    if( body.length > 0 ) {\r\n//        body[0].addEventListener( 'click', function( e ) {\r\n//            if ( e.target.classList.contains( 'wptb-panel-left' ) || WPTB_Helper.findAncestor( e.target, 'wptb-panel-left' ) ) {\r\n//                let toolbarActiveElementId = wpcdFixedToolbar.dataset.toolbarActiveId;\r\n//                document.getElementById( toolbarActiveElementId ).style.display = '';\r\n//            }\r\n//        }, false );\r\n//    }\r\n};","var WPTB_TableStateSaveManager = function() {\n    this.tableStateSet = () => {\n        // get preview table\n        let wptbPreviewTable = document.getElementsByClassName( 'wptb-preview-table' );\n        if( wptbPreviewTable.length > 0 ) {\n            wptbPreviewTable = wptbPreviewTable[0];\n            \n            // check if a global array doesn't exist with saved versions of the table \n            // them create it\n            if( ! window.wptbTableStateSaving ) {\n                window.wptbTableStateSaving = [];\n            } \n            \n            // remove the extra part of the array after changing the table \n            // when it is showed in the not last modified version\n            if( window.wptbTableStateSaving.length > window.wptbTableStateNumberShow + 1 ) {\n                window.wptbTableStateSaving = window.wptbTableStateSaving.slice( 0, window.wptbTableStateNumberShow + 1 );\n            }\n            \n            //add new state of table\n            let wptbNewPreviewTable = wptbPreviewTable.cloneNode( true );\n            let wptbHighlighted = wptbNewPreviewTable.getElementsByClassName( 'wptb-highlighted' );\n            for( let i = 0; i < wptbHighlighted.length; i++ ) {\n                wptbHighlighted[i].classList.remove( 'wptb-highlighted' );\n            }\n            let wptbDirectlyhovered = wptbNewPreviewTable.getElementsByClassName( 'wptb-directlyhovered' );\n            for( let i = 0; i < wptbDirectlyhovered.length; i++ ) {\n                wptbDirectlyhovered[i].classList.remove( 'wptb-directlyhovered' );\n            }\n            \n            let cssForTdsWidthAutoValue = '';\n            let head = document.head;\n            if( head ) {\n                let cssForTdsWidthAuto = head.querySelector( 'style[data-wptb-td-auto-width=\"true\"]' );\n                if( cssForTdsWidthAuto ) {\n                    cssForTdsWidthAutoValue = cssForTdsWidthAuto.innerHTML;\n                }\n            }\n            \n            let mceContentBodys = wptbNewPreviewTable.querySelectorAll( '.mce-content-body' );\n            if( mceContentBodys.length > 0 ) {\n                for ( let k = 0; k < mceContentBodys.length; k++ ) {\n                    mceContentBodys[k].classList.remove( 'mce-content-body' );\n                }\n            }\n\n            let dataMceStyle = wptbNewPreviewTable.querySelectorAll( '[data-mce-style]' );\n            if ( dataMceStyle.length > 0 ) {\n                for ( let k = 0; k < dataMceStyle.length; k++ ) {\n                    dataMceStyle[k].removeAttribute( 'data-mce-style' );\n                }\n            }\n\n            let mceIds = wptbNewPreviewTable.querySelectorAll( '[id^=mce_]' );\n            if ( mceIds.length > 0 ) {\n                for ( let k = 0; k < mceIds.length; k++ ) {\n                    mceIds[k].removeAttribute( 'id' );\n                }\n            }\n            \n            window.wptbTableStateSaving.push( [wptbNewPreviewTable, cssForTdsWidthAutoValue] );\n            \n            // set new number of state which is showed now\n            window.wptbTableStateNumberShow = window.wptbTableStateSaving.length - 1;\n            \n            // make undo arrow active when the table was changed\n            if( window.wptbTableStateSaving.length > 1 ) {\n                let wptbUndo = document.getElementsByClassName( 'wptb-undo' );\n                if( wptbUndo.length > 0 ) {\n                    wptbUndo = wptbUndo[0];\n\n                    wptbUndo.classList.remove( 'wptb-undoredo-disabled' );\n                }\n            }\n            \n            // make redo arrow not active when the table was changed\n            let wptbRedo = document.getElementsByClassName( 'wptb-redo' );\n            if( wptbRedo.length > 0 ) {\n                wptbRedo = wptbRedo[0];\n                \n                wptbRedo.classList.add( 'wptb-undoredo-disabled' );\n            }\n            \n            let wptbSaveBtn = document.getElementsByClassName( 'wptb-save-btn' );\n            if( wptbSaveBtn.length > 0 ) {\n                wptbSaveBtn = wptbSaveBtn[0];\n                if( ( ! wptbSaveBtn.dataset.wptbTableStateNumberSave && window.wptbTableStateNumberShow == 0 ) || \n                        window.wptbTableStateNumberShow == wptbSaveBtn.dataset.wptbTableStateNumberSave ) {\n                    wptbSaveBtn.classList.add( 'wptb-save-disabled' );\n                } else {\n                    wptbSaveBtn.classList.remove( 'wptb-save-disabled' );\n                }\n            }\n        }\n    }\n    \n    this.tableStateGet = ( datawptbUndoredo ) => {\n        if( datawptbUndoredo && window.wptbTableStateSaving && window.wptbTableStateSaving.length > 1 ) {\n            \n            // changes the number of the state which displays now\n            if( datawptbUndoredo == 'undo' ) {\n                if( window.wptbTableStateNumberShow > 0 ) {\n                    window.wptbTableStateNumberShow--;\n                } else {\n                    return false;\n                }\n            } else if( datawptbUndoredo == 'redo' ) {\n                if( window.wptbTableStateNumberShow < window.wptbTableStateSaving.length - 1 ) {\n                    window.wptbTableStateNumberShow++;\n                } else {\n                    return false;\n                }\n            }\n            \n            // add or delete class \"wptb-undoredo-disabled\" for undo button\n            let wptbUndo = document.getElementsByClassName( 'wptb-undo' );\n            if( wptbUndo.length > 0 ) {\n                wptbUndo = wptbUndo[0];\n            }\n            if( window.wptbTableStateNumberShow == 0 ) {\n                if( wptbUndo ) {\n                    wptbUndo.classList.add( 'wptb-undoredo-disabled' )\n                }\n            } else if( window.wptbTableStateNumberShow > 0 ) {\n                if( wptbUndo ) {\n                    wptbUndo.classList.remove( 'wptb-undoredo-disabled' )\n                }\n            }\n            \n            // add or delete class \"wptb-undoredo-disabled\" for redo button\n            let wptbRedo = document.getElementsByClassName( 'wptb-redo' );\n            if( wptbRedo.length > 0 ) {\n                wptbRedo = wptbRedo[0];\n            }\n            if( window.wptbTableStateNumberShow == window.wptbTableStateSaving.length - 1 ) {\n                if( wptbRedo ) {\n                    wptbRedo.classList.add( 'wptb-undoredo-disabled' )\n                }\n            } else if( window.wptbTableStateNumberShow < window.wptbTableStateSaving.length - 1 ) {\n                if( wptbRedo ) {\n                    wptbRedo.classList.remove( 'wptb-undoredo-disabled' )\n                }\n            }\n            \n            let wptbSaveBtn = document.getElementsByClassName( 'wptb-save-btn' );\n            if( wptbSaveBtn.length > 0 ) {\n                wptbSaveBtn = wptbSaveBtn[0];\n                if( ( ! wptbSaveBtn.dataset.wptbTableStateNumberSave && window.wptbTableStateNumberShow == 0 ) || \n                        window.wptbTableStateNumberShow == wptbSaveBtn.dataset.wptbTableStateNumberSave ) {\n                    wptbSaveBtn.classList.add( 'wptb-save-disabled' );\n                } else {\n                    wptbSaveBtn.classList.remove( 'wptb-save-disabled' );\n                }\n            }\n            \n            // load necessary saved table state\n            let wptbTableSetup = document.getElementsByClassName( 'wptb-table-setup' );\n            if( wptbTableSetup.length > 0 ) {\n                wptbTableSetup = wptbTableSetup[0];\n\n                wptbTableSetup.innerHTML = '';\n                wptbTableSetup.innerHTML = window.wptbTableStateSaving[window.wptbTableStateNumberShow][0].outerHTML;\n\n                if( window.wptbTableStateSaving[window.wptbTableStateNumberShow][1] ) {\n                    let cssForTdsWidthAuto = document.createElement( 'style' );\n                    cssForTdsWidthAuto.setAttribute( 'data-wptb-td-auto-width', true );\n                    cssForTdsWidthAuto.innerHTML = window.wptbTableStateSaving[window.wptbTableStateNumberShow][1];\n                    let head = document.head;\n                    if( head ) {\n                        let cssForTdsWidthAutoOld = head.querySelector( 'style[data-wptb-td-auto-width=\"true\"]' );\n                        if( cssForTdsWidthAutoOld ) {\n                            head.removeChild( cssForTdsWidthAutoOld );\n                        }\n                        head.appendChild( cssForTdsWidthAuto );\n                    }\n                }\n\n                WPTB_Helper.settingsPanelClear();\n                WPTB_Helper.elementOptionsPanelClear();\n                WPTB_LeftPanel();\n\n                let wptbLeftScrollPanelCellSetting = document.getElementById( 'wptb-left-scroll-panel-cell-settings' ); \n                if( wptbLeftScrollPanelCellSetting ) {\n                    wptbLeftScrollPanelCellSetting.classList.remove( 'visible' );\n                }\n            }\n        }\n    }\n}","var WPTB_Text = function ( text , DOMElementProt ) {\r\n    let DOMElement = document.createElement('div'),\r\n        elText2 = document.createElement('div'),\r\n        elP = document.createElement('p'),\r\n        kindIndexProt = undefined,\r\n        copy = false;\r\n        \r\n        DOMElement.classList.add( 'wptb-text-container' );\r\n\r\n        elP.innerHTML = text != undefined ? text : 'Text';\r\n        elText2.appendChild(elP);\r\n        DOMElement.appendChild(elText2);\r\n    if ( DOMElementProt ) {\r\n        let wptbElementMutch = DOMElementProt.className.match( /wptb-element-((.+-)\\d+)/i );\r\n        if ( wptbElementMutch && Array.isArray( wptbElementMutch ) ) {\r\n            kindIndexProt = wptbElementMutch[1];\r\n            copy = true;\r\n        };\r\n\r\n        let attributes = [...DOMElementProt.attributes];\r\n        for( let i = 0; i < attributes.length; i++ ) {\r\n            DOMElement.setAttribute(attributes[i].name, attributes[i].value);\r\n        }\r\n    } \r\n\r\n    this.kind = 'text';\r\n    this.getDOMElement = function () {\r\n        return DOMElement;\r\n    };\r\n    applyGenericItemSettings( this, kindIndexProt, copy );\r\n\r\n    return this;\r\n};"]}