{"version":3,"sources":["WPTB_Builder.js","WPTB_Button.js","WPTB_Cell.js","WPTB_ElementCounters.js","WPTB_ElementOptions.js","WPTB_Image.js","WPTB_Initializer.js","WPTB_LeftPanel.js","WPTB_List.js","WPTB_ListItem.js","WPTB_MultipleSelect.js","WPTB_Parser.js","WPTB_Settings.js","WPTB_Space.js","WPTB_Stringifier.js","WPTB_Table.js","WPTB_Text.js","applyGenericItemSettings.js","wptb-builder.js"],"names":["detectMode","url","window","location","href","regex","RegExp","results","exec","decodeURIComponent","replace","WPTB_Builder","table_id","http","XMLHttpRequest","ajaxurl","open","setRequestHeader","onreadystatechange","d","readyState","status","document","getElementsByClassName","style","display","appendChild","WPTB_Parser","responseText","send","counter","ElementCounters","select","MultipleSelect","initializer","WPTB_Initializer","settings","WPTB_Settings","addEventListener","WPTB_Button","text","DOMElement","createElement","elButton2","el_B","kind","classList","add","innerHTML","undefined","getDOMElement","applyGenericItemSettings","WPTB_Cell","newElementProxy","el","WPTB_List","WPTB_Image","WPTB_Text","highlightRow","td","parentRow","parentNode","columnCount","parseInt","getElementById","value","tds","getElementsByTagName","i","length","remove","classToAdd","ttd","highlightColumn","index","rowCount","table","tr","draggable","onclick","relativeActions","cells","_wptbManagementModeActive","contains","dataset","activeCell","onmousedown","activateMultipleSelectMode","pushSelectedCell","onmouseup","deactivateMultipleSelectMode","ondragenter","e","div","dataTransfer","getData","ondragover","preventDefault","ondragleave","ondrop","element","classId","space","t_space","spaceParent","WPTB_Space","console","log","nextSibling","removeChild","onmouseover","setCoords","y","x","yIndex","xIndex","getCoords","coords","appendElement","node","priv","increment","key","nextIndex","WPTB_ElementOptions","elemIdClass","prop","querySelector","cloneNode","properties","infArr","className","match","optionsClass","children","childNodes","buttons","size","n_Class","type","num","affectedEl","b","optionControls","jQuery","wpColorPicker","change","event","ui","parent","target","classe","ps","number","backgroundColor","color","toString","slider","oninput","onchange","val","img","src","alt","width","height","fontSize","bullets","querySelectorAll","listStyleType","toLowerCase","file_frame","wp","media","frames","title","button","multiple","on","attachment","state","get","first","toJSON","MIN_COLUMNS","MIN_ROWS","MAX_COLUMNS","MAX_ROWS","tableGenerator","body","columnsDecrementButton","columnsIncrementButton","rowsDecrementButton","rowsIncrementButton","columnsInput","rowsInput","columns","rows","WPTB_Table","WPTB_LeftPanel","wptbElementButtons","tableRows","j","tableHeader","addInnerBorderSize","tableCells","border","addCellPadding","padding","addInnerBorder","checked","styles","marginBottom","addBorderSize","_val","ondragstart","setData","wptbElement","addRowToTheEnd","addRowToTheStart","addRowBefore","addRowAfter","addColumnToTheEnd","addColumnToTheStart","addColumnBefore","addColumnAfter","deleteColumn","deleteRow","mergeCells","splitCell","innerElements","el_L","item","WPTB_ListItem","divdot","divcontent","libullet","onkeyup","listItemKeyListener","onmouseenter","btnDelete","btnCopy","actions","previous","article","content","html","duplicate","append","onmouseleave","onkeydown","which","keyCode","lastP","dontAddItems","insertBefore","focus","selectedCells","multipleCellMode","cell","push","flushSelectedCells","getFirst","minXIndex","minYIndex","getLast","maxXIndex","maxYIndex","last","removeAllButFirst","p","changeRemovalClass","formerX","formerY","formerClass","code","pos","getChar","getToken","char","token","ctoken","getCurrentToken","getExpectedToken","expected","getWordFromToken","indexOf","word","substring","getAttributesFromToken","elems","split","pair","attr","trim","parseAllHTML","analizeElement","t","analizeElements","analizeRows","tableNode","insertRow","analizeTds","analizeTd","row","analizeHeader","header","analizeRoot","n","effectAllowed","getAttribute","messagingArea","WPTB_Stringifier","setTimeout","params","spaceBetween","stopPropagation","tagName","margin","bg1","bg2","bg3","colSpan","rowSpan","isHidden","listClass","buttonSize","buttonColor","buttonBorder","fontColor","fontFamily","additionalCSS","additionalClass","additionalID","borderSize","innerBorder","colspan","rowspan","trueNode","nodeContent","listitems","wptbTableSetup","recalculateIndexes","trs","maxCols","addColumn","referenceTd","newTd","_this","xCoord","k","evt","addRow","referenceRow","active","tbody","firstCell","lastCell","Math","abs","classn","hidden","elText2","elP","listItems","btnMove","act","temp","srcList","copy","setDragImage","tinyMCE","init","inline","plugins","dialog_type","theme","menubar","fixed_toolbar_container","toolbar","setup","ed","execCommand","init_instance_callback","editor","getContent","setContent","range","selection","getRng","KeyID","startOffset","currentEditor","totalWidth","offsetWidth","scrollTop","bodyElement","position","right","top","paste_as_text","formerActions","par"],"mappings":"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","file":"admin.js","sourcesContent":["(function () {\n\n\tfunction detectMode() {\n\t\tvar url = window.location.href,\n\t\t\tregex = new RegExp('[?&]table(=([^&#]*)|&|#|$)'),\n\t\t\tresults = regex.exec(url);\n\t\tif (!results) return false;\n\t\tif (!results[2]) return '';\n\t\treturn decodeURIComponent(results[2].replace(/\\+/g, ' '));\n\t}\n\n\tvar WPTB_Builder = function () {\n\t\tvar table_id = detectMode();\n\t\tif (table_id) {\n\t\t\tvar http = new XMLHttpRequest(),\n\t\t\t\turl = ajaxurl + \"?action=get_table\" + '&id=' + table_id;\n\t\t\thttp.open('GET', url, true);\n\t\t\thttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n\t\t\thttp.onreadystatechange = function (d) {\n\t\t\t\tif (this.readyState == 4 && this.status == 200) {\n\t\t\t\t\tdocument.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\n\t\t\t\t\tdocument.getElementsByClassName('wptb-table-setup')[0].appendChild(WPTB_Parser(http.responseText));\n\t\t\t\t}\n\t\t\t}\n\t\t\thttp.send(null);\n\t\t}\n\t\tdocument.counter = new ElementCounters();\n\t\tdocument.select = new MultipleSelect();\n\n\t\tvar initializer = WPTB_Initializer();\n\t\tsettings = WPTB_Settings();\n\t};\n\n\tdocument.addEventListener('DOMContentLoaded', WPTB_Builder);\n\n})();","var WPTB_Button = function (text) {\n\n\tvar DOMElement = document.createElement('div'),\n\t\telButton2 = document.createElement('div'),\n\t\tel_B = document.createElement('p');\n\n\tthis.kind = 'button';\n\n\tDOMElement.classList.add('wptb-button-container');\n\telButton2.classList.add('wptb-button-wrapper');\n\tel_B.classList.add('wptb-button');\n\tel_B.classList.add('editable');\n\tel_B.innerHTML = text != undefined ? text : 'Button Text';\n\telButton2.appendChild(el_B);\n\tDOMElement.appendChild(elButton2);\n\n\tthis.getDOMElement = function () {\n\t\treturn DOMElement;\n\t}\n\n\tapplyGenericItemSettings(this);\n\n\treturn this;\n\n};","var WPTB_Cell = function (DOMElement) {\n\n    function newElementProxy(el) {\n        if (el == 'list') {\n            return new WPTB_List();\n        }\n        else if (el == 'image') {\n            return new WPTB_Image();\n        }\n        else if (el == 'text') {\n            return new WPTB_Text();\n        }\n        else if (el == 'button') {\n            return new WPTB_Button();\n        }\n    }\n\n    function highlightRow(td) {\n        var parentRow = td.parentNode,\n            columnCount = parseInt(document.getElementById('wptb-columns-number').value),\n            tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\n        for (var i = 0; i < tds.length; i++) {\n            tds[i].classList.remove('highlighted-row-first', 'highlighted-row-last', 'highlighted-row-inner',\n                'highlighted-column-first', 'highlighted-column-last', 'highlighted-column-inner');\n        }\n        for (var i = 0; i < columnCount; i++) {\n\n            var classToAdd = (i == 0 ? 'highlighted-row-first' :\n                (i == columnCount - 1 ? 'highlighted-row-last'\n                    : 'highlighted-row-inner'));\n            var ttd = parentRow.getElementsByTagName('td')[i];\n            if (ttd !== td) {\n                ttd.classList.add(classToAdd);\n            }\n        }\n    }\n\n        function highlightColumn(td){\n           \n            var index,\n                parentRow = td.parentNode;\n                columnCount = parseInt(document.getElementById('wptb-columns-number').value),\n                rowCount = parseInt(document.getElementById('wptb-rows-number').value),\n                table = document.getElementsByClassName('wptb-preview-table')[0];\n                for (var i = 0; i < columnCount; i++) {\n                    if(parentRow.getElementsByTagName('td')[i] === td ){\n                        index = i;\n                        break;\n                    }\n                }\n\n                for (var i = 0; i < rowCount; i++) {\n                    var classToAdd = (i == 0 ? 'highlighted-column-first' : \n                                    (i == rowCount-1 ? 'highlighted-column-last' \n                                        : 'highlighted-column-inner'));\n                    var tr = table.getElementsByTagName('tr')[i];\n                    if(tr.getElementsByTagName('td')[index]!==td){\n                        tr.getElementsByTagName('td')[index].classList.add(classToAdd);\n                    }\n                }\n        }\n        \n       \n    DOMElement = document.createElement(\"td\");\n\n    DOMElement.draggable = false;\n\n    DOMElement.classList.add('wptb-droppable', 'wptb-cell');\n\n    DOMElement.onclick = function () {\n\n        var relativeActions, cells;\n\n        if (window._wptbManagementModeActive) {\n            return;\n        }\n        if (this.classList.contains('wptb-highlighted')) {\n            //this.classList.remove('wptb-highlighted');\n        }\n        else {\n            relativeActions = document.getElementsByClassName('wptb-relative-action');\n            cells = document.getElementsByTagName('td');\n\n            for (var i = 0; i < relativeActions.length; i++) {\n                relativeActions[i].dataset.activeCell = this;\n            }\n\n            for (var i = 0; i < cells.length; i++) {\n                cells[i].classList.remove('wptb-highlighted');\n            }\n\n        }\n    };\n\n        DOMElement.onmousedown = function(){ \n            document.select.activateMultipleSelectMode();\n            document.select.pushSelectedCell(this);\n        };\n\n\n\n        DOMElement.onmouseup = function(){ \n            document.select.deactivateMultipleSelectMode();\n        };\n\n    DOMElement.ondragenter = function (e) {\n        var div;\n        if (!e.dataTransfer.getData('wptbElement')\n            && !e.dataTransfer.getData('node')) {\n            return;\n        }\n        this.classList.add('wptb-drop-here-empty');\n    }\n\n    DOMElement.ondragover = function (e) {\n        e.preventDefault();\n    }\n\n    DOMElement.ondragleave = function () {\n        this.classList.remove('wptb-drop-here-empty');\n\n    }\n\n    DOMElement.ondrop = function (e) {\n        var element, classId, space, t_space, spaceParent;\n        e.preventDefault();\n        space = new WPTB_Space();\n\n        console.log(e.dataTransfer);\n\n        if (!e.dataTransfer.getData('wptbElement')\n            && !e.dataTransfer.getData('node')) {\n            return;\n        }\n\n        if (e.dataTransfer.getData('wptbElement')) {\n            element = newElementProxy(e.dataTransfer.getData('wptbElement'));\n            if (this.innerHTML == '') {\n                this.appendChild(new WPTB_Space());\n            }\n            this.appendChild(element.getDOMElement());\n            this.appendChild(space);\n        }\n        else {\n\n            classId = e.dataTransfer.getData('node');\n            element = document.getElementsByClassName(classId)[0];\n            if (this.innerHTML == '') {\n                t_space = element.nextSibling;\n                spaceParent = element.parentNode;\n                if (t_space != undefined) {\n                    spaceParent.removeChild(t_space);\n                }\n                this.appendChild(new WPTB_Space());\n            }\n            this.appendChild(element);\n            this.appendChild(space);\n        }\n        this.classList.remove('wptb-drop-here-empty');\n        return true;\n    }\n\n    DOMElement.onmousedown = function () {\n        console.log(\"MOUSE DOWN!\");\n        document.select.activateMultipleSelectMode();\n        document.select.pushSelectedCell(this);\n    };\n\n    DOMElement.onmouseover = function () {\n        document.select.pushSelectedCell(this);\n    };\n\n    DOMElement.onmouseup = function () {\n        console.log(\"MOUSE UP!\");\n        document.select.deactivateMultipleSelectMode();\n    };\n\n    this.getDOMElement = function () {\n        return DOMElement;\n    }\n\n    this.setCoords = function (y, x) {\n        var el = this.getDOMElement();\n        el.dataset.yIndex = y;\n        el.dataset.xIndex = x;\n    }\n\n    this.getCoords = function () {\n        var coords,\n            el = this.getDOMElement();\n        coords.x = el.dataset.xIndex;\n        coords.y = el.dataset.yIndex;\n        return coords;\n    }\n\n    this.appendElement = function (node) {\n        getDOMElement().appendChild(node);\n    }\n\n    return this;\n\n};","var ElementCounters = function () {\n\n\tvar priv = [];\n\tpriv['text'] = 0;\n\tpriv['image'] = 0;\n\tpriv['list'] = 0;\n\tpriv['button'] = 0;\n\n\tthis.increment = function (key) {\n\n\t\tif (!(key in priv)) {\n\t\t\treturn;\n\t\t}\n\n\t\tpriv[key]++;\n\t}\n\tthis.nextIndex = function (key) {\n\n\t\tif (!(key in priv)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn priv[key] + 1;\n\t}\n\treturn this;\n\n};","var WPTB_ElementOptions = function (element, index) {\n\n    var node = element.getDOMElement(), elemIdClass;\n\n    prop = document.querySelector(\".wptb-\" + element.kind + \"-options-prototype\").cloneNode(true);\n    prop.classList.remove(\"wptb-\" + element.kind + \"-options-prototype\"); // remove prototype from the class\n    elemIdClass = 'wptb-options-' + element.kind + \"-\" + index;\n\n    var properties = prop.getElementsByClassName('wptb-element-property');\n\n    for (var i = 0; i < properties.length; i++) {\n        properties[i].dataset.element = elemIdClass;\n    }\n\n    prop.classList.add(elemIdClass);\n    document.getElementById(\"element-options-group\").appendChild(prop);\n\n    node.onclick = function () {\n        var infArr = this.className.match(/wptb-element-((.+-)\\d+)/i),\n            optionsClass = '.wptb-' + infArr[2] + 'options' +\n                '.wptb-options-' + infArr[1];\n\n        document.getElementById('add-elements').getElementsByTagName('a')[0].classList.remove('active');\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.add('active');\n\n        document.getElementsByClassName('wptb-elements-container')[0].style.display = 'none';\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'none';\n        document.getElementById(\"element-options-group\").style.display = 'block';\n\n        var children = document.getElementById(\"element-options-group\").childNodes;\n        for (var i = 0; i < children.length; i++) {\n            if (children[i].style)\n                children[i].style.display = 'none';\n        }\n\n        document.querySelector(optionsClass).style.display = 'block';\n    };\n\n    if (element.kind == 'button') {\n        //We must add this special kind of property, since it is triggered with click event\n        var buttons = prop.getElementsByClassName('wptb-btn-size-btn');\n\n        for (var i = 0; i < buttons.length; i++) {\n            buttons[i].onclick = function () {\n                console.log('Now we should change button size');\n                var size = this.innerHTML,\n                    n_Class = this.dataset.element,\n                    infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\n                    type = infArr[1],\n                    num = infArr[2],\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0];\n                affectedEl.classList.remove('wptb-size-S');\n                affectedEl.classList.remove('wptb-size-M');\n                affectedEl.classList.remove('wptb-size-L');\n                affectedEl.classList.remove('wptb-size-XL');\n                affectedEl.classList.add('wptb-size-' + size);\n                var b = prop.getElementsByClassName('wptb-btn-size-btn');\n                for (var i = 0; i < b.length; i++) {\n                    b[i].classList.remove('selected');\n                }\n                this.classList.add('selected');\n            }\n        }\n    }\n\n    var optionControls = prop.getElementsByClassName('wptb-element-property');\n\n    for (var i = 0; i < optionControls.length; i++) {\n        if (optionControls[i].classList.contains('wptb-color-picker')) {\n            jQuery(optionControls[i]).wpColorPicker({\n                change: function (event, ui) {\n                    var parent = event.target, classe, type, ps, number;\n                    classe = parent.dataset.element.match(/wptb-options-(.+)-(\\d+)/i);\n                    type = classe[1];\n                    number = classe[2];\n                    affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + number)[0];\n                    if (type == 'button') {\n                        affectedEl.getElementsByClassName('wptb-button')[0].style.backgroundColor = ui.color.toString();\n                    }\n                    else {\n                        ps = affectedEl.getElementsByTagName(\"p\");\n                        for (var i = 0; i < ps.length; i++) {\n                            ps[i].style.color = ui.color.toString();\n                        }\n                    }\n                }\n            });\n        }\n\n        if (optionControls[i].dataset.type === 'font-size') {\n            var slider = optionControls[i].parentNode.parentNode.getElementsByClassName('wptb-text-font-size-slider')[0];\n            slider.oninput = function () {\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].value = this.value;\n                this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-number')[0].onchange();\n            }\n        }\n\n        optionControls[i].onchange = function (event) {\n\n            var n_Class = this.dataset.element,\n                infArr = n_Class.match(/wptb-options-(.+)-(\\d+)/i),\n                type = infArr[1],\n                num = infArr[2],\n                affectedEl = document.getElementsByClassName('wptb-element-' + type + '-' + num)[0],\n                val = this.value;\n\n\n            switch (this.dataset.type) {\n                case 'src':\n                    var img = affectedEl.getElementsByTagName(\"img\")[0];\n                    img.src = this.value;\n                    break;\n                case 'alternative-text':\n                    var img = affectedEl.getElementsByTagName(\"img\")[0];\n                    img.alt = this.value;\n                    break;\n                case 'image-width':\n                    var img = affectedEl.getElementsByTagName(\"img\")[0];\n                    console.log(img, this.value);\n                    img.width = this.value;\n                    break;\n                case 'image-height':\n                    var img = affectedEl.getElementsByTagName(\"img\")[0];\n                    img.height = this.value;\n                    break;\n                case 'font-size':\n                    var ps = affectedEl.getElementsByTagName(\"p\");\n                    for (var i = 0; i < ps.length; i++) {\n                        ps[i].style.fontSize = val + 'px';\n                    }\n                    this.parentNode.parentNode.getElementsByClassName('wptb-text-font-size-slider')[0].value = this.value;\n                    break;\n                case 'color':\n                    var ps = affectedEl.getElementsByTagName(\"p\");\n                    for (var i = 0; i < ps.length; i++) {\n                        ps[i].style.color = val;\n                    }\n                    break;\n                case 'button-color': console.log('Event called!');\n                    break;\n                case 'list-class':\n                    if (val == 'unordered') {\n                        event.target\n                            .parentNode\n                            .parentNode\n                            .querySelector('[data-type=list-style-type]')\n                            .parentNode\n                            .style\n                            .display = 'flex';\n                        var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\n                        for (var i = 0; i < bullets.length; i++) {\n                            bullets[i].style.listStyleType = 'disc';\n                        }\n                        document.querySelector('[data-type=list-style-type]').value = 'disc';\n                    } else {\n                        event.target\n                            .parentNode\n                            .parentNode\n                            .querySelector('[data-type=list-style-type]')\n                            .parentNode\n                            .style\n                            .display = 'none';\n                        var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\n                        for (var i = 0; i < bullets.length; i++) {\n                            bullets[i].style.listStyleType = 'decimal';\n                        }\n                    }\n                    break;\n                case 'list-style-type':\n                    var bullets = affectedEl.querySelectorAll('article .wptb-list-item-style-dot li');\n                    for (var i = 0; i < bullets.length; i++) {\n                        bullets[i].style.listStyleType = val.toLowerCase();\n                    }\n                    break;\n            }\n        };\n    }\n};","var WPTB_Image = function (src) {\n\n\tvar DOMElement = document.createElement('div'),\n\t\timg = document.createElement('img');\n\n\tthis.kind = 'image';\n\n\tDOMElement.appendChild(img);\n\n\tthis.getDOMElement = function () {\n\t\treturn DOMElement;\n\t}\n\tapplyGenericItemSettings(this);\n\n\tfile_frame = wp.media.frames.file_frame = wp.media({\n\t\ttitle: 'Select a image to upload',\n\t\tbutton: {\n\t\t\ttext: 'Use this image',\n\t\t},\n\t\tmultiple: false\n\t});\n\t// When an image is selected, run a callback.\n\tfile_frame.on('select', function () {\n\t\tattachment = file_frame.state().get('selection').first().toJSON();\n\t\timg.src = attachment.url;\n\t});\n\t// Finally, open the modal\n\tif (src == undefined) {\n\t\tfile_frame.open();\n\t}\n\telse {\n\t\timg.src = src;\n\t}\n\n\treturn this;\n\n};","var WPTB_Initializer = function () {\n\n\tconst MIN_COLUMNS = 1,\n\t\tMIN_ROWS = 1,\n\t\tMAX_COLUMNS = 10,\n\t\tMAX_ROWS = 10;\n\n\tvar tableGenerator = document.body;\n\tcolumnsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[0],\n\t\tcolumnsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[0],\n\t\trowsDecrementButton = tableGenerator.getElementsByClassName('wptb-input-number-decrement')[1],\n\t\trowsIncrementButton = tableGenerator.getElementsByClassName('wptb-input-number-increment')[1],\n\t\tcolumnsInput = document.getElementById('wptb-columns-number'),\n\t\trowsInput = document.getElementById('wptb-rows-number');\n\n\tcolumnsDecrementButton.onclick = function () {\n\t\tif (columnsInput.value > MIN_COLUMNS) {\n\t\t\tcolumnsInput.value--;\n\t\t}\n\t};\n\n\tcolumnsIncrementButton.onclick = function () {\n\t\tif (columnsInput.value < MAX_COLUMNS) {\n\t\t\tcolumnsInput.value++;\n\t\t}\n\t};\n\n\trowsDecrementButton.onclick = function () {\n\t\tif (rowsInput.value > MIN_ROWS) {\n\t\t\trowsInput.value--;\n\t\t}\n\t};\n\n\trowsIncrementButton.onclick = function () {\n\t\tif (rowsInput.value < MAX_ROWS) {\n\t\t\trowsInput.value++;\n\t\t}\n\t};\n\n\tdocument.getElementById('wptb-generate-table').onclick = function () {\n\n\t\tvar columns = document.getElementById('wptb-columns-number').value,\n\t\t\trows = document.getElementById('wptb-rows-number').value;\n\n\t\tWPTB_Table(columns, rows);\n\t}\n\n};","var WPTB_LeftPanel = function () {\n\n    var table = document.getElementsByClassName('wptb-preview-table')[0],\n        wptbElementButtons = document.getElementsByClassName('wptb-element');\n\n    jQuery('#wptb-even-row-bg').wpColorPicker({\n        change: function (event, ui) {\n            var tableRows = table.getElementsByTagName('tr');\n            for (var i = 1; i < tableRows.length; i += 2) {\n                tds = tableRows[i].getElementsByTagName('td');\n                for (var j = 0; j < tds.length; j++) {\n                    tds[j].style.backgroundColor = ui.color.toString();\n                }\n            }\n        }\n    });\n    jQuery('#wptb-odd-row-bg').wpColorPicker({\n        change: function (event, ui) {\n            var tableRows = table.getElementsByTagName('tr');\n            for (var i = 2; i < tableRows.length; i += 2) {\n                tds = tableRows[i].getElementsByTagName('td');\n                for (var j = 0; j < tds.length; j++) {\n                    tds[j].style.backgroundColor = ui.color.toString();\n                }\n            }\n        }\n    });\n    jQuery('#wptb-table-header-bg').wpColorPicker({\n        change: function (event, ui) {\n            var tableHeader = table.getElementsByTagName('tr')[0],\n                tds = tableHeader.getElementsByTagName('td');\n            for (var j = 0; j < tds.length; j++) {\n                tds[j].style.backgroundColor = ui.color.toString();\n            }\n        }\n    });\n\n    function addInnerBorderSize(value) {\n        var tableCells = table.getElementsByTagName('td');\n        for (var i = 0; i < tableCells.length; i++) {\n            tableCells[i].style.border = value + 'px solid';\n        }\n    }\n\n    function addCellPadding(value) {\n        var tableCells = table.getElementsByTagName('td');\n        for (var i = 0; i < tableCells.length; i++) {\n            tableCells[i].style.padding = value + 'px';\n        }\n    }\n\n    function addInnerBorder(checked) {\n        var styles;\n\n        if (checked == 'checked') {\n            document.getElementById('wptb-apply-inner-border').style.marginBottom = '0px';\n            var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\n            for (var i = 0; i < tableCells.length; i++) {\n                tableCells[i].style.border = '1px solid';\n            }\n\n            document.getElementById('wptb-inner-border-settings').classList.add('visible');\n        } else {\n            document.getElementById('wptb-inner-border-settings').classList.remove('visible');\n            var tableCells = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\n            for (var i = 0; i < tableCells.length; i++) {\n                tableCells[i].style.border = '';\n            }\n        }\n    }\n\n    function addBorderSize(value) {\n        table.style.border = value + 'px solid';\n    }\n\n    document.getElementById('wptb-table-cell-slider').oninput = function () {\n        document.getElementById('wptb-table-cell-number').value = this.value;\n        addCellPadding(this.value);\n    };\n\n    document.getElementById('wptb-table-cell-number').onchange = function () {\n        document.getElementById('wptb-table-cell-slider').value = this.value;\n        addCellPadding(this.value);\n    };\n\n    document.getElementById('wptb-table-border-slider').oninput = function () {\n        document.getElementById('wptb-table-border-number').value = this.value;\n        addBorderSize(this.value);\n    };\n\n    document.getElementById('wptb-table-border-number').onchange = function () {\n        document.getElementById('wptb-table-border-slider').value = this.value;\n        addBorderSize(this.value);\n    };\n\n    document.getElementById('wptb-table-inner-border-slider').oninput = function () {\n        document.getElementById('wptb-table-inner-border-number').value = this.value;\n        addInnerBorderSize(this.value);\n    };\n\n    document.getElementById('wptb-table-inner-border-number').onchange = function () {\n        document.getElementById('wptb-table-inner-border-slider').value = this.value;\n        addInnerBorderSize(this.value);\n    };\n\n    document.getElementById('wptb-inner-border-check').onchange = function () {\n        var _val = this.checked ? 'checked' : 'unchecked';\n        addInnerBorder(_val);\n    };\n\n    for (var i = 0; i < wptbElementButtons.length; i++) {\n        wptbElementButtons[i].ondragstart = function (e) {\n            e.dataTransfer.setData('wptbElement', this.dataset.wptbElement);\n        }\n    }\n\n    document.getElementById('wptb-add-end-row').onclick = table.addRowToTheEnd;\n    document.getElementById('wptb-add-start-row').onclick = table.addRowToTheStart;\n    document.getElementById('wptb-add-row-before').onclick = table.addRowBefore;\n    document.getElementById('wptb-add-row-after').onclick = table.addRowAfter;\n    document.getElementById('wptb-add-end-column').onclick = table.addColumnToTheEnd;\n    document.getElementById('wptb-add-start-column').onclick = table.addColumnToTheStart;\n    document.getElementById('wptb-add-column-before').onclick = table.addColumnBefore;\n    document.getElementById('wptb-add-column-after').onclick = table.addColumnAfter;\n    document.getElementById('wptb-delete-column').onclick = table.deleteColumn;\n    document.getElementById('wptb-delete-row').onclick = table.deleteRow;\n    document.getElementById('wptb-merge-cells').onclick = table.mergeCells;\n    document.getElementById('wptb-split-cell').onclick = table.splitCell;\n    document.getElementById('add-elements').onclick = function () {\n        document.getElementById('element-options').getElementsByTagName('a')[0].classList.remove('active');\n        document.getElementById('add-elements').getElementsByTagName('a')[0].classList.add('active');\n        document.getElementsByClassName('wptb-elements-container')[0].style.display = 'table';\n        document.getElementsByClassName('wptb-settings-section')[0].style.display = 'block';\n        document.getElementById(\"element-options-group\").style.display = 'none';\n    };\n};","var WPTB_List = function (innerElements) {\n\n    var el_L = document.createElement('ul'), item,\n        DOMElement = document.createElement('div');\n\n    this.kind = 'list';\n\n    if (!innerElements)\n        for (var i = 0; i < 3; i++) {\n            item = new WPTB_ListItem('List Item ' + (i + 1));\n            el_L.appendChild(item.getDOMElement());\n        }\n    else {\n        for (var i = 0; i < innerElements.length; i++) {\n            item = new WPTB_ListItem(innerElements[i]);\n            el_L.appendChild(item.getDOMElement());\n        }\n    }\n    DOMElement.appendChild(el_L);\n    //window.addElementOptions('list', elList);\n\n    this.getDOMElement = function () {\n        return DOMElement;\n    }\n    applyGenericItemSettings(this);\n\n    return this;\n\n};","var WPTB_ListItem = function (text) {\n\n    if (text == undefined) text = 'New List Item';\n    var DOMElement = document.createElement('article'),\n        divdot = document.createElement('div'),\n        divcontent = document.createElement('div'),\n        libullet = document.createElement('li');\n    divdot.classList.add('wptb-list-item-style-dot');\n    divcontent.classList.add('wptb-list-item-content');\n    libullet.classList.add('wptb-bullet');\n    DOMElement.appendChild(divdot);\n    DOMElement.appendChild(divcontent);\n    divdot.appendChild(libullet);\n    divcontent.innerHTML = text;\n    divcontent.onkeyup = window.listItemKeyListener;\n\n    DOMElement.onmouseenter = function (event) {\n\n        var btnDelete = document.createElement('span'),\n            btnCopy = document.createElement('span'),\n            actions = document.createElement('span'),\n            previous, i;\n        actions.classList.add('wptb-actions');\n        btnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\n        btnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\n        this.classList.add('wptb-directlyhovered');\n\n        btnDelete.onclick = function () {\n            var item = this.parentNode.parentNode,\n                parent = item.parentNode;\n            parent.removeChild(item);\n        };\n\n        btnCopy.onclick = function (event) {\n            console.log('Clicking item');\n            var article = event.target.parentNode.parentNode,\n                content = article.querySelector('.wptb-list-item-content'),\n                html = content.innerHTML;\n            var duplicate = new WPTB_ListItem(html);\n            article.parentNode.appendChild(duplicate.getDOMElement());\n        };\n\n        actions.append(btnCopy, btnDelete);\n        this.appendChild(actions);\n    };\n\n    DOMElement.onmouseleave = function (event) {\n        this.classList.remove('wptb-directlyhovered');\n        var actions = this.parentNode.querySelector('.wptb-actions');\n        if (actions != undefined) {\n            let parent = actions.parentNode;\n            parent.removeChild(actions);\n        }\n    };\n\n    divcontent.onkeydown = function (event) {\n        var key = (event.which != undefined) ? event.which :\n            event.keyCode,\n            duplicate, lastP;\n        if (key !== 13 ||\n            (window.dontAddItems !== undefined && window.dontAddItems === true)) {\n            return;\n        }\n        event.preventDefault();\n        duplicate = new WPTB_ListItem(this.innerHTML);\n        console.log('duplicate', duplicate.getDOMElement());\n        DOMElement.parentNode.insertBefore(duplicate.getDOMElement(), DOMElement);\n        console.log(divcontent);\n        divcontent.innerHTML = 'New List Item';\n        duplicate.getDOMElement().querySelector('.wptb-list-item-content').focus();\n\n        return false;\n    };\n\n    this.getDOMElement = function () {\n        return DOMElement;\n    }\n\n    return this;\n\n};","var MultipleSelect = function () {\n\n\tvar selectedCells = [],\n\t\tmultipleCellMode = false;\n\n\tthis.activateMultipleSelectMode = function () {\n\t\tselectedCells = [];\n\t\tvar tds = document.getElementsByClassName('wptb-preview-table')[0].getElementsByTagName('td');\n\t\tfor (var i = 0; i < tds.length; i++) {\n\t\t\ttds[i].classList.remove('wptb-highlighted');\n\t\t}\n\t\tmultipleCellMode = true;\n\t}\n\n\tthis.deactivateMultipleSelectMode = function () {\n\t\tconsole.log(selectedCells);\n\t\tmultipleCellMode = false;\n\t}\n\n\tthis.pushSelectedCell = function (cell) {\n\t\tif (!multipleCellMode) {\n\t\t\treturn;\n\t\t}\n\t\tselectedCells.push(cell);\n\t\tcell.classList.add('wptb-highlighted');\n\t};\n\n\tthis.selectedCells = function () {\n\t\treturn selectedCells;\n\t}\n\n\tthis.flushSelectedCells = function () {\n\t\tselectedCells = [];\n\t}\n\n\tthis.getFirst = function () {\n\t\tvar minXIndex = 1000, minYIndex = 1000, first;\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\n\t\t\tif (minXIndex >= selectedCells[i].dataset.xIndex\n\t\t\t\t&& minYIndex >= selectedCells[i].dataset.yIndex) {\n\t\t\t\tfirst = selectedCells[i];\n\t\t\t\tminXIndex = selectedCells[i].dataset.xIndex;\n\t\t\t\tminYIndex = selectedCells[i].dataset.yIndex;\n\t\t\t}\n\t\t}\n\t\treturn first;\n\t}\n\n\tthis.getLast = function () {\n\t\tvar maxXIndex = -1, maxYIndex = -1, last;\n\t\tfor (var i = selectedCells.length - 1; i >= 0; i--) {\n\t\t\tif (maxXIndex <= selectedCells[i].dataset.xIndex\n\t\t\t\t&& maxYIndex <= selectedCells[i].dataset.yIndex) {\n\t\t\t\tlast = selectedCells[i];\n\t\t\t\tmaxXIndex = selectedCells[i].dataset.xIndex;\n\t\t\t\tmaxYIndex = selectedCells[i].dataset.yIndex;\n\t\t\t}\n\t\t}\n\t\treturn last;\n\t}\n\n\tthis.removeAllButFirst = function(){\n\t\tvar td = this.getFirst(), p, i;\n\t\tfor (i = 0; i < selectedCells.length; i++) {\n\t\t\tif(selectedCells[i] == td){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t    p = selectedCells[i].parentNode;\n\t\t    p.removeChild(selectedCells[i]);\n\t\t}\n\t\tselectedCells = [td];\n\t}\n\n\tthis.changeRemovalClass = function(formerX,formerY){\n\t\tvar td = this.getFirst(),\n\t\t\tformerClass = 'wptb-fused-cell-'+formerX+'-'+formerY;\n\n\t\tfor (var i = 1; i < selectedCells.length; i++) {\n\t\t\tselectedCells[i].classList.add('wptb-fused-cell-' + td.dataset.xIndex + '-' + td.dataset.yIndex);\n\t\t}\n\t\tfor(;selectedCells.length;)\n\t\t{\n\t\t    selectedCells[i].classList.remove('wptb-fused-cell-'+td.dataset.xIndex+'-'+td.dataset.yIndex);\n\t\t    console.log('Length after cycle:',console.log(selectedCells[i]));\n\t\t}\n\t}\n\n\treturn this;\n\n};","var WPTB_Parser = function (code) {\n\n\tvar node, pos = 0;\n\n\tfunction getChar() {\n\t\tif (pos >= code.length) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn code[pos++];\n\t}\n\n\tfunction getToken() {\n\t\tvar char = getChar(),\n\t\t\ttoken = char;\n\n\t\tif (char !== '[') {\n\t\t\treturn;\n\t\t}\n\n\t\tdo {\n\t\t\tchar = getChar();\n\t\t\tif (char === -1) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\ttoken += char;\n\t\t} while (char != ']');\n\n\t\tctoken = token;\n\n\t\treturn true;\n\t}\n\n\tfunction getCurrentToken() {\n\t\treturn ctoken;\n\t}\n\n\tfunction getExpectedToken(expected) {\n\t\tif (getWordFromToken(ctoken) !== expected) {\n\t\t\tthrow 'There was an error with the file and therefore the table could not be rendered';\n\t\t}\n\n\t\tgetToken();\n\t}\n\n\tfunction getWordFromToken(token) {\n\t\tvar p = token.indexOf(' '),\n\t\t\tword = token.substring(1, p);\n\t\tif (p == -1) { //This is, if token tag has no attributes\n\t\t\treturn token;\n\t\t}\n\t\treturn '[' + word + ']';\n\t}\n\n\tfunction getAttributesFromToken() {\n\t\tvar elems = ctoken.split(' '),\n\t\t\tpair,\n\t\t\tkey,\n\t\t\tvalue,\n\t\t\tattr = [];\n\n\t\tfor (var i = 1; i < elems.length; i++) {\n\t\t\tpair = elems[i].trim().split('=');\n\t\t\tkey = pair[0];\n\t\t\tvalue = pair[1].substring(1, pair[1].length - 1);\n\t\t\tattr[key] = value;\n\t\t}\n\n\t\treturn attr;\n\t}\n\n\tfunction parseAllHTML() {\n\t\tvar html = '';\n\t\tpos--;\n\n\t\tdo {\n\t\t\tchar = getChar();\n\t\t\tif (char === -1) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\thtml += char;\n\t\t} while (char != '[');\n\n\t\thtml = html.substring(0, html.length - 1);\n\n\t\tpos--;\n\n\t\treturn html;\n\n\t}\n\n\tfunction analizeElement() {\n\t\tvar t = getWordFromToken(getCurrentToken()), html, node;\n\n\t\tswitch (t) {\n\t\t\tcase '[text]': attr = getAttributesFromToken();\n\t\t\t\tconsole.log('Attributes', attr);\n\t\t\t\tgetExpectedToken('[text]');\n\t\t\t\thtml = parseAllHTML();\n\t\t\t\tnode = new WPTB_Text(html);\n\t\t\t\tconsole.log(html);\n\t\t\t\tgetToken();\n\t\t\t\tgetExpectedToken('[/text]');\n\t\t\t\tbreak;\n\t\t\tcase '[button]': attr = getAttributesFromToken();\n\t\t\t\tconsole.log('Attributes', attr);\n\t\t\t\tgetExpectedToken('[button]');\n\t\t\t\thtml = parseAllHTML();\n\t\t\t\tnode = new WPTB_Button(html);\n\t\t\t\tgetToken();\n\t\t\t\tgetExpectedToken('[/button]');\n\t\t\t\tbreak;\n\t\t\tcase '[img]': attr = getAttributesFromToken();\n\t\t\t\tconsole.log('Attributes', attr);\n\t\t\t\tnode = new WPTB_Image(attr['src']);\n\t\t\t\tgetExpectedToken('[img]');\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn node.getDOMElement();\n\t}\n\n\tfunction analizeElements(td) {\n\t\tdo {\n\t\t\ttd.appendChild(analizeElement());\n\t\t} while (getCurrentToken() == '[image]'\n\t\t|| getCurrentToken() == '[text]'\n\t\t|| getCurrentToken() == '[list]'\n\t\t\t|| getCurrentToken() == '[button]');\n\t}\n\n\tfunction analizeRows(tableNode) {\n\t\tconsole.log('Tr', tr);\n\t\tdo {\n\t\t\tvar tr = tableNode.insertRow();\n\t\t\ttr.classList.add('wptb-row');\n\t\t\tgetExpectedToken('[tr]');\n\t\t\tanalizeTds(tr);\n\t\t\tgetExpectedToken('[/tr]');\n\t\t} while (getWordFromToken(getCurrentToken()) === '[tr]');\n\t}\n\n\tfunction analizeTd() {\n\t\tvar td = new WPTB_Cell();\n\t\tgetExpectedToken('[td]');\n\t\tanalizeElements(td.getDOMElement());\n\t\tgetExpectedToken('[/td]');\n\t\treturn td.getDOMElement();\n\t}\n\n\tfunction analizeTds(row) {\n\t\tdo {\n\t\t\trow.appendChild(analizeTd());\n\t\t} while (getCurrentToken() == '[td]');\n\t}\n\n\tfunction analizeHeader(tableNode) {\n\t\tvar header = tableNode.insertRow();\n\t\theader.classList.add('wptb-row', 'wptb-table-head');\n\t\tconsole.log('Tr', header);\n\t\tgetExpectedToken('[tr]');\n\t\tanalizeTds(header);\n\t\tgetExpectedToken('[/tr]');\n\t}\n\n\tfunction analizeRoot() {\n\t\tgetToken();\n\t\tvar n = document.createElement('table');\n\t\tn.classList.add('wptb-preview-table');\n\t\tgetExpectedToken('[table]');\n\t\tanalizeHeader(n);\n\t\tanalizeRows(n);\n\t\tgetExpectedToken('[/table]');\n\t\treturn n;\n\t}\n\n\tnode = analizeRoot();\n\n\treturn node;\n\n};","var WPTB_Settings = function () {\n\n\tvar elems = document.getElementsByClassName('wptb-element');\n\n\tfor (var i = 0; i < elems.length; i++) {\n\t\telems[i].ondragstart = function (event) {\n\t\t\tevent.dataTransfer.effectAllowed = 'move';\n\t\t\tevent.dataTransfer.setData(\"text/plain\", event.target.getAttribute('id'));\n\t\t}\n\t};\n\n\tdocument.getElementsByClassName('wptb-save-btn')[0].onclick = function () {\n\t\tvar http = new XMLHttpRequest(),\n\t\t\turl = ajaxurl + \"?action=save_table\",\n\t\t\tt = document.getElementById('wptb-setup-name').value.trim(),\n\t\t\tmessagingArea,\n\t\t\tcode = WPTB_Stringifier(document.getElementsByClassName('wptb-preview-table')[0]);\n\n\t\tif (t === '') {\n\t\t\tmessagingArea = document.getElementsByClassName('wptb-messaging')[0];\n\t\t\tmessagingArea.innerHTML = 'Error: You must assign a name to the table before saving it.';\n\t\t\tmessagingArea.classList.add('warning');\n\t\t\tsetTimeout(function () {\n\t\t\t\tmessagingArea.classList.remove('warning');\n\t\t\t}, 5000);\n\t\t}\n\t\tconsole.log('Ajax called');\n\t\tvar params = 'title=' + t + '&content=' + code;\n\t\thttp.open('POST', url, true);\n\t\thttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n\t\thttp.onreadystatechange = function (d) {\n\t\t\tif (this.readyState == 4 && this.status == 200) {\n\t\t\t\tmessagingArea = document.getElementById('wptb-messaging-area');\n\t\t\t\tmessagingArea.innerHTML = 'Success: table \"' + t + '\" was successfully saved.';\n\t\t\t\tmessagingArea.classList.add('success');\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tmessagingArea.classList.remove('success');\n\t\t\t\t}, 5000);\n\t\t\t}\n\t\t}\n\t\thttp.send(params);\n\t}\n};\n","var WPTB_Space = function (text) {\n\n    function newElementProxy(el) {\n        if (el == 'list') {\n            return new WPTB_List();\n        }\n        else if (el == 'image') {\n            return new WPTB_Image();\n        }\n        else if (el == 'text') {\n            return new WPTB_Text();\n        }\n        else if (el == 'button') {\n            return new WPTB_Button();\n        }\n    }\n\n    spaceBetween = document.createElement('div'),\n        spaceBetween.classList.add('wptb-space-between');\n\n    spaceBetween.ondragenter = function () {\n        this.classList.add('visible');\n    };\n    spaceBetween.ondragover = function (event) {\n        event.preventDefault();\n    };\n\n    spaceBetween.ondragleave = function () {\n        this.classList.remove('visible');\n    };\n\n    spaceBetween.ondrop = function (event) {\n        event.stopPropagation();\n\n        var p = event.target.nextSibling,\n            td = event.target,\n            element, t_space, spaceParent;\n\n        while (!td.classList.contains('wptb-droppable')) {\n            td = td.parentNode;\n        }\n\n        if (event.dataTransfer.getData('wptbElement')) {\n\n            element = newElementProxy(event.dataTransfer.getData('wptbElement'));\n            this.classList.remove('visible');\n\n            if (p == null) {\n                td.appendChild(element.getDOMElement());\n                td.appendChild(new WPTB_Space());\n            }\n            else {\n                td.insertBefore(element.getDOMElement(), p);\n                td.insertBefore(new WPTB_Space(), p);\n            }\n\n        }\n\n        else {\n            element = document.getElementsByClassName(event.dataTransfer.getData('node'))[0];\n            t_space = element.nextSibling;\n            spaceParent = element.parentNode;\n            if (t_space != undefined) {\n                spaceParent.removeChild(t_space);\n            }\n\n            if (p == null) {\n                td.appendChild(element);\n                td.appendChild(new WPTB_Space());\n            }\n            else {\n                td.insertBefore(element, p);\n                td.insertBefore(new WPTB_Space(), p);\n            }\n\n        }\n        this.classList.remove('visible');\n    };\n\n    return spaceBetween;\n\n};","var WPTB_Stringifier = function (node) {\n\n\tif (node == undefined || node.tagName == undefined) {\n\t\treturn '';\n\t}\n\n\tvar code = '', children = node.childNodes,\n\t\tpadding, margin, bg1, bg2, bg3, border,\n\t\tcolSpan, rowSpan, isHidden, // Table Attributes\n\t\tlistClass, listStyleType, //list attributes\n\t\tbuttonSize, buttonColor, buttonBorder, //button attributes\n\t\tfontSize, fontColor, fontFamily, //text attributes\n\t\tsrc, width, height, //image attributes\n\t\tadditionalCSS, additionalClass, additionalID; // A few global attributes I wanted to add.\n\n\tswitch (node.tagName.toLowerCase()) {\n\t\tcase 'table':\n\t\t\tborder = node.style.borderSize;\n\t\t\tmargin = node.getElementsByTagName('td')[0].style.margin;\n\t\t\tpadding = node.getElementsByTagName('td')[0].style.padding;\n\t\t\tinnerBorder = node.getElementsByTagName('td')[0].style.borderSize;\n\t\t\tbg1 = node.rows[0].getElementsByTagName('td')[0].style.backgroundColor;\n\n\t\t\tif (node.rows.length > 1) {\n\t\t\t\tbg2 = node.rows[1].getElementsByTagName('td')[0].style.backgroundColor;\n\t\t\t}\n\t\t\tif (node.rows.length > 2) {\n\t\t\t\tbg3 = node.rows[2].getElementsByTagName('td')[0].style.backgroundColor;\n\t\t\t}\n\t\t\tconsole.log(innerBorder);\n\t\t\tcode += '[table'\n\t\t\t\t+ (margin != undefined && margin != '' ? ' margin=\"' + margin + '\"' : '')\n\t\t\t\t+ (padding != undefined && padding != '' ? ' padding=\"' + padding + '\"' : '')\n\t\t\t\t+ (innerBorder != undefined ? ' inner-border=\"' + innerBorder + '\"' : '')\n\t\t\t\t+ (bg1 != undefined ? ' data-bg1=\"' + bg1 + '\"' : '')\n\t\t\t\t+ (bg2 != undefined ? ' data-bg2=\"' + bg2 + '\"' : '')\n\t\t\t\t+ (bg3 != undefined ? ' data-bg3=\"' + bg3 + '\"' : '')\n\t\t\t\t+ ']';\n\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\tcode += WPTB_Stringifier(children[i]);\n\t\t\t}\n\n\t\t\tcode += '[/table]';\n\t\t\tbreak;\n\t\tcase 'tbody':\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\tcode += WPTB_Stringifier(children[i]);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'tr':\n\t\t\tcode += '[tr]';\n\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\tcode += WPTB_Stringifier(children[i]);\n\t\t\t}\n\n\t\t\tcode += '[/tr]';\n\t\t\tbreak;\n\t\tcase 'td': colspan = node.colSpan;\n\t\t\trowspan = node.rowSpan;\n\t\t\tisHidden = node.classList.contains(/^wptb-fused-cell-(\\d+)$/);\n\t\t\tcode += '[td'\n\t\t\t\t+ (colspan != undefined && colspan > 1 ? ' colspan=\"' + colspan + '\"' : '')\n\t\t\t\t+ (rowspan != undefined && rowspan > 1 ? ' rowspan=\"' + rowspan + '\"' : '')\n\t\t\t\t+ (isHidden ? ' hidden=\"true\"' : '')\n\t\t\t\t+ ']';\n\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\tcode += WPTB_Stringifier(children[i]);\n\t\t\t}\n\n\t\t\tcode += '[/td]';\n\t\t\tbreak;\n\t\tcase 'div':\n\t\t\tif (node.classList.contains('wptb-ph-element')) {\n\n\t\t\t\tvar infArr = node.className.match(/wptb-element-(.+)-(\\d+)/i),\n\t\t\t\t\toptionsClass, trueNode,\n\t\t\t\t\tnodeContent;\n\t\t\t\tif (infArr == undefined) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tswitch (infArr[1]) {\n\t\t\t\t\tcase 'list':\n\t\t\t\t\t\ttrueNode = node.getElementsByTagName('ul')[0];\n\t\t\t\t\t\tif (!trueNode) {\n\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlistStyleType = trueNode.getElementsByTagName('li')[0].style.listStyleType;\n\t\t\t\t\t\tlistClass = listStyleType == 'decimal' ? 'numbered' : 'unordered';\n\n\t\t\t\t\t\tcode += '[list'\n\t\t\t\t\t\t\t+ (listClass != undefined ? ' class=\"' + listClass + '\"' : 'class=\"unordered\"')\n\t\t\t\t\t\t\t+ (listStyleType != undefined ? ' style-type=\"' + listStyleType + '\"' : '')\n\t\t\t\t\t\t\t+ ']';\n\t\t\t\t\t\tlistitems = trueNode.getElementsByTagName('article');\n\t\t\t\t\t\tfor (var i = 0; i < listitems.length; i++) {\n\t\t\t\t\t\t\tcode += '[item]';\n\t\t\t\t\t\t\tcode += listitems[i]\n\t\t\t\t\t\t\t\t.getElementsByClassName('wptb-list-item-content')[0]\n\t\t\t\t\t\t\t\t.innerHTML;\n\t\t\t\t\t\t\tcode += '[/item]';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcode += '[/list]';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'image':\n\n\t\t\t\t\t\ttrueNode = node.getElementsByTagName('img')[0];\n\t\t\t\t\t\tif (!trueNode) {\n\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsrc = trueNode.src;\n\t\t\t\t\t\twidth = trueNode.width;\n\t\t\t\t\t\theight = trueNode.height;\n\t\t\t\t\t\talt = trueNode.alt;\n\t\t\t\t\t\tcode += '[img' +\n\t\t\t\t\t\t\t+(src != undefined ? ' src=\"' + src + '\"' : '')\n\t\t\t\t\t\t\t+ (width != undefined ? ' width=\"' + width + '\"' : '')\n\t\t\t\t\t\t\t+ (height != undefined ? ' height=\"' + height + '\"' : '')\n\t\t\t\t\t\t\t+ ']';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'text':\n\t\t\t\t\t\ttrueNode = node.getElementsByClassName('editable')[0];\n\t\t\t\t\t\tif (!trueNode) {\n\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfontSize = trueNode.getElementsByTagName('p')[0].style.fontSize;\n\t\t\t\t\t\tfontColor = trueNode.getElementsByTagName('p')[0].style.color;\n\t\t\t\t\t\tcode += '[text'\n\t\t\t\t\t\t\t+ (fontSize != undefined ? ' size=\"' + fontSize + '\"' : '')\n\t\t\t\t\t\t\t+ (fontColor != undefined ? ' color=\"' + fontColor + '\"' : '')\n\t\t\t\t\t\t\t+ ']';\n\t\t\t\t\t\tcode += trueNode.innerHTML;\n\t\t\t\t\t\tcode += '[/text]';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'button':\n\t\t\t\t\t\ttrueNode = node.getElementsByClassName('editable')[0];\n\t\t\t\t\t\tif (!trueNode) {\n\t\t\t\t\t\t\treturn ''; //We ignore the node in case of error\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbuttonColor = trueNode.style.backgroundColor;\n\t\t\t\t\t\tconsole.log(node);\n\t\t\t\t\t\tbuttonSize = node.className.match(/wptb-size-(.+)/i)[1];\n\n\t\t\t\t\t\tcode += '[button'\n\t\t\t\t\t\t\t+ (buttonColor != undefined ? ' color=\"' + buttonColor + '\"' : '')\n\t\t\t\t\t\t\t+ (buttonSize != undefined ? ' size=\"' + buttonSize + '\"' : '')\n\t\t\t\t\t\t\t+ ']';\n\t\t\t\t\t\tcode += trueNode.innerHTML;\n\t\t\t\t\t\tcode += '[/button]';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tcode += '';\n\t\t\tbreak;\n\t}\n\n\tif (node.nextSibling != undefined) {\n\t\tWPTB_Stringifier(node.nextSibling);\n\t}\n\n\treturn code;\n\n};","var WPTB_Table = function (columns, rows) {\n\n\tvar settings = document.getElementsByClassName('wptb-settings-items'),\n\t\twptbTableSetup = document.getElementsByClassName(\"wptb-table-setup\")[0],\n\t\ttable, row, cell;\n\n\tfor (var i = 0; i < settings.length; i++) {\n\t\tsettings[i].classList.add('visible');\n\t}\n\n\tdocument.getElementsByClassName('wptb-table-generator')[0].style.display = 'none';\n\n\t//Create a HTML Table element.\n\ttable = document.createElement('table');\n\ttable.classList.add('wptb-preview-table');\n\n\t//Add the header row.\n\trow = table.insertRow(-1);\n\trow.classList.add('wptb-table-head', 'wptb-row');\n\n\tfor (var i = 0; i < columns; i++) {\n\t\tcell = new WPTB_Cell();\n\t\tcell.setCoords(0, i);\n\t\trow.appendChild(cell.getDOMElement());\n\t}\n\n\t//Add the data rows.\n\tfor (var i = 1; i < rows; i++) {\n\n\t\trow = table.insertRow(-1);\n\t\trow.classList.add('wptb-row');\n\n\t\tfor (var j = 0; j < columns; j++) {\n\t\t\tcell = new WPTB_Cell();\n\t\t\tcell.setCoords(i, j);\n\t\t\trow.appendChild(cell.getDOMElement());\n\t\t}\n\t}\n\n\ttable.recalculateIndexes = function () {\n\n\t\tvar trs = this.getElementsByTagName('tr'), tds, maxCols = 0;\n\n\t\tfor (var i = 0; i < trs.length; i++) {\n\t\t\ttds = trs[i].getElementsByTagName('td');\n\t\t\tfor (var j = 0; j < tds.length; j++) {\n\n\t\t\t\tif (i == 0) {\n\t\t\t\t\ttds[j].parentNode.className = '';\n\t\t\t\t\ttds[j].parentNode.classList.add('wptb-row', 'wptb-table-head');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttds[j].parentNode.className = '';\n\t\t\t\t\ttds[j].parentNode.classList.add('wptb-row');\n\t\t\t\t}\n\n\t\t\t\ttds[j].dataset.xIndex = j;\n\t\t\t\ttds[j].dataset.yIndex = i;\n\t\t\t}\n\t\t\tif (j > maxCols) {\n\t\t\t\tmaxCols = j;\n\t\t\t}\n\t\t}\n\t\tthis.columns = maxCols;\n\t\tconsole.log('Table dimensions: ' + trs.length + ' rows ,' + maxCols + ' columns');\n\n\t}\n\n\ttable.addColumn = function (pos) {\n\t\tvar referenceTd, newTd, _this, xCoord;\n\t\treferenceTd = this.getElementsByClassName('wptb-highlighted')[0];\n\t\tconsole.log('Table', this.rows.length);\n\t\tfor (var i = 0; i < this.rows.length; i++) {\n\t\t\tconsole.log('Iteration ' + (i + 1));\n\t\t\tvar newTd = new WPTB_Cell();\n\n\t\t\tif (pos == 'before' || pos == 'after') {\n\t\t\t\txCoord = referenceTd.dataset.xIndex;\n\t\t\t\treferenceTd = this.rows[i].getElementsByTagName('td')[0];\n\t\t\t\tfor (var j = 0; j < xCoord; j++) {\n\t\t\t\t\treferenceTd = this.rows[i].childNodes[j];\n\t\t\t\t}\n\n\t\t\t\tif (pos == 'before') {\n\t\t\t\t\tconsole.log('referenceTd', referenceTd);\n\t\t\t\t\tthis.rows[i].insertBefore(newTd.getDOMElement(), referenceTd);\n\n\t\t\t\t\tvar buttons = document.getElementsByClassName('wptb-relative-action');\n\t\t\t\t\tfor (var k = 0; k < buttons.length; k++) {\n\t\t\t\t\t\tbuttons[k].dataset.xIndex++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.rows[i].insertBefore(newTd.getDOMElement(), referenceTd.nextSibling);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (pos == 'end') {\n\t\t\t\tthis.rows[i].appendChild(newTd.getDOMElement());\n\t\t\t}\n\t\t\telse {\n\t\t\t\treferenceTd = this.rows[i].getElementsByTagName('td')[0];\n\t\t\t\tthis.rows[i].insertBefore(newTd.getDOMElement(), referenceTd);\n\t\t\t}\n\t\t\ttable.columns++;\n\t\t}\n\n\t\tthis.recalculateIndexes();\n\t};\n\n\ttable.addColumnToTheEnd = function (evt) {\n\t\ttable.addColumn('end', this.dataset.activeCell);\n\t};\n\n\ttable.addColumnToTheStart = function (evt) {\n\t\ttable.addColumn('start', this.dataset.activeCell);\n\t};\n\n\ttable.addColumnBefore = function () {\n\t\ttable.addColumn('before', this.dataset.activeCell);\n\t};\n\n\ttable.addColumnAfter = function () {\n\t\ttable.addColumn('after', this.dataset.activeCell);\n\t};\n\n\ttable.addRow = function (pos) {\n\t\tvar _this, row, referenceRow = undefined;\n\n\t\tif (pos == 'end' || pos == 'start') {\n\t\t\trow = this.insertRow(pos == 'end' ? -1 : 0);\n\t\t} else {\n\t\t\trow = document.createElement('tr');\n\t\t}\n\n\t\tfor (var j = 0; j < this.columns; j++) {\n\t\t\tvar cell = new WPTB_Cell();\n\t\t\trow.appendChild(cell.getDOMElement());\n\t\t}\n\n\t\trow.classList.add('wptb-row');\n\n\t\tif (pos == 'before' || pos == 'after') {\n\t\t\t_this = this.getElementsByClassName('wptb-highlighted')[0];\n\t\t\treferenceRow = this.getElementsByTagName('tr')[_this.dataset.yIndex];\n\t\t\tif (pos == \"before\") {\n\t\t\t\tthis.getElementsByTagName('tbody')[0].insertBefore(row, referenceRow);\n\t\t\t\tvar buttons = document.getElementsByClassName('wptb-relative-action');\n\t\t\t\tfor (var i = 0; i < buttons.length; i++) {\n\t\t\t\t\tbuttons[i].dataset.yIndex++;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.getElementsByTagName('tbody')[0].insertBefore(row, referenceRow.nextSibling);\n\t\t\t}\n\t\t}\n\n\t\tif (pos == 'before' || pos == 'start') {\n\t\t\tvar active = document.querySelector('wptb-highlighted');\n\t\t\tif (active) {\n\t\t\t\tactive.onclick();\n\t\t\t}\n\t\t}\n\n\t\tthis.recalculateIndexes();\n\t};\n\n\ttable.addRowToTheEnd = function (evt) {\n\t\ttable.addRow('end');\n\t};\n\n\ttable.addRowToTheStart = function (evt) {\n\t\ttable.addRow('start');\n\t};\n\n\ttable.addRowBefore = function () {\n\t\ttable.addRow('before');\n\t};\n\n\ttable.addRowAfter = function () {\n\t\ttable.addRow('after');\n\t};\n\n\ttable.deleteRow = function (e) {\n\t\tvar cell = document.getElementsByClassName('wptb-highlighted')[0],\n\t\t\tindex = cell.dataset.yIndex,\n\t\t\ttable = document.getElementsByClassName('wptb-preview-table')[0],\n\t\t\trow = table.getElementsByTagName('tr')[index],\n\t\t\trowCount = table.rows.length,\n\t\t\ttbody = row.parentNode;\n\t\tif ((rowCount == 1 && columnCount == 1) || tbody == undefined) {\n\t\t\treturn;\n\t\t}\n\t\ttbody.removeChild(row);\n\t\tthis.recalculateIndexes();\n\t};\n\n\ttable.deleteColumn = function (e) {\n\t\tvar cell = document.getElementsByClassName('wptb-highlighted')[0],\n\t\t\tnum = cell.dataset.xIndex,\n\t\t\ttable = document.getElementsByClassName('wptb-preview-table')[0],\n\t\t\trowCount = table.rows.length;\n\n\t\tif ((rowCount == 1 && columnCount == 1)) {\n\t\t\treturn;\n\t\t}\n\t\tfor (var i = 0; i < rowCount; i++) {\n\t\t\tvar td = table.getElementsByTagName('tr')[i].getElementsByTagName('td')[num],\n\t\t\t\ttr = td.parentNode;\n\t\t\ttr.removeChild(td);\n\t\t}\n\t\tthis.recalculateIndexes();\n\t};\n\n\ttable.mergeCells = function () {\n\t\tvar firstCell = document.select.getFirst(),\n\t\t\tlastCell = document.select.getLast(),\n\t\t\tcolspan = Math.abs(lastCell.dataset.xIndex - firstCell.dataset.xIndex) + 1,\n\t\t\trowspan = Math.abs(lastCell.dataset.yIndex - firstCell.dataset.yIndex) + 1;\n\n\t\tconsole.log(firstCell);\n\t\tconsole.log(lastCell);\n\t\tconsole.log(colspan + ' ' + rowspan);\n\n\t\tdocument.select.removeAllButFirst();\n\n\t\tif (colspan > 1) {\n\t\t\tfirstCell.colSpan = colspan;\n\t\t}\n\n\t\tif (rowspan > 1) {\n\t\t\tfirstCell.rowSpan = rowspan;\n\t\t}\n\t\ttable.recalculateIndexes();\n\t};\n\n\ttable.splitCell = function () {\n\t\tvar cell = document.getElementsByClassName('wptb-highlighted')[0],\n\t\t\tclassn, hidden;\n\t\tif (cell.colSpan == 1 && cell.rowSpan == 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tcell.colSpan = 1;\n\t\tcell.rowSpan = 1;\n\n\t\tclassn = 'wptb-fused-cell-' + cell.dataset.xIndex + '-' + cell.dataset.yIndex;\n\t\thidden = document.getElementsByClassName(classn);\n\t\tconsole.log('Initial:', hidden);\n\n\t\tfor (; hidden.length;) {\n\t\t\tconsole.log(hidden[0]);\n\t\t\thidden[0].classList.remove(classn);\n\t\t}\n\t\ttable.recalculateIndexes();\n\t};\n\n\twptbTableSetup.appendChild(table);\n\n\ttable.recalculateIndexes();\n\n\tWPTB_LeftPanel();\n\n};","var WPTB_Text = function (text) {\n\n\tvar DOMElement = document.createElement('div'),\n\t\telText2 = document.createElement('div'),\n\t\telP = document.createElement('p');\n\n\tthis.kind = 'text';\n\n\telText2.classList.add('editable');\n\telP.innerHTML = text != undefined ? text : 'Text';\n\telText2.appendChild(elP);\n\tDOMElement.appendChild(elText2);\n\n\tthis.getDOMElement = function () {\n\t\treturn DOMElement;\n\t}\n\tapplyGenericItemSettings(this);\n\n\treturn this;\n\n};","var applyGenericItemSettings = function (element) {\n\n\tvar node = element.getDOMElement(),\n\t\tindex = document.counter.nextIndex(element.kind),\n\t\tlistItems;\n\n\tnode.onmouseenter = function (event) {\n\t\tthis.classList.add('wptb-directlyhovered');\n\t\tvar btnDelete = document.createElement('span'),\n\t\t\tbtnCopy = document.createElement('span'),\n\t\t\tbtnMove = document.createElement('span'),\n\t\t\tactions = document.createElement('span'),\n\t\t\tprevious, i;\n\t\tactions.classList.add('wptb-actions');\n\t\tbtnDelete.classList.add('dashicons', 'dashicons-trash', 'delete-action');\n\t\tbtnCopy.classList.add('dashicons', 'dashicons-admin-page', 'duplicate-action');\n\t\tbtnMove.classList.add(\"dashicons\", \"dashicons-move\", 'move-action');\n\t\tbtnMove.draggable = true;\n\t\tbtnDelete.onclick = function (event) {\n\t\t\tvar act = this.parentNode.parentNode,\n\t\t\t\tel = act.parentNode;\n\t\t\tel.removeChild(act);\n\t\t};\n\t\tbtnCopy.onclick = function (event) {\n\t\t\tif (element.kind == 'list') {\n\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\n\t\t\t\t\ttemp = [],\n\t\t\t\t\tsrcList = event.target.parentNode.parentNode.querySelectorAll('ul article .wptb-list-item-content');\n\n\t\t\t\tfor (var i = 0; i < srcList.length; i++) {\n\t\t\t\t\ttemp.push(srcList[i].innerHTML);\n\t\t\t\t}\n\t\t\t\tvar copy = new WPTB_List(temp);\n\t\t\t\ttd.appendChild(copy.getDOMElement());\n\n\t\t\t}\n\t\t\telse if (element.kind == 'text') {\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\n\t\t\t\t\tcopy = new WPTB_Text(event.target.parentNode.parentNode.childNodes[0].innerHTML);\n\t\t\t\ttd.appendChild(copy.getDOMElement());\n\t\t\t} else if (element.kind == 'image') {\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\n\t\t\t\t\tcopy = new WPTB_Image(event.target.parentNode.parentNode.childNodes[0].src);\n\t\t\t\ttd.appendChild(copy.getDOMElement());\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar td = event.target.parentNode.parentNode.parentNode,\n\t\t\t\t\tcopy = new WPTB_Button(event.target.parentNode.parentNode.childNodes[0].innerHTML);\n\t\t\t\ttd.appendChild(copy.getDOMElement());\n\t\t\t}\n\t\t};\n\t\tbtnMove.ondragstart = function (event) {\n\t\t\tvar parent = this, infArr, type;\n\n\t\t\twhile (parent.className == '' ||\n\t\t\t\t!parent.classList.contains('wptb-ph-element')) {\n\t\t\t\tparent = parent.parentNode;\n\t\t\t}\n\n\n\t\t\tinfArr = parent.className.match(/wptb-element-(.+)-(\\d+)/i);\n\t\t\ttype = infArr[1];\n\n\t\t\tvar img = document.createElement(\"img\");\n\t\t\timg.src = \"http://localhost/sandbox/wp-content/plugins/wp-table-builder/inc/admin/views/builder/icons/\" + type + \".png\";\n\t\t\tconsole.log(img.src);\n\t\t\tevent.dataTransfer.setDragImage(img, 0, 0);\n\t\t\tevent.dataTransfer.setData('node', 'wptb-element-' + infArr[1] + '-' + infArr[2]);\n\t\t};\n\n\n\t\tif (element.kind === 'button') {\n\t\t\ttinyMCE.init({\n\t\t\t\ttarget: node.childNodes[0].childNodes[0],\n\t\t\t\tinline: true,\n\t\t\t\tplugins: \"link\",\n\t\t\t\tdialog_type: \"modal\",\n\t\t\t\ttheme: 'modern',\n\t\t\t\tmenubar: false,\n\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\n\t\t\t\ttoolbar: 'bold italic strikethrough',\n\t\t\t\tsetup: function (ed) {\n\t\t\t\t\ted.on(\"init\",\n\t\t\t\t\t\tfunction (ed) {\n\t\t\t\t\t\t\ttinyMCE.execCommand('mceRepaint');\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tinit_instance_callback: function (editor) {\n\t\t\t\t\teditor.on('change', function (e) {\n\t\t\t\t\t\t// check if it becomes empty because if there's no value it's hard to edit the editor in button element\n\t\t\t\t\t\tif (editor.getContent() == \"\") {\n\t\t\t\t\t\t\teditor.setContent(\"<p class='wptb-button'>Button Text</p>\");\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditor.on('KeyDown', function (e) {\n\t\t\t\t\t\tvar range = editor.selection.getRng();\n\t\t\t\t\t\tvar KeyID = e.keyCode;\n\t\t\t\t\t\tif (range.startOffset == 0 && (KeyID == 8 || KeyID == 46)) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\teditor.setContent(\"<p class='wptb-button'></p>\");\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\twindow.currentEditor = editor;\n\t\t\t\t\teditor.on('focus', function (e) {\n\n\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\n\t\t\t\t\t\tif (window.currentEditor &&\n\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\n\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (element.kind === 'text') {\n\t\t\ttinyMCE.init({\n\t\t\t\ttarget: node.childNodes[0],\n\t\t\t\tinline: true,\n\t\t\t\tplugins: \"link, paste\",\n\t\t\t\tdialog_type: \"modal\",\n\t\t\t\ttheme: 'modern',\n\t\t\t\tmenubar: false,\n\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\n\t\t\t\tpaste_as_text: true,\n\t\t\t\ttoolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\n\t\t\t\tinit_instance_callback: function (editor) {\n\t\t\t\t\twindow.currentEditor = editor;\n\t\t\t\t\teditor.on('focus', function (e) {\n\n\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\n\t\t\t\t\t\tif (window.currentEditor &&\n\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\n\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\n\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\t\telse {\n\t\t\tlistItems = node.getElementsByClassName('wptb-list-item-content');\n\t\t\tfor (var i = 0; i < listItems.length; i++) {\n\t\t\t\ttinyMCE.init({\n\t\t\t\t\ttarget: listItems[i],\n\t\t\t\t\tinline: true,\n\t\t\t\t\tplugins: \"link, paste\",\n\t\t\t\t\tdialog_type: \"modal\",\n\t\t\t\t\ttheme: 'modern',\n\t\t\t\t\tmenubar: false,\n\t\t\t\t\tfixed_toolbar_container: '#wpcd_fixed_toolbar',\n\t\t\t\t\tpaste_as_text: true,\n\t\t\t\t\ttoolbar: 'bold italic strikethrough link unlink | alignleft aligncenter alignright alignjustify',\n\t\t\t\t\tinit_instance_callback: function (editor) {\n\t\t\t\t\t\twindow.currentEditor = editor;\n\t\t\t\t\t\teditor.on('focus', function (e) {\n\t\t\t\t\t\t\tvar totalWidth = document.getElementsByClassName('wptb-builder-panel')[0].offsetWidth;\n\t\t\t\t\t\t\tif (window.currentEditor &&\n\t\t\t\t\t\t\t\tdocument.getElementById('wptb_builder').scrollTop >= 55 &&\n\t\t\t\t\t\t\t\twindow.currentEditor.bodyElement.style.display != 'none') {\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'fixed';\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.right = (totalWidth / 2 - document.getElementById('wpcd_fixed_toolbar').offsetWidth / 2) + 'px';\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.top = '100px';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdocument.getElementById('wpcd_fixed_toolbar').style.position = 'static';\n\t\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.right;\n\t\t\t\t\t\t\t\tdelete document.getElementById('wpcd_fixed_toolbar').style.top;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tactions.appendChild(btnMove);\n\t\tactions.appendChild(btnCopy);\n\t\tactions.appendChild(btnDelete);\n\t\tthis.appendChild(actions);\n\t};\n\n\tnode.onmouseleave = function (event) {\n\t\tvar formerActions = this.getElementsByClassName('wptb-actions');\n\t\tif (formerActions && formerActions[0]) {\n\t\t\tlet par = formerActions[0].parentNode;\n\t\t\tpar.removeChild(formerActions[0]);\n\t\t}\n\t\tthis.classList.remove('wptb-directlyhovered');\n\t};\n\n\tnode.classList.add('wptb-ph-element', 'wptb-element-' + element.kind + '-' +\n\t\tindex);\n\n\tnew WPTB_ElementOptions(element, index);\n\n\tdocument.counter.increment(element.kind);\n\n};",""]}